{
  "v2.3.11": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "def install(package):",
    "subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", package])",
    "install(\"tensorflow==1.13.1\")",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Suppress tensorflow warning messages",
    "Train, evaluate & predict functions / all require TF",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path = auxfun_models.check_for_weights(pose_cfg['net_type'], parent_path)",
    "Updating training and test pose_cfg:",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read the config file",
    "deal with user passing a single video to add",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "looking for the pseudo label path",
    "spatial pyramid is not for adapted model",
    "spatial pyramid can still be useful for reducing jittering and quantization error",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "ratio_h and ratio_w should match though in reality it does not match exactly",
    "only keep the max",
    "empty prediction if pred is not a dict",
    "Compute cosine similarity",
    "len(frames) -> (n_scale,)",
    "frames[0].shape - > (batchsize, h, w, 3)",
    "no crop needed",
    "batch full, start true inferencing",
    "only do this when animal is detected",
    "in case we reach the end of the video",
    "add a temp folder for checkpoint",
    "spatial pyramid can still be useful for reducing jittering and quantization error",
    "extra data",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO(stes) mocking a few modules to rely in fewer dependencies, without",
    "causing import errors when using deeplabcut.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in.",
    "TODO(jeylau) add affinity.setter to Assembly",
    "TODO(stes): remove/rewrite",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "ignore the exception and continue with the next evaluation, without",
    "yielding a result value.",
    "return the result value, with NaN as the result for all metrics that",
    "could not be computed due to the error.",
    "raise the error and stop evaluation",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read the config file and related variables",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Flatten the list of bodyparts to connect",
    "Format data",
    "Trick to force equal aspect ratio of 3D plots",
    "Set up the matplotlib figure beforehand",
    "Set up skeleton LineCollections",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "Get track_method and do related checks",
    "Get track method suffix",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "## Assign nan to [X,Y] of low likelihood predictions ###",
    "Convert the data to a np array to easily mask out the low likelihood predictions",
    "Assign [X,Y] = nan to low likelihood predictions",
    "Reshape data back to original shape",
    "put data back to the dataframes",
    "Check individuals are the same in both views",
    "Cross-view match individuals",
    "Create a dummy variables for single-animal",
    "Cleaner variable (since inds view1 == inds view2)",
    "Reshape: (num_framex, num_individuals, num_bodyparts , 2)",
    "Triangulate data",
    "i is individual in view 1",
    "voting[i] is the matched individual in view 2",
    "Create 3D DataFrame column and row indices",
    "Swap num_animals with num_frames axes to ensure well-behaving reshape",
    "Fill up 3D dataframe",
    "Reorder 2D dataframe in view 2 to match order of view 1",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no intermediate saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "Store tracklets and corresponding negatives (those that overlap in time)",
    "TODO Avoid looping over all pairs of tracklets",
    "Pick the closest (spatially) overlapping tracklet",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Guarantee track data are sorted in the order defined in the config",
    "If there isn't a track for each animal, fill in the dataframe with NaNs",
    "Default to the distance cost function",
    "should only exist one",
    "Add in identity weighing before building the graph",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "offset if the data was cropped",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implementation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "make sure coords and videos are a list",
    "can we make a catch here? - in fact we should drop indices from DataCombined",
    "if they are in CollectedData.. [ideal behavior; currently pretty unlikely]",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "parse the alpha selection function",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "more videos are in principle covered, as OpenCV is used and allows many formats.",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "uses openCV",
    "cap.release() >> still used in frame_extraction!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "This dictionary maps the model types to the file locations where the models exist.",
    "Exit the function early if an unknown modeltype is provided.",
    "The path is right, hence the weights are missing; we'll download them again.",
    "Aliases for backwards-compatibility",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluding the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Initialize costs matrix",
    "get common bodypart detections in track pair",
    "add 3rd dim to the points",
    "cost for any point in time of t1 being the same",
    "any point in time of t2",
    "Get average cost of the entire track",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "check if it exists:",
    "(average_degree / 2) as many edges as there are nodes is required",
    "for undirected graphs to reach the target degree.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (individual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "In a multi animal scenario, show more verbose errors.",
    "Some vidoes were not evaluated.",
    "Keep only the individuals and bodyparts that were labeled",
    "Either display the animals defined in the config if they are found",
    "in the dataframe, or all the trajectories regardless of their names",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Load the config file",
    "Get the Project path",
    "Get the bodyparts",
    "Iterate over each labeled data video",
    "Use tqdm for a progress bar",
    "discard the file extension",
    "Load the csv file",
    "get the scorer",
    "Change the scorer in the dataframe",
    "Get the individuals",
    "Get the old bodyparts",
    "Get the unmber of old bodyparts",
    "Bodyparts to add",
    "If a bodypart is missing, add it to the dataframe",
    "create the columns for the bodypart, concatenate, the individual, the bodypart, and nan values",
    "Insert the columns in the dataframe",
    "If the old bodyparts are not in the new project, remove them",
    "Save the dataframe",
    "Create/Update the h5 file",
    "Make paths platform-agnostic if they are not already",
    "Ensure folder names are strings",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "make list of full paths",
    "filter list of videos",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "sort in ascending order of iteration number",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "aliases for backwards-compatibility.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Set up a logger and add an stdout handler.",
    "A single logger can have many handlers:",
    "https://docs.python.org/3/howto/logging.html#handler-basic",
    "TODO Dump to log file instead",
    "logger = logging.getLogger(\"GUI\")",
    "logger.setLevel(logging.DEBUG)",
    "handler = logging.StreamHandler(stream=sys.stdout)",
    "handler.setLevel(logging.DEBUG)",
    "formatter = logging.Formatter(",
    "\"%(asctime)s - %(name)s - %(levelname)s - %(message)s\", \"%Y-%m-%d %H:%M:%S\"",
    ")",
    "handler.setFormatter(formatter)",
    "logger.addHandler(handler)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "restore the background region",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Create dropdowns for selecting tracklets to swap, placing them near the swap button",
    "Get tracklet indices for each individual",
    "Frames to swap",
    "Swap the tracklets",
    "check that the input is a valid from the list of individuals",
    "check that the input is a valid from the list of individuals",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Thread-safe Stdout redirector",
    "Creating action using the first constructor",
    "Creating actions using the second constructor",
    "File menu",
    "View menu",
    "Help menu",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "all_bodyparts: List",
    "NOTE: Is there a case where a specific list should",
    "have bodyparts other than the root? I don't think so.",
    "Videotype selection",
    "Select videos",
    "Number of selected videos text",
    "Clear video selection",
    "Create a filter string with both lowercase and uppercase extensions",
    "Qt returns a tuple (list of files, filetype)",
    "Add tab header",
    "Add separating line",
    "Look for any extension by default",
    "This works both with e.g. .avi and avi",
    "Choose multiple files by default",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Automatically activate the napari-deeplabcut plugin",
    "TODO Insert new video",
    "TODO Insert skeleton link",
    "Hack to make the first column read-only, as we do not want users to touch it.",
    "The cleaner solution would be to use a QTreeView and QAbstractItemModel,",
    "but that is a lot of rework for little benefits.",
    "Leave untouched when it is already a string",
    "Slashes also raise the error, but no need to print anything since it is then likely to be a path",
    "Walk backwards across parents to get all keys",
    "Read the video until a frame is successfully read",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO: Multi video select.... have to change to single video!",
    "Shuffle",
    "Num animals",
    "Min swap length",
    "Max gap to fill",
    "Trail length",
    "Filter type",
    "Filter window length",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Tracker Type",
    "Num animals",
    "Num triplets",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Overwrite videos",
    "Trail Points",
    "Plot all bodyparts",
    "Skeleton",
    "Filtered data",
    "Plot trajectories",
    "High quality video",
    "Bodypart list",
    "Multianimal scenario.",
    "Color is based on individual or bodypart.",
    "Single animal scenario.",
    "Color is based on bodypart.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Extraction method",
    "Frame extraction algorithm",
    "Frame cropping",
    "Cluster step",
    "GUI Slider width",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "use the default pose_cfg file for default values",
    "Shuffle",
    "Display iterations",
    "Save iterations",
    "Max iterations",
    "Max number snapshots to keep",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Single / Multi animal Only Layouts",
    "Dynamic bodypart cropping",
    "Save results as csv",
    "Filter predictions",
    "Plot Trajectories",
    "Show trajectory plots",
    "Shuffle",
    "layout.addLayout(tmp_layout)",
    "tmp_layout = QtWidgets.QGridLayout()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Augmentation method",
    "Neural Network",
    "TODO: finish model_comparison",
    "Check that training data files were indeed created.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Add config text field and button",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Display all images",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "calling create_tracking_dataset, train_tracking_transformer, stitch_tracklets",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "only try to find these features if they are in the dictionary",
    "1) reference to video folder and get the proper bpt_feature file for feature table",
    "2) get either the path to gt or the path to track pickle",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "tracklets",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "with npy list form videos, split each to train and test",
    "video_name = '.'.join(video.split(\"/\")[-1].split(\".\")[:-1])",
    "assuming there is only one match",
    "make my own model factory",
    "make my own loss factory",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "NOTE scale factor was wrong in my original version, can set manually to be compat with prev weights",
    "NOTE: drop path for stochastic depth, we shall see if this is better than dropout here",
    "only channel pooling",
    "x -> (B, 12, 2048)",
    "x -> (B, 12, 768)",
    "trying to keep everything simple",
    "need to write my own keypoint embedding",
    "we don't need a fc layer here",
    "x: inputs",
    "(B, 12, 768)",
    "added pos embed",
    "remove all parts I don't understand",
    "forwarding through blocks. But num of blocks should be reduced",
    "i can't really tell what the difference is",
    "will have to change some of these",
    "For old models that I trained prior to conv based patchification",
    "To resize pos embedding when using model at different size from pretrained weights",
    "Rescale the grid of position embeddings when loading from state_dict. Adapted from",
    "https://github.com/google-research/vision_transformer/blob/00883dd691c63a6830751563748663526e811cee/vit_jax/checkpoint.py#L224",
    "Cut & paste from PyTorch official master until it's in a few official releases - RW",
    "Method based on https://people.sc.fsu.edu/~jburkardt/presentations/truncated_normal.pdf",
    "Computes standard normal cumulative distribution function",
    "Values are generated by using a truncated uniform distribution and",
    "then using the inverse CDF for the normal distribution.",
    "Get upper and lower cdf values",
    "Uniformly fill tensor with values from [l, u], then translate to",
    "[2l-1, 2u-1].",
    "Use inverse cdf transform for normal distribution to get truncated",
    "standard normal",
    "Transform to proper mean, std",
    "Clamp to ensure it's in the proper range",
    "type: (Tensor, float, float, float, float) -> Tensor",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 Ross Wightman",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Hacked together by / Copyright 2020 Ross Wightman",
    "https://github.com/rwightman/pytorch-image-models/blob/main/timm/scheduler/scheduler_factory.py",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "resample if noise out of percent limit, brute force but shouldn't spin much",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "distmat g",
    "q    1 3 2 4",
    "4 1 2 3",
    "0, 2, 1, 3",
    "1, 2, 3, 0",
    "compute cmc curve for each query",
    "get query pid and camid",
    "remove gallery samples that have the same pid and camid with query",
    "compute cmc curve",
    "binary vector, positions with value 1 are correct matches",
    "this condition is true when query identity does not appear in gallery",
    "compute average precision",
    "reference: https://en.wikipedia.org/wiki/Evaluation_measures_(information_retrieval)#Average_precision",
    "tmp_cmc = [x / (i + 1.) for i, x in enumerate(tmp_cmc)]",
    "query",
    "gallery",
    "distmat = re_ranking(qf, gf, k1=20, k2=6, lambda_value=0.3)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "if feature vector is numpy, you should use 'torch.tensor' transform it to tensor",
    "print('using GPU to compute original distance')",
    "print('starting re_ranking')",
    "k-reciprocal neighbors",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "More elegantly one can simply define:",
    "take care of difference between feature map space and original image space",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "cos = torch.cdist",
    "TODO: maybe find a better spot for this.",
    "dev =  device if torch.cuda.is_available() else \"cpu\"",
    "train",
    "print (f'validation loss {val_loss/len(val_loader)}')",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "normalize vectors here",
    "i th vector at j th kpt",
    "maybe needs to convert them to embeddings and position token",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "## dlcnet_ms5: backbone resnet50 + multi-fusion & multi-stage module",
    "## dlcr101_ms5/dlcr152_ms5: backbone resnet101/152 + multi-fusion & multi-stage module",
    "If the graph is unnecessarily large (with 15+ keypoints by default),",
    "we randomly prune it to a size guaranteeing an average node degree of 6;",
    "see Suppl. Fig S9c in Lauer et al., 2022.",
    "Use the skeleton defined in the config file",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Disable the prediction of PAFs if the graph is empty",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Search a pose_config.yaml file to parse missing information",
    "Clean the training-datasets folder prior to recreating the data pickles",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Load updated lists:",
    "Find the corresponding video file",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Determine the index length required to guarantee",
    "the train\u2013test ratio is exactly the desired one.",
    "Pad indices so lengths agree",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "DeprecationWarnings are silenced since Python 3.2 unless triggered in __main__",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "Also drop maDLC smart cropping augmentation parameters",
    "sort the model directories",
    "get the shuffle index and offset by 1.",
    "read cfg file",
    "create log file",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "Find the matching video from the config `video_sets`,",
    "as it may be stored elsewhere than in the `videos` directory.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "allow_growth must be true here because tensorflow does not automatically free gpu memory and setting it as false occupies all gpu memory so that pytorch cannot kick in",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "should close tensorflow session here in order to free gpu",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "Flip x, y, confidence and reshape",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "https://docs.opencv.org/2.4/modules/highgui/doc/reading_and_writing_images_and_video.html#videocapture-get",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: add cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Also ensure `boundingboxslack` is greater than zero, otherwise overlap",
    "between trackers cannot be evaluated, resulting in empty tracklets.",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: If dataname line above is changed then line below is obsolete?",
    "trackname = trackname.replace(videofolder, destfolder)",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/DeepLabCut/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "for multi animal, seems only this is used",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Get animal IDs and corresponding indices in the arrays of detections",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "get the indices of the images in the training set",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Only 1 animal, let us return the full graph indices only",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Covariance matrix estimation fails due to numerical singularities",
    "Distance is undefined if the assembly is empty",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Mark the unique body parts as assembled anyway so",
    "they are not used later on to fill assemblies.",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "Spawning (rather than forking) multiple processes does not",
    "work nicely with the GUI or interactive sessions.",
    "In that case, we fall back to the serial assembly.",
    "Swap corresponding keypoints",
    "Only consider assemblies of at least two keypoints",
    "Greedy assembly matching like in pycocotools",
    "Global rather than greedy assembly matching",
    "Cast columns of dtype 'object' to float to avoid TypeError",
    "further down in _parse_ground_truth_data.",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "Sort matching score (OKS) in descending order of assembly affinity",
    "Guarantee precision decreases monotonically",
    "See https://jonathan-hui.medium.com/map-mean-average-precision-for-object-detection-45c121a31173)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "High uncertainty to the unobservable initial velocities",
    "Give high uncertainty to the unobservable initial velocities",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "filter out matched with low IOU",
    "TODO: get cropping parameters and utilize!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "MA projects have column indices \"scorer\", \"individuals\" and \"bodyparts\"",
    "Drop the scorer level, and put individuals in rows",
    "The error rows are series; stack in axis 1 and pivot to get DF",
    "TODO: Make this code not so redundant!",
    "If a string was passed in, auto-convert to True for backward compatibility",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "TODO: Unlike using create_training_dataset() If create_training_model_comparison() is used there won't",
    "necessarily be training fractions for every shuffle which will raise the FileNotFoundError..",
    "Not sure if this should throw an exception or just be a warning...",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to initial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "TODO: Unlike using create_training_dataset() If create_training_model_comparison() is used there won't",
    "necessarily be training fractions for every shuffle which will raise the FileNotFoundError..",
    "Not sure if this should throw an exception or just be a warning...",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Ignore best edges possibly defined during a prior evaluation",
    "Create folder structure to store results.",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Pass the image and the keypoints through the resizer;",
    "this has no effect if no augmenters were added to it.",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Form 2D array of shape (n_rows, 4) where the last dim is",
    "(sample_index, peak_y, peak_x, bpt_index) to slice the PAFs.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "in case there was already a graph",
    "have to overwrite this",
    "removing the decoding layer from the checkpoint",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Clip peak locations to PAFs dimensions",
    "unit_vecs = vecs / lengths[:, np.newaxis]",
    "affinities = np.squeeze(y @ np.expand_dims(unit_vecs, axis=2)).sum(axis=1)",
    "Form cost matrices",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "loading backbone from ResNet, MobileNet etc.",
    "Auto-switch to Adam on M1/M2 chips, as the momentum optimizer crashes",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Convert a frozen graph to OpenVINO IR format",
    "Read network into memory",
    "For better efficiency, model is initialized for batch_size 1 and every sample processed independently",
    "Load network to device",
    "Prepare input data",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "Multi stage is currently only implemented for resnets",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "FIXME Fix wrong scope with Keras layers",
    "def prediction_layer(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2DTranspose(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=2,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "## New DLCNet Addition: multi-stage decoder",
    "def prediction_layer_stage(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2D(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=1,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "turn into x times y time bs * bpts",
    "extract corresponding locref x and y as well as probability",
    "Filter predicted heatmaps with a 2D Gaussian kernel as in:",
    "https://openaccess.thecvf.com/content_CVPR_2020/papers/Huang_The_Devil_Is_in_the_Details_Delving_Into_Unbiased_Data_CVPR_2020_paper.pdf",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrunk when given a depth-multiplier < 1.0.",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Clamp to 40% of crop size to ensure that at least",
    "the center keypoint remains visible after the offset is applied.",
    "Points located close to one another are sampled preferentially",
    "in order to augment crowded regions.",
    "Include keypoints in the count to avoid null probabilities",
    "Shift the crop center in both dimensions by random amounts",
    "and normalize to the original image dimensions.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "for topview, it's safe to mask keypoints under threshold",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "3 for likelihood",
    "we only do single animal here",
    "let's hard code it",
    "Add smart, keypoint-aware image cropping",
    "because of the existence of threshold, sampling population is adjusted to len(self.data)",
    "empty prediction for this frame",
    "in case it's empty prediction",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "Discard keypoints whose coordinates lie outside the cropped image",
    "Invisible joints are represented by nans",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "Produce score maps and location refinement fields",
    "Find indices of individuals in joint_id",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO Finish implementing actual abstract class",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "invisible joints are represented by nans",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Get rid of the interpolation beyond the spline knots",
    "Data has been filtered so continue to the next video",
    "Data haven't been filtered yet",
    "Retrieve original individual label indices",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Check the training image paths are correctly stored as arrays of strings",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "Sometimes tracks cannot be reconstructed as test data are randomly",
    "created; when this happens, we generate a fake h5 data file.",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Loading example data set",
    "# Create one identical splits for 3 networks and 3 augmentations",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "Setting specific parameters for training",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "MODELS = [\"dlcrnet_ms5\", \"dlcr101_ms5\", \"efficientnet-b0\", \"mobilenet_v2_0.35\"]",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "## adding it here",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Deleting unnecessary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "test if existing models are found:",
    "Test if nonexisting models are not found",
    "Add some other office files:",
    "Add a .pickle and .h5 files",
    "By default, all videos with common extensions are taken from a directory",
    "A list of extensions can also be passed in",
    "labeled_folders: (has_H5, H5_st_mtime, folder_name)",
    "mock files",
    "mock files",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test bounding box from a single keypoint",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test that shape was preserved after vectorization",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Guarantee that images smaller than crop size are handled fine",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Disable stochastic scale jitter",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Verify the aspect ratio is preserved",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/main/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Load sample multi animal data",
    "Generate a random permutation and reorder data. Ignore the unique bodypart",
    "Get inverse permutation and reorder the modified data to get back",
    "to the original",
    "Check",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check data comprise path, shape, and xy coordinates",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check that we get the number of frames we asked for",
    "Check that all indices are valid",
    "Check that all frames are unique",
    "Check that we get the number of frames we asked for",
    "Check that all indices are valid",
    "Check that all frames are unique",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "individual_1, individual2",
    "leftArm, rightArm, leftArm, rightArm",
    "positive int",
    "negative int",
    "all snapshots",
    "positive int",
    "negative int",
    "invalid str",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test flipped keypoints",
    "Original (cached) coordinates must have remained empty",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID.",
    "Test empty assembly",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Verify that the Hugging Face folder was removed",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-"
  ],
  "v2.3.10": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "def install(package):",
    "subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", package])",
    "install(\"tensorflow==1.13.1\")",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Suppress tensorflow warning messages",
    "Train, evaluate & predict functions / all require TF",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path = auxfun_models.check_for_weights(pose_cfg['net_type'], parent_path)",
    "Updating training and test pose_cfg:",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read the config file",
    "deal with user passing a single video to add",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "looking for the pseudo label path",
    "spatial pyramid is not for adapted model",
    "spatial pyramid can still be useful for reducing jittering and quantization error",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "ratio_h and ratio_w should match though in reality it does not match exactly",
    "only keep the max",
    "empty prediction if pred is not a dict",
    "Compute cosine similarity",
    "len(frames) -> (n_scale,)",
    "frames[0].shape - > (batchsize, h, w, 3)",
    "no crop needed",
    "batch full, start true inferencing",
    "only do this when animal is detected",
    "in case we reach the end of the video",
    "add a temp folder for checkpoint",
    "spatial pyramid can still be useful for reducing jittering and quantization error",
    "extra data",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO(stes) mocking a few modules to rely in fewer dependencies, without",
    "causing import errors when using deeplabcut.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in.",
    "TODO(jeylau) add affinity.setter to Assembly",
    "TODO(stes): remove/rewrite",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "ignore the exception and continue with the next evaluation, without",
    "yielding a result value.",
    "return the result value, with NaN as the result for all metrics that",
    "could not be computed due to the error.",
    "raise the error and stop evaluation",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read the config file and related variables",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Flatten the list of bodyparts to connect",
    "Format data",
    "Trick to force equal aspect ratio of 3D plots",
    "Set up the matplotlib figure beforehand",
    "Set up skeleton LineCollections",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "Get track_method and do related checks",
    "Get track method suffix",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "## Assign nan to [X,Y] of low likelihood predictions ###",
    "Convert the data to a np array to easily mask out the low likelihood predictions",
    "Assign [X,Y] = nan to low likelihood predictions",
    "Reshape data back to original shape",
    "put data back to the dataframes",
    "Check individuals are the same in both views",
    "Cross-view match individuals",
    "Create a dummy variables for single-animal",
    "Cleaner variable (since inds view1 == inds view2)",
    "Reshape: (num_framex, num_individuals, num_bodyparts , 2)",
    "Triangulate data",
    "i is individual in view 1",
    "voting[i] is the matched individual in view 2",
    "Create 3D DataFrame column and row indices",
    "Swap num_animals with num_frames axes to ensure well-behaving reshape",
    "Fill up 3D dataframe",
    "Reorder 2D dataframe in view 2 to match order of view 1",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no intermediate saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "Store tracklets and corresponding negatives (those that overlap in time)",
    "TODO Avoid looping over all pairs of tracklets",
    "Pick the closest (spatially) overlapping tracklet",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Guarantee track data are sorted in the order defined in the config",
    "If there isn't a track for each animal, fill in the dataframe with NaNs",
    "Default to the distance cost function",
    "should only exist one",
    "Add in identity weighing before building the graph",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "offset if the data was cropped",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implementation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "make sure coords and videos are a list",
    "can we make a catch here? - in fact we should drop indices from DataCombined",
    "if they are in CollectedData.. [ideal behavior; currently pretty unlikely]",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "parse the alpha selection function",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "more videos are in principle covered, as OpenCV is used and allows many formats.",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "uses openCV",
    "cap.release() >> still used in frame_extraction!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "This dictionary maps the model types to the file locations where the models exist.",
    "Exit the function early if an unknown modeltype is provided.",
    "The path is right, hence the weights are missing; we'll download them again.",
    "Aliases for backwards-compatibility",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluding the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Initialize costs matrix",
    "get common bodypart detections in track pair",
    "add 3rd dim to the points",
    "cost for any point in time of t1 being the same",
    "any point in time of t2",
    "Get average cost of the entire track",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "check if it exists:",
    "(average_degree / 2) as many edges as there are nodes is required",
    "for undirected graphs to reach the target degree.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (individual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "In a multi animal scenario, show more verbose errors.",
    "Some vidoes were not evaluated.",
    "Keep only the individuals and bodyparts that were labeled",
    "Either display the animals defined in the config if they are found",
    "in the dataframe, or all the trajectories regardless of their names",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Make paths platform-agnostic if they are not already",
    "Ensure folder names are strings",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "make list of full paths",
    "filter list of videos",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "aliases for backwards-compatibility.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Set up a logger and add an stdout handler.",
    "A single logger can have many handlers:",
    "https://docs.python.org/3/howto/logging.html#handler-basic",
    "TODO Dump to log file instead",
    "logger = logging.getLogger(\"GUI\")",
    "logger.setLevel(logging.DEBUG)",
    "handler = logging.StreamHandler(stream=sys.stdout)",
    "handler.setLevel(logging.DEBUG)",
    "formatter = logging.Formatter(",
    "\"%(asctime)s - %(name)s - %(levelname)s - %(message)s\", \"%Y-%m-%d %H:%M:%S\"",
    ")",
    "handler.setFormatter(formatter)",
    "logger.addHandler(handler)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "restore the background region",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Thread-safe Stdout redirector",
    "Creating action using the first constructor",
    "Creating actions using the second constructor",
    "File menu",
    "View menu",
    "Help menu",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "all_bodyparts: List",
    "NOTE: Is there a case where a specific list should",
    "have bodyparts other than the root? I don't think so.",
    "Videotype selection",
    "Select videos",
    "Number of selected videos text",
    "Clear video selection",
    "Qt returns a tuple (list of files, filetype)",
    "Add tab header",
    "Add separating line",
    "Look for any extension by default",
    "This works both with e.g. .avi and avi",
    "Choose multiple files by default",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Automatically activate the napari-deeplabcut plugin",
    "TODO Insert new video",
    "TODO Insert skeleton link",
    "Hack to make the first column read-only, as we do not want users to touch it.",
    "The cleaner solution would be to use a QTreeView and QAbstractItemModel,",
    "but that is a lot of rework for little benefits.",
    "Leave untouched when it is already a string",
    "Slashes also raise the error, but no need to print anything since it is then likely to be a path",
    "Walk backwards across parents to get all keys",
    "Read the video until a frame is successfully read",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO: Multi video select.... have to change to single video!",
    "Shuffle",
    "Num animals",
    "Min swap length",
    "Max gap to fill",
    "Trail length",
    "Filter type",
    "Filter window length",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Tracker Type",
    "Num animals",
    "Num triplets",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Overwrite videos",
    "Trail Points",
    "Plot all bodyparts",
    "Skeleton",
    "Filtered data",
    "Plot trajectories",
    "High quality video",
    "Bodypart list",
    "Multianimal scenario.",
    "Color is based on individual or bodypart.",
    "Single animal scenario.",
    "Color is based on bodypart.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Extraction method",
    "Frame extraction algorithm",
    "Frame cropping",
    "Cluster step",
    "GUI Slider width",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "use the default pose_cfg file for default values",
    "Shuffle",
    "Display iterations",
    "Save iterations",
    "Max iterations",
    "Max number snapshots to keep",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Single / Multi animal Only Layouts",
    "Dynamic bodypart cropping",
    "Save results as csv",
    "Filter predictions",
    "Plot Trajectories",
    "Show trajectory plots",
    "Shuffle",
    "layout.addLayout(tmp_layout)",
    "tmp_layout = QtWidgets.QGridLayout()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Augmentation method",
    "Neural Network",
    "TODO: finish model_comparison",
    "Check that training data files were indeed created.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Add config text field and button",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Display all images",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "calling create_tracking_dataset, train_tracking_transformer, stitch_tracklets",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "only try to find these features if they are in the dictionary",
    "1) reference to video folder and get the proper bpt_feature file for feature table",
    "2) get either the path to gt or the path to track pickle",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "tracklets",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "with npy list form videos, split each to train and test",
    "video_name = '.'.join(video.split(\"/\")[-1].split(\".\")[:-1])",
    "assuming there is only one match",
    "make my own model factory",
    "make my own loss factory",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "NOTE scale factor was wrong in my original version, can set manually to be compat with prev weights",
    "NOTE: drop path for stochastic depth, we shall see if this is better than dropout here",
    "only channel pooling",
    "x -> (B, 12, 2048)",
    "x -> (B, 12, 768)",
    "trying to keep everything simple",
    "need to write my own keypoint embedding",
    "we don't need a fc layer here",
    "x: inputs",
    "(B, 12, 768)",
    "added pos embed",
    "remove all parts I don't understand",
    "forwarding through blocks. But num of blocks should be reduced",
    "i can't really tell what the difference is",
    "will have to change some of these",
    "For old models that I trained prior to conv based patchification",
    "To resize pos embedding when using model at different size from pretrained weights",
    "Rescale the grid of position embeddings when loading from state_dict. Adapted from",
    "https://github.com/google-research/vision_transformer/blob/00883dd691c63a6830751563748663526e811cee/vit_jax/checkpoint.py#L224",
    "Cut & paste from PyTorch official master until it's in a few official releases - RW",
    "Method based on https://people.sc.fsu.edu/~jburkardt/presentations/truncated_normal.pdf",
    "Computes standard normal cumulative distribution function",
    "Values are generated by using a truncated uniform distribution and",
    "then using the inverse CDF for the normal distribution.",
    "Get upper and lower cdf values",
    "Uniformly fill tensor with values from [l, u], then translate to",
    "[2l-1, 2u-1].",
    "Use inverse cdf transform for normal distribution to get truncated",
    "standard normal",
    "Transform to proper mean, std",
    "Clamp to ensure it's in the proper range",
    "type: (Tensor, float, float, float, float) -> Tensor",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 Ross Wightman",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Hacked together by / Copyright 2020 Ross Wightman",
    "https://github.com/rwightman/pytorch-image-models/blob/main/timm/scheduler/scheduler_factory.py",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "resample if noise out of percent limit, brute force but shouldn't spin much",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "distmat g",
    "q    1 3 2 4",
    "4 1 2 3",
    "0, 2, 1, 3",
    "1, 2, 3, 0",
    "compute cmc curve for each query",
    "get query pid and camid",
    "remove gallery samples that have the same pid and camid with query",
    "compute cmc curve",
    "binary vector, positions with value 1 are correct matches",
    "this condition is true when query identity does not appear in gallery",
    "compute average precision",
    "reference: https://en.wikipedia.org/wiki/Evaluation_measures_(information_retrieval)#Average_precision",
    "tmp_cmc = [x / (i + 1.) for i, x in enumerate(tmp_cmc)]",
    "query",
    "gallery",
    "distmat = re_ranking(qf, gf, k1=20, k2=6, lambda_value=0.3)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "if feature vector is numpy, you should use 'torch.tensor' transform it to tensor",
    "print('using GPU to compute original distance')",
    "print('starting re_ranking')",
    "k-reciprocal neighbors",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "More elegantly one can simply define:",
    "take care of difference between feature map space and original image space",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "cos = torch.cdist",
    "TODO: maybe find a better spot for this.",
    "dev =  device if torch.cuda.is_available() else \"cpu\"",
    "train",
    "print (f'validation loss {val_loss/len(val_loader)}')",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "normalize vectors here",
    "i th vector at j th kpt",
    "maybe needs to convert them to embeddings and position token",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "## dlcnet_ms5: backbone resnet50 + multi-fusion & multi-stage module",
    "## dlcr101_ms5/dlcr152_ms5: backbone resnet101/152 + multi-fusion & multi-stage module",
    "If the graph is unnecessarily large (with 15+ keypoints by default),",
    "we randomly prune it to a size guaranteeing an average node degree of 6;",
    "see Suppl. Fig S9c in Lauer et al., 2022.",
    "Use the skeleton defined in the config file",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Disable the prediction of PAFs if the graph is empty",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Search a pose_config.yaml file to parse missing information",
    "Clean the training-datasets folder prior to recreating the data pickles",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Load updated lists:",
    "Find the corresponding video file",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Determine the index length required to guarantee",
    "the train\u2013test ratio is exactly the desired one.",
    "Pad indices so lengths agree",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "DeprecationWarnings are silenced since Python 3.2 unless triggered in __main__",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "Also drop maDLC smart cropping augmentation parameters",
    "sort the model directories",
    "get the shuffle index and offset by 1.",
    "read cfg file",
    "create log file",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "Find the matching video from the config `video_sets`,",
    "as it may be stored elsewhere than in the `videos` directory.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "allow_growth must be true here because tensorflow does not automatically free gpu memory and setting it as false occupies all gpu memory so that pytorch cannot kick in",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "should close tensorflow session here in order to free gpu",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "Flip x, y, confidence and reshape",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "https://docs.opencv.org/2.4/modules/highgui/doc/reading_and_writing_images_and_video.html#videocapture-get",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: add cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Also ensure `boundingboxslack` is greater than zero, otherwise overlap",
    "between trackers cannot be evaluated, resulting in empty tracklets.",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: If dataname line above is changed then line below is obsolete?",
    "trackname = trackname.replace(videofolder, destfolder)",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/DeepLabCut/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "for multi animal, seems only this is used",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Get animal IDs and corresponding indices in the arrays of detections",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "get the indices of the images in the training set",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Only 1 animal, let us return the full graph indices only",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Covariance matrix estimation fails due to numerical singularities",
    "Distance is undefined if the assembly is empty",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Mark the unique body parts as assembled anyway so",
    "they are not used later on to fill assemblies.",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "Spawning (rather than forking) multiple processes does not",
    "work nicely with the GUI or interactive sessions.",
    "In that case, we fall back to the serial assembly.",
    "Swap corresponding keypoints",
    "Only consider assemblies of at least two keypoints",
    "Greedy assembly matching like in pycocotools",
    "Global rather than greedy assembly matching",
    "Cast columns of dtype 'object' to float to avoid TypeError",
    "further down in _parse_ground_truth_data.",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "Sort matching score (OKS) in descending order of assembly affinity",
    "Guarantee precision decreases monotonically",
    "See https://jonathan-hui.medium.com/map-mean-average-precision-for-object-detection-45c121a31173)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "High uncertainty to the unobservable initial velocities",
    "Give high uncertainty to the unobservable initial velocities",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "filter out matched with low IOU",
    "TODO: get cropping parameters and utilize!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "MA projects have column indices \"scorer\", \"individuals\" and \"bodyparts\"",
    "Drop the scorer level, and put individuals in rows",
    "The error rows are series; stack in axis 1 and pivot to get DF",
    "TODO: Make this code not so redundant!",
    "If a string was passed in, auto-convert to True for backward compatibility",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "TODO: Unlike using create_training_dataset() If create_training_model_comparison() is used there won't",
    "necessarily be training fractions for every shuffle which will raise the FileNotFoundError..",
    "Not sure if this should throw an exception or just be a warning...",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to initial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "TODO: Unlike using create_training_dataset() If create_training_model_comparison() is used there won't",
    "necessarily be training fractions for every shuffle which will raise the FileNotFoundError..",
    "Not sure if this should throw an exception or just be a warning...",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Ignore best edges possibly defined during a prior evaluation",
    "Create folder structure to store results.",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Pass the image and the keypoints through the resizer;",
    "this has no effect if no augmenters were added to it.",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Form 2D array of shape (n_rows, 4) where the last dimension",
    "is (sample_index, peak_y, peak_x, bpt_index) to slice the PAFs.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "in case there was already a graph",
    "have to overwrite this",
    "removing the decoding layer from the checkpoint",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Clip peak locations to PAFs dimensions",
    "unit_vecs = vecs / lengths[:, np.newaxis]",
    "affinities = np.squeeze(y @ np.expand_dims(unit_vecs, axis=2)).sum(axis=1)",
    "Form cost matrices",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "loading backbone from ResNet, MobileNet etc.",
    "Auto-switch to Adam on M1/M2 chips, as the momentum optimizer crashes",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Convert a frozen graph to OpenVINO IR format",
    "Read network into memory",
    "For better efficiency, model is initialized for batch_size 1 and every sample processed independently",
    "Load network to device",
    "Prepare input data",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "Multi stage is currently only implemented for resnets",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "FIXME Fix wrong scope with Keras layers",
    "def prediction_layer(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2DTranspose(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=2,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "## New DLCNet Addition: multi-stage decoder",
    "def prediction_layer_stage(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2D(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=1,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "turn into x times y time bs * bpts",
    "extract corresponding locref x and y as well as probability",
    "Filter predicted heatmaps with a 2D Gaussian kernel as in:",
    "https://openaccess.thecvf.com/content_CVPR_2020/papers/Huang_The_Devil_Is_in_the_Details_Delving_Into_Unbiased_Data_CVPR_2020_paper.pdf",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrunk when given a depth-multiplier < 1.0.",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Clamp to 40% of crop size to ensure that at least",
    "the center keypoint remains visible after the offset is applied.",
    "Points located close to one another are sampled preferentially",
    "in order to augment crowded regions.",
    "Include keypoints in the count to avoid null probabilities",
    "Shift the crop center in both dimensions by random amounts",
    "and normalize to the original image dimensions.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "for topview, it's safe to mask keypoints under threshold",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "3 for likelihood",
    "we only do single animal here",
    "let's hard code it",
    "Add smart, keypoint-aware image cropping",
    "because of the existence of threshold, sampling population is adjusted to len(self.data)",
    "empty prediction for this frame",
    "in case it's empty prediction",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "Discard keypoints whose coordinates lie outside the cropped image",
    "Invisible joints are represented by nans",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "Produce score maps and location refinement fields",
    "Find indices of individuals in joint_id",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO Finish implementing actual abstract class",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "invisible joints are represented by nans",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Get rid of the interpolation beyond the spline knots",
    "Data has been filtered so continue to the next video",
    "Data haven't been filtered yet",
    "Retrieve original individual label indices",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Check the training image paths are correctly stored as arrays of strings",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "Sometimes tracks cannot be reconstructed as test data are randomly",
    "created; when this happens, we generate a fake h5 data file.",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Loading example data set",
    "# Create one identical splits for 3 networks and 3 augmentations",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "Setting specific parameters for training",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "MODELS = [\"dlcrnet_ms5\", \"dlcr101_ms5\", \"efficientnet-b0\", \"mobilenet_v2_0.35\"]",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "## adding it here",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Downloading the calibration images",
    "Deleting unnecessary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "test if existing models are found:",
    "Test if nonexisting models are not found",
    "Add some other office files:",
    "Add a .pickle and .h5 files",
    "By default, all videos with common extensions are taken from a directory",
    "A list of extensions can also be passed in",
    "labeled_folders: (has_H5, H5_st_mtime, folder_name)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test bounding box from a single keypoint",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test that shape was preserved after vectorization",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Guarantee that images smaller than crop size are handled fine",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Disable stochastic scale jitter",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Verify the aspect ratio is preserved",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/main/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Load sample multi animal data",
    "Generate a random permutation and reorder data. Ignore the unique bodypart",
    "Get inverse permutation and reorder the modified data to get back",
    "to the original",
    "Check",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check data comprise path, shape, and xy coordinates",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check that we get the number of frames we asked for",
    "Check that all indices are valid",
    "Check that all frames are unique",
    "Check that we get the number of frames we asked for",
    "Check that all indices are valid",
    "Check that all frames are unique",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "individual_1, individual2",
    "leftArm, rightArm, leftArm, rightArm",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test flipped keypoints",
    "Original (cached) coordinates must have remained empty",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID.",
    "Test empty assembly",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Verify that the Hugging Face folder was removed",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-"
  ],
  "v2.3.9": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "def install(package):",
    "subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", package])",
    "install(\"tensorflow==1.13.1\")",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Suppress tensorflow warning messages",
    "Train, evaluate & predict functions / all require TF",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path = auxfun_models.check_for_weights(pose_cfg['net_type'], parent_path)",
    "Updating training and test pose_cfg:",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read the config file",
    "deal with user passing a single video to add",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "looking for the pseudo label path",
    "spatial pyramid is not for adapted model",
    "spatial pyramid can still be useful for reducing jittering and quantization error",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "ratio_h and ratio_w should match though in reality it does not match exactly",
    "only keep the max",
    "empty prediction if pred is not a dict",
    "Compute cosine similarity",
    "len(frames) -> (n_scale,)",
    "frames[0].shape - > (batchsize, h, w, 3)",
    "no crop needed",
    "batch full, start true inferencing",
    "only do this when animal is detected",
    "in case we reach the end of the video",
    "add a temp folder for checkpoint",
    "spatial pyramid can still be useful for reducing jittering and quantization error",
    "extra data",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO(stes) mocking a few modules to rely in fewer dependencies, without",
    "causing import errors when using deeplabcut.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in.",
    "TODO(jeylau) add affinity.setter to Assembly",
    "TODO(stes): remove/rewrite",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "ignore the exception and continue with the next evaluation, without",
    "yielding a result value.",
    "return the result value, with NaN as the result for all metrics that",
    "could not be computed due to the error.",
    "raise the error and stop evaluation",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read the config file and related variables",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Flatten the list of bodyparts to connect",
    "Format data",
    "Trick to force equal aspect ratio of 3D plots",
    "Set up the matplotlib figure beforehand",
    "Set up skeleton LineCollections",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "Get track_method and do related checks",
    "Get track method suffix",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "## Assign nan to [X,Y] of low likelihood predictions ###",
    "Convert the data to a np array to easily mask out the low likelihood predictions",
    "Assign [X,Y] = nan to low likelihood predictions",
    "Reshape data back to original shape",
    "put data back to the dataframes",
    "Check individuals are the same in both views",
    "Cross-view match individuals",
    "Create a dummy variables for single-animal",
    "Cleaner variable (since inds view1 == inds view2)",
    "Reshape: (num_framex, num_individuals, num_bodyparts , 2)",
    "Triangulate data",
    "i is individual in view 1",
    "voting[i] is the matched individual in view 2",
    "Create 3D DataFrame column and row indices",
    "Swap num_animals with num_frames axes to ensure well-behaving reshape",
    "Fill up 3D dataframe",
    "Reorder 2D dataframe in view 2 to match order of view 1",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no intermediate saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "Store tracklets and corresponding negatives (those that overlap in time)",
    "TODO Avoid looping over all pairs of tracklets",
    "Pick the closest (spatially) overlapping tracklet",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Guarantee track data are sorted in the order defined in the config",
    "If there isn't a track for each animal, fill in the dataframe with NaNs",
    "Default to the distance cost function",
    "should only exist one",
    "Add in identity weighing before building the graph",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implementation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "make sure coords and videos are a list",
    "can we make a catch here? - in fact we should drop indices from DataCombined",
    "if they are in CollectedData.. [ideal behavior; currently pretty unlikely]",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "parse the alpha selection function",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "more videos are in principle covered, as OpenCV is used and allows many formats.",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "uses openCV",
    "cap.release() >> still used in frame_extraction!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "This dictionary maps the model types to the file locations where the models exist.",
    "Exit the function early if an unknown modeltype is provided.",
    "The path is right, hence the weights are missing; we'll download them again.",
    "Aliases for backwards-compatibility",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluding the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Initialize costs matrix",
    "get common bodypart detections in track pair",
    "add 3rd dim to the points",
    "cost for any point in time of t1 being the same",
    "any point in time of t2",
    "Get average cost of the entire track",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "check if it exists:",
    "(average_degree / 2) as many edges as there are nodes is required",
    "for undirected graphs to reach the target degree.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (individual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "In a multi animal scenario, show more verbose errors.",
    "Some vidoes were not evaluated.",
    "Keep only the individuals and bodyparts that were labeled",
    "Either display the animals defined in the config if they are found",
    "in the dataframe, or all the trajectories regardless of their names",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Make paths platform-agnostic if they are not already",
    "Ensure folder names are strings",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "make list of full paths",
    "filter list of videos",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "aliases for backwards-compatibility.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Set up a logger and add an stdout handler.",
    "A single logger can have many handlers:",
    "https://docs.python.org/3/howto/logging.html#handler-basic",
    "TODO Dump to log file instead",
    "logger = logging.getLogger(\"GUI\")",
    "logger.setLevel(logging.DEBUG)",
    "handler = logging.StreamHandler(stream=sys.stdout)",
    "handler.setLevel(logging.DEBUG)",
    "formatter = logging.Formatter(",
    "\"%(asctime)s - %(name)s - %(levelname)s - %(message)s\", \"%Y-%m-%d %H:%M:%S\"",
    ")",
    "handler.setFormatter(formatter)",
    "logger.addHandler(handler)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "restore the background region",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Thread-safe Stdout redirector",
    "Creating action using the first constructor",
    "Creating actions using the second constructor",
    "File menu",
    "View menu",
    "Help menu",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "all_bodyparts: List",
    "NOTE: Is there a case where a specific list should",
    "have bodyparts other than the root? I don't think so.",
    "Videotype selection",
    "Select videos",
    "Number of selected videos text",
    "Clear video selection",
    "Qt returns a tuple (list of files, filetype)",
    "Add tab header",
    "Add separating line",
    "Look for any extension by default",
    "This works both with e.g. .avi and avi",
    "Choose multiple files by default",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Automatically activate the napari-deeplabcut plugin",
    "TODO Insert new video",
    "TODO Insert skeleton link",
    "Hack to make the first column read-only, as we do not want users to touch it.",
    "The cleaner solution would be to use a QTreeView and QAbstractItemModel,",
    "but that is a lot of rework for little benefits.",
    "Leave untouched when it is already a string",
    "Slashes also raise the error, but no need to print anything since it is then likely to be a path",
    "Walk backwards across parents to get all keys",
    "Read the video until a frame is successfully read",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO: Multi video select.... have to change to single video!",
    "Shuffle",
    "Num animals",
    "Min swap length",
    "Max gap to fill",
    "Trail length",
    "Filter type",
    "Filter window length",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Tracker Type",
    "Num animals",
    "Num triplets",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Overwrite videos",
    "Trail Points",
    "Plot all bodyparts",
    "Skeleton",
    "Filtered data",
    "Plot trajectories",
    "High quality video",
    "Bodypart list",
    "Multianimal scenario.",
    "Color is based on individual or bodypart.",
    "Single animal scenario.",
    "Color is based on bodypart.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Extraction method",
    "Frame extraction algorithm",
    "Frame cropping",
    "Cluster step",
    "GUI Slider width",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "use the default pose_cfg file for default values",
    "Shuffle",
    "Display iterations",
    "Save iterations",
    "Max iterations",
    "Max number snapshots to keep",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Single / Multi animal Only Layouts",
    "Dynamic bodypart cropping",
    "Save results as csv",
    "Filter predictions",
    "Plot Trajectories",
    "Show trajectory plots",
    "Shuffle",
    "layout.addLayout(tmp_layout)",
    "tmp_layout = QtWidgets.QGridLayout()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Augmentation method",
    "Neural Network",
    "TODO: finish model_comparison",
    "Check that training data files were indeed created.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Add config text field and button",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Display all images",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "calling create_tracking_dataset, train_tracking_transformer, stitch_tracklets",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "only try to find these features if they are in the dictionary",
    "1) reference to video folder and get the proper bpt_feature file for feature table",
    "2) get either the path to gt or the path to track pickle",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "tracklets",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "with npy list form videos, split each to train and test",
    "video_name = '.'.join(video.split(\"/\")[-1].split(\".\")[:-1])",
    "assuming there is only one match",
    "make my own model factory",
    "make my own loss factory",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "NOTE scale factor was wrong in my original version, can set manually to be compat with prev weights",
    "NOTE: drop path for stochastic depth, we shall see if this is better than dropout here",
    "only channel pooling",
    "x -> (B, 12, 2048)",
    "x -> (B, 12, 768)",
    "trying to keep everything simple",
    "need to write my own keypoint embedding",
    "we don't need a fc layer here",
    "x: inputs",
    "(B, 12, 768)",
    "added pos embed",
    "remove all parts I don't understand",
    "forwarding through blocks. But num of blocks should be reduced",
    "i can't really tell what the difference is",
    "will have to change some of these",
    "For old models that I trained prior to conv based patchification",
    "To resize pos embedding when using model at different size from pretrained weights",
    "Rescale the grid of position embeddings when loading from state_dict. Adapted from",
    "https://github.com/google-research/vision_transformer/blob/00883dd691c63a6830751563748663526e811cee/vit_jax/checkpoint.py#L224",
    "Cut & paste from PyTorch official master until it's in a few official releases - RW",
    "Method based on https://people.sc.fsu.edu/~jburkardt/presentations/truncated_normal.pdf",
    "Computes standard normal cumulative distribution function",
    "Values are generated by using a truncated uniform distribution and",
    "then using the inverse CDF for the normal distribution.",
    "Get upper and lower cdf values",
    "Uniformly fill tensor with values from [l, u], then translate to",
    "[2l-1, 2u-1].",
    "Use inverse cdf transform for normal distribution to get truncated",
    "standard normal",
    "Transform to proper mean, std",
    "Clamp to ensure it's in the proper range",
    "type: (Tensor, float, float, float, float) -> Tensor",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 Ross Wightman",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Hacked together by / Copyright 2020 Ross Wightman",
    "https://github.com/rwightman/pytorch-image-models/blob/main/timm/scheduler/scheduler_factory.py",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "resample if noise out of percent limit, brute force but shouldn't spin much",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "distmat g",
    "q    1 3 2 4",
    "4 1 2 3",
    "0, 2, 1, 3",
    "1, 2, 3, 0",
    "compute cmc curve for each query",
    "get query pid and camid",
    "remove gallery samples that have the same pid and camid with query",
    "compute cmc curve",
    "binary vector, positions with value 1 are correct matches",
    "this condition is true when query identity does not appear in gallery",
    "compute average precision",
    "reference: https://en.wikipedia.org/wiki/Evaluation_measures_(information_retrieval)#Average_precision",
    "tmp_cmc = [x / (i + 1.) for i, x in enumerate(tmp_cmc)]",
    "query",
    "gallery",
    "distmat = re_ranking(qf, gf, k1=20, k2=6, lambda_value=0.3)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "if feature vector is numpy, you should use 'torch.tensor' transform it to tensor",
    "print('using GPU to compute original distance')",
    "print('starting re_ranking')",
    "k-reciprocal neighbors",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "More elegantly one can simply define:",
    "take care of difference between feature map space and original image space",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "cos = torch.cdist",
    "TODO: maybe find a better spot for this.",
    "dev =  device if torch.cuda.is_available() else \"cpu\"",
    "train",
    "print (f'validation loss {val_loss/len(val_loader)}')",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "normalize vectors here",
    "i th vector at j th kpt",
    "maybe needs to convert them to embeddings and position token",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "## dlcnet_ms5: backbone resnet50 + multi-fusion & multi-stage module",
    "## dlcr101_ms5/dlcr152_ms5: backbone resnet101/152 + multi-fusion & multi-stage module",
    "If the graph is unnecessarily large (with 15+ keypoints by default),",
    "we randomly prune it to a size guaranteeing an average node degree of 6;",
    "see Suppl. Fig S9c in Lauer et al., 2022.",
    "Use the skeleton defined in the config file",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Disable the prediction of PAFs if the graph is empty",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Search a pose_config.yaml file to parse missing information",
    "Clean the training-datasets folder prior to recreating the data pickles",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Load updated lists:",
    "Find the corresponding video file",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Determine the index length required to guarantee",
    "the train\u2013test ratio is exactly the desired one.",
    "Pad indices so lengths agree",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "DeprecationWarnings are silenced since Python 3.2 unless triggered in __main__",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "Also drop maDLC smart cropping augmentation parameters",
    "sort the model directories",
    "get the shuffle index and offset by 1.",
    "read cfg file",
    "create log file",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "Find the matching video from the config `video_sets`,",
    "as it may be stored elsewhere than in the `videos` directory.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "allow_growth must be true here because tensorflow does not automatically free gpu memory and setting it as false occupies all gpu memory so that pytorch cannot kick in",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "should close tensorflow session here in order to free gpu",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "Flip x, y, confidence and reshape",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "https://docs.opencv.org/2.4/modules/highgui/doc/reading_and_writing_images_and_video.html#videocapture-get",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: add cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Also ensure `boundingboxslack` is greater than zero, otherwise overlap",
    "between trackers cannot be evaluated, resulting in empty tracklets.",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: If dataname line above is changed then line below is obsolete?",
    "trackname = trackname.replace(videofolder, destfolder)",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/DeepLabCut/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "for multi animal, seems only this is used",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Get animal IDs and corresponding indices in the arrays of detections",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Only 1 animal, let us return the full graph indices only",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Covariance matrix estimation fails due to numerical singularities",
    "Distance is undefined if the assembly is empty",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Mark the unique body parts as assembled anyway so",
    "they are not used later on to fill assemblies.",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "Spawning (rather than forking) multiple processes does not",
    "work nicely with the GUI or interactive sessions.",
    "In that case, we fall back to the serial assembly.",
    "Swap corresponding keypoints",
    "Only consider assemblies of at least two keypoints",
    "Greedy assembly matching like in pycocotools",
    "Global rather than greedy assembly matching",
    "Cast columns of dtype 'object' to float to avoid TypeError",
    "further down in _parse_ground_truth_data.",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "Sort matching score (OKS) in descending order of assembly affinity",
    "Guarantee precision decreases monotonically",
    "See https://jonathan-hui.medium.com/map-mean-average-precision-for-object-detection-45c121a31173)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "High uncertainty to the unobservable initial velocities",
    "Give high uncertainty to the unobservable initial velocities",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "filter out matched with low IOU",
    "TODO: get cropping parameters and utilize!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "MA projects have column indices \"scorer\", \"individuals\" and \"bodyparts\"",
    "Drop the scorer level, and put individuals in rows",
    "The error rows are series; stack in axis 1 and pivot to get DF",
    "TODO: Make this code not so redundant!",
    "If a string was passed in, auto-convert to True for backward compatibility",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "TODO: Unlike using create_training_dataset() If create_training_model_comparison() is used there won't",
    "necessarily be training fractions for every shuffle which will raise the FileNotFoundError..",
    "Not sure if this should throw an exception or just be a warning...",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to initial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "TODO: Unlike using create_training_dataset() If create_training_model_comparison() is used there won't",
    "necessarily be training fractions for every shuffle which will raise the FileNotFoundError..",
    "Not sure if this should throw an exception or just be a warning...",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Ignore best edges possibly defined during a prior evaluation",
    "Create folder structure to store results.",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Pass the image and the keypoints through the resizer;",
    "this has no effect if no augmenters were added to it.",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Form 2D array of shape (n_rows, 4) where the last dimension",
    "is (sample_index, peak_y, peak_x, bpt_index) to slice the PAFs.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "in case there was already a graph",
    "have to overwrite this",
    "removing the decoding layer from the checkpoint",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Clip peak locations to PAFs dimensions",
    "unit_vecs = vecs / lengths[:, np.newaxis]",
    "affinities = np.squeeze(y @ np.expand_dims(unit_vecs, axis=2)).sum(axis=1)",
    "Form cost matrices",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "loading backbone from ResNet, MobileNet etc.",
    "Auto-switch to Adam on M1/M2 chips, as the momentum optimizer crashes",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Convert a frozen graph to OpenVINO IR format",
    "Read network into memory",
    "For better efficiency, model is initialized for batch_size 1 and every sample processed independently",
    "Load network to device",
    "Prepare input data",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "Multi stage is currently only implemented for resnets",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "FIXME Fix wrong scope with Keras layers",
    "def prediction_layer(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2DTranspose(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=2,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "## New DLCNet Addition: multi-stage decoder",
    "def prediction_layer_stage(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2D(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=1,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "turn into x times y time bs * bpts",
    "extract corresponding locref x and y as well as probability",
    "Filter predicted heatmaps with a 2D Gaussian kernel as in:",
    "https://openaccess.thecvf.com/content_CVPR_2020/papers/Huang_The_Devil_Is_in_the_Details_Delving_Into_Unbiased_Data_CVPR_2020_paper.pdf",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrunk when given a depth-multiplier < 1.0.",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Clamp to 40% of crop size to ensure that at least",
    "the center keypoint remains visible after the offset is applied.",
    "Points located close to one another are sampled preferentially",
    "in order to augment crowded regions.",
    "Include keypoints in the count to avoid null probabilities",
    "Shift the crop center in both dimensions by random amounts",
    "and normalize to the original image dimensions.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "for topview, it's safe to mask keypoints under threshold",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "3 for likelihood",
    "we only do single animal here",
    "let's hard code it",
    "Add smart, keypoint-aware image cropping",
    "because of the existence of threshold, sampling population is adjusted to len(self.data)",
    "empty prediction for this frame",
    "in case it's empty prediction",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "Discard keypoints whose coordinates lie outside the cropped image",
    "Invisible joints are represented by nans",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "Produce score maps and location refinement fields",
    "Find indices of individuals in joint_id",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO Finish implementing actual abstract class",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "invisible joints are represented by nans",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Get rid of the interpolation beyond the spline knots",
    "Data has been filtered so continue to the next video",
    "Data haven't been filtered yet",
    "Retrieve original individual label indices",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Check the training image paths are correctly stored as arrays of strings",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "Sometimes tracks cannot be reconstructed as test data are randomly",
    "created; when this happens, we generate a fake h5 data file.",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Loading example data set",
    "# Create one identical splits for 3 networks and 3 augmentations",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "Setting specific parameters for training",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "MODELS = [\"dlcrnet_ms5\", \"dlcr101_ms5\", \"efficientnet-b0\", \"mobilenet_v2_0.35\"]",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "## adding it here",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Downloading the calibration images",
    "Deleting unnecessary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "test if existing models are found:",
    "Test if nonexisting models are not found",
    "Add some other office files:",
    "Add a .pickle and .h5 files",
    "By default, all videos with common extensions are taken from a directory",
    "A list of extensions can also be passed in",
    "labeled_folders: (has_H5, H5_st_mtime, folder_name)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test bounding box from a single keypoint",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test that shape was preserved after vectorization",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Guarantee that images smaller than crop size are handled fine",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Disable stochastic scale jitter",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Verify the aspect ratio is preserved",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Load sample multi animal data",
    "Generate a random permutation and reorder data. Ignore the unique bodypart",
    "Get inverse permutation and reorder the modified data to get back",
    "to the original",
    "Check",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check data comprise path, shape, and xy coordinates",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check that we get the number of frames we asked for",
    "Check that all indices are valid",
    "Check that all frames are unique",
    "Check that we get the number of frames we asked for",
    "Check that all indices are valid",
    "Check that all frames are unique",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "individual_1, individual2",
    "leftArm, rightArm, leftArm, rightArm",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test flipped keypoints",
    "Original (cached) coordinates must have remained empty",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID.",
    "Test empty assembly",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Verify that the Hugging Face folder was removed",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-"
  ],
  "v2.3.8": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "def install(package):",
    "subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", package])",
    "install(\"tensorflow==1.13.1\")",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Suppress tensorflow warning messages",
    "Train, evaluate & predict functions / all require TF",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path = auxfun_models.check_for_weights(pose_cfg['net_type'], parent_path)",
    "Updating training and test pose_cfg:",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read the config file",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "looking for the pseudo label path",
    "spatial pyramid is not for adapted model",
    "spatial pyramid can still be useful for reducing jittering and quantization error",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "ratio_h and ratio_w should match though in reality it does not match exactly",
    "only keep the max",
    "empty prediction if pred is not a dict",
    "Compute cosine similarity",
    "len(frames) -> (n_scale,)",
    "frames[0].shape - > (batchsize, h, w, 3)",
    "no crop needed",
    "batch full, start true inferencing",
    "only do this when animal is detected",
    "in case we reach the end of the video",
    "add a temp folder for checkpoint",
    "spatial pyramid can still be useful for reducing jittering and quantization error",
    "extra data",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO(stes) mocking a few modules to rely in fewer dependencies, without",
    "causing import errors when using deeplabcut.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in.",
    "TODO(jeylau) add affinity.setter to Assembly",
    "TODO(stes): remove/rewrite",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "ignore the exception and continue with the next evaluation, without",
    "yielding a result value.",
    "return the result value, with NaN as the result for all metrics that",
    "could not be computed due to the error.",
    "raise the error and stop evaluation",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read the config file and related variables",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Flatten the list of bodyparts to connect",
    "Format data",
    "Trick to force equal aspect ratio of 3D plots",
    "Set up the matplotlib figure beforehand",
    "Set up skeleton LineCollections",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "Get track_method and do related checks",
    "Get track method suffix",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "## Assign nan to [X,Y] of low likelihood predictions ###",
    "Convert the data to a np array to easily mask out the low likelihood predictions",
    "Assign [X,Y] = nan to low likelihood predictions",
    "Reshape data back to original shape",
    "put data back to the dataframes",
    "Check individuals are the same in both views",
    "Cross-view match individuals",
    "Create a dummy variables for single-animal",
    "Cleaner variable (since inds view1 == inds view2)",
    "Reshape: (num_framex, num_individuals, num_bodyparts , 2)",
    "Triangulate data",
    "i is individual in view 1",
    "voting[i] is the matched individual in view 2",
    "Create 3D DataFrame column and row indices",
    "Swap num_animals with num_frames axes to ensure well-behaving reshape",
    "Fill up 3D dataframe",
    "Reorder 2D dataframe in view 2 to match order of view 1",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no intermediate saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "Store tracklets and corresponding negatives (those that overlap in time)",
    "TODO Avoid looping over all pairs of tracklets",
    "Pick the closest (spatially) overlapping tracklet",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Guarantee track data are sorted in the order defined in the config",
    "If there isn't a track for each animal, fill in the dataframe with NaNs",
    "Default to the distance cost function",
    "should only exist one",
    "Add in identity weighing before building the graph",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implementation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "make sure coords and videos are a list",
    "can we make a catch here? - in fact we should drop indices from DataCombined",
    "if they are in CollectedData.. [ideal behavior; currently pretty unlikely]",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "parse the alpha selection function",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "more videos are in principle covered, as OpenCV is used and allows many formats.",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "uses openCV",
    "cap.release() >> still used in frame_extraction!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "This dictionary maps the model types to the file locations where the models exist.",
    "Exit the function early if an unknown modeltype is provided.",
    "The path is right, hence the weights are missing; we'll download them again.",
    "Aliases for backwards-compatibility",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluding the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Initialize costs matrix",
    "get common bodypart detections in track pair",
    "add 3rd dim to the points",
    "cost for any point in time of t1 being the same",
    "any point in time of t2",
    "Get average cost of the entire track",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "check if it exists:",
    "(average_degree / 2) as many edges as there are nodes is required",
    "for undirected graphs to reach the target degree.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (individual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "In a multi animal scenario, show more verbose errors.",
    "Some vidoes were not evaluated.",
    "Keep only the individuals and bodyparts that were labeled",
    "Either display the animals defined in the config if they are found",
    "in the dataframe, or all the trajectories regardless of their names",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Make paths platform-agnostic if they are not already",
    "Ensure folder names are strings",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "make list of full paths",
    "filter list of videos",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "aliases for backwards-compatibility.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Set up a logger and add an stdout handler.",
    "A single logger can have many handlers:",
    "https://docs.python.org/3/howto/logging.html#handler-basic",
    "TODO Dump to log file instead",
    "logger = logging.getLogger(\"GUI\")",
    "logger.setLevel(logging.DEBUG)",
    "handler = logging.StreamHandler(stream=sys.stdout)",
    "handler.setLevel(logging.DEBUG)",
    "formatter = logging.Formatter(",
    "\"%(asctime)s - %(name)s - %(levelname)s - %(message)s\", \"%Y-%m-%d %H:%M:%S\"",
    ")",
    "handler.setFormatter(formatter)",
    "logger.addHandler(handler)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "restore the background region",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Thread-safe Stdout redirector",
    "Creating action using the first constructor",
    "Creating actions using the second constructor",
    "File menu",
    "View menu",
    "Help menu",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "all_bodyparts: List",
    "NOTE: Is there a case where a specific list should",
    "have bodyparts other than the root? I don't think so.",
    "Videotype selection",
    "Select videos",
    "Number of selected videos text",
    "Clear video selection",
    "Qt returns a tuple (list of files, filetype)",
    "Add tab header",
    "Add separating line",
    "Look for any extension by default",
    "This works both with e.g. .avi and avi",
    "Choose multiple files by default",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Automatically activate the napari-deeplabcut plugin",
    "TODO Insert new video",
    "TODO Insert skeleton link",
    "Hack to make the first column read-only, as we do not want users to touch it.",
    "The cleaner solution would be to use a QTreeView and QAbstractItemModel,",
    "but that is a lot of rework for little benefits.",
    "Leave untouched when it is already a string",
    "Slashes also raise the error, but no need to print anything since it is then likely to be a path",
    "Walk backwards across parents to get all keys",
    "Read the video until a frame is successfully read",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO: Multi video select.... have to change to single video!",
    "Shuffle",
    "Num animals",
    "Min swap length",
    "Max gap to fill",
    "Trail length",
    "Filter type",
    "Filter window length",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Tracker Type",
    "Num animals",
    "Num triplets",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Overwrite videos",
    "Trail Points",
    "Plot all bodyparts",
    "Skeleton",
    "Filtered data",
    "Plot trajectories",
    "High quality video",
    "Bodypart list",
    "Multianimal scenario.",
    "Color is based on individual or bodypart.",
    "Single animal scenario.",
    "Color is based on bodypart.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Extraction method",
    "Frame extraction algorithm",
    "Frame cropping",
    "Cluster step",
    "GUI Slider width",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "use the default pose_cfg file for default values",
    "Shuffle",
    "Display iterations",
    "Save iterations",
    "Max iterations",
    "Max number snapshots to keep",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Single / Multi animal Only Layouts",
    "Dynamic bodypart cropping",
    "Save results as csv",
    "Filter predictions",
    "Plot Trajectories",
    "Show trajectory plots",
    "Shuffle",
    "layout.addLayout(tmp_layout)",
    "tmp_layout = QtWidgets.QGridLayout()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Augmentation method",
    "Neural Network",
    "TODO: finish model_comparison",
    "Check that training data files were indeed created.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Add config text field and button",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Display all images",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "calling create_tracking_dataset, train_tracking_transformer, stitch_tracklets",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "only try to find these features if they are in the dictionary",
    "1) reference to video folder and get the proper bpt_feature file for feature table",
    "2) get either the path to gt or the path to track pickle",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "tracklets",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "with npy list form videos, split each to train and test",
    "video_name = '.'.join(video.split(\"/\")[-1].split(\".\")[:-1])",
    "assuming there is only one match",
    "make my own model factory",
    "make my own loss factory",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "NOTE scale factor was wrong in my original version, can set manually to be compat with prev weights",
    "NOTE: drop path for stochastic depth, we shall see if this is better than dropout here",
    "only channel pooling",
    "x -> (B, 12, 2048)",
    "x -> (B, 12, 768)",
    "trying to keep everything simple",
    "need to write my own keypoint embedding",
    "we don't need a fc layer here",
    "x: inputs",
    "(B, 12, 768)",
    "added pos embed",
    "remove all parts I don't understand",
    "forwarding through blocks. But num of blocks should be reduced",
    "i can't really tell what the difference is",
    "will have to change some of these",
    "For old models that I trained prior to conv based patchification",
    "To resize pos embedding when using model at different size from pretrained weights",
    "Rescale the grid of position embeddings when loading from state_dict. Adapted from",
    "https://github.com/google-research/vision_transformer/blob/00883dd691c63a6830751563748663526e811cee/vit_jax/checkpoint.py#L224",
    "Cut & paste from PyTorch official master until it's in a few official releases - RW",
    "Method based on https://people.sc.fsu.edu/~jburkardt/presentations/truncated_normal.pdf",
    "Computes standard normal cumulative distribution function",
    "Values are generated by using a truncated uniform distribution and",
    "then using the inverse CDF for the normal distribution.",
    "Get upper and lower cdf values",
    "Uniformly fill tensor with values from [l, u], then translate to",
    "[2l-1, 2u-1].",
    "Use inverse cdf transform for normal distribution to get truncated",
    "standard normal",
    "Transform to proper mean, std",
    "Clamp to ensure it's in the proper range",
    "type: (Tensor, float, float, float, float) -> Tensor",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 Ross Wightman",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Hacked together by / Copyright 2020 Ross Wightman",
    "https://github.com/rwightman/pytorch-image-models/blob/main/timm/scheduler/scheduler_factory.py",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "resample if noise out of percent limit, brute force but shouldn't spin much",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "distmat g",
    "q    1 3 2 4",
    "4 1 2 3",
    "0, 2, 1, 3",
    "1, 2, 3, 0",
    "compute cmc curve for each query",
    "get query pid and camid",
    "remove gallery samples that have the same pid and camid with query",
    "compute cmc curve",
    "binary vector, positions with value 1 are correct matches",
    "this condition is true when query identity does not appear in gallery",
    "compute average precision",
    "reference: https://en.wikipedia.org/wiki/Evaluation_measures_(information_retrieval)#Average_precision",
    "tmp_cmc = [x / (i + 1.) for i, x in enumerate(tmp_cmc)]",
    "query",
    "gallery",
    "distmat = re_ranking(qf, gf, k1=20, k2=6, lambda_value=0.3)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "if feature vector is numpy, you should use 'torch.tensor' transform it to tensor",
    "print('using GPU to compute original distance')",
    "print('starting re_ranking')",
    "k-reciprocal neighbors",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "More elegantly one can simply define:",
    "take care of difference between feature map space and original image space",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "cos = torch.cdist",
    "TODO: maybe find a better spot for this.",
    "dev =  device if torch.cuda.is_available() else \"cpu\"",
    "train",
    "print (f'validation loss {val_loss/len(val_loader)}')",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "normalize vectors here",
    "i th vector at j th kpt",
    "maybe needs to convert them to embeddings and position token",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "## dlcnet_ms5: backbone resnet50 + multi-fusion & multi-stage module",
    "## dlcr101_ms5/dlcr152_ms5: backbone resnet101/152 + multi-fusion & multi-stage module",
    "If the graph is unnecessarily large (with 15+ keypoints by default),",
    "we randomly prune it to a size guaranteeing an average node degree of 6;",
    "see Suppl. Fig S9c in Lauer et al., 2022.",
    "Use the skeleton defined in the config file",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Disable the prediction of PAFs if the graph is empty",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Search a pose_config.yaml file to parse missing information",
    "Clean the training-datasets folder prior to recreating the data pickles",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Load updated lists:",
    "Find the corresponding video file",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Determine the index length required to guarantee",
    "the train\u2013test ratio is exactly the desired one.",
    "Pad indices so lengths agree",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "DeprecationWarnings are silenced since Python 3.2 unless triggered in __main__",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "Also drop maDLC smart cropping augmentation parameters",
    "sort the model directories",
    "get the shuffle index and offset by 1.",
    "read cfg file",
    "create log file",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "Find the matching video from the config `video_sets`,",
    "as it may be stored elsewhere than in the `videos` directory.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "allow_growth must be true here because tensorflow does not automatically free gpu memory and setting it as false occupies all gpu memory so that pytorch cannot kick in",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "should close tensorflow session here in order to free gpu",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "Flip x, y, confidence and reshape",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "https://docs.opencv.org/2.4/modules/highgui/doc/reading_and_writing_images_and_video.html#videocapture-get",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: add cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Also ensure `boundingboxslack` is greater than zero, otherwise overlap",
    "between trackers cannot be evaluated, resulting in empty tracklets.",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: If dataname line above is changed then line below is obsolete?",
    "trackname = trackname.replace(videofolder, destfolder)",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/DeepLabCut/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "for multi animal, seems only this is used",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Get animal IDs and corresponding indices in the arrays of detections",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Only 1 animal, let us return the full graph indices only",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Covariance matrix estimation fails due to numerical singularities",
    "Distance is undefined if the assembly is empty",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Mark the unique body parts as assembled anyway so",
    "they are not used later on to fill assemblies.",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "Spawning (rather than forking) multiple processes does not",
    "work nicely with the GUI or interactive sessions.",
    "In that case, we fall back to the serial assembly.",
    "Swap corresponding keypoints",
    "Only consider assemblies of at least two keypoints",
    "Greedy assembly matching like in pycocotools",
    "Global rather than greedy assembly matching",
    "Cast columns of dtype 'object' to float to avoid TypeError",
    "further down in _parse_ground_truth_data.",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "Sort matching score (OKS) in descending order of assembly affinity",
    "Guarantee precision decreases monotonically",
    "See https://jonathan-hui.medium.com/map-mean-average-precision-for-object-detection-45c121a31173)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "High uncertainty to the unobservable initial velocities",
    "Give high uncertainty to the unobservable initial velocities",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "filter out matched with low IOU",
    "TODO: get cropping parameters and utilize!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "MA projects have column indices \"scorer\", \"individuals\" and \"bodyparts\"",
    "Drop the scorer level, and put individuals in rows",
    "The error rows are series; stack in axis 1 and pivot to get DF",
    "TODO: Make this code not so redundant!",
    "If a string was passed in, auto-convert to True for backward compatibility",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to initial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Ignore best edges possibly defined during a prior evaluation",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Pass the image and the keypoints through the resizer;",
    "this has no effect if no augmenters were added to it.",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Form 2D array of shape (n_rows, 4) where the last dimension",
    "is (sample_index, peak_y, peak_x, bpt_index) to slice the PAFs.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "in case there was already a graph",
    "have to overwrite this",
    "removing the decoding layer from the checkpoint",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Clip peak locations to PAFs dimensions",
    "unit_vecs = vecs / lengths[:, np.newaxis]",
    "affinities = np.squeeze(y @ np.expand_dims(unit_vecs, axis=2)).sum(axis=1)",
    "Form cost matrices",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "loading backbone from ResNet, MobileNet etc.",
    "Auto-switch to Adam on M1/M2 chips, as the momentum optimizer crashes",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Convert a frozen graph to OpenVINO IR format",
    "Read network into memory",
    "For better efficiency, model is initialized for batch_size 1 and every sample processed independently",
    "Load network to device",
    "Prepare input data",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "Multi stage is currently only implemented for resnets",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "FIXME Fix wrong scope with Keras layers",
    "def prediction_layer(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2DTranspose(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=2,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "## New DLCNet Addition: multi-stage decoder",
    "def prediction_layer_stage(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2D(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=1,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "turn into x times y time bs * bpts",
    "extract corresponding locref x and y as well as probability",
    "Filter predicted heatmaps with a 2D Gaussian kernel as in:",
    "https://openaccess.thecvf.com/content_CVPR_2020/papers/Huang_The_Devil_Is_in_the_Details_Delving_Into_Unbiased_Data_CVPR_2020_paper.pdf",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrunk when given a depth-multiplier < 1.0.",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Clamp to 40% of crop size to ensure that at least",
    "the center keypoint remains visible after the offset is applied.",
    "Points located close to one another are sampled preferentially",
    "in order to augment crowded regions.",
    "Include keypoints in the count to avoid null probabilities",
    "Shift the crop center in both dimensions by random amounts",
    "and normalize to the original image dimensions.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "for topview, it's safe to mask keypoints under threshold",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "3 for likelihood",
    "we only do single animal here",
    "let's hard code it",
    "Add smart, keypoint-aware image cropping",
    "because of the existence of threshold, sampling population is adjusted to len(self.data)",
    "empty prediction for this frame",
    "in case it's empty prediction",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "Discard keypoints whose coordinates lie outside the cropped image",
    "Invisible joints are represented by nans",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "Produce score maps and location refinement fields",
    "Find indices of individuals in joint_id",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO Finish implementing actual abstract class",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "invisible joints are represented by nans",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Get rid of the interpolation beyond the spline knots",
    "Data has been filtered so continue to the next video",
    "Data haven't been filtered yet",
    "Retrieve original individual label indices",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Check the training image paths are correctly stored as arrays of strings",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "Sometimes tracks cannot be reconstructed as test data are randomly",
    "created; when this happens, we generate a fake h5 data file.",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Loading example data set",
    "# Create one identical splits for 3 networks and 3 augmentations",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "Setting specific parameters for training",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "MODELS = [\"dlcrnet_ms5\", \"dlcr101_ms5\", \"efficientnet-b0\", \"mobilenet_v2_0.35\"]",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "## adding it here",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Downloading the calibration images",
    "Deleting unnecessary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "test if existing models are found:",
    "Test if nonexisting models are not found",
    "Add some other office files:",
    "Add a .pickle and .h5 files",
    "By default, all videos with common extensions are taken from a directory",
    "A list of extensions can also be passed in",
    "labeled_folders: (has_H5, H5_st_mtime, folder_name)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test bounding box from a single keypoint",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test that shape was preserved after vectorization",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Guarantee that images smaller than crop size are handled fine",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Disable stochastic scale jitter",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Verify the aspect ratio is preserved",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Load sample multi animal data",
    "Generate a random permutation and reorder data. Ignore the unique bodypart",
    "Get inverse permutation and reorder the modified data to get back",
    "to the original",
    "Check",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check data comprise path, shape, and xy coordinates",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check that we get the number of frames we asked for",
    "Check that all indices are valid",
    "Check that all frames are unique",
    "Check that we get the number of frames we asked for",
    "Check that all indices are valid",
    "Check that all frames are unique",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "individual_1, individual2",
    "leftArm, rightArm, leftArm, rightArm",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test flipped keypoints",
    "Original (cached) coordinates must have remained empty",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID.",
    "Test empty assembly",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Verify that the Hugging Face folder was removed",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-"
  ],
  "v2.3.7": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "def install(package):",
    "subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", package])",
    "install(\"tensorflow==1.13.1\")",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Suppress tensorflow warning messages",
    "Train, evaluate & predict functions / all require TF",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path = auxfun_models.check_for_weights(pose_cfg['net_type'], parent_path)",
    "Updating training and test pose_cfg:",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read the config file",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "looking for the pseudo label path",
    "spatial pyramid is not for adapted model",
    "spatial pyramid can still be useful for reducing jittering and quantization error",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "ratio_h and ratio_w should match though in reality it does not match exactly",
    "only keep the max",
    "empty prediction if pred is not a dict",
    "Compute cosine similarity",
    "len(frames) -> (n_scale,)",
    "frames[0].shape - > (batchsize, h, w, 3)",
    "no crop needed",
    "batch full, start true inferencing",
    "only do this when animal is detected",
    "in case we reach the end of the video",
    "add a temp folder for checkpoint",
    "spatial pyramid can still be useful for reducing jittering and quantization error",
    "extra data",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO(stes) mocking a few modules to rely in fewer dependencies, without",
    "causing import errors when using deeplabcut.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in.",
    "TODO(jeylau) add affinity.setter to Assembly",
    "TODO(stes): remove/rewrite",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "ignore the exception and continue with the next evaluation, without",
    "yielding a result value.",
    "return the result value, with NaN as the result for all metrics that",
    "could not be computed due to the error.",
    "raise the error and stop evaluation",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read the config file and related variables",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Flatten the list of bodyparts to connect",
    "Format data",
    "Trick to force equal aspect ratio of 3D plots",
    "Set up the matplotlib figure beforehand",
    "Set up skeleton LineCollections",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "Get track_method and do related checks",
    "Get track method suffix",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "## Assign nan to [X,Y] of low likelihood predictions ###",
    "Convert the data to a np array to easily mask out the low likelihood predictions",
    "Assign [X,Y] = nan to low likelihood predictions",
    "Reshape data back to original shape",
    "put data back to the dataframes",
    "Check individuals are the same in both views",
    "Cross-view match individuals",
    "Create a dummy variables for single-animal",
    "Cleaner variable (since inds view1 == inds view2)",
    "Reshape: (num_framex, num_individuals, num_bodyparts , 2)",
    "Triangulate data",
    "i is individual in view 1",
    "voting[i] is the matched individual in view 2",
    "Create 3D DataFrame column and row indices",
    "Swap num_animals with num_frames axes to ensure well-behaving reshape",
    "Fill up 3D dataframe",
    "Reorder 2D dataframe in view 2 to match order of view 1",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no intermediate saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "Store tracklets and corresponding negatives (those that overlap in time)",
    "TODO Avoid looping over all pairs of tracklets",
    "Pick the closest (spatially) overlapping tracklet",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Guarantee track data are sorted in the order defined in the config",
    "If there isn't a track for each animal, fill in the dataframe with NaNs",
    "Default to the distance cost function",
    "should only exist one",
    "Add in identity weighing before building the graph",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implementation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "make sure coords and videos are a list",
    "can we make a catch here? - in fact we should drop indices from DataCombined",
    "if they are in CollectedData.. [ideal behavior; currently pretty unlikely]",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "parse the alpha selection function",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "more videos are in principle covered, as OpenCV is used and allows many formats.",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "uses openCV",
    "cap.release() >> still used in frame_extraction!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "This dictionary maps the model types to the file locations where the models exist.",
    "Exit the function early if an unknown modeltype is provided.",
    "Aliases for backwards-compatibility",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluding the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Initialize costs matrix",
    "get common bodypart detections in track pair",
    "add 3rd dim to the points",
    "cost for any point in time of t1 being the same",
    "any point in time of t2",
    "Get average cost of the entire track",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "check if it exists:",
    "(average_degree / 2) as many edges as there are nodes is required",
    "for undirected graphs to reach the target degree.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (individual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "In a multi animal scenario, show more verbose errors.",
    "Some vidoes were not evaluated.",
    "Keep only the individuals and bodyparts that were labeled",
    "Either display the animals defined in the config if they are found",
    "in the dataframe, or all the trajectories regardless of their names",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Make paths platform-agnostic if they are not already",
    "Ensure folder names are strings",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "make list of full paths",
    "filter list of videos",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "aliases for backwards-compatibility.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Set up a logger and add an stdout handler.",
    "A single logger can have many handlers:",
    "https://docs.python.org/3/howto/logging.html#handler-basic",
    "TODO Dump to log file instead",
    "logger = logging.getLogger(\"GUI\")",
    "logger.setLevel(logging.DEBUG)",
    "handler = logging.StreamHandler(stream=sys.stdout)",
    "handler.setLevel(logging.DEBUG)",
    "formatter = logging.Formatter(",
    "\"%(asctime)s - %(name)s - %(levelname)s - %(message)s\", \"%Y-%m-%d %H:%M:%S\"",
    ")",
    "handler.setFormatter(formatter)",
    "logger.addHandler(handler)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "restore the background region",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Thread-safe Stdout redirector",
    "Creating action using the first constructor",
    "Creating actions using the second constructor",
    "File menu",
    "View menu",
    "Help menu",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "all_bodyparts: List",
    "NOTE: Is there a case where a specific list should",
    "have bodyparts other than the root? I don't think so.",
    "Videotype selection",
    "Select videos",
    "Number of selected videos text",
    "Clear video selection",
    "Qt returns a tuple (list of files, filetype)",
    "Add tab header",
    "Add separating line",
    "Look for any extension by default",
    "This works both with e.g. .avi and avi",
    "Choose multiple files by default",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Automatically activate the napari-deeplabcut plugin",
    "TODO Insert new video",
    "TODO Insert skeleton link",
    "Hack to make the first column read-only, as we do not want users to touch it.",
    "The cleaner solution would be to use a QTreeView and QAbstractItemModel,",
    "but that is a lot of rework for little benefits.",
    "Leave untouched when it is already a string",
    "Slashes also raise the error, but no need to print anything since it is then likely to be a path",
    "Walk backwards across parents to get all keys",
    "Read the video until a frame is successfully read",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO: Multi video select.... have to change to single video!",
    "Shuffle",
    "Num animals",
    "Min swap length",
    "Max gap to fill",
    "Trail length",
    "Filter type",
    "Filter window length",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Tracker Type",
    "Num animals",
    "Num triplets",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Overwrite videos",
    "Trail Points",
    "Plot all bodyparts",
    "Skeleton",
    "Filtered data",
    "Plot trajectories",
    "High quality video",
    "Bodypart list",
    "Multianimal scenario.",
    "Color is based on individual or bodypart.",
    "Single animal scenario.",
    "Color is based on bodypart.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Extraction method",
    "Frame extraction algorithm",
    "Frame cropping",
    "Cluster step",
    "GUI Slider width",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "use the default pose_cfg file for default values",
    "Shuffle",
    "Display iterations",
    "Save iterations",
    "Max iterations",
    "Max number snapshots to keep",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Single / Multi animal Only Layouts",
    "Dynamic bodypart cropping",
    "Save results as csv",
    "Filter predictions",
    "Plot Trajectories",
    "Show trajectory plots",
    "Shuffle",
    "layout.addLayout(tmp_layout)",
    "tmp_layout = QtWidgets.QGridLayout()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Augmentation method",
    "Neural Network",
    "TODO: finish model_comparison",
    "Check that training data files were indeed created.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Add config text field and button",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Display all images",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "calling create_tracking_dataset, train_tracking_transformer, stitch_tracklets",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "only try to find these features if they are in the dictionary",
    "1) reference to video folder and get the proper bpt_feature file for feature table",
    "2) get either the path to gt or the path to track pickle",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "tracklets",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "with npy list form videos, split each to train and test",
    "video_name = '.'.join(video.split(\"/\")[-1].split(\".\")[:-1])",
    "assuming there is only one match",
    "make my own model factory",
    "make my own loss factory",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "NOTE scale factor was wrong in my original version, can set manually to be compat with prev weights",
    "NOTE: drop path for stochastic depth, we shall see if this is better than dropout here",
    "only channel pooling",
    "x -> (B, 12, 2048)",
    "x -> (B, 12, 768)",
    "trying to keep everything simple",
    "need to write my own keypoint embedding",
    "we don't need a fc layer here",
    "x: inputs",
    "(B, 12, 768)",
    "added pos embed",
    "remove all parts I don't understand",
    "forwarding through blocks. But num of blocks should be reduced",
    "i can't really tell what the difference is",
    "will have to change some of these",
    "For old models that I trained prior to conv based patchification",
    "To resize pos embedding when using model at different size from pretrained weights",
    "Rescale the grid of position embeddings when loading from state_dict. Adapted from",
    "https://github.com/google-research/vision_transformer/blob/00883dd691c63a6830751563748663526e811cee/vit_jax/checkpoint.py#L224",
    "Cut & paste from PyTorch official master until it's in a few official releases - RW",
    "Method based on https://people.sc.fsu.edu/~jburkardt/presentations/truncated_normal.pdf",
    "Computes standard normal cumulative distribution function",
    "Values are generated by using a truncated uniform distribution and",
    "then using the inverse CDF for the normal distribution.",
    "Get upper and lower cdf values",
    "Uniformly fill tensor with values from [l, u], then translate to",
    "[2l-1, 2u-1].",
    "Use inverse cdf transform for normal distribution to get truncated",
    "standard normal",
    "Transform to proper mean, std",
    "Clamp to ensure it's in the proper range",
    "type: (Tensor, float, float, float, float) -> Tensor",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 Ross Wightman",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Hacked together by / Copyright 2020 Ross Wightman",
    "https://github.com/rwightman/pytorch-image-models/blob/main/timm/scheduler/scheduler_factory.py",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "resample if noise out of percent limit, brute force but shouldn't spin much",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "distmat g",
    "q    1 3 2 4",
    "4 1 2 3",
    "0, 2, 1, 3",
    "1, 2, 3, 0",
    "compute cmc curve for each query",
    "get query pid and camid",
    "remove gallery samples that have the same pid and camid with query",
    "compute cmc curve",
    "binary vector, positions with value 1 are correct matches",
    "this condition is true when query identity does not appear in gallery",
    "compute average precision",
    "reference: https://en.wikipedia.org/wiki/Evaluation_measures_(information_retrieval)#Average_precision",
    "tmp_cmc = [x / (i + 1.) for i, x in enumerate(tmp_cmc)]",
    "query",
    "gallery",
    "distmat = re_ranking(qf, gf, k1=20, k2=6, lambda_value=0.3)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "if feature vector is numpy, you should use 'torch.tensor' transform it to tensor",
    "print('using GPU to compute original distance')",
    "print('starting re_ranking')",
    "k-reciprocal neighbors",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "More elegantly one can simply define:",
    "take care of difference between feature map space and original image space",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "cos = torch.cdist",
    "TODO: maybe find a better spot for this.",
    "dev =  device if torch.cuda.is_available() else \"cpu\"",
    "train",
    "print (f'validation loss {val_loss/len(val_loader)}')",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "normalize vectors here",
    "i th vector at j th kpt",
    "maybe needs to convert them to embeddings and position token",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "## dlcnet_ms5: backbone resnet50 + multi-fusion & multi-stage module",
    "## dlcr101_ms5/dlcr152_ms5: backbone resnet101/152 + multi-fusion & multi-stage module",
    "If the graph is unnecessarily large (with 15+ keypoints by default),",
    "we randomly prune it to a size guaranteeing an average node degree of 6;",
    "see Suppl. Fig S9c in Lauer et al., 2022.",
    "Use the skeleton defined in the config file",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Disable the prediction of PAFs if the graph is empty",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Search a pose_config.yaml file to parse missing information",
    "Clean the training-datasets folder prior to recreating the data pickles",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Load updated lists:",
    "Find the corresponding video file",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Determine the index length required to guarantee",
    "the train\u2013test ratio is exactly the desired one.",
    "Pad indices so lengths agree",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "DeprecationWarnings are silenced since Python 3.2 unless triggered in __main__",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "Also drop maDLC smart cropping augmentation parameters",
    "sort the model directories",
    "get the shuffle index and offset by 1.",
    "read cfg file",
    "create log file",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "Find the matching video from the config `video_sets`,",
    "as it may be stored elsewhere than in the `videos` directory.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "allow_growth must be true here because tensorflow does not automatically free gpu memory and setting it as false occupies all gpu memory so that pytorch cannot kick in",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "should close tensorflow session here in order to free gpu",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "Flip x, y, confidence and reshape",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "https://docs.opencv.org/2.4/modules/highgui/doc/reading_and_writing_images_and_video.html#videocapture-get",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: add cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Also ensure `boundingboxslack` is greater than zero, otherwise overlap",
    "between trackers cannot be evaluated, resulting in empty tracklets.",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: If dataname line above is changed then line below is obsolete?",
    "trackname = trackname.replace(videofolder, destfolder)",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/DeepLabCut/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "for multi animal, seems only this is used",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Get animal IDs and corresponding indices in the arrays of detections",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Only 1 animal, let us return the full graph indices only",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Covariance matrix estimation fails due to numerical singularities",
    "Distance is undefined if the assembly is empty",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Mark the unique body parts as assembled anyway so",
    "they are not used later on to fill assemblies.",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "Spawning (rather than forking) multiple processes does not",
    "work nicely with the GUI or interactive sessions.",
    "In that case, we fall back to the serial assembly.",
    "Swap corresponding keypoints",
    "Only consider assemblies of at least two keypoints",
    "Greedy assembly matching like in pycocotools",
    "Global rather than greedy assembly matching",
    "Cast columns of dtype 'object' to float to avoid TypeError",
    "further down in _parse_ground_truth_data.",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "Sort matching score (OKS) in descending order of assembly affinity",
    "Guarantee precision decreases monotonically",
    "See https://jonathan-hui.medium.com/map-mean-average-precision-for-object-detection-45c121a31173)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "High uncertainty to the unobservable initial velocities",
    "Give high uncertainty to the unobservable initial velocities",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "filter out matched with low IOU",
    "TODO: get cropping parameters and utilize!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "MA projects have column indices \"scorer\", \"individuals\" and \"bodyparts\"",
    "Drop the scorer level, and put individuals in rows",
    "The error rows are series; stack in axis 1 and pivot to get DF",
    "TODO: Make this code not so redundant!",
    "If a string was passed in, auto-convert to True for backward compatibility",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to initial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Ignore best edges possibly defined during a prior evaluation",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Pass the image and the keypoints through the resizer;",
    "this has no effect if no augmenters were added to it.",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Form 2D array of shape (n_rows, 4) where the last dimension",
    "is (sample_index, peak_y, peak_x, bpt_index) to slice the PAFs.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "in case there was already a graph",
    "have to overwrite this",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Clip peak locations to PAFs dimensions",
    "unit_vecs = vecs / lengths[:, np.newaxis]",
    "affinities = np.squeeze(y @ np.expand_dims(unit_vecs, axis=2)).sum(axis=1)",
    "Form cost matrices",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "loading backbone from ResNet, MobileNet etc.",
    "Auto-switch to Adam on M1/M2 chips, as the momentum optimizer crashes",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Convert a frozen graph to OpenVINO IR format",
    "Read network into memory",
    "For better efficiency, model is initialized for batch_size 1 and every sample processed independently",
    "Load network to device",
    "Prepare input data",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "Multi stage is currently only implemented for resnets",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "FIXME Fix wrong scope with Keras layers",
    "def prediction_layer(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2DTranspose(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=2,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "## New DLCNet Addition: multi-stage decoder",
    "def prediction_layer_stage(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2D(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=1,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "turn into x times y time bs * bpts",
    "extract corresponding locref x and y as well as probability",
    "Filter predicted heatmaps with a 2D Gaussian kernel as in:",
    "https://openaccess.thecvf.com/content_CVPR_2020/papers/Huang_The_Devil_Is_in_the_Details_Delving_Into_Unbiased_Data_CVPR_2020_paper.pdf",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrunk when given a depth-multiplier < 1.0.",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Clamp to 40% of crop size to ensure that at least",
    "the center keypoint remains visible after the offset is applied.",
    "Points located close to one another are sampled preferentially",
    "in order to augment crowded regions.",
    "Include keypoints in the count to avoid null probabilities",
    "Shift the crop center in both dimensions by random amounts",
    "and normalize to the original image dimensions.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "for topview, it's safe to mask keypoints under threshold",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "3 for likelihood",
    "we only do single animal here",
    "let's hard code it",
    "Add smart, keypoint-aware image cropping",
    "because of the existence of threshold, sampling population is adjusted to len(self.data)",
    "empty prediction for this frame",
    "in case it's empty prediction",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "Discard keypoints whose coordinates lie outside the cropped image",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "Produce score maps and location refinement fields",
    "Find indices of individuals in joint_id",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO Finish implementing actual abstract class",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "invisible joints are represented by nans",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Check the training image paths are correctly stored as arrays of strings",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "Sometimes tracks cannot be reconstructed as test data are randomly",
    "created; when this happens, we generate a fake h5 data file.",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Loading example data set",
    "# Create one identical splits for 3 networks and 3 augmentations",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "Setting specific parameters for training",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "MODELS = [\"dlcrnet_ms5\", \"dlcr101_ms5\", \"efficientnet-b0\", \"mobilenet_v2_0.35\"]",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "## adding it here",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Downloading the calibration images",
    "Deleting unnecessary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "test if existing models are found:",
    "Test if nonexisting models are not found",
    "Add some other office files:",
    "Add a .pickle and .h5 files",
    "By default, all videos with common extensions are taken from a directory",
    "A list of extensions can also be passed in",
    "labeled_folders: (has_H5, H5_st_mtime, folder_name)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test bounding box from a single keypoint",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test that shape was preserved after vectorization",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Guarantee that images smaller than crop size are handled fine",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Disable stochastic scale jitter",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Verify the aspect ratio is preserved",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Load sample multi animal data",
    "Generate a random permutation and reorder data. Ignore the unique bodypart",
    "Get inverse permutation and reorder the modified data to get back",
    "to the original",
    "Check",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check data comprise path, shape, and xy coordinates",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check that we get the number of frames we asked for",
    "Check that all indices are valid",
    "Check that all frames are unique",
    "Check that we get the number of frames we asked for",
    "Check that all indices are valid",
    "Check that all frames are unique",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "individual_1, individual2",
    "leftArm, rightArm, leftArm, rightArm",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test flipped keypoints",
    "Original (cached) coordinates must have remained empty",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID.",
    "Test empty assembly",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Verify that the Hugging Face folder was removed",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-"
  ],
  "v2.3.6": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "def install(package):",
    "subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", package])",
    "install(\"tensorflow==1.13.1\")",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Suppress tensorflow warning messages",
    "Train, evaluate & predict functions / all require TF",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path = auxfun_models.check_for_weights(pose_cfg['net_type'], parent_path)",
    "Updating training and test pose_cfg:",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read the config file",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "looking for the pseudo label path",
    "spatial pyramid is not for adapted model",
    "spatial pyramid can still be useful for reducing jittering and quantization error",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "ratio_h and ratio_w should match though in reality it does not match exactly",
    "only keep the max",
    "empty prediction if pred is not a dict",
    "Compute cosine similarity",
    "len(frames) -> (n_scale,)",
    "frames[0].shape - > (batchsize, h, w, 3)",
    "no crop needed",
    "batch full, start true inferencing",
    "only do this when animal is detected",
    "in case we reach the end of the video",
    "add a temp folder for checkpoint",
    "spatial pyramid can still be useful for reducing jittering and quantization error",
    "extra data",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO(stes) mocking a few modules to rely in fewer dependencies, without",
    "causing import errors when using deeplabcut.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in.",
    "TODO(jeylau) add affinity.setter to Assembly",
    "TODO(stes): remove/rewrite",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "ignore the exception and continue with the next evaluation, without",
    "yielding a result value.",
    "return the result value, with NaN as the result for all metrics that",
    "could not be computed due to the error.",
    "raise the error and stop evaluation",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read the config file and related variables",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Flatten the list of bodyparts to connect",
    "Format data",
    "Trick to force equal aspect ratio of 3D plots",
    "Set up the matplotlib figure beforehand",
    "Set up skeleton LineCollections",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "Get track_method and do related checks",
    "Get track method suffix",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "## Assign nan to [X,Y] of low likelihood predictions ###",
    "Convert the data to a np array to easily mask out the low likelihood predictions",
    "Assign [X,Y] = nan to low likelihood predictions",
    "Reshape data back to original shape",
    "put data back to the dataframes",
    "Check individuals are the same in both views",
    "Cross-view match individuals",
    "Create a dummy variables for single-animal",
    "Cleaner variable (since inds view1 == inds view2)",
    "Reshape: (num_framex, num_individuals, num_bodyparts , 2)",
    "Triangulate data",
    "i is individual in view 1",
    "voting[i] is the matched individual in view 2",
    "Create 3D DataFrame column and row indices",
    "Swap num_animals with num_frames axes to ensure well-behaving reshape",
    "Fill up 3D dataframe",
    "Reorder 2D dataframe in view 2 to match order of view 1",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no intermediate saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "Store tracklets and corresponding negatives (those that overlap in time)",
    "TODO Avoid looping over all pairs of tracklets",
    "Pick the closest (spatially) overlapping tracklet",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Guarantee track data are sorted in the order defined in the config",
    "If there isn't a track for each animal, fill in the dataframe with NaNs",
    "Default to the distance cost function",
    "should only exist one",
    "Add in identity weighing before building the graph",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implementation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "make sure coords and videos are a list",
    "can we make a catch here? - in fact we should drop indices from DataCombined",
    "if they are in CollectedData.. [ideal behavior; currently pretty unlikely]",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "parse the alpha selection function",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "more videos are in principle covered, as OpenCV is used and allows many formats.",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "uses openCV",
    "cap.release() >> still used in frame_extraction!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "This dictionary maps the model types to the file locations where the models exist.",
    "Exit the function early if an unknown modeltype is provided.",
    "Aliases for backwards-compatibility",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Initialize costs matrix",
    "get common bodypart detections in track pair",
    "add 3rd dim to the points",
    "cost for any point in time of t1 being the same",
    "any point in time of t2",
    "Get average cost of the entire track",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "check if it exists:",
    "(average_degree / 2) as many edges as there are nodes is required",
    "for undirected graphs to reach the target degree.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (individual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "In a multi animal scenario, show more verbose errors.",
    "Some vidoes were not evaluated.",
    "Keep only the individuals and bodyparts that were labeled",
    "Either display the animals defined in the config if they are found",
    "in the dataframe, or all the trajectories regardless of their names",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Make paths platform-agnostic if they are not already",
    "Ensure folder names are strings",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "make list of full paths",
    "filter list of videos",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "aliases for backwards-compatibility.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Set up a logger and add an stdout handler.",
    "A single logger can have many handlers:",
    "https://docs.python.org/3/howto/logging.html#handler-basic",
    "TODO Dump to log file instead",
    "logger = logging.getLogger(\"GUI\")",
    "logger.setLevel(logging.DEBUG)",
    "handler = logging.StreamHandler(stream=sys.stdout)",
    "handler.setLevel(logging.DEBUG)",
    "formatter = logging.Formatter(",
    "\"%(asctime)s - %(name)s - %(levelname)s - %(message)s\", \"%Y-%m-%d %H:%M:%S\"",
    ")",
    "handler.setFormatter(formatter)",
    "logger.addHandler(handler)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "restore the background region",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Thread-safe Stdout redirector",
    "Creating action using the first constructor",
    "Creating actions using the second constructor",
    "File menu",
    "View menu",
    "Help menu",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "all_bodyparts: List",
    "NOTE: Is there a case where a specific list should",
    "have bodyparts other than the root? I don't think so.",
    "Videotype selection",
    "Select videos",
    "Number of selected videos text",
    "Clear video selection",
    "Qt returns a tuple (list of files, filetype)",
    "Add tab header",
    "Add separating line",
    "Look for any extension by default",
    "This works both with e.g. .avi and avi",
    "Choose multiple files by default",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Automatically activate the napari-deeplabcut plugin",
    "TODO Insert new video",
    "TODO Insert skeleton link",
    "Hack to make the first column read-only, as we do not want users to touch it.",
    "The cleaner solution would be to use a QTreeView and QAbstractItemModel,",
    "but that is a lot of rework for little benefits.",
    "Leave untouched when it is already a string",
    "Slashes also raise the error, but no need to print anything since it is then likely to be a path",
    "Walk backwards across parents to get all keys",
    "Read the video until a frame is successfully read",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO: Multi video select.... have to change to single video!",
    "Shuffle",
    "Num animals",
    "Min swap length",
    "Max gap to fill",
    "Trail length",
    "Filter type",
    "Filter window length",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Tracker Type",
    "Num animals",
    "Num triplets",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Overwrite videos",
    "Trail Points",
    "Plot all bodyparts",
    "Skeleton",
    "Filtered data",
    "Plot trajectories",
    "High quality video",
    "Bodypart list",
    "Multianimal scenario.",
    "Color is based on individual or bodypart.",
    "Single animal scenario.",
    "Color is based on bodypart.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Extraction method",
    "Frame extraction algorithm",
    "Frame cropping",
    "Cluster step",
    "GUI Slider width",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "use the default pose_cfg file for default values",
    "Shuffle",
    "Display iterations",
    "Save iterations",
    "Max iterations",
    "Max number snapshots to keep",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Single / Multi animal Only Layouts",
    "Dynamic bodypart cropping",
    "Save results as csv",
    "Filter predictions",
    "Plot Trajectories",
    "Show trajectory plots",
    "Shuffle",
    "layout.addLayout(tmp_layout)",
    "tmp_layout = QtWidgets.QGridLayout()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Augmentation method",
    "Neural Network",
    "TODO: finish model_comparison",
    "Check that training data files were indeed created.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Add config text field and button",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Display all images",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "calling create_tracking_dataset, train_tracking_transformer, stitch_tracklets",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "only try to find these features if they are in the dictionary",
    "1) reference to video folder and get the proper bpt_feature file for feature table",
    "2) get either the path to gt or the path to track pickle",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "tracklets",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "with npy list form videos, split each to train and test",
    "video_name = '.'.join(video.split(\"/\")[-1].split(\".\")[:-1])",
    "assuming there is only one match",
    "make my own model factory",
    "make my own loss factory",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "NOTE scale factor was wrong in my original version, can set manually to be compat with prev weights",
    "NOTE: drop path for stochastic depth, we shall see if this is better than dropout here",
    "only channel pooling",
    "x -> (B, 12, 2048)",
    "x -> (B, 12, 768)",
    "trying to keep everything simple",
    "need to write my own keypoint embedding",
    "we don't need a fc layer here",
    "x: inputs",
    "(B, 12, 768)",
    "added pos embed",
    "remove all parts I don't understand",
    "forwarding through blocks. But num of blocks should be reduced",
    "i can't really tell what the difference is",
    "will have to change some of these",
    "For old models that I trained prior to conv based patchification",
    "To resize pos embedding when using model at different size from pretrained weights",
    "Rescale the grid of position embeddings when loading from state_dict. Adapted from",
    "https://github.com/google-research/vision_transformer/blob/00883dd691c63a6830751563748663526e811cee/vit_jax/checkpoint.py#L224",
    "Cut & paste from PyTorch official master until it's in a few official releases - RW",
    "Method based on https://people.sc.fsu.edu/~jburkardt/presentations/truncated_normal.pdf",
    "Computes standard normal cumulative distribution function",
    "Values are generated by using a truncated uniform distribution and",
    "then using the inverse CDF for the normal distribution.",
    "Get upper and lower cdf values",
    "Uniformly fill tensor with values from [l, u], then translate to",
    "[2l-1, 2u-1].",
    "Use inverse cdf transform for normal distribution to get truncated",
    "standard normal",
    "Transform to proper mean, std",
    "Clamp to ensure it's in the proper range",
    "type: (Tensor, float, float, float, float) -> Tensor",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 Ross Wightman",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Hacked together by / Copyright 2020 Ross Wightman",
    "https://github.com/rwightman/pytorch-image-models/blob/main/timm/scheduler/scheduler_factory.py",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "resample if noise out of percent limit, brute force but shouldn't spin much",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "distmat g",
    "q    1 3 2 4",
    "4 1 2 3",
    "0, 2, 1, 3",
    "1, 2, 3, 0",
    "compute cmc curve for each query",
    "get query pid and camid",
    "remove gallery samples that have the same pid and camid with query",
    "compute cmc curve",
    "binary vector, positions with value 1 are correct matches",
    "this condition is true when query identity does not appear in gallery",
    "compute average precision",
    "reference: https://en.wikipedia.org/wiki/Evaluation_measures_(information_retrieval)#Average_precision",
    "tmp_cmc = [x / (i + 1.) for i, x in enumerate(tmp_cmc)]",
    "query",
    "gallery",
    "distmat = re_ranking(qf, gf, k1=20, k2=6, lambda_value=0.3)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "if feature vector is numpy, you should use 'torch.tensor' transform it to tensor",
    "print('using GPU to compute original distance')",
    "print('starting re_ranking')",
    "k-reciprocal neighbors",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "More elegantly one can simply define:",
    "take care of difference between feature map space and original image space",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "cos = torch.cdist",
    "TODO: maybe find a better spot for this.",
    "dev =  device if torch.cuda.is_available() else \"cpu\"",
    "train",
    "print (f'validation loss {val_loss/len(val_loader)}')",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "normalize vectors here",
    "i th vector at j th kpt",
    "maybe needs to convert them to embeddings and position token",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "## dlcnet_ms5: backbone resnet50 + multi-fusion & multi-stage module",
    "## dlcr101_ms5/dlcr152_ms5: backbone resnet101/152 + multi-fusion & multi-stage module",
    "If the graph is unnecessarily large (with 15+ keypoints by default),",
    "we randomly prune it to a size guaranteeing an average node degree of 6;",
    "see Suppl. Fig S9c in Lauer et al., 2022.",
    "Use the skeleton defined in the config file",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Disable the prediction of PAFs if the graph is empty",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Search a pose_config.yaml file to parse missing information",
    "Clean the training-datasets folder prior to recreating the data pickles",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Load updated lists:",
    "Find the corresponding video file",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Determine the index length required to guarantee",
    "the train\u2013test ratio is exactly the desired one.",
    "Pad indices so lengths agree",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "DeprecationWarnings are silenced since Python 3.2 unless triggered in __main__",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "Also drop maDLC smart cropping augmentation parameters",
    "sort the model directories",
    "get the shuffle index and offset by 1.",
    "read cfg file",
    "create log file",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "Find the matching video from the config `video_sets`,",
    "as it may be stored elsewhere than in the `videos` directory.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "allow_growth must be true here because tensorflow does not automatically free gpu memory and setting it as false occupies all gpu memory so that pytorch cannot kick in",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "should close tensorflow session here in order to free gpu",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "Flip x, y, confidence and reshape",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "https://docs.opencv.org/2.4/modules/highgui/doc/reading_and_writing_images_and_video.html#videocapture-get",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: add cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Also ensure `boundingboxslack` is greater than zero, otherwise overlap",
    "between trackers cannot be evaluated, resulting in empty tracklets.",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: If dataname line above is changed then line below is obsolete?",
    "trackname = trackname.replace(videofolder, destfolder)",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/DeepLabCut/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "for multi animal, seems only this is used",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Get animal IDs and corresponding indices in the arrays of detections",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Only 1 animal, let us return the full graph indices only",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Covariance matrix estimation fails due to numerical singularities",
    "Distance is undefined if the assembly is empty",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Mark the unique body parts as assembled anyway so",
    "they are not used later on to fill assemblies.",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "Spawning (rather than forking) multiple processes does not",
    "work nicely with the GUI or interactive sessions.",
    "In that case, we fall back to the serial assembly.",
    "Swap corresponding keypoints",
    "Only consider assemblies of at least two keypoints",
    "Greedy assembly matching like in pycocotools",
    "Global rather than greedy assembly matching",
    "Cast columns of dtype 'object' to float to avoid TypeError",
    "further down in _parse_ground_truth_data.",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "Sort matching score (OKS) in descending order of assembly affinity",
    "Guarantee precision decreases monotonically",
    "See https://jonathan-hui.medium.com/map-mean-average-precision-for-object-detection-45c121a31173)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "High uncertainty to the unobservable initial velocities",
    "Give high uncertainty to the unobservable initial velocities",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "filter out matched with low IOU",
    "TODO: get cropping parameters and utilize!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "MA projects have column indices \"scorer\", \"individuals\" and \"bodyparts\"",
    "Drop the scorer level, and put individuals in rows",
    "The error rows are series; stack in axis 1 and pivot to get DF",
    "TODO: Make this code not so redundant!",
    "If a string was passed in, auto-convert to True for backward compatibility",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to initial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Ignore best edges possibly defined during a prior evaluation",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Pass the image and the keypoints through the resizer;",
    "this has no effect if no augmenters were added to it.",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Form 2D array of shape (n_rows, 4) where the last dimension",
    "is (sample_index, peak_y, peak_x, bpt_index) to slice the PAFs.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "in case there was already a graph",
    "have to overwrite this",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Clip peak locations to PAFs dimensions",
    "unit_vecs = vecs / lengths[:, np.newaxis]",
    "affinities = np.squeeze(y @ np.expand_dims(unit_vecs, axis=2)).sum(axis=1)",
    "Form cost matrices",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "loading backbone from ResNet, MobileNet etc.",
    "Auto-switch to Adam on M1/M2 chips, as the momentum optimizer crashes",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Convert a frozen graph to OpenVINO IR format",
    "Read network into memory",
    "For better efficiency, model is initialized for batch_size 1 and every sample processed independently",
    "Load network to device",
    "Prepare input data",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "Multi stage is currently only implemented for resnets",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "FIXME Fix wrong scope with Keras layers",
    "def prediction_layer(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2DTranspose(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=2,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "## New DLCNet Addition: multi-stage decoder",
    "def prediction_layer_stage(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2D(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=1,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "turn into x times y time bs * bpts",
    "extract corresponding locref x and y as well as probability",
    "Filter predicted heatmaps with a 2D Gaussian kernel as in:",
    "https://openaccess.thecvf.com/content_CVPR_2020/papers/Huang_The_Devil_Is_in_the_Details_Delving_Into_Unbiased_Data_CVPR_2020_paper.pdf",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrunk when given a depth-multiplier < 1.0.",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Clamp to 40% of crop size to ensure that at least",
    "the center keypoint remains visible after the offset is applied.",
    "Points located close to one another are sampled preferentially",
    "in order to augment crowded regions.",
    "Include keypoints in the count to avoid null probabilities",
    "Shift the crop center in both dimensions by random amounts",
    "and normalize to the original image dimensions.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "for topview, it's safe to mask keypoints under threshold",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "3 for likelihood",
    "we only do single animal here",
    "let's hard code it",
    "Add smart, keypoint-aware image cropping",
    "because of the existence of threshold, sampling population is adjusted to len(self.data)",
    "empty prediction for this frame",
    "in case it's empty prediction",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "Discard keypoints whose coordinates lie outside the cropped image",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "Produce score maps and location refinement fields",
    "Find indices of individuals in joint_id",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO Finish implementing actual abstract class",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "invisible joints are represented by nans",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Check the training image paths are correctly stored as arrays of strings",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "Sometimes tracks cannot be reconstructed as test data are randomly",
    "created; when this happens, we generate a fake h5 data file.",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Loading example data set",
    "# Create one identical splits for 3 networks and 3 augmentations",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "Setting specific parameters for training",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "MODELS = [\"dlcrnet_ms5\", \"dlcr101_ms5\", \"efficientnet-b0\", \"mobilenet_v2_0.35\"]",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "## adding it here",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Downloading the calibration images",
    "Deleting unnecessary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "test if existing models are found:",
    "Test if nonexisting models are not found",
    "Add some other office files:",
    "Add a .pickle and .h5 files",
    "By default, all videos with common extensions are taken from a directory",
    "A list of extensions can also be passed in",
    "labeled_folders: (has_H5, H5_st_mtime, folder_name)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test bounding box from a single keypoint",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test that shape was preserved after vectorization",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Guarantee that images smaller than crop size are handled fine",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Disable stochastic scale jitter",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Verify the aspect ratio is preserved",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Load sample multi animal data",
    "Generate a random permutation and reorder data. Ignore the unique bodypart",
    "Get inverse permutation and reorder the modified data to get back",
    "to the original",
    "Check",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check data comprise path, shape, and xy coordinates",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check that we get the number of frames we asked for",
    "Check that all indices are valid",
    "Check that all frames are unique",
    "Check that we get the number of frames we asked for",
    "Check that all indices are valid",
    "Check that all frames are unique",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "individual_1, individual2",
    "leftArm, rightArm, leftArm, rightArm",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test flipped keypoints",
    "Original (cached) coordinates must have remained empty",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID.",
    "Test empty assembly",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Verify that the Hugging Face folder was removed",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-"
  ],
  "v2.3.5": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "def install(package):",
    "subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", package])",
    "install(\"tensorflow==1.13.1\")",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Suppress tensorflow warning messages",
    "Train, evaluate & predict functions / all require TF",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read the config file",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "looking for the pseudo label path",
    "spatial pyramid is not for adapted model",
    "spatial pyramid can still be useful for reducing jittering and quantization error",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "ratio_h and ratio_w should match though in reality it does not match exactly",
    "only keep the max",
    "empty prediction if pred is not a dict",
    "Compute cosine similarity",
    "len(frames) -> (n_scale,)",
    "frames[0].shape - > (batchsize, h, w, 3)",
    "no crop needed",
    "batch full, start true inferencing",
    "only do this when animal is detected",
    "in case we reach the end of the video",
    "add a temp folder for checkpoint",
    "spatial pyramid can still be useful for reducing jittering and quantization error",
    "extra data",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO(stes) mocking a few modules to rely in fewer dependencies, without",
    "causing import errors when using deeplabcut.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in.",
    "TODO(jeylau) add affinity.setter to Assembly",
    "TODO(stes): remove/rewrite",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "ignore the exception and continue with the next evaluation, without",
    "yielding a result value.",
    "return the result value, with NaN as the result for all metrics that",
    "could not be computed due to the error.",
    "raise the error and stop evaluation",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read the config file and related variables",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Flatten the list of bodyparts to connect",
    "Format data",
    "Trick to force equal aspect ratio of 3D plots",
    "Set up the matplotlib figure beforehand",
    "Set up skeleton LineCollections",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "Get track_method and do related checks",
    "Get track method suffix",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "## Assign nan to [X,Y] of low likelihood predictions ###",
    "Convert the data to a np array to easily mask out the low likelihood predictions",
    "Assign [X,Y] = nan to low likelihood predictions",
    "Reshape data back to original shape",
    "put data back to the dataframes",
    "Check individuals are the same in both views",
    "Cross-view match individuals",
    "Create a dummy variables for single-animal",
    "Cleaner variable (since inds view1 == inds view2)",
    "Reshape: (num_framex, num_individuals, num_bodyparts , 2)",
    "Triangulate data",
    "i is individual in view 1",
    "voting[i] is the matched individual in view 2",
    "Create 3D DataFrame column and row indices",
    "Swap num_animals with num_frames axes to ensure well-behaving reshape",
    "Fill up 3D dataframe",
    "Reorder 2D dataframe in view 2 to match order of view 1",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no intermediate saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "Store tracklets and corresponding negatives (those that overlap in time)",
    "TODO Avoid looping over all pairs of tracklets",
    "Pick the closest (spatially) overlapping tracklet",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Guarantee track data are sorted in the order defined in the config",
    "Default to the distance cost function",
    "should only exist one",
    "Add in identity weighing before building the graph",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implementation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "more videos are in principle covered, as OpenCV is used and allows many formats.",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "uses openCV",
    "cap.release() >> still used in frame_extraction!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "This dictionary maps the model types to the file locations where the models exist.",
    "Exit the function early if an unknown modeltype is provided.",
    "Aliases for backwards-compatibility",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Initialize costs matrix",
    "get common bodypart detections in track pair",
    "add 3rd dim to the points",
    "cost for any point in time of t1 being the same",
    "any point in time of t2",
    "Get average cost of the entire track",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "check if it exists:",
    "(average_degree / 2) as many edges as there are nodes is required",
    "for undirected graphs to reach the target degree.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (individual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "In a multi animal scenario, show more verbose errors.",
    "Some vidoes were not evaluated.",
    "Keep only the individuals and bodyparts that were labeled",
    "Either display the animals defined in the config if they are found",
    "in the dataframe, or all the trajectories regardless of their names",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Make paths platform-agnostic if they are not already",
    "Ensure folder names are strings",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "make list of full paths",
    "filter list of videos",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "aliases for backwards-compatibility.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Set up a logger and add an stdout handler.",
    "A single logger can have many handlers:",
    "https://docs.python.org/3/howto/logging.html#handler-basic",
    "TODO Dump to log file instead",
    "logger = logging.getLogger(\"GUI\")",
    "logger.setLevel(logging.DEBUG)",
    "handler = logging.StreamHandler(stream=sys.stdout)",
    "handler.setLevel(logging.DEBUG)",
    "formatter = logging.Formatter(",
    "\"%(asctime)s - %(name)s - %(levelname)s - %(message)s\", \"%Y-%m-%d %H:%M:%S\"",
    ")",
    "handler.setFormatter(formatter)",
    "logger.addHandler(handler)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "restore the background region",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Thread-safe Stdout redirector",
    "Creating action using the first constructor",
    "Creating actions using the second constructor",
    "File menu",
    "View menu",
    "Help menu",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "all_bodyparts: List",
    "NOTE: Is there a case where a specific list should",
    "have bodyparts other than the root? I don't think so.",
    "Videotype selection",
    "Select videos",
    "Number of selected videos text",
    "Clear video selection",
    "Qt returns a tuple (list of files, filetype)",
    "Add tab header",
    "Add separating line",
    "Look for any extension by default",
    "This works both with e.g. .avi and avi",
    "Choose multiple files by default",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Automatically activate the napari-deeplabcut plugin",
    "TODO Insert new video",
    "TODO Insert skeleton link",
    "Hack to make the first column read-only, as we do not want users to touch it.",
    "The cleaner solution would be to use a QTreeView and QAbstractItemModel,",
    "but that is a lot of rework for little benefits.",
    "Leave untouched when it is already a string",
    "Slashes also raise the error, but no need to print anything since it is then likely to be a path",
    "Walk backwards across parents to get all keys",
    "Read the video until a frame is successfully read",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO: Multi video select.... have to change to single video!",
    "Shuffle",
    "Num animals",
    "Min swap length",
    "Max gap to fill",
    "Trail length",
    "Filter type",
    "Filter window length",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Tracker Type",
    "Num animals",
    "Num triplets",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Overwrite videos",
    "Trail Points",
    "Plot all bodyparts",
    "Skeleton",
    "Filtered data",
    "Plot trajectories",
    "High quality video",
    "Bodypart list",
    "Multianimal scenario.",
    "Color is based on individual or bodypart.",
    "Single animal scenario.",
    "Color is based on bodypart.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Extraction method",
    "Frame extraction algorithm",
    "Frame cropping",
    "Cluster step",
    "GUI Slider width",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "use the default pose_cfg file for default values",
    "Shuffle",
    "Display iterations",
    "Save iterations",
    "Max iterations",
    "Max number snapshots to keep",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Single / Multi animal Only Layouts",
    "Dynamic bodypart cropping",
    "Save results as csv",
    "Filter predictions",
    "Plot Trajectories",
    "Show trajectory plots",
    "Shuffle",
    "layout.addLayout(tmp_layout)",
    "tmp_layout = QtWidgets.QGridLayout()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Augmentation method",
    "Neural Network",
    "TODO: finish model_comparison",
    "Check that training data files were indeed created.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Add config text field and button",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Display all images",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "calling create_tracking_dataset, train_tracking_transformer, stitch_tracklets",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "only try to find these features if they are in the dictionary",
    "1) reference to video folder and get the proper bpt_feature file for feature table",
    "2) get either the path to gt or the path to track pickle",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "tracklets",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "with npy list form videos, split each to train and test",
    "video_name = '.'.join(video.split(\"/\")[-1].split(\".\")[:-1])",
    "assuming there is only one match",
    "make my own model factory",
    "make my own loss factory",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "NOTE scale factor was wrong in my original version, can set manually to be compat with prev weights",
    "NOTE: drop path for stochastic depth, we shall see if this is better than dropout here",
    "only channel pooling",
    "x -> (B, 12, 2048)",
    "x -> (B, 12, 768)",
    "trying to keep everything simple",
    "need to write my own keypoint embedding",
    "we don't need a fc layer here",
    "x: inputs",
    "(B, 12, 768)",
    "added pos embed",
    "remove all parts I don't understand",
    "forwarding through blocks. But num of blocks should be reduced",
    "i can't really tell what the difference is",
    "will have to change some of these",
    "For old models that I trained prior to conv based patchification",
    "To resize pos embedding when using model at different size from pretrained weights",
    "Rescale the grid of position embeddings when loading from state_dict. Adapted from",
    "https://github.com/google-research/vision_transformer/blob/00883dd691c63a6830751563748663526e811cee/vit_jax/checkpoint.py#L224",
    "Cut & paste from PyTorch official master until it's in a few official releases - RW",
    "Method based on https://people.sc.fsu.edu/~jburkardt/presentations/truncated_normal.pdf",
    "Computes standard normal cumulative distribution function",
    "Values are generated by using a truncated uniform distribution and",
    "then using the inverse CDF for the normal distribution.",
    "Get upper and lower cdf values",
    "Uniformly fill tensor with values from [l, u], then translate to",
    "[2l-1, 2u-1].",
    "Use inverse cdf transform for normal distribution to get truncated",
    "standard normal",
    "Transform to proper mean, std",
    "Clamp to ensure it's in the proper range",
    "type: (Tensor, float, float, float, float) -> Tensor",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 Ross Wightman",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Hacked together by / Copyright 2020 Ross Wightman",
    "https://github.com/rwightman/pytorch-image-models/blob/main/timm/scheduler/scheduler_factory.py",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "resample if noise out of percent limit, brute force but shouldn't spin much",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "distmat g",
    "q    1 3 2 4",
    "4 1 2 3",
    "0, 2, 1, 3",
    "1, 2, 3, 0",
    "compute cmc curve for each query",
    "get query pid and camid",
    "remove gallery samples that have the same pid and camid with query",
    "compute cmc curve",
    "binary vector, positions with value 1 are correct matches",
    "this condition is true when query identity does not appear in gallery",
    "compute average precision",
    "reference: https://en.wikipedia.org/wiki/Evaluation_measures_(information_retrieval)#Average_precision",
    "tmp_cmc = [x / (i + 1.) for i, x in enumerate(tmp_cmc)]",
    "query",
    "gallery",
    "distmat = re_ranking(qf, gf, k1=20, k2=6, lambda_value=0.3)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "if feature vector is numpy, you should use 'torch.tensor' transform it to tensor",
    "print('using GPU to compute original distance')",
    "print('starting re_ranking')",
    "k-reciprocal neighbors",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "More elegantly one can simply define:",
    "take care of difference between feature map space and original image space",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "cos = torch.cdist",
    "TODO: maybe find a better spot for this.",
    "dev =  device if torch.cuda.is_available() else \"cpu\"",
    "train",
    "print (f'validation loss {val_loss/len(val_loader)}')",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "normalize vectors here",
    "i th vector at j th kpt",
    "maybe needs to convert them to embeddings and position token",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "## dlcnet_ms5: backbone resnet50 + multi-fusion & multi-stage module",
    "## dlcr101_ms5/dlcr152_ms5: backbone resnet101/152 + multi-fusion & multi-stage module",
    "If the graph is unnecessarily large (with 15+ keypoints by default),",
    "we randomly prune it to a size guaranteeing an average node degree of 6;",
    "see Suppl. Fig S9c in Lauer et al., 2022.",
    "Use the skeleton defined in the config file",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Disable the prediction of PAFs if the graph is empty",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Search a pose_config.yaml file to parse missing information",
    "Clean the training-datasets folder prior to recreating the data pickles",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Load updated lists:",
    "Find the corresponding video file",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Determine the index length required to guarantee",
    "the train\u2013test ratio is exactly the desired one.",
    "Pad indices so lengths agree",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "DeprecationWarnings are silenced since Python 3.2 unless triggered in __main__",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "Also drop maDLC smart cropping augmentation parameters",
    "sort the model directories",
    "get the shuffle index and offset by 1.",
    "read cfg file",
    "create log file",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "Find the matching video from the config `video_sets`,",
    "as it may be stored elsewhere than in the `videos` directory.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "allow_growth must be true here because tensorflow does not automatically free gpu memory and setting it as false occupies all gpu memory so that pytorch cannot kick in",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "should close tensorflow session here in order to free gpu",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "Flip x, y, confidence and reshape",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "https://docs.opencv.org/2.4/modules/highgui/doc/reading_and_writing_images_and_video.html#videocapture-get",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: add cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Also ensure `boundingboxslack` is greater than zero, otherwise overlap",
    "between trackers cannot be evaluated, resulting in empty tracklets.",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: If dataname line above is changed then line below is obsolete?",
    "trackname = trackname.replace(videofolder, destfolder)",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/DeepLabCut/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "for multi animal, seems only this is used",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Get animal IDs and corresponding indices in the arrays of detections",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Only 1 animal, let us return the full graph indices only",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Covariance matrix estimation fails due to numerical singularities",
    "Distance is undefined if the assembly is empty",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Mark the unique body parts as assembled anyway so",
    "they are not used later on to fill assemblies.",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "Spawning (rather than forking) multiple processes does not",
    "work nicely with the GUI or interactive sessions.",
    "In that case, we fall back to the serial assembly.",
    "Swap corresponding keypoints",
    "Only consider assemblies of at least two keypoints",
    "Greedy assembly matching like in pycocotools",
    "Global rather than greedy assembly matching",
    "Cast columns of dtype 'object' to float to avoid TypeError",
    "further down in _parse_ground_truth_data.",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "Sort matching score (OKS) in descending order of assembly affinity",
    "Guarantee precision decreases monotonically",
    "See https://jonathan-hui.medium.com/map-mean-average-precision-for-object-detection-45c121a31173)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "High uncertainty to the unobservable initial velocities",
    "Give high uncertainty to the unobservable initial velocities",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "filter out matched with low IOU",
    "TODO: get cropping parameters and utilize!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "If a string was passed in, auto-convert to True for backward compatibility",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to initial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Ignore best edges possibly defined during a prior evaluation",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Pass the image and the keypoints through the resizer;",
    "this has no effect if no augmenters were added to it.",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Form 2D array of shape (n_rows, 4) where the last dimension",
    "is (sample_index, peak_y, peak_x, bpt_index) to slice the PAFs.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "in case there was already a graph",
    "have to overwrite this",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Clip peak locations to PAFs dimensions",
    "unit_vecs = vecs / lengths[:, np.newaxis]",
    "affinities = np.squeeze(y @ np.expand_dims(unit_vecs, axis=2)).sum(axis=1)",
    "Form cost matrices",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "loading backbone from ResNet, MobileNet etc.",
    "Auto-switch to Adam on M1/M2 chips, as the momentum optimizer crashes",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Convert a frozen graph to OpenVINO IR format",
    "Read network into memory",
    "For better efficiency, model is initialized for batch_size 1 and every sample processed independently",
    "Load network to device",
    "Prepare input data",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "Multi stage is currently only implemented for resnets",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "FIXME Fix wrong scope with Keras layers",
    "def prediction_layer(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2DTranspose(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=2,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "## New DLCNet Addition: multi-stage decoder",
    "def prediction_layer_stage(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2D(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=1,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "turn into x times y time bs * bpts",
    "extract corresponding locref x and y as well as probability",
    "Filter predicted heatmaps with a 2D Gaussian kernel as in:",
    "https://openaccess.thecvf.com/content_CVPR_2020/papers/Huang_The_Devil_Is_in_the_Details_Delving_Into_Unbiased_Data_CVPR_2020_paper.pdf",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrunk when given a depth-multiplier < 1.0.",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Clamp to 40% of crop size to ensure that at least",
    "the center keypoint remains visible after the offset is applied.",
    "Points located close to one another are sampled preferentially",
    "in order to augment crowded regions.",
    "Include keypoints in the count to avoid null probabilities",
    "Shift the crop center in both dimensions by random amounts",
    "and normalize to the original image dimensions.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "for topview, it's safe to mask keypoints under threshold",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "3 for likelihood",
    "we only do single animal here",
    "let's hard code it",
    "Add smart, keypoint-aware image cropping",
    "because of the existence of threshold, sampling population is adjusted to len(self.data)",
    "empty prediction for this frame",
    "in case it's empty prediction",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "Discard keypoints whose coordinates lie outside the cropped image",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "Produce score maps and location refinement fields",
    "Find indices of individuals in joint_id",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO Finish implementing actual abstract class",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "invisible joints are represented by nans",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Check the training image paths are correctly stored as arrays of strings",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "Sometimes tracks cannot be reconstructed as test data are randomly",
    "created; when this happens, we generate a fake h5 data file.",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Loading example data set",
    "# Create one identical splits for 3 networks and 3 augmentations",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "Setting specific parameters for training",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "MODELS = [\"dlcrnet_ms5\", \"dlcr101_ms5\", \"efficientnet-b0\", \"mobilenet_v2_0.35\"]",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "## adding it here",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Downloading the calibration images",
    "Deleting unnecessary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "test if existing models are found:",
    "Test if nonexisting models are not found",
    "Add some other office files:",
    "Add a .pickle and .h5 files",
    "By default, all videos with common extensions are taken from a directory",
    "A list of extensions can also be passed in",
    "labeled_folders: (has_H5, H5_st_mtime, folder_name)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test bounding box from a single keypoint",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test that shape was preserved after vectorization",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Guarantee that images smaller than crop size are handled fine",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Disable stochastic scale jitter",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Verify the aspect ratio is preserved",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Load sample multi animal data",
    "Generate a random permutation and reorder data. Ignore the unique bodypart",
    "Get inverse permutation and reorder the modified data to get back",
    "to the original",
    "Check",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check data comprise path, shape, and xy coordinates",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check that we get the number of frames we asked for",
    "Check that all indices are valid",
    "Check that all frames are unique",
    "Check that we get the number of frames we asked for",
    "Check that all indices are valid",
    "Check that all frames are unique",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test flipped keypoints",
    "Original (cached) coordinates must have remained empty",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID.",
    "Test empty assembly",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Verify that the Hugging Face folder was removed",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-"
  ],
  "v2.3.4": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "def install(package):",
    "subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", package])",
    "install(\"tensorflow==1.13.1\")",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Suppress tensorflow warning messages",
    "Train, evaluate & predict functions / all require TF",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read the config file",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "looking for the pseudo label path",
    "spatial pyramid is not for adapted model",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "ratio_h and ratio_w should match though in reality it does not match exactly",
    "only keep the max",
    "Compute cosine similarity",
    "len(frames) -> (n_scale,)",
    "frames[0].shape - > (batchsize, h, w, 3)",
    "no crop needed",
    "batch full, start true inferencing",
    "only do this when animal is detected",
    "in case we reach the end of the video",
    "add a temp folder for checkpoint",
    "if the scale_list is empty, by default we use the original one",
    "extra data",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO(stes) mocking a few modules to rely in fewer dependencies, without",
    "causing import errors when using deeplabcut.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in.",
    "TODO(jeylau) add affinity.setter to Assembly",
    "TODO(stes): remove/rewrite",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "ignore the exception and continue with the next evaluation, without",
    "yielding a result value.",
    "return the result value, with NaN as the result for all metrics that",
    "could not be computed due to the error.",
    "raise the error and stop evaluation",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read the config file and related variables",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Flatten the list of bodyparts to connect",
    "Format data",
    "Trick to force equal aspect ratio of 3D plots",
    "Set up the matplotlib figure beforehand",
    "Set up skeleton LineCollections",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "Get track_method and do related checks",
    "Get track method suffix",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "## Assign nan to [X,Y] of low likelihood predictions ###",
    "Convert the data to a np array to easily mask out the low likelihood predictions",
    "Assign [X,Y] = nan to low likelihood predictions",
    "Reshape data back to original shape",
    "put data back to the dataframes",
    "Check individuals are the same in both views",
    "Cross-view match individuals",
    "Create a dummy variables for single-animal",
    "Cleaner variable (since inds view1 == inds view2)",
    "Reshape: (num_framex, num_individuals, num_bodyparts , 2)",
    "Triangulate data",
    "i is individual in view 1",
    "voting[i] is the matched individual in view 2",
    "Create 3D DataFrame column and row indices",
    "Swap num_animals with num_frames axes to ensure well-behaving reshape",
    "Fill up 3D dataframe",
    "Reorder 2D dataframe in view 2 to match order of view 1",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no intermediate saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "Store tracklets and corresponding negatives (those that overlap in time)",
    "TODO Avoid looping over all pairs of tracklets",
    "Pick the closest (spatially) overlapping tracklet",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Guarantee track data are sorted in the order defined in the config",
    "Default to the distance cost function",
    "should only exist one",
    "Add in identity weighing before building the graph",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implementation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "more videos are in principle covered, as OpenCV is used and allows many formats.",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "uses openCV",
    "cap.release() >> still used in frame_extraction!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "This dictionary maps the model types to the file locations where the models exist.",
    "Exit the function early if an unknown modeltype is provided.",
    "Aliases for backwards-compatibility",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Initialize costs matrix",
    "get common bodypart detections in track pair",
    "add 3rd dim to the points",
    "cost for any point in time of t1 being the same",
    "any point in time of t2",
    "Get average cost of the entire track",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "check if it exists:",
    "(average_degree / 2) as many edges as there are nodes is required",
    "for undirected graphs to reach the target degree.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (individual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "In a multi animal scenario, show more verbose errors.",
    "Some vidoes were not evaluated.",
    "Keep only the individuals and bodyparts that were labeled",
    "Either display the animals defined in the config if they are found",
    "in the dataframe, or all the trajectories regardless of their names",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Make paths platform-agnostic if they are not already",
    "Ensure folder names are strings",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "make list of full paths",
    "filter list of videos",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "aliases for backwards-compatibility.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Set up a logger and add an stdout handler.",
    "A single logger can have many handlers:",
    "https://docs.python.org/3/howto/logging.html#handler-basic",
    "TODO Dump to log file instead",
    "logger = logging.getLogger(\"GUI\")",
    "logger.setLevel(logging.DEBUG)",
    "handler = logging.StreamHandler(stream=sys.stdout)",
    "handler.setLevel(logging.DEBUG)",
    "formatter = logging.Formatter(",
    "\"%(asctime)s - %(name)s - %(levelname)s - %(message)s\", \"%Y-%m-%d %H:%M:%S\"",
    ")",
    "handler.setFormatter(formatter)",
    "logger.addHandler(handler)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "restore the background region",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Thread-safe Stdout redirector",
    "Creating action using the first constructor",
    "Creating actions using the second constructor",
    "File menu",
    "View menu",
    "Help menu",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "all_bodyparts: List",
    "NOTE: Is there a case where a specific list should",
    "have bodyparts other than the root? I don't think so.",
    "Videotype selection",
    "Select videos",
    "Number of selected videos text",
    "Clear video selection",
    "Qt returns a tuple (list of files, filetype)",
    "Add tab header",
    "Add separating line",
    "Look for any extension by default",
    "This works both with e.g. .avi and avi",
    "Choose multiple files by default",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Automatically activate the napari-deeplabcut plugin",
    "TODO Insert new video",
    "TODO Insert skeleton link",
    "Hack to make the first column read-only, as we do not want users to touch it.",
    "The cleaner solution would be to use a QTreeView and QAbstractItemModel,",
    "but that is a lot of rework for little benefits.",
    "Leave untouched when it is already a string",
    "Slashes also raise the error, but no need to print anything since it is then likely to be a path",
    "Walk backwards across parents to get all keys",
    "Read the video until a frame is successfully read",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO: Multi video select.... have to change to single video!",
    "Shuffle",
    "Num animals",
    "Min swap length",
    "Max gap to fill",
    "Trail length",
    "Filter type",
    "Filter window length",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Tracker Type",
    "Num animals",
    "Num triplets",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Overwrite videos",
    "Trail Points",
    "Plot all bodyparts",
    "Skeleton",
    "Filtered data",
    "Plot trajectories",
    "High quality video",
    "Bodypart list",
    "Multianimal scenario.",
    "Color is based on individual or bodypart.",
    "Single animal scenario.",
    "Color is based on bodypart.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Extraction method",
    "Frame extraction algorithm",
    "Frame cropping",
    "Cluster step",
    "GUI Slider width",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "use the default pose_cfg file for default values",
    "Shuffle",
    "Display iterations",
    "Save iterations",
    "Max iterations",
    "Max number snapshots to keep",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Single / Multi animal Only Layouts",
    "Dynamic bodypart cropping",
    "Save results as csv",
    "Filter predictions",
    "Plot Trajectories",
    "Show trajectory plots",
    "Shuffle",
    "layout.addLayout(tmp_layout)",
    "tmp_layout = QtWidgets.QGridLayout()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Augmentation method",
    "Neural Network",
    "TODO: finish model_comparison",
    "Check that training data files were indeed created.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Add config text field and button",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Display all images",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "calling create_tracking_dataset, train_tracking_transformer, stitch_tracklets",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "only try to find these features if they are in the dictionary",
    "1) reference to video folder and get the proper bpt_feature file for feature table",
    "2) get either the path to gt or the path to track pickle",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "tracklets",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "with npy list form videos, split each to train and test",
    "video_name = '.'.join(video.split(\"/\")[-1].split(\".\")[:-1])",
    "assuming there is only one match",
    "make my own model factory",
    "make my own loss factory",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "NOTE scale factor was wrong in my original version, can set manually to be compat with prev weights",
    "NOTE: drop path for stochastic depth, we shall see if this is better than dropout here",
    "only channel pooling",
    "x -> (B, 12, 2048)",
    "x -> (B, 12, 768)",
    "trying to keep everything simple",
    "need to write my own keypoint embedding",
    "we don't need a fc layer here",
    "x: inputs",
    "(B, 12, 768)",
    "added pos embed",
    "remove all parts I don't understand",
    "forwarding through blocks. But num of blocks should be reduced",
    "i can't really tell what the difference is",
    "will have to change some of these",
    "For old models that I trained prior to conv based patchification",
    "To resize pos embedding when using model at different size from pretrained weights",
    "Rescale the grid of position embeddings when loading from state_dict. Adapted from",
    "https://github.com/google-research/vision_transformer/blob/00883dd691c63a6830751563748663526e811cee/vit_jax/checkpoint.py#L224",
    "Cut & paste from PyTorch official master until it's in a few official releases - RW",
    "Method based on https://people.sc.fsu.edu/~jburkardt/presentations/truncated_normal.pdf",
    "Computes standard normal cumulative distribution function",
    "Values are generated by using a truncated uniform distribution and",
    "then using the inverse CDF for the normal distribution.",
    "Get upper and lower cdf values",
    "Uniformly fill tensor with values from [l, u], then translate to",
    "[2l-1, 2u-1].",
    "Use inverse cdf transform for normal distribution to get truncated",
    "standard normal",
    "Transform to proper mean, std",
    "Clamp to ensure it's in the proper range",
    "type: (Tensor, float, float, float, float) -> Tensor",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 Ross Wightman",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Hacked together by / Copyright 2020 Ross Wightman",
    "https://github.com/rwightman/pytorch-image-models/blob/main/timm/scheduler/scheduler_factory.py",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "resample if noise out of percent limit, brute force but shouldn't spin much",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "distmat g",
    "q    1 3 2 4",
    "4 1 2 3",
    "0, 2, 1, 3",
    "1, 2, 3, 0",
    "compute cmc curve for each query",
    "get query pid and camid",
    "remove gallery samples that have the same pid and camid with query",
    "compute cmc curve",
    "binary vector, positions with value 1 are correct matches",
    "this condition is true when query identity does not appear in gallery",
    "compute average precision",
    "reference: https://en.wikipedia.org/wiki/Evaluation_measures_(information_retrieval)#Average_precision",
    "tmp_cmc = [x / (i + 1.) for i, x in enumerate(tmp_cmc)]",
    "query",
    "gallery",
    "distmat = re_ranking(qf, gf, k1=20, k2=6, lambda_value=0.3)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "if feature vector is numpy, you should use 'torch.tensor' transform it to tensor",
    "print('using GPU to compute original distance')",
    "print('starting re_ranking')",
    "k-reciprocal neighbors",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "More elegantly one can simply define:",
    "take care of difference between feature map space and original image space",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "cos = torch.cdist",
    "TODO: maybe find a better spot for this.",
    "dev =  device if torch.cuda.is_available() else \"cpu\"",
    "train",
    "print (f'validation loss {val_loss/len(val_loader)}')",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "normalize vectors here",
    "i th vector at j th kpt",
    "maybe needs to convert them to embeddings and position token",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "## dlcnet_ms5: backbone resnet50 + multi-fusion & multi-stage module",
    "## dlcr101_ms5/dlcr152_ms5: backbone resnet101/152 + multi-fusion & multi-stage module",
    "If the graph is unnecessarily large (with 15+ keypoints by default),",
    "we randomly prune it to a size guaranteeing an average node degree of 6;",
    "see Suppl. Fig S9c in Lauer et al., 2022.",
    "Use the skeleton defined in the config file",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Disable the prediction of PAFs if the graph is empty",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Search a pose_config.yaml file to parse missing information",
    "Clean the training-datasets folder prior to recreating the data pickles",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Load updated lists:",
    "Find the corresponding video file",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Determine the index length required to guarantee",
    "the train\u2013test ratio is exactly the desired one.",
    "Pad indices so lengths agree",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "DeprecationWarnings are silenced since Python 3.2 unless triggered in __main__",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "Also drop maDLC smart cropping augmentation parameters",
    "sort the model directories",
    "get the shuffle index and offset by 1.",
    "read cfg file",
    "create log file",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "Find the matching video from the config `video_sets`,",
    "as it may be stored elsewhere than in the `videos` directory.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "allow_growth must be true here because tensorflow does not automatically free gpu memory and setting it as false occupies all gpu memory so that pytorch cannot kick in",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "should close tensorflow session here in order to free gpu",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "Flip x, y, confidence and reshape",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "https://docs.opencv.org/2.4/modules/highgui/doc/reading_and_writing_images_and_video.html#videocapture-get",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: add cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Also ensure `boundingboxslack` is greater than zero, otherwise overlap",
    "between trackers cannot be evaluated, resulting in empty tracklets.",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: If dataname line above is changed then line below is obsolete?",
    "trackname = trackname.replace(videofolder, destfolder)",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/DeepLabCut/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "for multi animal, seems only this is used",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Get animal IDs and corresponding indices in the arrays of detections",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Only 1 animal, let us return the full graph indices only",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Covariance matrix estimation fails due to numerical singularities",
    "Distance is undefined if the assembly is empty",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Mark the unique body parts as assembled anyway so",
    "they are not used later on to fill assemblies.",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "Spawning (rather than forking) multiple processes does not",
    "work nicely with the GUI or interactive sessions.",
    "In that case, we fall back to the serial assembly.",
    "Swap corresponding keypoints",
    "Only consider assemblies of at least two keypoints",
    "Greedy assembly matching like in pycocotools",
    "Global rather than greedy assembly matching",
    "Cast columns of dtype 'object' to float to avoid TypeError",
    "further down in _parse_ground_truth_data.",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "Sort matching score (OKS) in descending order of assembly affinity",
    "Guarantee precision decreases monotonically",
    "See https://jonathan-hui.medium.com/map-mean-average-precision-for-object-detection-45c121a31173)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "High uncertainty to the unobservable initial velocities",
    "Give high uncertainty to the unobservable initial velocities",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "filter out matched with low IOU",
    "TODO: get cropping parameters and utilize!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "If a string was passed in, auto-convert to True for backward compatibility",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to initial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Ignore best edges possibly defined during a prior evaluation",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Pass the image and the keypoints through the resizer;",
    "this has no effect if no augmenters were added to it.",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Form 2D array of shape (n_rows, 4) where the last dimension",
    "is (sample_index, peak_y, peak_x, bpt_index) to slice the PAFs.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "in case there was already a graph",
    "have to overwrite this",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Clip peak locations to PAFs dimensions",
    "unit_vecs = vecs / lengths[:, np.newaxis]",
    "affinities = np.squeeze(y @ np.expand_dims(unit_vecs, axis=2)).sum(axis=1)",
    "Form cost matrices",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "loading backbone from ResNet, MobileNet etc.",
    "Auto-switch to Adam on M1/M2 chips, as the momentum optimizer crashes",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Convert a frozen graph to OpenVINO IR format",
    "Read network into memory",
    "For better efficiency, model is initialized for batch_size 1 and every sample processed independently",
    "Load network to device",
    "Prepare input data",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "Multi stage is currently only implemented for resnets",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "FIXME Fix wrong scope with Keras layers",
    "def prediction_layer(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2DTranspose(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=2,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "## New DLCNet Addition: multi-stage decoder",
    "def prediction_layer_stage(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2D(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=1,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "turn into x times y time bs * bpts",
    "extract corresponding locref x and y as well as probability",
    "Filter predicted heatmaps with a 2D Gaussian kernel as in:",
    "https://openaccess.thecvf.com/content_CVPR_2020/papers/Huang_The_Devil_Is_in_the_Details_Delving_Into_Unbiased_Data_CVPR_2020_paper.pdf",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrunk when given a depth-multiplier < 1.0.",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Clamp to 40% of crop size to ensure that at least",
    "the center keypoint remains visible after the offset is applied.",
    "Points located close to one another are sampled preferentially",
    "in order to augment crowded regions.",
    "Include keypoints in the count to avoid null probabilities",
    "Shift the crop center in both dimensions by random amounts",
    "and normalize to the original image dimensions.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "3 for likelihood",
    "we only do single animal here",
    "let's hard code it",
    "Add smart, keypoint-aware image cropping",
    "empty prediction for this frame",
    "in case it's empty prediction",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "Discard keypoints whose coordinates lie outside the cropped image",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "Produce score maps and location refinement fields",
    "Find indices of individuals in joint_id",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO Finish implementing actual abstract class",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "invisible joints are represented by nans",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Check the training image paths are correctly stored as arrays of strings",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Loading example data set",
    "# Create one identical splits for 3 networks and 3 augmentations",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "Setting specific parameters for training",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "MODELS = [\"dlcrnet_ms5\", \"dlcr101_ms5\", \"efficientnet-b0\", \"mobilenet_v2_0.35\"]",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "## adding it here",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Downloading the calibration images",
    "Deleting unnecessary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "test if existing models are found:",
    "Test if nonexisting models are not found",
    "Add some other office files:",
    "Add a .pickle and .h5 files",
    "By default, all videos with common extensions are taken from a directory",
    "A list of extensions can also be passed in",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test bounding box from a single keypoint",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test that shape was preserved after vectorization",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Guarantee that images smaller than crop size are handled fine",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Disable stochastic scale jitter",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Verify the aspect ratio is preserved",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Load sample multi animal data",
    "Generate a random permutation and reorder data. Ignore the unique bodypart",
    "Get inverse permutation and reorder the modified data to get back",
    "to the original",
    "Check",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check data comprise path, shape, and xy coordinates",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test flipped keypoints",
    "Original (cached) coordinates must have remained empty",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID.",
    "Test empty assembly",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Verify that the Hugging Face folder was removed",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-"
  ],
  "v2.3.2": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "def install(package):",
    "subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", package])",
    "install(\"tensorflow==1.13.1\")",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Suppress tensorflow warning messages",
    "Train, evaluate & predict functions / all require TF",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read the config file",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "looking for the pseudo label path",
    "spatial pyramid is not for adapted model",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "ratio_h and ratio_w should match though in reality it does not match exactly",
    "only keep the max",
    "Compute cosine similarity",
    "len(frames) -> (n_scale,)",
    "frames[0].shape - > (batchsize, h, w, 3)",
    "no crop needed",
    "batch full, start true inferencing",
    "only do this when animal is detected",
    "in case we reach the end of the video",
    "add a temp folder for checkpoint",
    "if the scale_list is empty, by default we use the original one",
    "extra data",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO(stes) mocking a few modules to rely in fewer dependencies, without",
    "causing import errors when using deeplabcut.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in.",
    "TODO(jeylau) add affinity.setter to Assembly",
    "TODO(stes): remove/rewrite",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "ignore the exception and continue with the next evaluation, without",
    "yielding a result value.",
    "return the result value, with NaN as the result for all metrics that",
    "could not be computed due to the error.",
    "raise the error and stop evaluation",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read the config file and related variables",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Flatten the list of bodyparts to connect",
    "Format data",
    "Trick to force equal aspect ratio of 3D plots",
    "Set up the matplotlib figure beforehand",
    "Set up skeleton LineCollections",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "Get track_method and do related checks",
    "Get track method suffix",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "## Assign nan to [X,Y] of low likelihood predictions ###",
    "Convert the data to a np array to easily mask out the low likelihood predictions",
    "Assign [X,Y] = nan to low likelihood predictions",
    "Reshape data back to original shape",
    "put data back to the dataframes",
    "Check individuals are the same in both views",
    "Cross-view match individuals",
    "Create a dummy variables for single-animal",
    "Cleaner variable (since inds view1 == inds view2)",
    "Reshape: (num_framex, num_individuals, num_bodyparts , 2)",
    "Triangulate data",
    "i is individual in view 1",
    "voting[i] is the matched individual in view 2",
    "Create 3D DataFrame column and row indices",
    "Swap num_animals with num_frames axes to ensure well-behaving reshape",
    "Fill up 3D dataframe",
    "Reorder 2D dataframe in view 2 to match order of view 1",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "Store tracklets and corresponding negatives (those that overlap in time)",
    "TODO Avoid looping over all pairs of tracklets",
    "Pick the closest (spatially) overlapping tracklet",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Default to the distance cost function",
    "should only exist one",
    "Add in identity weighing before building the graph",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implementation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "will otherwise always return ellipse",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "more videos are in principle covered, as OpenCV is used and allows many formats.",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "uses openCV",
    "cap.release() >> still used in frame_extraction!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "This dictionary maps the model types to the file locations where the models exist.",
    "Exit the function early if an unknown modeltype is provided.",
    "Aliases for backwards-compatibility",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Initialize costs matrix",
    "get common bodypart detections in track pair",
    "add 3rd dim to the points",
    "cost for any point in time of t1 being the same",
    "any point in time of t2",
    "Get average cost of the entire track",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "check if it exists:",
    "(average_degree / 2) as many edges as there are nodes is required",
    "for undirected graphs to reach the target degree.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (individual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "In a multi animal scenario, show more verbose errors.",
    "Some vidoes were not evaluated.",
    "Keep only the individuals and bodyparts that were labeled",
    "Either display the animals defined in the config if they are found",
    "in the dataframe, or all the trajectories regardless of their names",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Make paths platform-agnostic if they are not already",
    "Ensure folder names are strings",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "make list of full paths",
    "filter list of videos",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "aliases for backwards-compatibility.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Set up a logger and add an stdout handler.",
    "A single logger can have many handlers:",
    "https://docs.python.org/3/howto/logging.html#handler-basic",
    "TODO Dump to log file instead",
    "logger = logging.getLogger(\"GUI\")",
    "logger.setLevel(logging.DEBUG)",
    "handler = logging.StreamHandler(stream=sys.stdout)",
    "handler.setLevel(logging.DEBUG)",
    "formatter = logging.Formatter(",
    "\"%(asctime)s - %(name)s - %(levelname)s - %(message)s\", \"%Y-%m-%d %H:%M:%S\"",
    ")",
    "handler.setFormatter(formatter)",
    "logger.addHandler(handler)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "restore the background region",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Thread-safe Stdout redirector",
    "Creating action using the first constructor",
    "Creating actions using the second constructor",
    "File menu",
    "View menu",
    "Help menu",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "all_bodyparts: List",
    "NOTE: Is there a case where a specific list should",
    "have bodyparts other than the root? I don't think so.",
    "Videotype selection",
    "Select videos",
    "Number of selected videos text",
    "Clear video selection",
    "Qt returns a tuple (list of files, filetype)",
    "Add tab header",
    "Add separating line",
    "Look for any extension by default",
    "This works both with e.g. .avi and avi",
    "Choose multiple files by default",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Automatically activate the napari-deeplabcut plugin",
    "TODO Insert new video",
    "TODO Insert skeleton link",
    "Hack to make the first column read-only, as we do not want users to touch it.",
    "The cleaner solution would be to use a QTreeView and QAbstractItemModel,",
    "but that is a lot of rework for little benefits.",
    "Leave untouched when it is already a string",
    "Slashes also raise the error, but no need to print anything since it is then likely to be a path",
    "Walk backwards across parents to get all keys",
    "Read the video until a frame is successfully read",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO: Multi video select.... have to change to single video!",
    "Shuffle",
    "Num animals",
    "Min swap length",
    "Max gap to fill",
    "Trail length",
    "Filter type",
    "Filter window length",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Tracker Type",
    "Num animals",
    "Num triplets",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Overwrite videos",
    "Trail Points",
    "Plot all bodyparts",
    "Skeleton",
    "Filtered data",
    "Plot trajectories",
    "High quality video",
    "Bodypart list",
    "Multianimal scenario.",
    "Color is based on individual or bodypart.",
    "Single animal scenario.",
    "Color is based on bodypart.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Extraction method",
    "Frame extraction algorithm",
    "Frame cropping",
    "Cluster step",
    "GUI Slider width",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "use the default pose_cfg file for default values",
    "Shuffle",
    "Display iterations",
    "Save iterations",
    "Max iterations",
    "Max number snapshots to keep",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Single / Multi animal Only Layouts",
    "Dynamic bodypart cropping",
    "Save results as csv",
    "Filter predictions",
    "Plot Trajectories",
    "Show trajectory plots",
    "Shuffle",
    "layout.addLayout(tmp_layout)",
    "tmp_layout = QtWidgets.QGridLayout()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Augmentation method",
    "Neural Network",
    "TODO: finish model_comparison",
    "Check that training data files were indeed created.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Add config text field and button",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Display all images",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "calling create_tracking_dataset, train_tracking_transformer, stitch_tracklets",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "only try to find these features if they are in the dictionary",
    "1) reference to video folder and get the proper bpt_feature file for feature table",
    "2) get either the path to gt or the path to track pickle",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "tracklets",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "with npy list form videos, split each to train and test",
    "video_name = '.'.join(video.split(\"/\")[-1].split(\".\")[:-1])",
    "assuming there is only one match",
    "make my own model factory",
    "make my own loss factory",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "NOTE scale factor was wrong in my original version, can set manually to be compat with prev weights",
    "NOTE: drop path for stochastic depth, we shall see if this is better than dropout here",
    "only channel pooling",
    "x -> (B, 12, 2048)",
    "x -> (B, 12, 768)",
    "trying to keep everything simple",
    "need to write my own keypoint embedding",
    "we don't need a fc layer here",
    "x: inputs",
    "(B, 12, 768)",
    "added pos embed",
    "remove all parts I don't understand",
    "forwarding through blocks. But num of blocks should be reduced",
    "i can't really tell what the difference is",
    "will have to change some of these",
    "For old models that I trained prior to conv based patchification",
    "To resize pos embedding when using model at different size from pretrained weights",
    "Rescale the grid of position embeddings when loading from state_dict. Adapted from",
    "https://github.com/google-research/vision_transformer/blob/00883dd691c63a6830751563748663526e811cee/vit_jax/checkpoint.py#L224",
    "Cut & paste from PyTorch official master until it's in a few official releases - RW",
    "Method based on https://people.sc.fsu.edu/~jburkardt/presentations/truncated_normal.pdf",
    "Computes standard normal cumulative distribution function",
    "Values are generated by using a truncated uniform distribution and",
    "then using the inverse CDF for the normal distribution.",
    "Get upper and lower cdf values",
    "Uniformly fill tensor with values from [l, u], then translate to",
    "[2l-1, 2u-1].",
    "Use inverse cdf transform for normal distribution to get truncated",
    "standard normal",
    "Transform to proper mean, std",
    "Clamp to ensure it's in the proper range",
    "type: (Tensor, float, float, float, float) -> Tensor",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 Ross Wightman",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Hacked together by / Copyright 2020 Ross Wightman",
    "https://github.com/rwightman/pytorch-image-models/blob/main/timm/scheduler/scheduler_factory.py",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "resample if noise out of percent limit, brute force but shouldn't spin much",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "distmat g",
    "q    1 3 2 4",
    "4 1 2 3",
    "0, 2, 1, 3",
    "1, 2, 3, 0",
    "compute cmc curve for each query",
    "get query pid and camid",
    "remove gallery samples that have the same pid and camid with query",
    "compute cmc curve",
    "binary vector, positions with value 1 are correct matches",
    "this condition is true when query identity does not appear in gallery",
    "compute average precision",
    "reference: https://en.wikipedia.org/wiki/Evaluation_measures_(information_retrieval)#Average_precision",
    "tmp_cmc = [x / (i + 1.) for i, x in enumerate(tmp_cmc)]",
    "query",
    "gallery",
    "distmat = re_ranking(qf, gf, k1=20, k2=6, lambda_value=0.3)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "if feature vector is numpy, you should use 'torch.tensor' transform it to tensor",
    "print('using GPU to compute original distance')",
    "print('starting re_ranking')",
    "k-reciprocal neighbors",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "More elegantly one can simply define:",
    "take care of difference between feature map space and original image space",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "cos = torch.cdist",
    "TODO: maybe find a better spot for this.",
    "dev =  device if torch.cuda.is_available() else \"cpu\"",
    "train",
    "print (f'validation loss {val_loss/len(val_loader)}')",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "normalize vectors here",
    "i th vector at j th kpt",
    "maybe needs to convert them to embeddings and position token",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "## dlcnet_ms5: backbone resnet50 + multi-fusion & multi-stage module",
    "## dlcr101_ms5/dlcr152_ms5: backbone resnet101/152 + multi-fusion & multi-stage module",
    "If the graph is unnecessarily large (with 15+ keypoints by default),",
    "we randomly prune it to a size guaranteeing an average node degree of 6;",
    "see Suppl. Fig S9c in Lauer et al., 2022.",
    "Use the skeleton defined in the config file",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Disable the prediction of PAFs if the graph is empty",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Search a pose_config.yaml file to parse missing information",
    "Clean the training-datasets folder prior to recreating the data pickles",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Load updated lists:",
    "Find the corresponding video file",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Determine the index length required to guarantee",
    "the train\u2013test ratio is exactly the desired one.",
    "Pad indices so lengths agree",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "DeprecationWarnings are silenced since Python 3.2 unless triggered in __main__",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "Also drop maDLC smart cropping augmentation parameters",
    "sort the model directories",
    "get the shuffle index and offset by 1.",
    "read cfg file",
    "create log file",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "Find the matching video from the config `video_sets`,",
    "as it may be stored elsewhere than in the `videos` directory.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "allow_growth must be true here because tensorflow does not automatically free gpu memory and setting it as false occupies all gpu memory so that pytorch cannot kick in",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "should close tensorflow session here in order to free gpu",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "Flip x, y, confidence and reshape",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "https://docs.opencv.org/2.4/modules/highgui/doc/reading_and_writing_images_and_video.html#videocapture-get",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: add cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Also ensure `boundingboxslack` is greater than zero, otherwise overlap",
    "between trackers cannot be evaluated, resulting in empty tracklets.",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: If dataname line above is changed then line below is obsolete?",
    "trackname = trackname.replace(videofolder, destfolder)",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/DeepLabCut/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "for multi animal, seems only this is used",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Get animal IDs and corresponding indices in the arrays of detections",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Only 1 animal, let us return the full graph indices only",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Covariance matrix estimation fails due to numerical singularities",
    "Distance is undefined if the assembly is empty",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Mark the unique body parts as assembled anyway so",
    "they are not used later on to fill assemblies.",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "Spawning (rather than forking) multiple processes does not",
    "work nicely with the GUI or interactive sessions.",
    "In that case, we fall back to the serial assembly.",
    "Swap corresponding keypoints",
    "Only consider assemblies of at least two keypoints",
    "Greedy assembly matching like in pycocotools",
    "Global rather than greedy assembly matching",
    "Cast columns of dtype 'object' to float to avoid TypeError",
    "further down in _parse_ground_truth_data.",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "Sort matching score (OKS) in descending order of assembly affinity",
    "Guarantee precision decreases monotonically",
    "See https://jonathan-hui.medium.com/map-mean-average-precision-for-object-detection-45c121a31173)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "High uncertainty to the unobservable initial velocities",
    "Give high uncertainty to the unobservable initial velocities",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "filter out matched with low IOU",
    "TODO: get cropping parameters and utilize!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "If a string was passed in, auto-convert to True for backward compatibility",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to initial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Ignore best edges possibly defined during a prior evaluation",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Pass the image and the keypoints through the resizer;",
    "this has no effect if no augmenters were added to it.",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Form 2D array of shape (n_rows, 4) where the last dimension",
    "is (sample_index, peak_y, peak_x, bpt_index) to slice the PAFs.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "in case there was already a graph",
    "have to overwrite this",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Clip peak locations to PAFs dimensions",
    "unit_vecs = vecs / lengths[:, np.newaxis]",
    "affinities = np.squeeze(y @ np.expand_dims(unit_vecs, axis=2)).sum(axis=1)",
    "Form cost matrices",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "loading backbone from ResNet, MobileNet etc.",
    "Auto-switch to Adam on M1/M2 chips, as the momentum optimizer crashes",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Convert a frozen graph to OpenVINO IR format",
    "Read network into memory",
    "For better efficiency, model is initialized for batch_size 1 and every sample processed independently",
    "Load network to device",
    "Prepare input data",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "Multi stage is currently only implemented for resnets",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "FIXME Fix wrong scope with Keras layers",
    "def prediction_layer(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2DTranspose(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=2,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "## New DLCNet Addition: multi-stage decoder",
    "def prediction_layer_stage(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2D(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=1,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "turn into x times y time bs * bpts",
    "extract corresponding locref x and y as well as probability",
    "Filter predicted heatmaps with a 2D Gaussian kernel as in:",
    "https://openaccess.thecvf.com/content_CVPR_2020/papers/Huang_The_Devil_Is_in_the_Details_Delving_Into_Unbiased_Data_CVPR_2020_paper.pdf",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrunk when given a depth-multiplier < 1.0.",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Clamp to 40% of crop size to ensure that at least",
    "the center keypoint remains visible after the offset is applied.",
    "Points located close to one another are sampled preferentially",
    "in order to augment crowded regions.",
    "Include keypoints in the count to avoid null probabilities",
    "Shift the crop center in both dimensions by random amounts",
    "and normalize to the original image dimensions.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "3 for likelihood",
    "we only do single animal here",
    "let's hard code it",
    "Add smart, keypoint-aware image cropping",
    "empty prediction for this frame",
    "in case it's empty prediction",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "Discard keypoints whose coordinates lie outside the cropped image",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "Produce score maps and location refinement fields",
    "Find indices of individuals in joint_id",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO Finish implementing actual abstract class",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "invisible joints are represented by nans",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Check the training image paths are correctly stored as arrays of strings",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Loading example data set",
    "# Create one identical splits for 3 networks and 3 augmentations",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "Setting specific parameters for training",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "MODELS = [\"dlcrnet_ms5\", \"dlcr101_ms5\", \"efficientnet-b0\", \"mobilenet_v2_0.35\"]",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "## adding it here",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Downloading the calibration images",
    "Deleting unnecessary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "test if existing models are found:",
    "Test if nonexisting models are not found",
    "Add some other office files:",
    "Add a .pickle and .h5 files",
    "By default, all videos with common extensions are taken from a directory",
    "A list of extensions can also be passed in",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test bounding box from a single keypoint",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test that shape was preserved after vectorization",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Guarantee that images smaller than crop size are handled fine",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Disable stochastic scale jitter",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Verify the aspect ratio is preserved",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Load sample multi animal data",
    "Generate a random permutation and reorder data. Ignore the unique bodypart",
    "Get inverse permutation and reorder the modified data to get back",
    "to the original",
    "Check",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check data comprise path, shape, and xy coordinates",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test flipped keypoints",
    "Original (cached) coordinates must have remained empty",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID.",
    "Test empty assembly",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Verify that the Hugging Face folder was removed",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-"
  ],
  "v2.3": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "def install(package):",
    "subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", package])",
    "install(\"tensorflow==1.13.1\")",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Suppress tensorflow warning messages",
    "Train, evaluate & predict functions / all require TF",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read the config file",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO(stes) mocking a few modules to rely in fewer dependencies, without",
    "causing import errors when using deeplabcut.",
    "Map image paths from predicted data to GT as the first are typically",
    "absolute whereas the latter are relative to the project path.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in.",
    "TODO(jeylau) add affinity.setter to Assembly",
    "TODO(stes): remove/rewrite",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "ignore the exception and continue with the next evaluation, without",
    "yielding a result value.",
    "return the result value, with NaN as the result for all metrics that",
    "could not be computed due to the error.",
    "raise the error and stop evaluation",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read the config file and related variables",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Flatten the list of bodyparts to connect",
    "Format data",
    "Trick to force equal aspect ratio of 3D plots",
    "Set up the matplotlib figure beforehand",
    "Set up skeleton LineCollections",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "Get track_method and do related checks",
    "Get track method suffix",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "## Assign nan to [X,Y] of low likelihood predictions ###",
    "Convert the data to a np array to easily mask out the low likelihood predictions",
    "Assign [X,Y] = nan to low likelihood predictions",
    "Reshape data back to original shape",
    "put data back to the dataframes",
    "Check individuals are the same in both views",
    "Cross-view match individuals",
    "Create a dummy variables for single-animal",
    "Cleaner variable (since inds view1 == inds view2)",
    "Reshape: (num_framex, num_individuals, num_bodyparts , 2)",
    "Triangulate data",
    "i is individual in view 1",
    "voting[i] is the matched individual in view 2",
    "Create 3D DataFrame column and row indices",
    "Swap num_animals with num_frames axes to ensure well-behaving reshape",
    "Fill up 3D dataframe",
    "Reorder 2D dataframe in view 2 to match order of view 1",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "Store tracklets and corresponding negatives (those that overlap in time)",
    "TODO Avoid looping over all pairs of tracklets",
    "Pick the closest (spatially) overlapping tracklet",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Default to the distance cost function",
    "should only exist one",
    "Add in identity weighing before building the graph",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implementation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "more videos are in principle covered, as OpenCV is used and allows many formats.",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "uses openCV",
    "cap.release() >> still used in frame_extraction!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "This dictionary maps the model types to the file locations where the models exist.",
    "Exit the function early if an unknown modeltype is provided.",
    "Aliases for backwards-compatibility",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Initialize costs matrix",
    "get common bodypart detections in track pair",
    "add 3rd dim to the points",
    "cost for any point in time of t1 being the same",
    "any point in time of t2",
    "Get average cost of the entire track",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "check if it exists:",
    "(average_degree / 2) as many edges as there are nodes is required",
    "for undirected graphs to reach the target degree.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (individual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "Keep only the individuals and bodyparts that were labeled",
    "Either display the animals defined in the config if they are found",
    "in the dataframe, or all the trajectories regardless of their names",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Make paths platform-agnostic if they are not already",
    "Ensure folder names are strings",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "make list of full paths",
    "filter list of videos",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "aliases for backwards-compatibility.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Set up a logger and add an stdout handler.",
    "A single logger can have many handlers:",
    "https://docs.python.org/3/howto/logging.html#handler-basic",
    "TODO Dump to log file instead",
    "logger = logging.getLogger(\"GUI\")",
    "logger.setLevel(logging.DEBUG)",
    "handler = logging.StreamHandler(stream=sys.stdout)",
    "handler.setLevel(logging.DEBUG)",
    "formatter = logging.Formatter(",
    "\"%(asctime)s - %(name)s - %(levelname)s - %(message)s\", \"%Y-%m-%d %H:%M:%S\"",
    ")",
    "handler.setFormatter(formatter)",
    "logger.addHandler(handler)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "restore the background region",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Thread-safe Stdout redirector",
    "Creating action using the first constructor",
    "Creating actions using the second constructor",
    "File menu",
    "View menu",
    "Help menu",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "all_bodyparts: List",
    "NOTE: Is there a case where a specific list should",
    "have bodyparts other than the root? I don't think so.",
    "Videotype selection",
    "Select videos",
    "Number of selected videos text",
    "Clear video selection",
    "Qt returns a tuple (list of files, filetype)",
    "Add tab header",
    "Add separating line",
    "Look for any extension by default",
    "This works both with e.g. .avi and avi",
    "Choose multiple files by default",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Automatically activate the napari-deeplabcut plugin",
    "TODO Insert new video",
    "TODO Insert skeleton link",
    "Hack to make the first column read-only, as we do not want users to touch it.",
    "The cleaner solution would be to use a QTreeView and QAbstractItemModel,",
    "but that is a lot of rework for little benefits.",
    "Leave untouched when it is already a string",
    "Slashes also raise the error, but no need to print anything since it is then likely to be a path",
    "Walk backwards across parents to get all keys",
    "Read the video until a frame is successfully read",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO: Multi video select.... have to change to single video!",
    "Shuffle",
    "Num animals",
    "Min swap length",
    "Max gap to fill",
    "Trail length",
    "Filter type",
    "Filter window length",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Tracker Type",
    "Num animals",
    "Num triplets",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Overwrite videos",
    "Trail Points",
    "Plot all bodyparts",
    "Skeleton",
    "Filtered data",
    "Plot trajectories",
    "High quality video",
    "Bodypart list",
    "Multianimal scenario.",
    "Color is based on individual or bodypart.",
    "Single animal scenario.",
    "Color is based on bodypart.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Extraction method",
    "Frame extraction algorithm",
    "Frame cropping",
    "Cluster step",
    "GUI Slider width",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "use the default pose_cfg file for default values",
    "Shuffle",
    "Display iterations",
    "Save iterations",
    "Max iterations",
    "Max number snapshots to keep",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Single / Multi animal Only Layouts",
    "Dynamic bodypart cropping",
    "Save results as csv",
    "Filter predictions",
    "Plot Trajectories",
    "Show trajectory plots",
    "Shuffle",
    "layout.addLayout(tmp_layout)",
    "tmp_layout = QtWidgets.QGridLayout()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "Augmentation method",
    "Neural Network",
    "TODO: finish model_comparison",
    "Check that training data files were indeed created.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Add config text field and button",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "layout.addWidget()",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Display all images",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Shuffle",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "calling create_tracking_dataset, train_tracking_transformer, stitch_tracklets",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "only try to find these features if they are in the dictionary",
    "1) reference to video folder and get the proper bpt_feature file for feature table",
    "2) get either the path to gt or the path to track pickle",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "tracklets",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "with npy list form videos, split each to train and test",
    "video_name = '.'.join(video.split(\"/\")[-1].split(\".\")[:-1])",
    "assuming there is only one match",
    "make my own model factory",
    "make my own loss factory",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "NOTE scale factor was wrong in my original version, can set manually to be compat with prev weights",
    "NOTE: drop path for stochastic depth, we shall see if this is better than dropout here",
    "only channel pooling",
    "x -> (B, 12, 2048)",
    "x -> (B, 12, 768)",
    "trying to keep everything simple",
    "need to write my own keypoint embedding",
    "we don't need a fc layer here",
    "x: inputs",
    "(B, 12, 768)",
    "added pos embed",
    "remove all parts I don't understand",
    "forwarding through blocks. But num of blocks should be reduced",
    "i can't really tell what the difference is",
    "will have to change some of these",
    "For old models that I trained prior to conv based patchification",
    "To resize pos embedding when using model at different size from pretrained weights",
    "Rescale the grid of position embeddings when loading from state_dict. Adapted from",
    "https://github.com/google-research/vision_transformer/blob/00883dd691c63a6830751563748663526e811cee/vit_jax/checkpoint.py#L224",
    "Cut & paste from PyTorch official master until it's in a few official releases - RW",
    "Method based on https://people.sc.fsu.edu/~jburkardt/presentations/truncated_normal.pdf",
    "Computes standard normal cumulative distribution function",
    "Values are generated by using a truncated uniform distribution and",
    "then using the inverse CDF for the normal distribution.",
    "Get upper and lower cdf values",
    "Uniformly fill tensor with values from [l, u], then translate to",
    "[2l-1, 2u-1].",
    "Use inverse cdf transform for normal distribution to get truncated",
    "standard normal",
    "Transform to proper mean, std",
    "Clamp to ensure it's in the proper range",
    "type: (Tensor, float, float, float, float) -> Tensor",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 Ross Wightman",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Hacked together by / Copyright 2020 Ross Wightman",
    "https://github.com/rwightman/pytorch-image-models/blob/main/timm/scheduler/scheduler_factory.py",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "resample if noise out of percent limit, brute force but shouldn't spin much",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "distmat g",
    "q    1 3 2 4",
    "4 1 2 3",
    "0 2 1 3",
    "1 2 3 0",
    "compute cmc curve for each query",
    "get query pid and camid",
    "remove gallery samples that have the same pid and camid with query",
    "compute cmc curve",
    "binary vector, positions with value 1 are correct matches",
    "this condition is true when query identity does not appear in gallery",
    "compute average precision",
    "reference: https://en.wikipedia.org/wiki/Evaluation_measures_(information_retrieval)#Average_precision",
    "tmp_cmc = [x / (i + 1.) for i, x in enumerate(tmp_cmc)]",
    "query",
    "gallery",
    "distmat = re_ranking(qf, gf, k1=20, k2=6, lambda_value=0.3)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "if feature vector is numpy, you should use 'torch.tensor' transform it to tensor",
    "print('using GPU to compute original distance')",
    "print('starting re_ranking')",
    "k-reciprocal neighbors",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "More elegantly one can simply define:",
    "take care of difference between feature map space and original image space",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "cos = torch.cdist",
    "TODO: maybe find a better spot for this.",
    "dev =  device if torch.cuda.is_available() else \"cpu\"",
    "train",
    "print (f'validation loss {val_loss/len(val_loader)}')",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "normalize vectors here",
    "i th vector at j th kpt",
    "maybe needs to convert them to embeddings and position token",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "## dlcnet_ms5: backbone resnet50 + multi-fusion & multi-stage module",
    "## dlcr101_ms5/dlcr152_ms5: backbone resnet101/152 + multi-fusion & multi-stage module",
    "If the graph is unnecessarily large (with 15+ keypoints by default),",
    "we randomly prune it to a size guaranteeing an average node degree of 6;",
    "see Suppl. Fig S9c in Lauer et al., 2022.",
    "Use the skeleton defined in the config file",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Disable the prediction of PAFs if the graph is empty",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Search a pose_config.yaml file to parse missing information",
    "Clean the training-datasets folder prior to recreating the data pickles",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Load updated lists:",
    "Find the corresponding video file",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Determine the index length required to guarantee",
    "the train\u2013test ratio is exactly the desired one.",
    "Pad indices so lengths agree",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "DeprecationWarnings are silenced since Python 3.2 unless triggered in __main__",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "Also drop maDLC smart cropping augmentation parameters",
    "sort the model directories",
    "get the shuffle index and offset by 1.",
    "read cfg file",
    "create log file",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "Find the matching video from the config `video_sets`,",
    "as it may be stored elsewhere than in the `videos` directory.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "allow_growth must be true here because tensorflow does not automatically free gpu memory and setting it as false occupies all gpu memory so that pytorch cannot kick in",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "should close tensorflow session here in order to free gpu",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "Flip x, y, confidence and reshape",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "https://docs.opencv.org/2.4/modules/highgui/doc/reading_and_writing_images_and_video.html#videocapture-get",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: add cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Also ensure `boundingboxslack` is greater than zero, otherwise overlap",
    "between trackers cannot be evaluated, resulting in empty tracklets.",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: If dataname line above is changed then line below is obsolete?",
    "trackname = trackname.replace(videofolder, destfolder)",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/DeepLabCut/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "for multi animal, seems only this is used",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Get animal IDs and corresponding indices in the arrays of detections",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Only 1 animal, let us return the full graph indices only",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Covariance matrix estimation fails due to numerical singularities",
    "Distance is undefined if the assembly is empty",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Mark the unique body parts as assembled anyway so",
    "they are not used later on to fill assemblies.",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "Spawning (rather than forking) multiple processes does not",
    "work nicely with the GUI or interactive sessions.",
    "In that case, we fall back to the serial assembly.",
    "Swap corresponding keypoints",
    "Only consider assemblies of at least two keypoints",
    "Greedy assembly matching like in pycocotools",
    "Global rather than greedy assembly matching",
    "Cast columns of dtype 'object' to float to avoid TypeError",
    "further down in _parse_ground_truth_data.",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "Sort matching score (OKS) in descending order of assembly affinity",
    "Guarantee precision decreases monotonically",
    "See https://jonathan-hui.medium.com/map-mean-average-precision-for-object-detection-45c121a31173)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "High uncertainty to the unobservable initial velocities",
    "Give high uncertainty to the unobservable initial velocities",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "filter out matched with low IOU",
    "TODO: get cropping parameters and utilize!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "If a string was passed in, auto-convert to True for backward compatibility",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to initial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Ignore best edges possibly defined during a prior evaluation",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Pass the image and the keypoints through the resizer;",
    "this has no effect if no augmenters were added to it.",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Form 2D array of shape (n_rows, 4) where the last dimension",
    "is (sample_index, peak_y, peak_x, bpt_index) to slice the PAFs.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Clip peak locations to PAFs dimensions",
    "unit_vecs = vecs / lengths[:, np.newaxis]",
    "affinities = np.squeeze(y @ np.expand_dims(unit_vecs, axis=2)).sum(axis=1)",
    "Form cost matrices",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "loading backbone from ResNet, MobileNet etc.",
    "Auto-switch to Adam on M1/M2 chips, as the momentum optimizer crashes",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Convert a frozen graph to OpenVINO IR format",
    "Read network into memory",
    "For better efficiency, model is initialized for batch_size 1 and every sample processed independently",
    "Load network to device",
    "Prepare input data",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "Multi stage is currently only implemented for resnets",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "FIXME Fix wrong scope with Keras layers",
    "def prediction_layer(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2DTranspose(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=2,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "## New DLCNet Addition: multi-stage decoder",
    "def prediction_layer_stage(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2D(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=1,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "turn into x times y time bs * bpts",
    "extract corresponding locref x and y as well as probability",
    "Filter predicted heatmaps with a 2D Gaussian kernel as in:",
    "https://openaccess.thecvf.com/content_CVPR_2020/papers/Huang_The_Devil_Is_in_the_Details_Delving_Into_Unbiased_Data_CVPR_2020_paper.pdf",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrunk when given a depth-multiplier < 1.0.",
    "",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Adapted from DeeperCut by Eldar Insafutdinov",
    "https://github.com/eldar/pose-tensorflow",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Clamp to 40% of crop size to ensure that at least",
    "the center keypoint remains visible after the offset is applied.",
    "Points located close to one another are sampled preferentially",
    "in order to augment crowded regions.",
    "Include keypoints in the count to avoid null probabilities",
    "Shift the crop center in both dimensions by random amounts",
    "and normalize to the original image dimensions.",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "Add smart, keypoint-aware image cropping",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "Discard keypoints whose coordinates lie outside the cropped image",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "Produce score maps and location refinement fields",
    "Find indices of individuals in joint_id",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "TODO Finish implementing actual abstract class",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "invisible joints are represented by nans",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Check the training image paths are correctly stored as arrays of strings",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Loading example data set",
    "# Create one identical splits for 3 networks and 3 augmentations",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "Setting specific parameters for training",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "MODELS = [\"dlcrnet_ms5\", \"dlcr101_ms5\", \"efficientnet-b0\", \"mobilenet_v2_0.35\"]",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "## adding it here",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Downloading the calibration images",
    "Deleting unnecessary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "test if existing models are found:",
    "Test if nonexisting models are not found",
    "Add some other office files:",
    "Add a .pickle and .h5 files",
    "By default, all videos with common extensions are taken from a directory",
    "A list of extensions can also be passed in",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test bounding box from a single keypoint",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test that shape was preserved after vectorization",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Guarantee that images smaller than crop size are handled fine",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Disable stochastic scale jitter",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Verify the aspect ratio is preserved",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Load sample multi animal data",
    "Generate a random permutation and reorder data. Ignore the unique bodypart",
    "Get inverse permutation and reorder the modified data to get back",
    "to the original",
    "Check",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Check data comprise path, shape, and xy coordinates",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "",
    "DeepLabCut Toolbox (deeplabcut.org)",
    "\u00a9 A. & M.W. Mathis Labs",
    "https://github.com/DeepLabCut/DeepLabCut",
    "",
    "Please see AUTHORS for contributors.",
    "https://github.com/DeepLabCut/DeepLabCut/blob/master/AUTHORS",
    "",
    "Licensed under GNU Lesser General Public License v3.0",
    "",
    "Test flipped keypoints",
    "Original (cached) coordinates must have remained empty",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID.",
    "Test empty assembly",
    "Verify that the Hugging Face folder was removed",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-"
  ],
  "v2.3rc3": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "def install(package):",
    "subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", package])",
    "install(\"tensorflow==1.13.1\")",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Suppress tensorflow warning messages",
    "Train, evaluate & predict functions / all require TF",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "AM: Rowland server down...",
    "auxfun_models.download_model(model, train_dir)",
    "Updating config file:",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "Read the config file",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "DeepLabCut2.0 Toolbox (deeplabcut.org)",
    "\u00a9 A. & M. Mathis Labs",
    "https://github.com/AlexEMG/DeepLabCut",
    "Please see AUTHORS for contributors.",
    "",
    "https://github.com/AlexEMG/DeepLabCut/blob/master/AUTHORS",
    "Licensed under GNU Lesser General Public License v3.0",
    "TODO(stes) mocking a few modules to rely in fewer dependencies, without",
    "causing import errors when using deeplabcut.",
    "Map image paths from predicted data to GT as the first are typically",
    "absolute whereas the latter are relative to the project path.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in.",
    "TODO(jeylau) add affinity.setter to Assembly",
    "TODO(stes): remove/rewrite",
    "DeepLabCut2.0 Toolbox (deeplabcut.org)",
    "\u00a9 A. & M. Mathis Labs",
    "https://github.com/AlexEMG/DeepLabCut",
    "Please see AUTHORS for contributors.",
    "",
    "https://github.com/AlexEMG/DeepLabCut/blob/master/AUTHORS",
    "Licensed under GNU Lesser General Public License v3.0",
    "DeepLabCut2.0 Toolbox (deeplabcut.org)",
    "\u00a9 A. & M. Mathis Labs",
    "https://github.com/AlexEMG/DeepLabCut",
    "Please see AUTHORS for contributors.",
    "",
    "https://github.com/AlexEMG/DeepLabCut/blob/master/AUTHORS",
    "Licensed under GNU Lesser General Public License v3.0",
    "DeepLabCut2.0 Toolbox (deeplabcut.org)",
    "\u00a9 A. & M. Mathis Labs",
    "https://github.com/AlexEMG/DeepLabCut",
    "Please see AUTHORS for contributors.",
    "",
    "https://github.com/AlexEMG/DeepLabCut/blob/master/AUTHORS",
    "Licensed under GNU Lesser General Public License v3.0",
    "DeepLabCut2.0 Toolbox (deeplabcut.org)",
    "\u00a9 A. & M. Mathis Labs",
    "https://github.com/AlexEMG/DeepLabCut",
    "Please see AUTHORS for contributors.",
    "",
    "https://github.com/AlexEMG/DeepLabCut/blob/master/AUTHORS",
    "Licensed under GNU Lesser General Public License v3.0",
    "DeepLabCut2.0 Toolbox (deeplabcut.org)",
    "\u00a9 A. & M. Mathis Labs",
    "https://github.com/AlexEMG/DeepLabCut",
    "Please see AUTHORS for contributors.",
    "",
    "https://github.com/AlexEMG/DeepLabCut/blob/master/AUTHORS",
    "Licensed under GNU Lesser General Public License v3.0",
    "ignore the exception and continue with the next evaluation, without",
    "yielding a result value.",
    "return the result value, with NaN as the result for all metrics that",
    "could not be computed due to the error.",
    "raise the error and stop evaluation",
    "DeepLabCut2.0 Toolbox (deeplabcut.org)",
    "\u00a9 A. & M. Mathis Labs",
    "https://github.com/AlexEMG/DeepLabCut",
    "Please see AUTHORS for contributors.",
    "",
    "https://github.com/AlexEMG/DeepLabCut/blob/master/AUTHORS",
    "Licensed under GNU Lesser General Public License v3.0",
    "Read the config file and related variables",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Flatten the list of bodyparts to connect",
    "Format data",
    "Trick to force equal aspect ratio of 3D plots",
    "Set up the matplotlib figure beforehand",
    "Set up skeleton LineCollections",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "Get track_method and do related checks",
    "Get track method suffix",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "## Assign nan to [X,Y] of low likelihood predictions ###",
    "Convert the data to a np array to easily mask out the low likelihood predictions",
    "Assign [X,Y] = nan to low likelihood predictions",
    "Reshape data back to original shape",
    "put data back to the dataframes",
    "Check individuals are the same in both views",
    "Cross-view match individuals",
    "Create a dummy variables for single-animal",
    "Cleaner variable (since inds view1 == inds view2)",
    "Reshape: (num_framex, num_individuals, num_bodyparts , 2)",
    "Triangulate data",
    "i is individual in view 1",
    "voting[i] is the matched individual in view 2",
    "Create 3D DataFrame column and row indices",
    "Swap num_animals with num_frames axes to ensure well-behaving reshape",
    "Fill up 3D dataframe",
    "Reorder 2D dataframe in view 2 to match order of view 1",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "Store tracklets and corresponding negatives (those that overlap in time)",
    "TODO Avoid looping over all pairs of tracklets",
    "Pick the closest (spatially) overlapping tracklet",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Default to the distance cost function",
    "should only exist one",
    "Add in identity weighing before building the graph",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implementation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "more videos are in principle covered, as OpenCV is used and allows many formats.",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "cap.release() >> still used in frame_extraction!",
    "This dictionary maps the model types to the file locations where the models exist.",
    "Exit the function early if an unknown modeltype is provided.",
    "Loading urls of models",
    "creates a new subfolder as indicated below, unzipping from there and deleting this folder",
    "Hack to get hf path ...",
    "print('removing hf dir')",
    "Aliases for backwards-compatibility",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Initialize costs matrix",
    "get common bodypart detections in track pair",
    "add 3rd dim to the points",
    "cost for any point in time of t1 being the same",
    "any point in time of t2",
    "Get average cost of the entire track",
    "check if it exists:",
    "(average_degree / 2) as many edges as there are nodes is required",
    "for undirected graphs to reach the target degree.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (individual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "Keep only the individuals and bodyparts that were labeled",
    "Either display the animals defined in the config if they are found",
    "in the dataframe, or all the trajectories regardless of their names",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Make paths platform-agnostic if they are not already",
    "Ensure folder names are strings",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "make list of full paths",
    "filter list of videos",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "aliases for backwards-compatibility.",
    "Set up a logger and add an stdout handler.",
    "A single logger can have many handlers:",
    "https://docs.python.org/3/howto/logging.html#handler-basic",
    "TODO Dump to log file instead",
    "logger = logging.getLogger(\"GUI\")",
    "logger.setLevel(logging.DEBUG)",
    "handler = logging.StreamHandler(stream=sys.stdout)",
    "handler.setLevel(logging.DEBUG)",
    "formatter = logging.Formatter(",
    "\"%(asctime)s - %(name)s - %(levelname)s - %(message)s\", \"%Y-%m-%d %H:%M:%S\"",
    ")",
    "handler.setFormatter(formatter)",
    "logger.addHandler(handler)",
    "restore the background region",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "Thread-safe Stdout redirector",
    "Creating action using the first constructor",
    "Creating actions using the second constructor",
    "File menu",
    "View menu",
    "Help menu",
    "all_bodyparts: List",
    "NOTE: Is there a case where a specific list should",
    "have bodyparts other than the root? I don't think so.",
    "Videotype selection",
    "Select videos",
    "Number of selected videos text",
    "Clear video selection",
    "Qt returns a tuple (list of files, filetype)",
    "Add tab header",
    "Add separating line",
    "Look for any extension by default",
    "This works both with e.g. .avi and avi",
    "Choose multiple files by default",
    "Automatically activate the napari-deeplabcut plugin",
    "TODO Insert new video",
    "TODO Insert skeleton link",
    "Hack to make the first column read-only, as we do not want users to touch it.",
    "The cleaner solution would be to use a QTreeView and QAbstractItemModel,",
    "but that is a lot of rework for little benefits.",
    "Leave untouched when it is already a string",
    "Slashes also raise the error, but no need to print anything since it is then likely to be a path",
    "Walk backwards across parents to get all keys",
    "Read the video until a frame is successfully read",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "TODO: Multi video select.... have to change to single video!",
    "Shuffle",
    "Num animals",
    "Min swap length",
    "Max gap to fill",
    "Trail length",
    "Filter type",
    "Filter window length",
    "Shuffle",
    "Tracker Type",
    "Num animals",
    "Num triplets",
    "layout.addWidget()",
    "Shuffle",
    "Overwrite videos",
    "Trail Points",
    "Plot all bodyparts",
    "Skeleton",
    "Filtered data",
    "Plot trajectories",
    "High quality video",
    "Bodypart list",
    "Extraction method",
    "Frame extraction algorithm",
    "Frame cropping",
    "Cluster step",
    "GUI Slider width",
    "use the default pose_cfg file for default values",
    "Shuffle",
    "Display iterations",
    "Save iterations",
    "Max iterations",
    "Max number snapshots to keep",
    "layout.addWidget()",
    "Single / Multi animal Only Layouts",
    "Dynamic bodypart cropping",
    "Save results as csv",
    "Filter predictions",
    "Plot Trajectories",
    "Show trajectory plots",
    "Shuffle",
    "layout.addLayout(tmp_layout)",
    "tmp_layout = QtWidgets.QGridLayout()",
    "Shuffle",
    "Augmentation method",
    "Neural Network",
    "TODO: finish model_comparison",
    "Check that training data files were indeed created.",
    "Add config text field and button",
    "layout.addWidget()",
    "Display all images",
    "Shuffle",
    "calling create_tracking_dataset, train_tracking_transformer, stitch_tracklets",
    "only try to find these features if they are in the dictionary",
    "1) reference to video folder and get the proper bpt_feature file for feature table",
    "2) get either the path to gt or the path to track pickle",
    "tracklets",
    "with npy list form videos, split each to train and test",
    "video_name = '.'.join(video.split(\"/\")[-1].split(\".\")[:-1])",
    "assuming there is only one match",
    "make my own model factory",
    "make my own loss factory",
    "NOTE scale factor was wrong in my original version, can set manually to be compat with prev weights",
    "NOTE: drop path for stochastic depth, we shall see if this is better than dropout here",
    "only channel pooling",
    "x -> (B, 12, 2048)",
    "x -> (B, 12, 768)",
    "trying to keep everything simple",
    "need to write my own keypoint embedding",
    "we don't need a fc layer here",
    "x: inputs",
    "(B, 12, 768)",
    "added pos embed",
    "remove all parts I don't understand",
    "forwarding through blocks. But num of blocks should be reduced",
    "i can't really tell what the difference is",
    "will have to change some of these",
    "For old models that I trained prior to conv based patchification",
    "To resize pos embedding when using model at different size from pretrained weights",
    "Rescale the grid of position embeddings when loading from state_dict. Adapted from",
    "https://github.com/google-research/vision_transformer/blob/00883dd691c63a6830751563748663526e811cee/vit_jax/checkpoint.py#L224",
    "Cut & paste from PyTorch official master until it's in a few official releases - RW",
    "Method based on https://people.sc.fsu.edu/~jburkardt/presentations/truncated_normal.pdf",
    "Computes standard normal cumulative distribution function",
    "Values are generated by using a truncated uniform distribution and",
    "then using the inverse CDF for the normal distribution.",
    "Get upper and lower cdf values",
    "Uniformly fill tensor with values from [l, u], then translate to",
    "[2l-1, 2u-1].",
    "Use inverse cdf transform for normal distribution to get truncated",
    "standard normal",
    "Transform to proper mean, std",
    "Clamp to ensure it's in the proper range",
    "type: (Tensor, float, float, float, float) -> Tensor",
    "resample if noise out of percent limit, brute force but shouldn't spin much",
    "distmat g",
    "q    1 3 2 4",
    "4 1 2 3",
    "0 2 1 3",
    "1 2 3 0",
    "compute cmc curve for each query",
    "get query pid and camid",
    "remove gallery samples that have the same pid and camid with query",
    "compute cmc curve",
    "binary vector, positions with value 1 are correct matches",
    "this condition is true when query identity does not appear in gallery",
    "compute average precision",
    "reference: https://en.wikipedia.org/wiki/Evaluation_measures_(information_retrieval)#Average_precision",
    "tmp_cmc = [x / (i + 1.) for i, x in enumerate(tmp_cmc)]",
    "query",
    "gallery",
    "distmat = re_ranking(qf, gf, k1=20, k2=6, lambda_value=0.3)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "if feature vector is numpy, you should use 'torch.tensor' transform it to tensor",
    "print('using GPU to compute original distance')",
    "print('starting re_ranking')",
    "k-reciprocal neighbors",
    "More elegantly one can simply define:",
    "take care of difference between feature map space and original image space",
    "cos = torch.cdist",
    "TODO: maybe find a better spot for this.",
    "dev =  device if torch.cuda.is_available() else \"cpu\"",
    "train",
    "print (f'validation loss {val_loss/len(val_loader)}')",
    "normalize vectors here",
    "i th vector at j th kpt",
    "maybe needs to convert them to embeddings and position token",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "## dlcnet_ms5: backbone resnet50 + multi-fusion & multi-stage module",
    "## dlcr101_ms5/dlcr152_ms5: backbone resnet101/152 + multi-fusion & multi-stage module",
    "If the graph is unnecessarily large (with 15+ keypoints by default),",
    "we randomly prune it to a size guaranteeing an average node degree of 6;",
    "see Suppl. Fig S9c in Lauer et al., 2022.",
    "Use the skeleton defined in the config file",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Disable the prediction of PAFs if the graph is empty",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Search a pose_config.yaml file to parse missing information",
    "Clean the training-datasets folder prior to recreating the data pickles",
    "Load updated lists:",
    "Find the corresponding video file",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Determine the index length required to guarantee",
    "the train\u2013test ratio is exactly the desired one.",
    "Pad indices so lengths agree",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "DeprecationWarnings are silenced since Python 3.2 unless triggered in __main__",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "Also drop maDLC smart cropping augmentation parameters",
    "sort the model directories",
    "get the shuffle index and offset by 1.",
    "read cfg file",
    "create log file",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "allow_growth must be true here because tensorflow does not automatically free gpu memory and setting it as false occupies all gpu memory so that pytorch cannot kick in",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "should close tensorflow session here in order to free gpu",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "Flip x, y, confidence and reshape",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "https://docs.opencv.org/2.4/modules/highgui/doc/reading_and_writing_images_and_video.html#videocapture-get",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: add cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Also ensure `boundingboxslack` is greater than zero, otherwise overlap",
    "between trackers cannot be evaluated, resulting in empty tracklets.",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: If dataname line above is changed then line below is obsolete?",
    "trackname = trackname.replace(videofolder, destfolder)",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/DeepLabCut/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "for multi animal, seems only this is used",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Get animal IDs and corresponding indices in the arrays of detections",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Only 1 animal, let us return the full graph indices only",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Covariance matrix estimation fails due to numerical singularities",
    "Distance is undefined if the assembly is empty",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Mark the unique body parts as assembled anyway so",
    "they are not used later on to fill assemblies.",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "Spawning (rather than forking) multiple processes does not",
    "work nicely with the GUI or interactive sessions.",
    "In that case, we fall back to the serial assembly.",
    "Swap corresponding keypoints",
    "Only consider assemblies of at least two keypoints",
    "Greedy assembly matching like in pycocotools",
    "Global rather than greedy assembly matching",
    "Cast columns of dtype 'object' to float to avoid TypeError",
    "further down in _parse_ground_truth_data.",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "Sort matching score (OKS) in descending order of assembly affinity",
    "Guarantee precision decreases monotonically",
    "See https://jonathan-hui.medium.com/map-mean-average-precision-for-object-detection-45c121a31173)",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "High uncertainty to the unobservable initial velocities",
    "Give high uncertainty to the unobservable initial velocities",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "filter out matched with low IOU",
    "TODO: get cropping parameters and utilize!",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "If a string was passed in, auto-convert to True for backward compatibility",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to initial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Ignore best edges possibly defined during a prior evaluation",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Pass the image and the keypoints through the resizer;",
    "this has no effect if no augmenters were added to it.",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Form 2D array of shape (n_rows, 4) where the last dimension",
    "is (sample_index, peak_y, peak_x, bpt_index) to slice the PAFs.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "Clip peak locations to PAFs dimensions",
    "unit_vecs = vecs / lengths[:, np.newaxis]",
    "affinities = np.squeeze(y @ np.expand_dims(unit_vecs, axis=2)).sum(axis=1)",
    "Form cost matrices",
    "loading backbone from ResNet, MobileNet etc.",
    "Auto-switch to Adam on M1/M2 chips, as the momentum optimizer crashes",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Convert a frozen graph to OpenVINO IR format",
    "Read network into memory",
    "For better efficiency, model is initialized for batch_size 1 and every sample processed independently",
    "Load network to device",
    "Prepare input data",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "Multi stage is currently only implemented for resnets",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "FIXME Fix wrong scope with Keras layers",
    "def prediction_layer(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2DTranspose(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=2,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "## New DLCNet Addition: multi-stage decoder",
    "def prediction_layer_stage(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2D(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=1,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "turn into x times y time bs * bpts",
    "extract corresponding locref x and y as well as probability",
    "Filter predicted heatmaps with a 2D Gaussian kernel as in:",
    "https://openaccess.thecvf.com/content_CVPR_2020/papers/Huang_The_Devil_Is_in_the_Details_Delving_Into_Unbiased_Data_CVPR_2020_paper.pdf",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrunk when given a depth-multiplier < 1.0.",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Clamp to 40% of crop size to ensure that at least",
    "the center keypoint remains visible after the offset is applied.",
    "Points located close to one another are sampled preferentially",
    "in order to augment crowded regions.",
    "Include keypoints in the count to avoid null probabilities",
    "Shift the crop center in both dimensions by random amounts",
    "and normalize to the original image dimensions.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "Add smart, keypoint-aware image cropping",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "Discard keypoints whose coordinates lie outside the cropped image",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "Produce score maps and location refinement fields",
    "Find indices of individuals in joint_id",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "TODO Finish implementing actual abstract class",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "invisible joints are represented by nans",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Check the training image paths are correctly stored as arrays of strings",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one identical splits for 3 networks and 3 augmentations",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "Setting specific parameters for training",
    "MODELS = [\"dlcrnet_ms5\", \"dlcr101_ms5\", \"efficientnet-b0\", \"mobilenet_v2_0.35\"]",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "## adding it here",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Downloading the calibration images",
    "Deleting unnecessary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "test if existing models are found:",
    "Test if nonexisting models are not found",
    "Add some other office files:",
    "Add a .pickle and .h5 files",
    "By default, all videos with common extensions are taken from a directory",
    "A list of extensions can also be passed in",
    "Test bounding box from a single keypoint",
    "Test that shape was preserved after vectorization",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Guarantee that images smaller than crop size are handled fine",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Disable stochastic scale jitter",
    "Verify the aspect ratio is preserved",
    "Load sample multi animal data",
    "Generate a random permutation and reorder data. Ignore the unique bodypart",
    "Get inverse permutation and reorder the modified data to get back",
    "to the original",
    "Check",
    "Check data comprise path, shape, and xy coordinates",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "Test flipped keypoints",
    "Original (cached) coordinates must have remained empty",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID.",
    "Test empty assembly",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-"
  ],
  "v2.3rc1": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "def install(package):",
    "subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", package])",
    "install(\"tensorflow==1.13.1\")",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Suppress tensorflow warning messages",
    "Train, evaluate & predict functions / all require TF",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "Read the config file",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Flatten the list of bodyparts to connect",
    "Format data",
    "Trick to force equal aspect ratio of 3D plots",
    "Set up the matplotlib figure beforehand",
    "Set up skeleton LineCollections",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "Get track_method and do related checks",
    "Get track method suffix",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "## Assign nan to [X,Y] of low likelihood predictions ###",
    "Convert the data to a np array to easily mask out the low likelihood predictions",
    "Assign [X,Y] = nan to low likelihood predictions",
    "Reshape data back to original shape",
    "put data back to the dataframes",
    "Check individuals are the same in both views",
    "Cross-view match individuals",
    "Create a dummy variables for single-animal",
    "Cleaner variable (since inds view1 == inds view2)",
    "Reshape: (num_framex, num_individuals, num_bodyparts , 2)",
    "Triangulate data",
    "i is individual in view 1",
    "voting[i] is the matched individual in view 2",
    "Create 3D DataFrame column and row indices",
    "Swap num_animals with num_frames axes to ensure well-behaving reshape",
    "Fill up 3D dataframe",
    "Reorder 2D dataframe in view 2 to match order of view 1",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "Store tracklets and corresponding negatives (those that overlap in time)",
    "TODO Avoid looping over all pairs of tracklets",
    "Pick the closest (spatially) overlapping tracklet",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Default to the distance cost function",
    "should only exist one",
    "Add in identity weighing before building the graph",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implementation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "more videos are in principle covered, as OpenCV is used and allows many formats.",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "This dictionary maps the model types to the file locations where the models exist.",
    "Exit the function early if an unknown modeltype is provided.",
    "Aliases for backwards-compatibility",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Initialize costs matrix",
    "get common bodypart detections in track pair",
    "add 3rd dim to the points",
    "cost for any point in time of t1 being the same",
    "any point in time of t2",
    "Get average cost of the entire track",
    "check if it exists:",
    "(average_degree / 2) as many edges as there are nodes is required",
    "for undirected graphs to reach the target degree.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (individual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "Keep only the individuals and bodyparts that were labeled",
    "Either display the animals defined in the config if they are found",
    "in the dataframe, or all the trajectories regardless of their names",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Make paths platform-agnostic if they are not already",
    "Ensure folder names are strings",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "make list of full paths",
    "filter list of videos",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "aliases for backwards-compatibility.",
    "Set up a logger and add an stdout handler.",
    "A single logger can have many handlers:",
    "https://docs.python.org/3/howto/logging.html#handler-basic",
    "TODO Dump to log file instead",
    "logger = logging.getLogger(\"GUI\")",
    "logger.setLevel(logging.DEBUG)",
    "handler = logging.StreamHandler(stream=sys.stdout)",
    "handler.setLevel(logging.DEBUG)",
    "formatter = logging.Formatter(",
    "\"%(asctime)s - %(name)s - %(levelname)s - %(message)s\", \"%Y-%m-%d %H:%M:%S\"",
    ")",
    "handler.setFormatter(formatter)",
    "logger.addHandler(handler)",
    "restore the background region",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "Thread-safe Stdout redirector",
    "Creating action using the first constructor",
    "Creating actions using the second constructor",
    "File menu",
    "View menu",
    "Help menu",
    "all_bodyparts: List",
    "NOTE: Is there a case where a specific list should",
    "have bodyparts other than the root? I don't think so.",
    "Videotype selection",
    "Select videos",
    "Number of selected videos text",
    "Clear video selection",
    "Qt returns a tuple (list of files, filetype)",
    "Add tab header",
    "Add separating line",
    "Look for any extension by default",
    "This works both with e.g. .avi and avi",
    "Choose multiple files by default",
    "Automatically activate the napari-deeplabcut plugin",
    "TODO Insert new video",
    "TODO Insert skeleton link",
    "Hack to make the first column read-only, as we do not want users to touch it.",
    "The cleaner solution would be to use a QTreeView and QAbstractItemModel,",
    "but that is a lot of rework for little benefits.",
    "Leave untouched when it is already a string",
    "Slashes also raise the error, but no need to print anything since it is then likely to be a path",
    "Walk backwards across parents to get all keys",
    "Read the video until a frame is successfully read",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "TODO: Multi video select.... have to change to single video!",
    "Shuffle",
    "Num animals",
    "Min swap length",
    "Max gap to fill",
    "Trail length",
    "Filter type",
    "Filter window length",
    "Shuffle",
    "Tracker Type",
    "Num animals",
    "Num triplets",
    "layout.addWidget()",
    "Shuffle",
    "Overwrite videos",
    "Trail Points",
    "Plot all bodyparts",
    "Skeleton",
    "Filtered data",
    "Plot trajectories",
    "High quality video",
    "Bodypart list",
    "Extraction method",
    "Frame extraction algorithm",
    "Frame cropping",
    "Cluster step",
    "GUI Slider width",
    "use the default pose_cfg file for default values",
    "Shuffle",
    "Display iterations",
    "Save iterations",
    "Max iterations",
    "Max number snapshots to keep",
    "layout.addWidget()",
    "Single / Multi animal Only Layouts",
    "Dynamic bodypart cropping",
    "Save results as csv",
    "Filter predictions",
    "Plot Trajectories",
    "Show trajectory plots",
    "Shuffle",
    "layout.addLayout(tmp_layout)",
    "tmp_layout = QtWidgets.QGridLayout()",
    "Shuffle",
    "Augmentation method",
    "Neural Network",
    "TODO: finish model_comparison",
    "Check that training data files were indeed created.",
    "Add config text field and button",
    "layout.addWidget()",
    "Display all images",
    "Shuffle",
    "calling create_tracking_dataset, train_tracking_transformer, stitch_tracklets",
    "only try to find these features if they are in the dictionary",
    "1) reference to video folder and get the proper bpt_feature file for feature table",
    "2) get either the path to gt or the path to track pickle",
    "tracklets",
    "with npy list form videos, split each to train and test",
    "video_name = '.'.join(video.split(\"/\")[-1].split(\".\")[:-1])",
    "assuming there is only one match",
    "make my own model factory",
    "make my own loss factory",
    "NOTE scale factor was wrong in my original version, can set manually to be compat with prev weights",
    "NOTE: drop path for stochastic depth, we shall see if this is better than dropout here",
    "only channel pooling",
    "x -> (B, 12, 2048)",
    "x -> (B, 12, 768)",
    "trying to keep everything simple",
    "need to write my own keypoint embedding",
    "we don't need a fc layer here",
    "x: inputs",
    "(B, 12, 768)",
    "added pos embed",
    "remove all parts I don't understand",
    "forwarding through blocks. But num of blocks should be reduced",
    "i can't really tell what the difference is",
    "will have to change some of these",
    "For old models that I trained prior to conv based patchification",
    "To resize pos embedding when using model at different size from pretrained weights",
    "Rescale the grid of position embeddings when loading from state_dict. Adapted from",
    "https://github.com/google-research/vision_transformer/blob/00883dd691c63a6830751563748663526e811cee/vit_jax/checkpoint.py#L224",
    "Cut & paste from PyTorch official master until it's in a few official releases - RW",
    "Method based on https://people.sc.fsu.edu/~jburkardt/presentations/truncated_normal.pdf",
    "Computes standard normal cumulative distribution function",
    "Values are generated by using a truncated uniform distribution and",
    "then using the inverse CDF for the normal distribution.",
    "Get upper and lower cdf values",
    "Uniformly fill tensor with values from [l, u], then translate to",
    "[2l-1, 2u-1].",
    "Use inverse cdf transform for normal distribution to get truncated",
    "standard normal",
    "Transform to proper mean, std",
    "Clamp to ensure it's in the proper range",
    "type: (Tensor, float, float, float, float) -> Tensor",
    "resample if noise out of percent limit, brute force but shouldn't spin much",
    "distmat g",
    "q    1 3 2 4",
    "4 1 2 3",
    "0 2 1 3",
    "1 2 3 0",
    "compute cmc curve for each query",
    "get query pid and camid",
    "remove gallery samples that have the same pid and camid with query",
    "compute cmc curve",
    "binary vector, positions with value 1 are correct matches",
    "this condition is true when query identity does not appear in gallery",
    "compute average precision",
    "reference: https://en.wikipedia.org/wiki/Evaluation_measures_(information_retrieval)#Average_precision",
    "tmp_cmc = [x / (i + 1.) for i, x in enumerate(tmp_cmc)]",
    "query",
    "gallery",
    "distmat = re_ranking(qf, gf, k1=20, k2=6, lambda_value=0.3)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "if feature vector is numpy, you should use 'torch.tensor' transform it to tensor",
    "print('using GPU to compute original distance')",
    "print('starting re_ranking')",
    "k-reciprocal neighbors",
    "More elegantly one can simply define:",
    "take care of difference between feature map space and original image space",
    "cos = torch.cdist",
    "TODO: maybe find a better spot for this.",
    "dev =  device if torch.cuda.is_available() else \"cpu\"",
    "train",
    "print (f'validation loss {val_loss/len(val_loader)}')",
    "normalize vectors here",
    "i th vector at j th kpt",
    "maybe needs to convert them to embeddings and position token",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "## dlcnet_ms5: backbone resnet50 + multi-fusion & multi-stage module",
    "## dlcr101_ms5/dlcr152_ms5: backbone resnet101/152 + multi-fusion & multi-stage module",
    "If the graph is unnecessarily large (with 15+ keypoints by default),",
    "we randomly prune it to a size guaranteeing an average node degree of 6;",
    "see Suppl. Fig S9c in Lauer et al., 2022.",
    "Use the skeleton defined in the config file",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Disable the prediction of PAFs if the graph is empty",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Search a pose_config.yaml file to parse missing information",
    "Clean the training-datasets folder prior to recreating the data pickles",
    "Load updated lists:",
    "Find the corresponding video file",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Determine the index length required to guarantee",
    "the train\u2013test ratio is exactly the desired one.",
    "Pad indices so lengths agree",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "DeprecationWarnings are silenced since Python 3.2 unless triggered in __main__",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "Also drop maDLC smart cropping augmentation parameters",
    "sort the model directories",
    "get the shuffle index and offset by 1.",
    "read cfg file",
    "create log file",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "allow_growth must be true here because tensorflow does not automatically free gpu memory and setting it as false occupies all gpu memory so that pytorch cannot kick in",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "should close tensorflow session here in order to free gpu",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "https://docs.opencv.org/2.4/modules/highgui/doc/reading_and_writing_images_and_video.html#videocapture-get",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: add cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Also ensure `boundingboxslack` is greater than zero, otherwise overlap",
    "between trackers cannot be evaluated, resulting in empty tracklets.",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: If dataname line above is changed then line below is obsolete?",
    "trackname = trackname.replace(videofolder, destfolder)",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/DeepLabCut/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "for multi animal, seems only this is used",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Get animal IDs and corresponding indices in the arrays of detections",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Only 1 animal, let us return the full graph indices only",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Covariance matrix estimation fails due to numerical singularities",
    "Distance is undefined if the assembly is empty",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Mark the unique body parts as assembled anyway so",
    "they are not used later on to fill assemblies.",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "Spawning (rather than forking) multiple processes does not",
    "work nicely with the GUI or interactive sessions.",
    "In that case, we fall back to the serial assembly.",
    "Swap corresponding keypoints",
    "Only consider assemblies of at least two keypoints",
    "Greedy assembly matching like in pycocotools",
    "Global rather than greedy assembly matching",
    "Cast columns of dtype 'object' to float to avoid TypeError",
    "further down in _parse_ground_truth_data.",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "Sort matching score (OKS) in descending order of assembly affinity",
    "Guarantee precision decreases monotonically",
    "See https://jonathan-hui.medium.com/map-mean-average-precision-for-object-detection-45c121a31173)",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "High uncertainty to the unobservable initial velocities",
    "Give high uncertainty to the unobservable initial velocities",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "filter out matched with low IOU",
    "TODO: get cropping parameters and utilize!",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "If a string was passed in, auto-convert to True for backward compatibility",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to initial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Ignore best edges possibly defined during a prior evaluation",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Pass the image and the keypoints through the resizer;",
    "this has no effect if no augmenters were added to it.",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Form 2D array of shape (n_rows, 4) where the last dimension",
    "is (sample_index, peak_y, peak_x, bpt_index) to slice the PAFs.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "Clip peak locations to PAFs dimensions",
    "unit_vecs = vecs / lengths[:, np.newaxis]",
    "affinities = np.squeeze(y @ np.expand_dims(unit_vecs, axis=2)).sum(axis=1)",
    "Form cost matrices",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Convert a frozen graph to OpenVINO IR format",
    "Read network into memory",
    "For better efficiency, model is initialized for batch_size 1 and every sample processed independently",
    "Load network to device",
    "Prepare input data",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "Multi stage is currently only implemented for resnets",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "FIXME Fix wrong scope with Keras layers",
    "def prediction_layer(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2DTranspose(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=2,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "## New DLCNet Addition: multi-stage decoder",
    "def prediction_layer_stage(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2D(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=1,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "turn into x times y time bs * bpts",
    "extract corresponding locref x and y as well as probability",
    "Filter predicted heatmaps with a 2D Gaussian kernel as in:",
    "https://openaccess.thecvf.com/content_CVPR_2020/papers/Huang_The_Devil_Is_in_the_Details_Delving_Into_Unbiased_Data_CVPR_2020_paper.pdf",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrunk when given a depth-multiplier < 1.0.",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Clamp to 40% of crop size to ensure that at least",
    "the center keypoint remains visible after the offset is applied.",
    "Points located close to one another are sampled preferentially",
    "in order to augment crowded regions.",
    "Include keypoints in the count to avoid null probabilities",
    "Shift the crop center in both dimensions by random amounts",
    "and normalize to the original image dimensions.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "Add smart, keypoint-aware image cropping",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "Discard keypoints whose coordinates lie outside the cropped image",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "Produce score maps and location refinement fields",
    "Find indices of individuals in joint_id",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "TODO Finish implementing actual abstract class",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "invisible joints are represented by nans",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Check the training image paths are correctly stored as arrays of strings",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one identical splits for 3 networks and 3 augmentations",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "Setting specific parameters for training",
    "MODELS = [\"dlcrnet_ms5\", \"dlcr101_ms5\", \"efficientnet-b0\", \"mobilenet_v2_0.35\"]",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "## adding it here",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Downloading the calibration images",
    "Deleting unnecessary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "test if existing models are found:",
    "Test if nonexisting models are not found",
    "Add some other office files:",
    "Add a .pickle and .h5 files",
    "By default, all videos with common extensions are taken from a directory",
    "A list of extensions can also be passed in",
    "Test bounding box from a single keypoint",
    "Test that shape was preserved after vectorization",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Guarantee that images smaller than crop size are handled fine",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Disable stochastic scale jitter",
    "Verify the aspect ratio is preserved",
    "Load sample multi animal data",
    "Generate a random permutation and reorder data. Ignore the unique bodypart",
    "Get inverse permutation and reorder the modified data to get back",
    "to the original",
    "Check",
    "Check data comprise path, shape, and xy coordinates",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "Test flipped keypoints",
    "Original (cached) coordinates must have remained empty",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID.",
    "Test empty assembly",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-"
  ],
  "v2.2.3": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "def install(package):",
    "subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", package])",
    "install(\"tensorflow==1.13.1\")",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Suppress tensorflow warning messages",
    "Train, evaluate & predict functions / all require TF",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "Read the config file",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Flatten the list of bodyparts to connect",
    "Format data",
    "Trick to force equal aspect ratio of 3D plots",
    "Set up the matplotlib figure beforehand",
    "Set up skeleton LineCollections",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "Get track_method and do related checks",
    "Get track method suffix",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "## Assign nan to [X,Y] of low likelihood predictions ###",
    "Convert the data to a np array to easily mask out the low likelihood predictions",
    "Assign [X,Y] = nan to low likelihood predictions",
    "Reshape data back to original shape",
    "put data back to the dataframes",
    "Check individuals are the same in both views",
    "Cross-view match individuals",
    "Create a dummy variables for single-animal",
    "Cleaner variable (since inds view1 == inds view2)",
    "Reshape: (num_framex, num_individuals, num_bodyparts , 2)",
    "Triangulate data",
    "i is individual in view 1",
    "voting[i] is the matched individual in view 2",
    "Create 3D DataFrame column and row indices",
    "Swap num_animals with num_frames axes to ensure well-behaving reshape",
    "Fill up 3D dataframe",
    "Reorder 2D dataframe in view 2 to match order of view 1",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "Store tracklets and corresponding negatives (those that overlap in time)",
    "TODO Avoid looping over all pairs of tracklets",
    "Pick the closest (spatially) overlapping tracklet",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Default to the distance cost function",
    "should only exist one",
    "Add in identity weighing before building the graph",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implementation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "more videos are in principle covered, as OpenCV is used and allows many formats.",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "This dictionary maps the model types to the file locations where the models exist.",
    "Exit the function early if an unknown modeltype is provided.",
    "Aliases for backwards-compatibility",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Initialize costs matrix",
    "get common bodypart detections in track pair",
    "add 3rd dim to the points",
    "cost for any point in time of t1 being the same",
    "any point in time of t2",
    "Get average cost of the entire track",
    "check if it exists:",
    "(average_degree / 2) as many edges as there are nodes is required",
    "for undirected graphs to reach the target degree.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (individual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "Keep only the individuals and bodyparts that were labeled",
    "Either display the animals defined in the config if they are found",
    "in the dataframe, or all the trajectories regardless of their names",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Make paths platform-agnostic if they are not already",
    "Ensure folder names are strings",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "make list of full paths",
    "filter list of videos",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "aliases for backwards-compatibility.",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingset = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingset_boxsizer = wx.StaticBoxSizer(trainingset, wx.VERTICAL)",
    "self.trainingset = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingset_boxsizer.Add(",
    "self.trainingset, 1, wx.EXPAND | wx.TOP | wx.BOTTOM, 10",
    ")",
    "hbox_.Add(trainingset_boxsizer, 5, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "Read the infer config file",
    "trainingsetindex = self.trainingset.GetValue()",
    "let the user open the file with default text editor. Also make it mac compatible",
    "trainingsetindex = self.trainingset.GetValue()",
    "trainingsetindex=trainingsetindex,",
    "trainingsetindex=self.trainingset.GetValue(),",
    "self.save.Enable(False)",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "topSplitter = wx.SplitterWindow(self)",
    "",
    "self.image_panel = ImagePanel(topSplitter, config,video,shuffle,Dataframe,self.gui_size)",
    "self.widget_panel = WidgetPanel(topSplitter)",
    "",
    "topSplitter.SplitHorizontally(self.image_panel, self.widget_panel,sashPosition=self.gui_size[1]*0.83)#0.9",
    "topSplitter.SetSashGravity(1)",
    "sizer = wx.BoxSizer(wx.VERTICAL)",
    "sizer.Add(topSplitter, 1, wx.EXPAND)",
    "self.SetSizer(sizer)",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "Read config file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0,10), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=10)",
    "Add all the options",
    "line = wx.StaticLine(self)",
    "self.sizer.Add(line, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=10)",
    "",
    "self.multi_choice.Bind(wx.EVT_CHECKBOX,self.activate_copy_videos)",
    "Hide the button as this is not the default option",
    "self.vids.Enable(False)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "page10 = Refine_labels(self.parent, self.gui_size, self.cfg, page5)",
    "self.parent.AddPage(page10, \"OPT: Refine Labels\")",
    "self.yes.Enable(False)",
    "self.no.Enable(False)",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.buttonCounter = []",
    "self.bodyparts = []",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "convert the image to RGB as you are showing the image with matplotlib",
    "draw epipolar lines",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.filelist = self.filelist + self.vids",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "## train and go ###",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "convert the image to RGB as you are showing the image with matplotlib",
    "draw epipolar lines",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "checks for unique bodyparts",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Cache original bodyparts",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Rearrange bodypart columns in config order",
    "Test whether there are missing frames and superfluous data",
    "Check whether new individuals or body parts were added",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is selected when radio buttons are changed",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Discard data associated with bodyparts that are no longer in the config",
    "Re-organize the dataframe so the CSV looks consistent with the config",
    "restore the background region",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.build = wx.Button(self, label=\"Build skeleton\")",
    "sizer.Add(self.build, pos=(4, 3), flag=wx.BOTTOM | wx.RIGHT, border=10)",
    "self.build.Bind(wx.EVT_BUTTON, self.build_skeleton)",
    "self.build.Enable(True)",
    "def build_skeleton(self, event):",
    "skeleton.SkeletonBuilder(self.config)",
    "Setting the GUI size and panels design",
    "This sets the minimum size of the GUI. It can scale now!",
    "Checks if zoom/pan button is ON",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingindex = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingindex_boxsizer = wx.StaticBoxSizer(trainingindex, wx.VERTICAL)",
    "self.trainingindex = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingindex_boxsizer.Add(",
    "self.trainingindex, 1, wx.EXPAND | wx.TOP | wx.BOTTOM, 10)",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "hbox1.Add(trainingindex_boxsizer, 10, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "self.trainingindex.Enable(False)",
    "self.trainingindex.Enable(True)",
    "self.trainingindex.Enable(True)",
    "Read the pose config file",
    "print(trainFraction[-1])",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.get_model_folder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "self.trainingindex.Enable(True)",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "### BOX 1 ####",
    "### BOX 2 ####",
    "### BOX 3 ####",
    "Trigger chooseOption as if the radio button had been clicked",
    "Read the infer config file",
    "trainFraction = cfg[\"TrainingFraction\"][trainingsetindex]",
    "let the user open the file with default text editor. Also make it mac compatible",
    "self.select_destfolder.SetPath(\"None\")",
    "self.config = []",
    "self.sel_config.SetPath(\"\")",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingindex_box = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingindex_boxsizer = wx.StaticBoxSizer(trainingindex_box, wx.VERTICAL)",
    "self.trainingindex = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingindex_boxsizer.Add(",
    "self.trainingindex, 0, wx.EXPAND | wx.TOP | wx.BOTTOM, 10",
    ")",
    "self.hbox2.Add(trainingindex_boxsizer, 10, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "trainindex = self.trainingindex.GetValue()",
    "trainindex=trainindex,",
    "self.shuffles.SetValue(\"1\")",
    "DownSampleVideo(vname,width=-1,height=200,outsuffix='downsampled',outpath=None,rotatecw=False):",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "majorDimension=0,",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "Overwrite the config-defined individual names",
    "with those actually present in the annotated data",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingset = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingset_boxsizer = wx.StaticBoxSizer(trainingset, wx.VERTICAL)",
    "self.trainingset = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingset_boxsizer.Add(",
    "self.trainingset, 1, wx.EXPAND | wx.TOP | wx.BOTTOM, 10",
    ")",
    "self.hbox1.Add(trainingset_boxsizer, 5, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "if self.plot_scoremaps.GetStringSelection() == \"Yes\":",
    "Read the infer config file",
    "trainingsetindex = self.trainingset.GetValue()",
    "let the user open the file with default text editor. Also make it mac compatible",
    "shuffle = self.shuffle.GetValue()",
    "trainingsetindex = self.trainingset.GetValue()",
    "trainingsetindex=trainingsetindex,",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "## LABELING ###",
    "self.sel_config.SetPath(\"\")",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "self.cfg = auxiliaryfunctions.read_config(config)",
    "self.statusbar.SetStatusText(\"\")",
    "dlg = wx.MessageDialog(None,\"Are you sure?\", \"Quit!\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_YES:",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0, 4), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=5)",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "calling create_tracking_dataset, train_tracking_transformer, stitch_tracklets",
    "only try to find these features if they are in the dictionary",
    "1) reference to video folder and get the proper bpt_feature file for feature table",
    "2) get either the path to gt or the path to track pickle",
    "tracklets",
    "with npy list form videos, split each to train and test",
    "video_name = '.'.join(video.split(\"/\")[-1].split(\".\")[:-1])",
    "assuming there is only one match",
    "make my own model factory",
    "make my own loss factory",
    "NOTE scale factor was wrong in my original version, can set manually to be compat with prev weights",
    "NOTE: drop path for stochastic depth, we shall see if this is better than dropout here",
    "only channel pooling",
    "x -> (B, 12, 2048)",
    "x -> (B, 12, 768)",
    "trying to keep everything simple",
    "need to write my own keypoint embedding",
    "we don't need a fc layer here",
    "x: inputs",
    "(B, 12, 768)",
    "added pos embed",
    "remove all parts I don't understand",
    "forwarding through blocks. But num of blocks should be reduced",
    "i can't really tell what the difference is",
    "will have to change some of these",
    "For old models that I trained prior to conv based patchification",
    "To resize pos embedding when using model at different size from pretrained weights",
    "Rescale the grid of position embeddings when loading from state_dict. Adapted from",
    "https://github.com/google-research/vision_transformer/blob/00883dd691c63a6830751563748663526e811cee/vit_jax/checkpoint.py#L224",
    "Cut & paste from PyTorch official master until it's in a few official releases - RW",
    "Method based on https://people.sc.fsu.edu/~jburkardt/presentations/truncated_normal.pdf",
    "Computes standard normal cumulative distribution function",
    "Values are generated by using a truncated uniform distribution and",
    "then using the inverse CDF for the normal distribution.",
    "Get upper and lower cdf values",
    "Uniformly fill tensor with values from [l, u], then translate to",
    "[2l-1, 2u-1].",
    "Use inverse cdf transform for normal distribution to get truncated",
    "standard normal",
    "Transform to proper mean, std",
    "Clamp to ensure it's in the proper range",
    "type: (Tensor, float, float, float, float) -> Tensor",
    "resample if noise out of percent limit, brute force but shouldn't spin much",
    "distmat g",
    "q    1 3 2 4",
    "4 1 2 3",
    "0 2 1 3",
    "1 2 3 0",
    "compute cmc curve for each query",
    "get query pid and camid",
    "remove gallery samples that have the same pid and camid with query",
    "compute cmc curve",
    "binary vector, positions with value 1 are correct matches",
    "this condition is true when query identity does not appear in gallery",
    "compute average precision",
    "reference: https://en.wikipedia.org/wiki/Evaluation_measures_(information_retrieval)#Average_precision",
    "tmp_cmc = [x / (i + 1.) for i, x in enumerate(tmp_cmc)]",
    "query",
    "gallery",
    "distmat = re_ranking(qf, gf, k1=20, k2=6, lambda_value=0.3)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "if feature vector is numpy, you should use 'torch.tensor' transform it to tensor",
    "print('using GPU to compute original distance')",
    "print('starting re_ranking')",
    "k-reciprocal neighbors",
    "More elegantly one can simply define:",
    "take care of difference between feature map space and original image space",
    "cos = torch.cdist",
    "TODO: maybe find a better spot for this.",
    "dev =  device if torch.cuda.is_available() else \"cpu\"",
    "train",
    "print (f'validation loss {val_loss/len(val_loader)}')",
    "normalize vectors here",
    "i th vector at j th kpt",
    "maybe needs to convert them to embeddings and position token",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "## dlcnet_ms5: backbone resnet50 + multi-fusion & multi-stage module",
    "## dlcr101_ms5/dlcr152_ms5: backbone resnet101/152 + multi-fusion & multi-stage module",
    "If the graph is unnecessarily large (with 15+ keypoints by default),",
    "we randomly prune it to a size guaranteeing an average node degree of 6;",
    "see Suppl. Fig S9c in Lauer et al., 2022.",
    "Use the skeleton defined in the config file",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Disable the prediction of PAFs if the graph is empty",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Search a pose_config.yaml file to parse missing information",
    "Clean the training-datasets folder prior to recreating the data pickles",
    "Load updated lists:",
    "Find the corresponding video file",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Determine the index length required to guarantee",
    "the train\u2013test ratio is exactly the desired one.",
    "Pad indices so lengths agree",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "DeprecationWarnings are silenced since Python 3.2 unless triggered in __main__",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "Also drop maDLC smart cropping augmentation parameters",
    "sort the model directories",
    "get the shuffle index and offset by 1.",
    "read cfg file",
    "create log file",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "allow_growth must be true here because tensorflow does not automatically free gpu memory and setting it as false occupies all gpu memory so that pytorch cannot kick in",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "should close tensorflow session here in order to free gpu",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "https://docs.opencv.org/2.4/modules/highgui/doc/reading_and_writing_images_and_video.html#videocapture-get",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: add cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Also ensure `boundingboxslack` is greater than zero, otherwise overlap",
    "between trackers cannot be evaluated, resulting in empty tracklets.",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: If dataname line above is changed then line below is obsolete?",
    "trackname = trackname.replace(videofolder, destfolder)",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/DeepLabCut/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "for multi animal, seems only this is used",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Get animal IDs and corresponding indices in the arrays of detections",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Only 1 animal, let us return the full graph indices only",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Covariance matrix estimation fails due to numerical singularities",
    "Distance is undefined if the assembly is empty",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Mark the unique body parts as assembled anyway so",
    "they are not used later on to fill assemblies.",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "Spawning (rather than forking) multiple processes does not",
    "work nicely with the GUI or interactive sessions.",
    "In that case, we fall back to the serial assembly.",
    "Swap corresponding keypoints",
    "Only consider assemblies of at least two keypoints",
    "Greedy assembly matching like in pycocotools",
    "Global rather than greedy assembly matching",
    "Cast columns of dtype 'object' to float to avoid TypeError",
    "further down in _parse_ground_truth_data.",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "Sort matching score (OKS) in descending order of assembly affinity",
    "Guarantee precision decreases monotonically",
    "See https://jonathan-hui.medium.com/map-mean-average-precision-for-object-detection-45c121a31173)",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "High uncertainty to the unobservable initial velocities",
    "Give high uncertainty to the unobservable initial velocities",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "filter out matched with low IOU",
    "TODO: get cropping parameters and utilize!",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "If a string was passed in, auto-convert to True for backward compatibility",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to initial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Ignore best edges possibly defined during a prior evaluation",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Pass the image and the keypoints through the resizer;",
    "this has no effect if no augmenters were added to it.",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Form 2D array of shape (n_rows, 4) where the last dimension",
    "is (sample_index, peak_y, peak_x, bpt_index) to slice the PAFs.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "Clip peak locations to PAFs dimensions",
    "unit_vecs = vecs / lengths[:, np.newaxis]",
    "affinities = np.squeeze(y @ np.expand_dims(unit_vecs, axis=2)).sum(axis=1)",
    "Form cost matrices",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Convert a frozen graph to OpenVINO IR format",
    "Read network into memory",
    "For better efficiency, model is initialized for batch_size 1 and every sample processed independently",
    "Load network to device",
    "Prepare input data",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "Multi stage is currently only implemented for resnets",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "FIXME Fix wrong scope with Keras layers",
    "def prediction_layer(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2DTranspose(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=2,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "## New DLCNet Addition: multi-stage decoder",
    "def prediction_layer_stage(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2D(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=1,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "turn into x times y time bs * bpts",
    "extract corresponding locref x and y as well as probability",
    "Filter predicted heatmaps with a 2D Gaussian kernel as in:",
    "https://openaccess.thecvf.com/content_CVPR_2020/papers/Huang_The_Devil_Is_in_the_Details_Delving_Into_Unbiased_Data_CVPR_2020_paper.pdf",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrunk when given a depth-multiplier < 1.0.",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Clamp to 40% of crop size to ensure that at least",
    "the center keypoint remains visible after the offset is applied.",
    "Points located close to one another are sampled preferentially",
    "in order to augment crowded regions.",
    "Include keypoints in the count to avoid null probabilities",
    "Shift the crop center in both dimensions by random amounts",
    "and normalize to the original image dimensions.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "Add smart, keypoint-aware image cropping",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "Discard keypoints whose coordinates lie outside the cropped image",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "Produce score maps and location refinement fields",
    "Find indices of individuals in joint_id",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "TODO Finish implementing actual abstract class",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "invisible joints are represented by nans",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Check the training image paths are correctly stored as arrays of strings",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one identical splits for 3 networks and 3 augmentations",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "Setting specific parameters for training",
    "MODELS = [\"dlcrnet_ms5\", \"dlcr101_ms5\", \"efficientnet-b0\", \"mobilenet_v2_0.35\"]",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "## adding it here",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Downloading the calibration images",
    "Deleting unnecessary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "test if existing models are found:",
    "Test if nonexisting models are not found",
    "Add some other office files:",
    "Add a .pickle and .h5 files",
    "By default, all videos with common extensions are taken from a directory",
    "A list of extensions can also be passed in",
    "Test bounding box from a single keypoint",
    "Test that shape was preserved after vectorization",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Guarantee that images smaller than crop size are handled fine",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Disable stochastic scale jitter",
    "Verify the aspect ratio is preserved",
    "Load sample multi animal data",
    "Generate a random permutation and reorder data. Ignore the unique bodypart",
    "Get inverse permutation and reorder the modified data to get back",
    "to the original",
    "Check",
    "Check data comprise path, shape, and xy coordinates",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "Test flipped keypoints",
    "Original (cached) coordinates must have remained empty",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID.",
    "Test empty assembly",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-"
  ],
  "v2.2.2": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "def install(package):",
    "subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", package])",
    "install(\"tensorflow==1.13.1\")",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Suppress tensorflow warning messages",
    "Train, evaluate & predict functions / all require TF",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "Read the config file",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Flatten the list of bodyparts to connect",
    "Format data",
    "Trick to force equal aspect ratio of 3D plots",
    "Set up the matplotlib figure beforehand",
    "Set up skeleton LineCollections",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "Get track_method and do related checks",
    "Get track method suffix",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "## Assign nan to [X,Y] of low likelihood predictions ###",
    "Convert the data to a np array to easily mask out the low likelihood predictions",
    "Assign [X,Y] = nan to low likelihood predictions",
    "Reshape data back to original shape",
    "put data back to the dataframes",
    "Check individuals are the same in both views",
    "Cross-view match individuals",
    "Create a dummy variables for single-animal",
    "Cleaner variable (since inds view1 == inds view2)",
    "Reshape: (num_framex, num_individuals, num_bodyparts , 2)",
    "Triangulate data",
    "i is individual in view 1",
    "voting[i] is the matched individual in view 2",
    "Create 3D DataFrame column and row indices",
    "Swap num_animals with num_frames axes to ensure well-behaving reshape",
    "Fill up 3D dataframe",
    "Reorder 2D dataframe in view 2 to match order of view 1",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "Store tracklets and corresponding negatives (those that overlap in time)",
    "TODO Avoid looping over all pairs of tracklets",
    "Pick the closest (spatially) overlapping tracklet",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Default to the distance cost function",
    "should only exist one",
    "Add in identity weighing before building the graph",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implementation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "more videos are in principle covered, as OpenCV is used and allows many formats.",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "This dictionary maps the model types to the file locations where the models exist.",
    "Exit the function early if an unknown modeltype is provided.",
    "Aliases for backwards-compatibility",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Initialize costs matrix",
    "get common bodypart detections in track pair",
    "add 3rd dim to the points",
    "cost for any point in time of t1 being the same",
    "any point in time of t2",
    "Get average cost of the entire track",
    "check if it exists:",
    "(average_degree / 2) as many edges as there are nodes is required",
    "for undirected graphs to reach the target degree.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (individual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "Keep only the individuals and bodyparts that were labeled",
    "Either display the animals defined in the config if they are found",
    "in the dataframe, or all the trajectories regardless of their names",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Make paths platform-agnostic if they are not already",
    "Ensure folder names are strings",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "make list of full paths",
    "filter list of videos",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "aliases for backwards-compatibility.",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingset = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingset_boxsizer = wx.StaticBoxSizer(trainingset, wx.VERTICAL)",
    "self.trainingset = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingset_boxsizer.Add(",
    "self.trainingset, 1, wx.EXPAND | wx.TOP | wx.BOTTOM, 10",
    ")",
    "hbox_.Add(trainingset_boxsizer, 5, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "Read the infer config file",
    "trainingsetindex = self.trainingset.GetValue()",
    "let the user open the file with default text editor. Also make it mac compatible",
    "trainingsetindex = self.trainingset.GetValue()",
    "trainingsetindex=trainingsetindex,",
    "trainingsetindex=self.trainingset.GetValue(),",
    "self.save.Enable(False)",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "topSplitter = wx.SplitterWindow(self)",
    "",
    "self.image_panel = ImagePanel(topSplitter, config,video,shuffle,Dataframe,self.gui_size)",
    "self.widget_panel = WidgetPanel(topSplitter)",
    "",
    "topSplitter.SplitHorizontally(self.image_panel, self.widget_panel,sashPosition=self.gui_size[1]*0.83)#0.9",
    "topSplitter.SetSashGravity(1)",
    "sizer = wx.BoxSizer(wx.VERTICAL)",
    "sizer.Add(topSplitter, 1, wx.EXPAND)",
    "self.SetSizer(sizer)",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "Read config file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0,10), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=10)",
    "Add all the options",
    "line = wx.StaticLine(self)",
    "self.sizer.Add(line, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=10)",
    "",
    "self.multi_choice.Bind(wx.EVT_CHECKBOX,self.activate_copy_videos)",
    "Hide the button as this is not the default option",
    "self.vids.Enable(False)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "page10 = Refine_labels(self.parent, self.gui_size, self.cfg, page5)",
    "self.parent.AddPage(page10, \"OPT: Refine Labels\")",
    "self.yes.Enable(False)",
    "self.no.Enable(False)",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.buttonCounter = []",
    "self.bodyparts = []",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "convert the image to RGB as you are showing the image with matplotlib",
    "draw epipolar lines",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.filelist = self.filelist + self.vids",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "## train and go ###",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "convert the image to RGB as you are showing the image with matplotlib",
    "draw epipolar lines",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "checks for unique bodyparts",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Cache original bodyparts",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Rearrange bodypart columns in config order",
    "Test whether there are missing frames and superfluous data",
    "Check whether new individuals or body parts were added",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is selected when radio buttons are changed",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Discard data associated with bodyparts that are no longer in the config",
    "Re-organize the dataframe so the CSV looks consistent with the config",
    "restore the background region",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.build = wx.Button(self, label=\"Build skeleton\")",
    "sizer.Add(self.build, pos=(4, 3), flag=wx.BOTTOM | wx.RIGHT, border=10)",
    "self.build.Bind(wx.EVT_BUTTON, self.build_skeleton)",
    "self.build.Enable(True)",
    "def build_skeleton(self, event):",
    "skeleton.SkeletonBuilder(self.config)",
    "Setting the GUI size and panels design",
    "This sets the minimum size of the GUI. It can scale now!",
    "Checks if zoom/pan button is ON",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingindex = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingindex_boxsizer = wx.StaticBoxSizer(trainingindex, wx.VERTICAL)",
    "self.trainingindex = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingindex_boxsizer.Add(",
    "self.trainingindex, 1, wx.EXPAND | wx.TOP | wx.BOTTOM, 10)",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "hbox1.Add(trainingindex_boxsizer, 10, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "self.trainingindex.Enable(False)",
    "self.trainingindex.Enable(True)",
    "self.trainingindex.Enable(True)",
    "Read the pose config file",
    "print(trainFraction[-1])",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.get_model_folder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "self.trainingindex.Enable(True)",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "### BOX 1 ####",
    "### BOX 2 ####",
    "### BOX 3 ####",
    "Trigger chooseOption as if the radio button had been clicked",
    "Read the infer config file",
    "trainFraction = cfg[\"TrainingFraction\"][trainingsetindex]",
    "let the user open the file with default text editor. Also make it mac compatible",
    "self.select_destfolder.SetPath(\"None\")",
    "self.config = []",
    "self.sel_config.SetPath(\"\")",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingindex_box = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingindex_boxsizer = wx.StaticBoxSizer(trainingindex_box, wx.VERTICAL)",
    "self.trainingindex = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingindex_boxsizer.Add(",
    "self.trainingindex, 0, wx.EXPAND | wx.TOP | wx.BOTTOM, 10",
    ")",
    "self.hbox2.Add(trainingindex_boxsizer, 10, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "trainindex = self.trainingindex.GetValue()",
    "trainindex=trainindex,",
    "self.shuffles.SetValue(\"1\")",
    "DownSampleVideo(vname,width=-1,height=200,outsuffix='downsampled',outpath=None,rotatecw=False):",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "majorDimension=0,",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "Overwrite the config-defined individual names",
    "with those actually present in the annotated data",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingset = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingset_boxsizer = wx.StaticBoxSizer(trainingset, wx.VERTICAL)",
    "self.trainingset = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingset_boxsizer.Add(",
    "self.trainingset, 1, wx.EXPAND | wx.TOP | wx.BOTTOM, 10",
    ")",
    "self.hbox1.Add(trainingset_boxsizer, 5, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "if self.plot_scoremaps.GetStringSelection() == \"Yes\":",
    "Read the infer config file",
    "trainingsetindex = self.trainingset.GetValue()",
    "let the user open the file with default text editor. Also make it mac compatible",
    "shuffle = self.shuffle.GetValue()",
    "trainingsetindex = self.trainingset.GetValue()",
    "trainingsetindex=trainingsetindex,",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "## LABELING ###",
    "self.sel_config.SetPath(\"\")",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "self.cfg = auxiliaryfunctions.read_config(config)",
    "self.statusbar.SetStatusText(\"\")",
    "dlg = wx.MessageDialog(None,\"Are you sure?\", \"Quit!\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_YES:",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0, 4), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=5)",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "calling create_tracking_dataset, train_tracking_transformer, stitch_tracklets",
    "only try to find these features if they are in the dictionary",
    "1) reference to video folder and get the proper bpt_feature file for feature table",
    "2) get either the path to gt or the path to track pickle",
    "tracklets",
    "with npy list form videos, split each to train and test",
    "video_name = '.'.join(video.split(\"/\")[-1].split(\".\")[:-1])",
    "assuming there is only one match",
    "make my own model factory",
    "make my own loss factory",
    "NOTE scale factor was wrong in my original version, can set manually to be compat with prev weights",
    "NOTE: drop path for stochastic depth, we shall see if this is better than dropout here",
    "only channel pooling",
    "x -> (B, 12, 2048)",
    "x -> (B, 12, 768)",
    "trying to keep everything simple",
    "need to write my own keypoint embedding",
    "we don't need a fc layer here",
    "x: inputs",
    "(B, 12, 768)",
    "added pos embed",
    "remove all parts I don't understand",
    "forwarding through blocks. But num of blocks should be reduced",
    "i can't really tell what the difference is",
    "will have to change some of these",
    "For old models that I trained prior to conv based patchification",
    "To resize pos embedding when using model at different size from pretrained weights",
    "Rescale the grid of position embeddings when loading from state_dict. Adapted from",
    "https://github.com/google-research/vision_transformer/blob/00883dd691c63a6830751563748663526e811cee/vit_jax/checkpoint.py#L224",
    "Cut & paste from PyTorch official master until it's in a few official releases - RW",
    "Method based on https://people.sc.fsu.edu/~jburkardt/presentations/truncated_normal.pdf",
    "Computes standard normal cumulative distribution function",
    "Values are generated by using a truncated uniform distribution and",
    "then using the inverse CDF for the normal distribution.",
    "Get upper and lower cdf values",
    "Uniformly fill tensor with values from [l, u], then translate to",
    "[2l-1, 2u-1].",
    "Use inverse cdf transform for normal distribution to get truncated",
    "standard normal",
    "Transform to proper mean, std",
    "Clamp to ensure it's in the proper range",
    "type: (Tensor, float, float, float, float) -> Tensor",
    "resample if noise out of percent limit, brute force but shouldn't spin much",
    "distmat g",
    "q    1 3 2 4",
    "4 1 2 3",
    "0 2 1 3",
    "1 2 3 0",
    "compute cmc curve for each query",
    "get query pid and camid",
    "remove gallery samples that have the same pid and camid with query",
    "compute cmc curve",
    "binary vector, positions with value 1 are correct matches",
    "this condition is true when query identity does not appear in gallery",
    "compute average precision",
    "reference: https://en.wikipedia.org/wiki/Evaluation_measures_(information_retrieval)#Average_precision",
    "tmp_cmc = [x / (i + 1.) for i, x in enumerate(tmp_cmc)]",
    "query",
    "gallery",
    "distmat = re_ranking(qf, gf, k1=20, k2=6, lambda_value=0.3)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "if feature vector is numpy, you should use 'torch.tensor' transform it to tensor",
    "print('using GPU to compute original distance')",
    "print('starting re_ranking')",
    "k-reciprocal neighbors",
    "More elegantly one can simply define:",
    "take care of difference between feature map space and original image space",
    "cos = torch.cdist",
    "TODO: maybe find a better spot for this.",
    "dev =  device if torch.cuda.is_available() else \"cpu\"",
    "train",
    "print (f'validation loss {val_loss/len(val_loader)}')",
    "normalize vectors here",
    "i th vector at j th kpt",
    "maybe needs to convert them to embeddings and position token",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "## dlcnet_ms5: backbone resnet50 + multi-fusion & multi-stage module",
    "## dlcr101_ms5/dlcr152_ms5: backbone resnet101/152 + multi-fusion & multi-stage module",
    "If the graph is unnecessarily large (with 15+ keypoints by default),",
    "we randomly prune it to a size guaranteeing an average node degree of 6;",
    "see Suppl. Fig S9c in Lauer et al., 2022.",
    "Use the skeleton defined in the config file",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Disable the prediction of PAFs if the graph is empty",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Search a pose_config.yaml file to parse missing information",
    "Clean the training-datasets folder prior to recreating the data pickles",
    "Load updated lists:",
    "Find the corresponding video file",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Determine the index length required to guarantee",
    "the train\u2013test ratio is exactly the desired one.",
    "Pad indices so lengths agree",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "DeprecationWarnings are silenced since Python 3.2 unless triggered in __main__",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "Also drop maDLC smart cropping augmentation parameters",
    "sort the model directories",
    "get the shuffle index and offset by 1.",
    "read cfg file",
    "create log file",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "allow_growth must be true here because tensorflow does not automatically free gpu memory and setting it as false occupies all gpu memory so that pytorch cannot kick in",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "should close tensorflow session here in order to free gpu",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "https://docs.opencv.org/2.4/modules/highgui/doc/reading_and_writing_images_and_video.html#videocapture-get",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: add cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Also ensure `boundingboxslack` is greater than zero, otherwise overlap",
    "between trackers cannot be evaluated, resulting in empty tracklets.",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: If dataname line above is changed then line below is obsolete?",
    "trackname = trackname.replace(videofolder, destfolder)",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/DeepLabCut/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "for multi animal, seems only this is used",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Get animal IDs and corresponding indices in the arrays of detections",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Only 1 animal, let us return the full graph indices only",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Covariance matrix estimation fails due to numerical singularities",
    "Distance is undefined if the assembly is empty",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Mark the unique body parts as assembled anyway so",
    "they are not used later on to fill assemblies.",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "Spawning (rather than forking) multiple processes does not",
    "work nicely with the GUI or interactive sessions.",
    "In that case, we fall back to the serial assembly.",
    "Swap corresponding keypoints",
    "Only consider assemblies of at least two keypoints",
    "Greedy assembly matching like in pycocotools",
    "Global rather than greedy assembly matching",
    "Cast columns of dtype 'object' to float to avoid TypeError",
    "further down in _parse_ground_truth_data.",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "Sort matching score (OKS) in descending order of assembly affinity",
    "Guarantee precision decreases monotonically",
    "See https://jonathan-hui.medium.com/map-mean-average-precision-for-object-detection-45c121a31173)",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "High uncertainty to the unobservable initial velocities",
    "Give high uncertainty to the unobservable initial velocities",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "filter out matched with low IOU",
    "TODO: get cropping parameters and utilize!",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "If a string was passed in, auto-convert to True for backward compatibility",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to initial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Ignore best edges possibly defined during a prior evaluation",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Pass the image and the keypoints through the resizer;",
    "this has no effect if no augmenters were added to it.",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Form 2D array of shape (n_rows, 4) where the last dimension",
    "is (sample_index, peak_y, peak_x, bpt_index) to slice the PAFs.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "Clip peak locations to PAFs dimensions",
    "unit_vecs = vecs / lengths[:, np.newaxis]",
    "affinities = np.squeeze(y @ np.expand_dims(unit_vecs, axis=2)).sum(axis=1)",
    "Form cost matrices",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Convert a frozen graph to OpenVINO IR format",
    "Read network into memory",
    "For better efficiency, model is initialized for batch_size 1 and every sample processed independently",
    "Load network to device",
    "Prepare input data",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "Multi stage is currently only implemented for resnets",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "FIXME Fix wrong scope with Keras layers",
    "def prediction_layer(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2DTranspose(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=2,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "## New DLCNet Addition: multi-stage decoder",
    "def prediction_layer_stage(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2D(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=1,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "turn into x times y time bs * bpts",
    "extract corresponding locref x and y as well as probability",
    "Filter predicted heatmaps with a 2D Gaussian kernel as in:",
    "https://openaccess.thecvf.com/content_CVPR_2020/papers/Huang_The_Devil_Is_in_the_Details_Delving_Into_Unbiased_Data_CVPR_2020_paper.pdf",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrunk when given a depth-multiplier < 1.0.",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Clamp to 40% of crop size to ensure that at least",
    "the center keypoint remains visible after the offset is applied.",
    "Points located close to one another are sampled preferentially",
    "in order to augment crowded regions.",
    "Include keypoints in the count to avoid null probabilities",
    "Shift the crop center in both dimensions by random amounts",
    "and normalize to the original image dimensions.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "Add smart, keypoint-aware image cropping",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "Discard keypoints whose coordinates lie outside the cropped image",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "Produce score maps and location refinement fields",
    "Find indices of individuals in joint_id",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "TODO Finish implementing actual abstract class",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Check the training image paths are correctly stored as arrays of strings",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one identical splits for 3 networks and 3 augmentations",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "Setting specific parameters for training",
    "MODELS = [\"dlcrnet_ms5\", \"dlcr101_ms5\", \"efficientnet-b0\", \"mobilenet_v2_0.35\"]",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "## adding it here",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Downloading the calibration images",
    "Deleting unnecessary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "test if existing models are found:",
    "Test if nonexisting models are not found",
    "Add some other office files:",
    "Add a .pickle and .h5 files",
    "By default, all videos with common extensions are taken from a directory",
    "A list of extensions can also be passed in",
    "Test bounding box from a single keypoint",
    "Test that shape was preserved after vectorization",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Guarantee that images smaller than crop size are handled fine",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Disable stochastic scale jitter",
    "Verify the aspect ratio is preserved",
    "Load sample multi animal data",
    "Generate a random permutation and reorder data. Ignore the unique bodypart",
    "Get inverse permutation and reorder the modified data to get back",
    "to the original",
    "Check",
    "Check data comprise path, shape, and xy coordinates",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "Test flipped keypoints",
    "Original (cached) coordinates must have remained empty",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID.",
    "Test empty assembly",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-"
  ],
  "v2.2.1.1": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "def install(package):",
    "subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", package])",
    "install(\"tensorflow==1.13.1\")",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Suppress tensorflow warning messages",
    "Train, evaluate & predict functions / all require TF",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "Read the config file",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Flatten the list of bodyparts to connect",
    "Format data",
    "Trick to force equal aspect ratio of 3D plots",
    "Set up the matplotlib figure beforehand",
    "Set up skeleton LineCollections",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "Get track_method and do related checks",
    "Get track method suffix",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "## Assign nan to [X,Y] of low likelihood predictions ###",
    "Convert the data to a np array to easily mask out the low likelihood predictions",
    "Assign [X,Y] = nan to low likelihood predictions",
    "Reshape data back to original shape",
    "put data back to the dataframes",
    "Check individuals are the same in both views",
    "Cross-view match individuals",
    "Create a dummy variables for single-animal",
    "Cleaner variable (since inds view1 == inds view2)",
    "Reshape: (num_framex, num_individuals, num_bodyparts , 2)",
    "Triangulate data",
    "i is individual in view 1",
    "voting[i] is the matched individual in view 2",
    "Create 3D DataFrame column and row indices",
    "Swap num_animals with num_frames axes to ensure well-behaving reshape",
    "Fill up 3D dataframe",
    "Reorder 2D dataframe in view 2 to match order of view 1",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "Store tracklets and corresponding negatives (those that overlap in time)",
    "TODO Avoid looping over all pairs of tracklets",
    "Pick the closest (spatially) overlapping tracklet",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Default to the distance cost function",
    "should only exist one",
    "Add in identity weighing before building the graph",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implementation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "more videos are in principle covered, as OpenCV is used and allows many formats.",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "This dictionary maps the model types to the file locations where the models exist.",
    "Exit the function early if an unknown modeltype is provided.",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Initialize costs matrix",
    "get common bodypart detections in track pair",
    "add 3rd dim to the points",
    "cost for any point in time of t1 being the same",
    "any point in time of t2",
    "Get average cost of the entire track",
    "check if it exists:",
    "(average_degree / 2) as many edges as there are nodes is required",
    "for undirected graphs to reach the target degree.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (individual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "Keep only the individuals and bodyparts that were labeled",
    "Either display the animals defined in the config if they are found",
    "in the dataframe, or all the trajectories regardless of their names",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Make paths platform-agnostic if they are not already",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "make list of full paths",
    "filter list of videos",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingset = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingset_boxsizer = wx.StaticBoxSizer(trainingset, wx.VERTICAL)",
    "self.trainingset = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingset_boxsizer.Add(",
    "self.trainingset, 1, wx.EXPAND | wx.TOP | wx.BOTTOM, 10",
    ")",
    "hbox_.Add(trainingset_boxsizer, 5, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "Read the infer config file",
    "trainingsetindex = self.trainingset.GetValue()",
    "let the user open the file with default text editor. Also make it mac compatible",
    "trainingsetindex = self.trainingset.GetValue()",
    "trainingsetindex=trainingsetindex,",
    "trainingsetindex=self.trainingset.GetValue(),",
    "self.save.Enable(False)",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "topSplitter = wx.SplitterWindow(self)",
    "",
    "self.image_panel = ImagePanel(topSplitter, config,video,shuffle,Dataframe,self.gui_size)",
    "self.widget_panel = WidgetPanel(topSplitter)",
    "",
    "topSplitter.SplitHorizontally(self.image_panel, self.widget_panel,sashPosition=self.gui_size[1]*0.83)#0.9",
    "topSplitter.SetSashGravity(1)",
    "sizer = wx.BoxSizer(wx.VERTICAL)",
    "sizer.Add(topSplitter, 1, wx.EXPAND)",
    "self.SetSizer(sizer)",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0,10), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=10)",
    "Add all the options",
    "line = wx.StaticLine(self)",
    "self.sizer.Add(line, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=10)",
    "",
    "self.multi_choice.Bind(wx.EVT_CHECKBOX,self.activate_copy_videos)",
    "Hide the button as this is not the default option",
    "self.vids.Enable(False)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "page10 = Refine_labels(self.parent, self.gui_size, self.cfg, page5)",
    "self.parent.AddPage(page10, \"OPT: Refine Labels\")",
    "self.yes.Enable(False)",
    "self.no.Enable(False)",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.buttonCounter = []",
    "self.bodyparts = []",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "convert the image to RGB as you are showing the image with matplotlib",
    "draw epipolar lines",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.filelist = self.filelist + self.vids",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "## train and go ###",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "convert the image to RGB as you are showing the image with matplotlib",
    "draw epipolar lines",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "checks for unique bodyparts",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Cache original bodyparts",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Rearrange bodypart columns in config order",
    "Test whether there are missing frames and superfluous data",
    "Check whether new individuals or body parts were added",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is selected when radio buttons are changed",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Discard data associated with bodyparts that are no longer in the config",
    "Re-organize the dataframe so the CSV looks consistent with the config",
    "restore the background region",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.build = wx.Button(self, label=\"Build skeleton\")",
    "sizer.Add(self.build, pos=(4, 3), flag=wx.BOTTOM | wx.RIGHT, border=10)",
    "self.build.Bind(wx.EVT_BUTTON, self.build_skeleton)",
    "self.build.Enable(True)",
    "def build_skeleton(self, event):",
    "skeleton.SkeletonBuilder(self.config)",
    "Setting the GUI size and panels design",
    "This sets the minimum size of the GUI. It can scale now!",
    "Checks if zoom/pan button is ON",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingindex = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingindex_boxsizer = wx.StaticBoxSizer(trainingindex, wx.VERTICAL)",
    "self.trainingindex = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingindex_boxsizer.Add(",
    "self.trainingindex, 1, wx.EXPAND | wx.TOP | wx.BOTTOM, 10)",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "hbox1.Add(trainingindex_boxsizer, 10, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "self.trainingindex.Enable(False)",
    "self.trainingindex.Enable(True)",
    "self.trainingindex.Enable(True)",
    "Read the pose config file",
    "print(trainFraction[-1])",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.get_model_folder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "self.trainingindex.Enable(True)",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "### BOX 1 ####",
    "### BOX 2 ####",
    "### BOX 3 ####",
    "Read the infer config file",
    "trainFraction = cfg[\"TrainingFraction\"][trainingsetindex]",
    "let the user open the file with default text editor. Also make it mac compatible",
    "self.select_destfolder.SetPath(\"None\")",
    "self.config = []",
    "self.sel_config.SetPath(\"\")",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingindex_box = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingindex_boxsizer = wx.StaticBoxSizer(trainingindex_box, wx.VERTICAL)",
    "self.trainingindex = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingindex_boxsizer.Add(",
    "self.trainingindex, 0, wx.EXPAND | wx.TOP | wx.BOTTOM, 10",
    ")",
    "self.hbox2.Add(trainingindex_boxsizer, 10, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "trainindex = self.trainingindex.GetValue()",
    "trainindex=trainindex,",
    "self.shuffles.SetValue(\"1\")",
    "DownSampleVideo(vname,width=-1,height=200,outsuffix='downsampled',outpath=None,rotatecw=False):",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "majorDimension=0,",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "Overwrite the config-defined individual names",
    "with those actually present in the annotated data",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingset = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingset_boxsizer = wx.StaticBoxSizer(trainingset, wx.VERTICAL)",
    "self.trainingset = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingset_boxsizer.Add(",
    "self.trainingset, 1, wx.EXPAND | wx.TOP | wx.BOTTOM, 10",
    ")",
    "self.hbox1.Add(trainingset_boxsizer, 5, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "if self.plot_scoremaps.GetStringSelection() == \"Yes\":",
    "Read the infer config file",
    "trainingsetindex = self.trainingset.GetValue()",
    "let the user open the file with default text editor. Also make it mac compatible",
    "shuffle = self.shuffle.GetValue()",
    "trainingsetindex = self.trainingset.GetValue()",
    "trainingsetindex=trainingsetindex,",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "## LABELING ###",
    "self.sel_config.SetPath(\"\")",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "self.cfg = auxiliaryfunctions.read_config(config)",
    "self.statusbar.SetStatusText(\"\")",
    "dlg = wx.MessageDialog(None,\"Are you sure?\", \"Quit!\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_YES:",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0, 4), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=5)",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "calling create_tracking_dataset, train_tracking_transformer, stitch_tracklets",
    "only try to find these features if they are in the dictionary",
    "1) reference to video folder and get the proper bpt_feature file for feature table",
    "2) get either the path to gt or the path to track pickle",
    "tracklets",
    "with npy list form videos, split each to train and test",
    "video_name = '.'.join(video.split(\"/\")[-1].split(\".\")[:-1])",
    "assuming there is only one match",
    "make my own model factory",
    "make my own loss factory",
    "NOTE scale factor was wrong in my original version, can set manually to be compat with prev weights",
    "NOTE: drop path for stochastic depth, we shall see if this is better than dropout here",
    "only channel pooling",
    "x -> (B, 12, 2048)",
    "x -> (B, 12, 768)",
    "trying to keep everything simple",
    "need to write my own keypoint embedding",
    "we don't need a fc layer here",
    "x: inputs",
    "(B, 12, 768)",
    "added pos embed",
    "remove all parts I don't understand",
    "forwarding through blocks. But num of blocks should be reduced",
    "i can't really tell what the difference is",
    "will have to change some of these",
    "For old models that I trained prior to conv based patchification",
    "To resize pos embedding when using model at different size from pretrained weights",
    "Rescale the grid of position embeddings when loading from state_dict. Adapted from",
    "https://github.com/google-research/vision_transformer/blob/00883dd691c63a6830751563748663526e811cee/vit_jax/checkpoint.py#L224",
    "Cut & paste from PyTorch official master until it's in a few official releases - RW",
    "Method based on https://people.sc.fsu.edu/~jburkardt/presentations/truncated_normal.pdf",
    "Computes standard normal cumulative distribution function",
    "Values are generated by using a truncated uniform distribution and",
    "then using the inverse CDF for the normal distribution.",
    "Get upper and lower cdf values",
    "Uniformly fill tensor with values from [l, u], then translate to",
    "[2l-1, 2u-1].",
    "Use inverse cdf transform for normal distribution to get truncated",
    "standard normal",
    "Transform to proper mean, std",
    "Clamp to ensure it's in the proper range",
    "type: (Tensor, float, float, float, float) -> Tensor",
    "resample if noise out of percent limit, brute force but shouldn't spin much",
    "distmat g",
    "q    1 3 2 4",
    "4 1 2 3",
    "0 2 1 3",
    "1 2 3 0",
    "compute cmc curve for each query",
    "get query pid and camid",
    "remove gallery samples that have the same pid and camid with query",
    "compute cmc curve",
    "binary vector, positions with value 1 are correct matches",
    "this condition is true when query identity does not appear in gallery",
    "compute average precision",
    "reference: https://en.wikipedia.org/wiki/Evaluation_measures_(information_retrieval)#Average_precision",
    "tmp_cmc = [x / (i + 1.) for i, x in enumerate(tmp_cmc)]",
    "query",
    "gallery",
    "distmat = re_ranking(qf, gf, k1=20, k2=6, lambda_value=0.3)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "if feature vector is numpy, you should use 'torch.tensor' transform it to tensor",
    "print('using GPU to compute original distance')",
    "print('starting re_ranking')",
    "k-reciprocal neighbors",
    "More elegantly one can simply define:",
    "take care of difference between feature map space and original image space",
    "cos = torch.cdist",
    "TODO: maybe find a better spot for this.",
    "dev =  device if torch.cuda.is_available() else \"cpu\"",
    "train",
    "print (f'validation loss {val_loss/len(val_loader)}')",
    "normalize vectors here",
    "i th vector at j th kpt",
    "maybe needs to convert them to embeddings and position token",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "## dlcnet_ms5: backbone resnet50 + multi-fusion & multi-stage module",
    "## dlcr101_ms5/dlcr152_ms5: backbone resnet101/152 + multi-fusion & multi-stage module",
    "If the graph is unnecessarily large (with 15+ keypoints by default),",
    "we randomly prune it to a size guaranteeing an average node degree of 6;",
    "see Suppl. Fig S9c in Lauer et al., 2022.",
    "Use the skeleton defined in the config file",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Disable the prediction of PAFs if the graph is empty",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Search a pose_config.yaml file to parse missing information",
    "Clean the training-datasets folder prior to recreating the data pickles",
    "Load updated lists:",
    "Find the corresponding video file",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Determine the index length required to guarantee",
    "the train\u2013test ratio is exactly the desired one.",
    "Pad indices so lengths agree",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "DeprecationWarnings are silenced since Python 3.2 unless triggered in __main__",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "Also drop maDLC smart cropping augmentation parameters",
    "sort the model directories",
    "get the shuffle index and offset by 1.",
    "read cfg file",
    "create log file",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "allow_growth must be true here because tensorflow does not automatically free gpu memory and setting it as false occupies all gpu memory so that pytorch cannot kick in",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "should close tensorflow session here in order to free gpu",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "https://docs.opencv.org/2.4/modules/highgui/doc/reading_and_writing_images_and_video.html#videocapture-get",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: add cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Also ensure `boundingboxslack` is greater than zero, otherwise overlap",
    "between trackers cannot be evaluated, resulting in empty tracklets.",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: If dataname line above is changed then line below is obsolete?",
    "trackname = trackname.replace(videofolder, destfolder)",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/DeepLabCut/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "for multi animal, seems only this is used",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Get animal IDs and corresponding indices in the arrays of detections",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Only 1 animal, let us return the full graph indices only",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Covariance matrix estimation fails due to numerical singularities",
    "Distance is undefined if the assembly is empty",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Mark the unique body parts as assembled anyway so",
    "they are not used later on to fill assemblies.",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "Spawning (rather than forking) multiple processes does not",
    "work nicely with the GUI or interactive sessions.",
    "In that case, we fall back to the serial assembly.",
    "Swap corresponding keypoints",
    "Only consider assemblies of at least two keypoints",
    "Greedy assembly matching like in pycocotools",
    "Global rather than greedy assembly matching",
    "Cast columns of dtype 'object' to float to avoid TypeError",
    "further down in _parse_ground_truth_data.",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "Sort matching score (OKS) in descending order of assembly affinity",
    "Guarantee precision decreases monotonically",
    "See https://jonathan-hui.medium.com/map-mean-average-precision-for-object-detection-45c121a31173)",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "High uncertainty to the unobservable initial velocities",
    "Give high uncertainty to the unobservable initial velocities",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "filter out matched with low IOU",
    "TODO: get cropping parameters and utilize!",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "If a string was passed in, auto-convert to True for backward compatibility",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to initial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Ignore best edges possibly defined during a prior evaluation",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Pass the image and the keypoints through the resizer;",
    "this has no effect if no augmenters were added to it.",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Form 2D array of shape (n_rows, 4) where the last dimension",
    "is (sample_index, peak_y, peak_x, bpt_index) to slice the PAFs.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "Clip peak locations to PAFs dimensions",
    "unit_vecs = vecs / lengths[:, np.newaxis]",
    "affinities = np.squeeze(y @ np.expand_dims(unit_vecs, axis=2)).sum(axis=1)",
    "Form cost matrices",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Convert a frozen graph to OpenVINO IR format",
    "Read network into memory",
    "For better efficiency, model is initialized for batch_size 1 and every sample processed independently",
    "Load network to device",
    "Prepare input data",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "Multi stage is currently only implemented for resnets",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "FIXME Fix wrong scope with Keras layers",
    "def prediction_layer(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2DTranspose(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=2,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "## New DLCNet Addition: multi-stage decoder",
    "def prediction_layer_stage(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2D(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=1,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "turn into x times y time bs * bpts",
    "extract corresponding locref x and y as well as probability",
    "Filter predicted heatmaps with a 2D Gaussian kernel as in:",
    "https://openaccess.thecvf.com/content_CVPR_2020/papers/Huang_The_Devil_Is_in_the_Details_Delving_Into_Unbiased_Data_CVPR_2020_paper.pdf",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrunk when given a depth-multiplier < 1.0.",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Clamp to 40% of crop size to ensure that at least",
    "the center keypoint remains visible after the offset is applied.",
    "Points located close to one another are sampled preferentially",
    "in order to augment crowded regions.",
    "Include keypoints in the count to avoid null probabilities",
    "Shift the crop center in both dimensions by random amounts",
    "and normalize to the original image dimensions.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "Add smart, keypoint-aware image cropping",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "Discard keypoints whose coordinates lie outside the cropped image",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "imageio.imwrite(data_items[i].im_path.split('/')[-1],im)",
    "Produce score maps and location refinement fields",
    "Find indices of individuals in joint_id",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "TODO Finish implementing actual abstract class",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Check the training image paths are correctly stored as arrays of strings",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one identical splits for 3 networks and 3 augmentations",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "Setting specific parameters for training",
    "MODELS = [\"dlcrnet_ms5\", \"dlcr101_ms5\", \"efficientnet-b0\", \"mobilenet_v2_0.35\"]",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "## adding it here",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Downloading the calibration images",
    "Deleting unnecessary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "test if existing models are found:",
    "Test if nonexisting models are not found",
    "Add some other office files:",
    "Add a .pickle and .h5 files",
    "By default, all videos with common extensions are taken from a directory",
    "A list of extensions can also be passed in",
    "Test bounding box from a single keypoint",
    "Test that shape was preserved after vectorization",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Guarantee that images smaller than crop size are handled fine",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Disable stochastic scale jitter",
    "Verify the aspect ratio is preserved",
    "Load sample multi animal data",
    "Generate a random permutation and reorder data. Ignore the unique bodypart",
    "Get inverse permutation and reorder the modified data to get back",
    "to the original",
    "Check",
    "Check data comprise path, shape, and xy coordinates",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "Test flipped keypoints",
    "Original (cached) coordinates must have remained empty",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID.",
    "Test empty assembly",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-"
  ],
  "v2.2.1": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "def install(package):",
    "subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", package])",
    "install(\"tensorflow==1.13.1\")",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Suppress tensorflow warning messages",
    "Train, evaluate & predict functions / all require TF",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Flatten the list of bodyparts to connect",
    "Format data",
    "Trick to force equal aspect ratio of 3D plots",
    "Set up the matplotlib figure beforehand",
    "Set up skeleton LineCollections",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "Get track_method and do related checks",
    "Get track method suffix",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "## Assign nan to [X,Y] of low likelihood predictions ###",
    "Convert the data to a np array to easily mask out the low likelihood predictions",
    "Assign [X,Y] = nan to low likelihood predictions",
    "Reshape data back to original shape",
    "put data back to the dataframes",
    "Check individuals are the same in both views",
    "Cross-view match individuals",
    "Create a dummy variables for single-animal",
    "Cleaner variable (since inds view1 == inds view2)",
    "Reshape: (num_framex, num_individuals, num_bodyparts , 2)",
    "Triangulate data",
    "i is individual in view 1",
    "voting[i] is the matched individual in view 2",
    "Create 3D DataFrame column and row indices",
    "Swap num_animals with num_frames axes to ensure well-behaving reshape",
    "Fill up 3D dataframe",
    "Reorder 2D dataframe in view 2 to match order of view 1",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "Store tracklets and corresponding negatives (those that overlap in time)",
    "TODO Avoid looping over all pairs of tracklets",
    "Pick the closest (spatially) overlapping tracklet",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Default to the distance cost function",
    "should only exist one",
    "Add in identity weighing before building the graph",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implementation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "more videos are in principle covered, as OpenCV is used and allows many formats.",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Initialize costs matrix",
    "get common bodypart detections in track pair",
    "add 3rd dim to the points",
    "cost for any point in time of t1 being the same",
    "any point in time of t2",
    "Get average cost of the entire track",
    "check if it exists:",
    "(average_degree / 2) as many edges as there are nodes is required",
    "for undirected graphs to reach the target degree.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (individual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "Keep only the individuals and bodyparts that were labeled",
    "Either display the animals defined in the config if they are found",
    "in the dataframe, or all the trajectories regardless of their names",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Make paths platform-agnostic if they are not already",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Fraction of video to start/stop when extracting frames for labeling/refinement",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "make list of full paths",
    "filter list of videos",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingset = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingset_boxsizer = wx.StaticBoxSizer(trainingset, wx.VERTICAL)",
    "self.trainingset = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingset_boxsizer.Add(",
    "self.trainingset, 1, wx.EXPAND | wx.TOP | wx.BOTTOM, 10",
    ")",
    "hbox_.Add(trainingset_boxsizer, 5, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "Read the infer config file",
    "trainingsetindex = self.trainingset.GetValue()",
    "let the user open the file with default text editor. Also make it mac compatible",
    "trainingsetindex = self.trainingset.GetValue()",
    "trainingsetindex=trainingsetindex,",
    "trainingsetindex=self.trainingset.GetValue(),",
    "self.save.Enable(False)",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "topSplitter = wx.SplitterWindow(self)",
    "",
    "self.image_panel = ImagePanel(topSplitter, config,video,shuffle,Dataframe,self.gui_size)",
    "self.widget_panel = WidgetPanel(topSplitter)",
    "",
    "topSplitter.SplitHorizontally(self.image_panel, self.widget_panel,sashPosition=self.gui_size[1]*0.83)#0.9",
    "topSplitter.SetSashGravity(1)",
    "sizer = wx.BoxSizer(wx.VERTICAL)",
    "sizer.Add(topSplitter, 1, wx.EXPAND)",
    "self.SetSizer(sizer)",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0,10), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=10)",
    "Add all the options",
    "line = wx.StaticLine(self)",
    "self.sizer.Add(line, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=10)",
    "",
    "self.multi_choice.Bind(wx.EVT_CHECKBOX,self.activate_copy_videos)",
    "Hide the button as this is not the default option",
    "self.vids.Enable(False)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "page10 = Refine_labels(self.parent, self.gui_size, self.cfg, page5)",
    "self.parent.AddPage(page10, \"OPT: Refine Labels\")",
    "self.yes.Enable(False)",
    "self.no.Enable(False)",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.buttonCounter = []",
    "self.bodyparts = []",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "convert the image to RGB as you are showing the image with matplotlib",
    "draw epipolar lines",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.filelist = self.filelist + self.vids",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "## train and go ###",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "convert the image to RGB as you are showing the image with matplotlib",
    "draw epipolar lines",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "checks for unique bodyparts",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Cache original bodyparts",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Rearrange bodypart columns in config order",
    "Test whether there are missing frames and superfluous data",
    "Check whether new individuals or body parts were added",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is selected when radio buttons are changed",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Discard data associated with bodyparts that are no longer in the config",
    "Re-organize the dataframe so the CSV looks consistent with the config",
    "restore the background region",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.build = wx.Button(self, label=\"Build skeleton\")",
    "sizer.Add(self.build, pos=(4, 3), flag=wx.BOTTOM | wx.RIGHT, border=10)",
    "self.build.Bind(wx.EVT_BUTTON, self.build_skeleton)",
    "self.build.Enable(True)",
    "def build_skeleton(self, event):",
    "skeleton.SkeletonBuilder(self.config)",
    "Setting the GUI size and panels design",
    "This sets the minimum size of the GUI. It can scale now!",
    "Checks if zoom/pan button is ON",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingindex = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingindex_boxsizer = wx.StaticBoxSizer(trainingindex, wx.VERTICAL)",
    "self.trainingindex = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingindex_boxsizer.Add(",
    "self.trainingindex, 1, wx.EXPAND | wx.TOP | wx.BOTTOM, 10)",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "hbox1.Add(trainingindex_boxsizer, 10, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "self.trainingindex.Enable(False)",
    "self.trainingindex.Enable(True)",
    "self.trainingindex.Enable(True)",
    "Read the pose config file",
    "print(trainFraction[-1])",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.get_model_folder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "self.trainingindex.Enable(True)",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "### BOX 1 ####",
    "### BOX 2 ####",
    "### BOX 3 ####",
    "Read the infer config file",
    "trainFraction = cfg[\"TrainingFraction\"][trainingsetindex]",
    "let the user open the file with default text editor. Also make it mac compatible",
    "self.select_destfolder.SetPath(\"None\")",
    "self.config = []",
    "self.sel_config.SetPath(\"\")",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingindex_box = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingindex_boxsizer = wx.StaticBoxSizer(trainingindex_box, wx.VERTICAL)",
    "self.trainingindex = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingindex_boxsizer.Add(",
    "self.trainingindex, 0, wx.EXPAND | wx.TOP | wx.BOTTOM, 10",
    ")",
    "self.hbox2.Add(trainingindex_boxsizer, 10, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "trainindex = self.trainingindex.GetValue()",
    "self.shuffles.SetValue(\"1\")",
    "DownSampleVideo(vname,width=-1,height=200,outsuffix='downsampled',outpath=None,rotatecw=False):",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "majorDimension=0,",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "Overwrite the config-defined individual names",
    "with those actually present in the annotated data",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingset = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingset_boxsizer = wx.StaticBoxSizer(trainingset, wx.VERTICAL)",
    "self.trainingset = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingset_boxsizer.Add(",
    "self.trainingset, 1, wx.EXPAND | wx.TOP | wx.BOTTOM, 10",
    ")",
    "self.hbox1.Add(trainingset_boxsizer, 5, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "if self.plot_scoremaps.GetStringSelection() == \"Yes\":",
    "Read the infer config file",
    "trainingsetindex = self.trainingset.GetValue()",
    "let the user open the file with default text editor. Also make it mac compatible",
    "shuffle = self.shuffle.GetValue()",
    "trainingsetindex = self.trainingset.GetValue()",
    "trainingsetindex=trainingsetindex,",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "## LABELING ###",
    "self.sel_config.SetPath(\"\")",
    "##################################################################################################################################################",
    "Splitting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "self.cfg = auxiliaryfunctions.read_config(config)",
    "self.statusbar.SetStatusText(\"\")",
    "dlg = wx.MessageDialog(None,\"Are you sure?\", \"Quit!\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_YES:",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0, 4), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=5)",
    "variable initialization",
    "design the panel",
    "Add logo of DLC",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "calling create_tracking_dataset, train_tracking_transformer, stitch_tracklets",
    "if animal == 'pup' and anchor_coord.shape[0]!=5:",
    "continue",
    "1) reference to video folder and get the proper bpt_feature file for feature table",
    "2) get either the path to gt or the path to track pickle",
    "tracklets",
    "with npy list form videos, split each to train and test",
    "video_name = '.'.join(video.split(\"/\")[-1].split(\".\")[:-1])",
    "assuming there is only one match",
    "make my own model factory",
    "make my own loss factory",
    "NOTE scale factor was wrong in my original version, can set manually to be compat with prev weights",
    "NOTE: drop path for stochastic depth, we shall see if this is better than dropout here",
    "only channel pooling",
    "x -> (B, 12, 2048)",
    "x -> (B, 12, 768)",
    "trying to keep everything simple",
    "need to write my own keypoint embedding",
    "we don't need a fc layer here",
    "x: inputs",
    "(B, 12, 768)",
    "added pos embed",
    "remove all parts I don't understand",
    "forwarding through blocks. But num of blocks should be reduced",
    "i can't really tell what the difference is",
    "will have to change some of these",
    "For old models that I trained prior to conv based patchification",
    "To resize pos embedding when using model at different size from pretrained weights",
    "Rescale the grid of position embeddings when loading from state_dict. Adapted from",
    "https://github.com/google-research/vision_transformer/blob/00883dd691c63a6830751563748663526e811cee/vit_jax/checkpoint.py#L224",
    "Cut & paste from PyTorch official master until it's in a few official releases - RW",
    "Method based on https://people.sc.fsu.edu/~jburkardt/presentations/truncated_normal.pdf",
    "Computes standard normal cumulative distribution function",
    "Values are generated by using a truncated uniform distribution and",
    "then using the inverse CDF for the normal distribution.",
    "Get upper and lower cdf values",
    "Uniformly fill tensor with values from [l, u], then translate to",
    "[2l-1, 2u-1].",
    "Use inverse cdf transform for normal distribution to get truncated",
    "standard normal",
    "Transform to proper mean, std",
    "Clamp to ensure it's in the proper range",
    "type: (Tensor, float, float, float, float) -> Tensor",
    "resample if noise out of percent limit, brute force but shouldn't spin much",
    "distmat g",
    "q    1 3 2 4",
    "4 1 2 3",
    "0 2 1 3",
    "1 2 3 0",
    "compute cmc curve for each query",
    "get query pid and camid",
    "remove gallery samples that have the same pid and camid with query",
    "compute cmc curve",
    "binary vector, positions with value 1 are correct matches",
    "this condition is true when query identity does not appear in gallery",
    "compute average precision",
    "reference: https://en.wikipedia.org/wiki/Evaluation_measures_(information_retrieval)#Average_precision",
    "tmp_cmc = [x / (i + 1.) for i, x in enumerate(tmp_cmc)]",
    "query",
    "gallery",
    "distmat = re_ranking(qf, gf, k1=20, k2=6, lambda_value=0.3)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "if feature vector is numpy, you should use 'torch.tensor' transform it to tensor",
    "print('using GPU to compute original distance')",
    "print('starting re_ranking')",
    "k-reciprocal neighbors",
    "More elegantly one can simply define:",
    "take care of difference between feature map space and original image space",
    "cos = torch.cdist",
    "TODO: maybe find a better spot for this.",
    "dev =  device if torch.cuda.is_available() else \"cpu\"",
    "train",
    "print (f'validation loss {val_loss/len(val_loader)}')",
    "normalize vectors here",
    "i th vector at j th kpt",
    "maybe needs to convert them to embeddings and position token",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "## dlcnet_ms5: backbone resnet50 + multi-fusion & multi-stage module",
    "## dlcr101_ms5/dlcr152_ms5: backbone resnet101/152 + multi-fusion & multi-stage module",
    "If the graph is unnecessarily large (with 15+ keypoints by default),",
    "we randomly prune it to a size guaranteeing an average node degree of 6;",
    "see Suppl. Fig S9c in Lauer et al., 2022.",
    "Use the skeleton defined in the config file",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Disable the prediction of PAFs if the graph is empty",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Search a pose_config.yaml file to parse missing information",
    "Clean the training-datasets folder prior to recreating the data pickles",
    "Load updated lists:",
    "Find the corresponding video file",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Determine the index length required to guarantee",
    "the train\u2013test ratio is exactly the desired one.",
    "Pad indices so lengths agree",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "DeprecationWarnings are silenced since Python 3.2 unless triggered in __main__",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "Also drop maDLC smart cropping augmentation parameters",
    "sort the model directories",
    "get the shuffle index and offset by 1.",
    "read cfg file",
    "create log file",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "allow_growth must be true here because tensorflow does not automatically free gpu memory and setting it as false occupies all gpu memory so that pytorch cannot kick in",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "should close tensorflow session here in order to free gpu",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: add cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Also ensure `boundingboxslack` is greater than zero, otherwise overlap",
    "between trackers cannot be evaluated, resulting in empty tracklets.",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: If dataname line above is changed then line below is obsolete?",
    "trackname = trackname.replace(videofolder, destfolder)",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "for multi animal, seems only this is used",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Get animal IDs and corresponding indices in the arrays of detections",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Only 1 animal, let us return the full graph indices only",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Covariance matrix estimation fails due to numerical singularities",
    "Distance is undefined if the assembly is empty",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Mark the unique body parts as assembled anyway so",
    "they are not used later on to fill assemblies.",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "Spawning (rather than forking) multiple processes does not",
    "work nicely with the GUI or interactive sessions.",
    "In that case, we fall back to the serial assembly.",
    "Swap corresponding keypoints",
    "Only consider assemblies of at least two keypoints",
    "Greedy assembly matching like in pycocotools",
    "Global rather than greedy assembly matching",
    "Cast columns of dtype 'object' to float to avoid TypeError",
    "further down in _parse_ground_truth_data.",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "Sort matching score (OKS) in descending order of assembly affinity",
    "Guarantee precision decreases monotonically",
    "See https://jonathan-hui.medium.com/map-mean-average-precision-for-object-detection-45c121a31173)",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "High uncertainty to the unobservable initial velocities",
    "Give high uncertainty to the unobservable initial velocities",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "filter out matched with low IOU",
    "TODO: get cropping parameters and utilize!",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "If a string was passed in, auto-convert to True for backward compatibility",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to initial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Ignore best edges possibly defined during a prior evaluation",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Pass the image and the keypoints through the resizer;",
    "this has no effect if no augmenters were added to it.",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Form 2D array of shape (n_rows, 4) where the last dimension",
    "is (sample_index, peak_y, peak_x, bpt_index) to slice the PAFs.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "Clip peak locations to PAFs dimensions",
    "unit_vecs = vecs / lengths[:, np.newaxis]",
    "affinities = np.squeeze(y @ np.expand_dims(unit_vecs, axis=2)).sum(axis=1)",
    "Form cost matrices",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Convert a frozen graph to OpenVINO IR format",
    "Read network into memory",
    "For better efficiency, model is initialized for batch_size 1 and every sample processed independently",
    "Load network to device",
    "Prepare input data",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "Multi stage is currently only implemented for resnets",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "FIXME Fix wrong scope with Keras layers",
    "def prediction_layer(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2DTranspose(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=2,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "## New DLCNet Addition: multi-stage decoder",
    "def prediction_layer_stage(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2D(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=1,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "turn into x times y time bs * bpts",
    "extract corresponding locref x and y as well as probability",
    "Filter predicted heatmaps with a 2D Gaussian kernel as in:",
    "https://openaccess.thecvf.com/content_CVPR_2020/papers/Huang_The_Devil_Is_in_the_Details_Delving_Into_Unbiased_Data_CVPR_2020_paper.pdf",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrunk when given a depth-multiplier < 1.0.",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Clamp to 40% of crop size to ensure that at least",
    "the center keypoint remains visible after the offset is applied.",
    "Points located close to one another are sampled preferentially",
    "in order to augment crowded regions.",
    "Include keypoints in the count to avoid null probabilities",
    "Shift the crop center in both dimensions by random amounts",
    "and normalize to the original image dimensions.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "Add smart, keypoint-aware image cropping",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "Discard keypoints whose coordinates lie outside the cropped image",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "imageio.imwrite(data_items[i].im_path.split('/')[-1],im)",
    "Produce score maps and location refinement fields",
    "Find indices of individuals in joint_id",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "TODO Finish implementing actual abstract class",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Check the training image paths are correctly stored as arrays of strings",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one identical splits for 3 networks and 3 augmentations",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "Setting specific parameters for training",
    "MODELS = [\"dlcrnet_ms5\", \"dlcr101_ms5\", \"efficientnet-b0\", \"mobilenet_v2_0.35\"]",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "## adding it here",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Downloading the calibration images",
    "Deleting unnecessary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "test if existing models are found:",
    "Test if nonexisting models are not found",
    "Add some other office files:",
    "Add a .pickle and .h5 files",
    "By default, all videos with common extensions are taken from a directory",
    "A list of extensions can also be passed in",
    "Test bounding box from a single keypoint",
    "Test that shape was preserved after vectorization",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Guarantee that images smaller than crop size are handled fine",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Disable stochastic scale jitter",
    "Verify the aspect ratio is preserved",
    "Load sample multi animal data",
    "Generate a random permutation and reorder data. Ignore the unique bodypart",
    "Get inverse permutation and reorder the modified data to get back",
    "to the original",
    "Check",
    "Check data comprise path, shape, and xy coordinates",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "Test flipped keypoints",
    "Original (cached) coordinates must have remained empty",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID.",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-"
  ],
  "v2.2.0.6": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "def install(package):",
    "subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", package])",
    "install(\"tensorflow==1.13.1\")",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Suppress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / all require TF",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "Store tracklets and corresponding negatives (those that overlap in time)",
    "TODO Avoid looping over all pairs of tracklets",
    "Pick the closest (spatially) overlapping tracklet",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Default to the distance cost function",
    "Add in identity weighing before building the graph",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "from deeplabcut.utils.auxfun_videos import imread",
    "auxfun_videos.imread(image_path, mode=\"skimage\")",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "check if it exists:",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (indivdual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "Keep only the individuals and bodyparts that were labeled",
    "Either display the animals defined in the config if they are found",
    "in the dataframe, or all the trajectories regardless of their names",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Make paths platform-agnostic if they are not already",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingset = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingset_boxsizer = wx.StaticBoxSizer(trainingset, wx.VERTICAL)",
    "self.trainingset = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingset_boxsizer.Add(",
    "self.trainingset, 1, wx.EXPAND | wx.TOP | wx.BOTTOM, 10",
    ")",
    "hbox_.Add(trainingset_boxsizer, 5, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "Read the infer config file",
    "trainingsetindex = self.trainingset.GetValue()",
    "let the user open the file with default text editor. Also make it mac compatible",
    "trainingsetindex = self.trainingset.GetValue()",
    "trainingsetindex=trainingsetindex,",
    "trainingsetindex=self.trainingset.GetValue(),",
    "self.save.Enable(False)",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "topSplitter = wx.SplitterWindow(self)",
    "",
    "self.image_panel = ImagePanel(topSplitter, config,video,shuffle,Dataframe,self.gui_size)",
    "self.widget_panel = WidgetPanel(topSplitter)",
    "",
    "topSplitter.SplitHorizontally(self.image_panel, self.widget_panel,sashPosition=self.gui_size[1]*0.83)#0.9",
    "topSplitter.SetSashGravity(1)",
    "sizer = wx.BoxSizer(wx.VERTICAL)",
    "sizer.Add(topSplitter, 1, wx.EXPAND)",
    "self.SetSizer(sizer)",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0,10), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=10)",
    "Add all the options",
    "line = wx.StaticLine(self)",
    "self.sizer.Add(line, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=10)",
    "",
    "self.multi_choice.Bind(wx.EVT_CHECKBOX,self.activate_copy_videos)",
    "Hide the button as this is not the default option",
    "self.vids.Enable(False)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "page10 = Refine_labels(self.parent, self.gui_size, self.cfg, page5)",
    "self.parent.AddPage(page10, \"OPT: Refine Labels\")",
    "self.yes.Enable(False)",
    "self.no.Enable(False)",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.buttonCounter = []",
    "self.bodyparts = []",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "convert the image to RGB as you are showing the image with matplotlib",
    "draw epipolar lines",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.filelist = self.filelist + self.vids",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "convert the image to RGB as you are showing the image with matplotlib",
    "draw epipolar lines",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "checks for unique bodyparts",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Cache original bodyparts",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Rearrange bodypart columns in config order",
    "Test whether there are missing frames and superfluous data",
    "Check whether new individuals or body parts were added",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Discard data associated with bodyparts that are no longer in the config",
    "Re-organize the dataframe so the CSV looks consistent with the config",
    "restore the background region",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.build = wx.Button(self, label=\"Build skeleton\")",
    "sizer.Add(self.build, pos=(4, 3), flag=wx.BOTTOM | wx.RIGHT, border=10)",
    "self.build.Bind(wx.EVT_BUTTON, self.build_skeleton)",
    "self.build.Enable(True)",
    "def build_skeleton(self, event):",
    "skeleton.SkeletonBuilder(self.config)",
    "Settting the GUI size and panels design",
    "Checks if zoom/pan button is ON",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingindex = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingindex_boxsizer = wx.StaticBoxSizer(trainingindex, wx.VERTICAL)",
    "self.trainingindex = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingindex_boxsizer.Add(",
    "self.trainingindex, 1, wx.EXPAND | wx.TOP | wx.BOTTOM, 10)",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "hbox1.Add(trainingindex_boxsizer, 10, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "self.trainingindex.Enable(False)",
    "self.trainingindex.Enable(True)",
    "self.trainingindex.Enable(True)",
    "Read the pose config file",
    "print(trainFraction[-1])",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "self.trainingindex.Enable(True)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "### BOX 1 ####",
    "### BOX 2 ####",
    "### BOX 3 ####",
    "Read the infer config file",
    "trainFraction = cfg[\"TrainingFraction\"][trainingsetindex]",
    "let the user open the file with default text editor. Also make it mac compatible",
    "self.select_destfolder.SetPath(\"None\")",
    "self.config = []",
    "self.sel_config.SetPath(\"\")",
    "self.videotype.SetStringSelection(\".avi\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingindex_box = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingindex_boxsizer = wx.StaticBoxSizer(trainingindex_box, wx.VERTICAL)",
    "self.trainingindex = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingindex_boxsizer.Add(",
    "self.trainingindex, 0, wx.EXPAND | wx.TOP | wx.BOTTOM, 10",
    ")",
    "self.hbox2.Add(trainingindex_boxsizer, 10, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "trainindex = self.trainingindex.GetValue()",
    "self.shuffles.SetValue(\"1\")",
    "DownSampleVideo(vname,width=-1,height=200,outsuffix='downsampled',outpath=None,rotatecw=False):",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "majorDimension=0,",
    "self.videotype.SetStringSelection(\".avi\")",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "Overwrite the config-defined individual names",
    "with those actually present in the annotated data",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingset = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingset_boxsizer = wx.StaticBoxSizer(trainingset, wx.VERTICAL)",
    "self.trainingset = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingset_boxsizer.Add(",
    "self.trainingset, 1, wx.EXPAND | wx.TOP | wx.BOTTOM, 10",
    ")",
    "self.hbox1.Add(trainingset_boxsizer, 5, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "if self.plot_scoremaps.GetStringSelection() == \"Yes\":",
    "Read the infer config file",
    "trainingsetindex = self.trainingset.GetValue()",
    "let the user open the file with default text editor. Also make it mac compatible",
    "shuffle = self.shuffle.GetValue()",
    "trainingsetindex = self.trainingset.GetValue()",
    "trainingsetindex=trainingsetindex,",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "## LABELING ###",
    "self.sel_config.SetPath(\"\")",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "self.cfg = auxiliaryfunctions.read_config(config)",
    "self.statusbar.SetStatusText(\"\")",
    "dlg = wx.MessageDialog(None,\"Are you sure?\", \"Quit!\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_YES:",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0, 4), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=5)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "## dlcnet_ms5: backbone resnet50 + multi-fusion & multi-stage module",
    "## dlcr101_ms5/dlcr152_ms5: backbone resnet101/152 + multi-fusion & multi-stage module",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Disable the prediction of PAFs if the graph is empty",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Search a pose_config.yaml file to parse missing information",
    "Clean the training-datasets folder prior to recreating the data pickles",
    "Load updated lists:",
    "Find the corresponding video file",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Determine the index length required to guarantee",
    "the train\u2013test ratio is exactly the desired one.",
    "Pad indices so lengths agree",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "DeprecationWarnings are silenced since Python 3.2 unless triggered in __main__",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "sort the model directories",
    "get the shuffle index and offset by 1.",
    "read cfg file",
    "create log file",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: addd cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Also ensure `boundingboxslack` is greater than zero, otherwise overlap",
    "between trackers cannot be evaluated, resulting in empty tracklets.",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: If dataname line above is changed then line below is obsolete?",
    "trackname = trackname.replace(videofolder, destfolder)",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Get animal IDs and corresponding indices in the arrays of detections",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Only 1 animal, let us return the full graph indices only",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Covariance matrix estimation fails due to numerical singularities",
    "Distance is undefined if the assembly is empty",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Mark the unique body parts as assembled anyway so",
    "they are not used later on to fill assemblies.",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "Spawning (rather than forking) multiple processes does not",
    "work nicely with the GUI or interactive sessions.",
    "In that case, we fall back to the serial assembly.",
    "Swap corresponding keypoints",
    "Only consider assemblies of at least two keypoints",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "Sort matching score (OKS) in descending order of assembly affinity",
    "Guarantee precision decreases monotonically",
    "See https://jonathan-hui.medium.com/map-mean-average-precision-for-object-detection-45c121a31173)",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "High uncertainty to the unobservable initial velocities",
    "Give high uncertainty to the unobservable initial velocities",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "filter out matched with low IOU",
    "TODO: get cropping parameters and utilize!",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "If a string was passed in, auto-convert to True for backward compatibility",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Ignore best edges possibly defined during a prior evaluation",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Form 2D array of shape (n_rows, 4) where the last dimension",
    "is (sample_index, peak_y, peak_x, bpt_index) to slice the PAFs.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "Clip peak locations to PAFs dimensions",
    "unit_vecs = vecs / lengths[:, np.newaxis]",
    "affinities = np.squeeze(y @ np.expand_dims(unit_vecs, axis=2)).sum(axis=1)",
    "Form cost matrices",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "Multi stage is currently only implemented for resnets",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "FIXME Fix wrong scope with Keras layers",
    "def prediction_layer(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2DTranspose(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=2,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "## New DLCNet Addition: multi-stage decoder",
    "def prediction_layer_stage(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2D(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=1,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "turn into x times y time bs * bpts",
    "extract corresponding locref x and y as well as probability",
    "Filter predicted heatmaps with a 2D Gaussian kernel as in:",
    "https://openaccess.thecvf.com/content_CVPR_2020/papers/Huang_The_Devil_Is_in_the_Details_Delving_Into_Unbiased_Data_CVPR_2020_paper.pdf",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Clamp to 40% of crop size to ensure that at least",
    "the center keypoint remains visible after the offset is applied.",
    "Points located close to one another are sampled preferentially",
    "in order to augment crowded regions.",
    "Include keypoints in the count to avoid null probabilities",
    "Shift the crop center in both dimensions by random amounts",
    "and normalize to the original image dimensions.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "Add smart, keypoint-aware image cropping",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "Discard keypoints whose coordinates lie outside the cropped image",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "imageio.imwrite(data_items[i].im_path.split('/')[-1],im)",
    "Produce score maps and location refinement fields",
    "Find indices of individuals in joint_id",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "TODO Finish implementing actual abstract class",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Check the training image paths are correctly stored as arrays of strings",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one identical splits for 3 networks and 3 augmentations",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "Setting specific parameters for training",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "Test bounding box from a single keypoint",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Guarantee that images smaller than crop size are handled fine",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Disable stochastic scale jitter",
    "Verify the aspect ratio is preserved",
    "Check data comprise path, shape, and xy coordinates",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "Test flipped keypoints",
    "Original (cached) coordinates must have remained empty",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID.",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-"
  ],
  "v2.2.0.5": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "def install(package):",
    "subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", package])",
    "install(\"tensorflow==1.13.1\")",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Suppress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / all require TF",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "Store tracklets and corresponding negatives (those that overlap in time)",
    "TODO Avoid looping over all pairs of tracklets",
    "Pick the closest (spatially) overlapping tracklet",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Default to the distance cost function",
    "Add in identity weighing before building the graph",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "from deeplabcut.utils.auxfun_videos import imread",
    "auxfun_videos.imread(image_path, mode=\"skimage\")",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "check if it exists:",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (indivdual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "Keep only the individuals and bodyparts that were labeled",
    "Either display the animals defined in the config if they are found",
    "in the dataframe, or all the trajectories regardless of their names",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Make paths platform-agnostic if they are not already",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingset = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingset_boxsizer = wx.StaticBoxSizer(trainingset, wx.VERTICAL)",
    "self.trainingset = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingset_boxsizer.Add(",
    "self.trainingset, 1, wx.EXPAND | wx.TOP | wx.BOTTOM, 10",
    ")",
    "hbox_.Add(trainingset_boxsizer, 5, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "Read the infer config file",
    "trainingsetindex = self.trainingset.GetValue()",
    "let the user open the file with default text editor. Also make it mac compatible",
    "trainingsetindex = self.trainingset.GetValue()",
    "trainingsetindex=trainingsetindex,",
    "trainingsetindex=self.trainingset.GetValue(),",
    "self.save.Enable(False)",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "topSplitter = wx.SplitterWindow(self)",
    "",
    "self.image_panel = ImagePanel(topSplitter, config,video,shuffle,Dataframe,self.gui_size)",
    "self.widget_panel = WidgetPanel(topSplitter)",
    "",
    "topSplitter.SplitHorizontally(self.image_panel, self.widget_panel,sashPosition=self.gui_size[1]*0.83)#0.9",
    "topSplitter.SetSashGravity(1)",
    "sizer = wx.BoxSizer(wx.VERTICAL)",
    "sizer.Add(topSplitter, 1, wx.EXPAND)",
    "self.SetSizer(sizer)",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0,10), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=10)",
    "Add all the options",
    "line = wx.StaticLine(self)",
    "self.sizer.Add(line, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=10)",
    "",
    "self.multi_choice.Bind(wx.EVT_CHECKBOX,self.activate_copy_videos)",
    "Hide the button as this is not the default option",
    "self.vids.Enable(False)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "page10 = Refine_labels(self.parent, self.gui_size, self.cfg, page5)",
    "self.parent.AddPage(page10, \"OPT: Refine Labels\")",
    "self.yes.Enable(False)",
    "self.no.Enable(False)",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.buttonCounter = []",
    "self.bodyparts = []",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "convert the image to RGB as you are showing the image with matplotlib",
    "draw epipolar lines",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.filelist = self.filelist + self.vids",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "convert the image to RGB as you are showing the image with matplotlib",
    "draw epipolar lines",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "checks for unique bodyparts",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Cache original bodyparts",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Rearrange bodypart columns in config order",
    "Test whether there are missing frames and superfluous data",
    "Check whether new individuals or body parts were added",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Discard data associated with bodyparts that are no longer in the config",
    "Re-organize the dataframe so the CSV looks consistent with the config",
    "restore the background region",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.build = wx.Button(self, label=\"Build skeleton\")",
    "sizer.Add(self.build, pos=(4, 3), flag=wx.BOTTOM | wx.RIGHT, border=10)",
    "self.build.Bind(wx.EVT_BUTTON, self.build_skeleton)",
    "self.build.Enable(True)",
    "def build_skeleton(self, event):",
    "skeleton.SkeletonBuilder(self.config)",
    "Settting the GUI size and panels design",
    "Checks if zoom/pan button is ON",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingindex = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingindex_boxsizer = wx.StaticBoxSizer(trainingindex, wx.VERTICAL)",
    "self.trainingindex = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingindex_boxsizer.Add(",
    "self.trainingindex, 1, wx.EXPAND | wx.TOP | wx.BOTTOM, 10)",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "hbox1.Add(trainingindex_boxsizer, 10, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "self.trainingindex.Enable(False)",
    "self.trainingindex.Enable(True)",
    "self.trainingindex.Enable(True)",
    "Read the pose config file",
    "print(trainFraction[-1])",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "self.trainingindex.Enable(True)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "### BOX 1 ####",
    "### BOX 2 ####",
    "### BOX 3 ####",
    "Read the infer config file",
    "trainFraction = cfg[\"TrainingFraction\"][trainingsetindex]",
    "let the user open the file with default text editor. Also make it mac compatible",
    "self.select_destfolder.SetPath(\"None\")",
    "self.config = []",
    "self.sel_config.SetPath(\"\")",
    "self.videotype.SetStringSelection(\".avi\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingindex_box = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingindex_boxsizer = wx.StaticBoxSizer(trainingindex_box, wx.VERTICAL)",
    "self.trainingindex = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingindex_boxsizer.Add(",
    "self.trainingindex, 0, wx.EXPAND | wx.TOP | wx.BOTTOM, 10",
    ")",
    "self.hbox2.Add(trainingindex_boxsizer, 10, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "trainindex = self.trainingindex.GetValue()",
    "self.shuffles.SetValue(\"1\")",
    "DownSampleVideo(vname,width=-1,height=200,outsuffix='downsampled',outpath=None,rotatecw=False):",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "majorDimension=0,",
    "self.videotype.SetStringSelection(\".avi\")",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "Overwrite the config-defined individual names",
    "with those actually present in the annotated data",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingset = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingset_boxsizer = wx.StaticBoxSizer(trainingset, wx.VERTICAL)",
    "self.trainingset = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingset_boxsizer.Add(",
    "self.trainingset, 1, wx.EXPAND | wx.TOP | wx.BOTTOM, 10",
    ")",
    "self.hbox1.Add(trainingset_boxsizer, 5, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "if self.plot_scoremaps.GetStringSelection() == \"Yes\":",
    "Read the infer config file",
    "trainingsetindex = self.trainingset.GetValue()",
    "let the user open the file with default text editor. Also make it mac compatible",
    "shuffle = self.shuffle.GetValue()",
    "trainingsetindex = self.trainingset.GetValue()",
    "trainingsetindex=trainingsetindex,",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "## LABELING ###",
    "self.sel_config.SetPath(\"\")",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "self.cfg = auxiliaryfunctions.read_config(config)",
    "self.statusbar.SetStatusText(\"\")",
    "dlg = wx.MessageDialog(None,\"Are you sure?\", \"Quit!\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_YES:",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0, 4), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=5)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "## dlcnet_ms5: backbone resnet50 + multi-fusion & multi-stage module",
    "## dlcr101_ms5/dlcr152_ms5: backbone resnet101/152 + multi-fusion & multi-stage module",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Disable the prediction of PAFs if the graph is empty",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Search a pose_config.yaml file to parse missing information",
    "Clean the training-datasets folder prior to recreating the data pickles",
    "Load updated lists:",
    "Find the corresponding video file",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Determine the index length required to guarantee",
    "the train\u2013test ratio is exactly the desired one.",
    "Pad indices so lengths agree",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "DeprecationWarnings are silenced since Python 3.2 unless triggered in __main__",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "sort the model directories",
    "get the shuffle index and offset by 1.",
    "read cfg file",
    "create log file",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: addd cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Also ensure `boundingboxslack` is greater than zero, otherwise overlap",
    "between trackers cannot be evaluated, resulting in empty tracklets.",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: If dataname line above is changed then line below is obsolete?",
    "trackname = trackname.replace(videofolder, destfolder)",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Get animal IDs and corresponding indices in the arrays of detections",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Only 1 animal, let us return the full graph indices only",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Covariance matrix estimation fails due to numerical singularities",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Mark the unique body parts as assembled anyway so",
    "they are not used later on to fill assemblies.",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "Spawning (rather than forking) multiple processes does not",
    "work nicely with the GUI or interactive sessions.",
    "In that case, we fall back to the serial assembly.",
    "Swap corresponding keypoints",
    "Only consider assemblies of at least two keypoints",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "Sort matching score (OKS) in descending order of assembly affinity",
    "Guarantee precision decreases monotonically",
    "See https://jonathan-hui.medium.com/map-mean-average-precision-for-object-detection-45c121a31173)",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "High uncertainty to the unobservable initial velocities",
    "Give high uncertainty to the unobservable initial velocities",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "filter out matched with low IOU",
    "TODO: get cropping parameters and utilize!",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "If a string was passed in, auto-convert to True for backward compatibility",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Ignore best edges possibly defined during a prior evaluation",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Form 2D array of shape (n_rows, 4) where the last dimension",
    "is (sample_index, peak_y, peak_x, bpt_index) to slice the PAFs.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "Clip peak locations to PAFs dimensions",
    "unit_vecs = vecs / lengths[:, np.newaxis]",
    "affinities = np.squeeze(y @ np.expand_dims(unit_vecs, axis=2)).sum(axis=1)",
    "Form cost matrices",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "Multi stage is currently only implemented for resnets",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "FIXME Fix wrong scope with Keras layers",
    "def prediction_layer(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2DTranspose(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=2,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "## New DLCNet Addition: multi-stage decoder",
    "def prediction_layer_stage(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2D(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=1,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "turn into x times y time bs * bpts",
    "extract corresponding locref x and y as well as probability",
    "Filter predicted heatmaps with a 2D Gaussian kernel as in:",
    "https://openaccess.thecvf.com/content_CVPR_2020/papers/Huang_The_Devil_Is_in_the_Details_Delving_Into_Unbiased_Data_CVPR_2020_paper.pdf",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Clamp to 40% of crop size to ensure that at least",
    "the center keypoint remains visible after the offset is applied.",
    "Points located close to one another are sampled preferentially",
    "in order to augment crowded regions.",
    "Include keypoints in the count to avoid null probabilities",
    "Shift the crop center in both dimensions by random amounts",
    "and normalize to the original image dimensions.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "Add smart, keypoint-aware image cropping",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "Discard keypoints whose coordinates lie outside the cropped image",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "imageio.imwrite(data_items[i].im_path.split('/')[-1],im)",
    "Produce score maps and location refinement fields",
    "Find indices of individuals in joint_id",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "TODO Finish implementing actual abstract class",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Check the training image paths are correctly stored as arrays of strings",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one identical splits for 3 networks and 3 augmentations",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "Setting specific parameters for training",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "Test bounding box from a single keypoint",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Guarantee that images smaller than crop size are handled fine",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Disable stochastic scale jitter",
    "Verify the aspect ratio is preserved",
    "Check data comprise path, shape, and xy coordinates",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "Test flipped keypoints",
    "Original (cached) coordinates must have remained empty",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID.",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-"
  ],
  "v2.2.0.4": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "def install(package):",
    "subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", package])",
    "install(\"tensorflow==1.13.1\")",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Suppress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / all require TF",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "TODO Avoid looping over all pairs of tracklets",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Default to the distance cost function",
    "Add in identity weighing before building the graph",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "from deeplabcut.utils.auxfun_videos import imread",
    "auxfun_videos.imread(image_path, mode=\"skimage\")",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "TODO: check if this tracker actually exists?",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (indivdual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "Keep only the individuals and bodyparts that were labeled",
    "Either display the animals defined in the config if they are found",
    "in the dataframe, or all the trajectories regardless of their names",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Make paths platform-agnostic if they are not already",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingset = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingset_boxsizer = wx.StaticBoxSizer(trainingset, wx.VERTICAL)",
    "self.trainingset = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingset_boxsizer.Add(",
    "self.trainingset, 1, wx.EXPAND | wx.TOP | wx.BOTTOM, 10",
    ")",
    "hbox_.Add(trainingset_boxsizer, 5, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "Read the infer config file",
    "trainingsetindex = self.trainingset.GetValue()",
    "let the user open the file with default text editor. Also make it mac compatible",
    "trainingsetindex = self.trainingset.GetValue()",
    "trainingsetindex=trainingsetindex,",
    "trainingsetindex=self.trainingset.GetValue(),",
    "self.save.Enable(False)",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "topSplitter = wx.SplitterWindow(self)",
    "",
    "self.image_panel = ImagePanel(topSplitter, config,video,shuffle,Dataframe,self.gui_size)",
    "self.widget_panel = WidgetPanel(topSplitter)",
    "",
    "topSplitter.SplitHorizontally(self.image_panel, self.widget_panel,sashPosition=self.gui_size[1]*0.83)#0.9",
    "topSplitter.SetSashGravity(1)",
    "sizer = wx.BoxSizer(wx.VERTICAL)",
    "sizer.Add(topSplitter, 1, wx.EXPAND)",
    "self.SetSizer(sizer)",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0,10), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=10)",
    "Add all the options",
    "line = wx.StaticLine(self)",
    "self.sizer.Add(line, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=10)",
    "",
    "self.multi_choice.Bind(wx.EVT_CHECKBOX,self.activate_copy_videos)",
    "Hide the button as this is not the default option",
    "self.vids.Enable(False)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "page10 = Refine_labels(self.parent, self.gui_size, self.cfg, page5)",
    "self.parent.AddPage(page10, \"OPT: Refine Labels\")",
    "self.yes.Enable(False)",
    "self.no.Enable(False)",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.buttonCounter = []",
    "self.bodyparts = []",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "convert the image to RGB as you are showing the image with matplotlib",
    "draw epipolar lines",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.filelist = self.filelist + self.vids",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "convert the image to RGB as you are showing the image with matplotlib",
    "draw epipolar lines",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "checks for unique bodyparts",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Cache original bodyparts",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Rearrange bodypart columns in config order",
    "Test whether there are missing frames and superfluous data",
    "Check whether new individuals or body parts were added",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Discard data associated with bodyparts that are no longer in the config",
    "Re-organize the dataframe so the CSV looks consistent with the config",
    "restore the background region",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.build = wx.Button(self, label=\"Build skeleton\")",
    "sizer.Add(self.build, pos=(4, 3), flag=wx.BOTTOM | wx.RIGHT, border=10)",
    "self.build.Bind(wx.EVT_BUTTON, self.build_skeleton)",
    "self.build.Enable(True)",
    "def build_skeleton(self, event):",
    "skeleton.SkeletonBuilder(self.config)",
    "Settting the GUI size and panels design",
    "Checks if zoom/pan button is ON",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingindex = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingindex_boxsizer = wx.StaticBoxSizer(trainingindex, wx.VERTICAL)",
    "self.trainingindex = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingindex_boxsizer.Add(",
    "self.trainingindex, 1, wx.EXPAND | wx.TOP | wx.BOTTOM, 10)",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "hbox1.Add(trainingindex_boxsizer, 10, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "self.trainingindex.Enable(False)",
    "self.trainingindex.Enable(True)",
    "self.trainingindex.Enable(True)",
    "Read the pose config file",
    "print(trainFraction[-1])",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "self.trainingindex.Enable(True)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "### BOX 1 ####",
    "### BOX 2 ####",
    "### BOX 3 ####",
    "Read the infer config file",
    "trainFraction = cfg[\"TrainingFraction\"][trainingsetindex]",
    "let the user open the file with default text editor. Also make it mac compatible",
    "self.select_destfolder.SetPath(\"None\")",
    "self.config = []",
    "self.sel_config.SetPath(\"\")",
    "self.videotype.SetStringSelection(\".avi\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingindex_box = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingindex_boxsizer = wx.StaticBoxSizer(trainingindex_box, wx.VERTICAL)",
    "self.trainingindex = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingindex_boxsizer.Add(",
    "self.trainingindex, 0, wx.EXPAND | wx.TOP | wx.BOTTOM, 10",
    ")",
    "self.hbox2.Add(trainingindex_boxsizer, 10, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "trainindex = self.trainingindex.GetValue()",
    "self.shuffles.SetValue(\"1\")",
    "DownSampleVideo(vname,width=-1,height=200,outsuffix='downsampled',outpath=None,rotatecw=False):",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "majorDimension=0,",
    "self.videotype.SetStringSelection(\".avi\")",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "Overwrite the config-defined individual names",
    "with those actually present in the annotated data",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "trainingset = wx.StaticBox(self, label=\"Specify the trainingset index\")",
    "trainingset_boxsizer = wx.StaticBoxSizer(trainingset, wx.VERTICAL)",
    "self.trainingset = wx.SpinCtrl(self, value=\"0\", min=0, max=100)",
    "trainingset_boxsizer.Add(",
    "self.trainingset, 1, wx.EXPAND | wx.TOP | wx.BOTTOM, 10",
    ")",
    "self.hbox1.Add(trainingset_boxsizer, 5, wx.EXPAND | wx.TOP | wx.BOTTOM, 5)",
    "if self.plot_scoremaps.GetStringSelection() == \"Yes\":",
    "Read the infer config file",
    "trainingsetindex = self.trainingset.GetValue()",
    "let the user open the file with default text editor. Also make it mac compatible",
    "shuffle = self.shuffle.GetValue()",
    "trainingsetindex = self.trainingset.GetValue()",
    "trainingsetindex=trainingsetindex,",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "## LABELING ###",
    "self.sel_config.SetPath(\"\")",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "self.cfg = auxiliaryfunctions.read_config(config)",
    "self.statusbar.SetStatusText(\"\")",
    "dlg = wx.MessageDialog(None,\"Are you sure?\", \"Quit!\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_YES:",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0, 4), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=5)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "## dlcnet_ms5: backbone resnet50 + multi-fusion & multi-stage module",
    "## dlcr101_ms5/dlcr152_ms5: backbone resnet101/152 + multi-fusion & multi-stage module",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Disable the prediction of PAFs if the graph is empty",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Search a pose_config.yaml file to parse missing information",
    "Clean the training-datasets folder prior to recreating the data pickles",
    "Load updated lists:",
    "Find the corresponding video file",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Determine the index length required to guarantee",
    "the train\u2013test ratio is exactly the desired one.",
    "Pad indices so lengths agree",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "DeprecationWarnings are silenced since Python 3.2 unless triggered in __main__",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "sort the model directories",
    "get the shuffle index and offset by 1.",
    "read cfg file",
    "create log file",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: addd cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Also ensure `boundingboxslack` is greater than zero, otherwise overlap",
    "between trackers cannot be evaluated, resulting in empty tracklets.",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: If dataname line above is changed then line below is obsolete?",
    "trackname = trackname.replace(videofolder, destfolder)",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "Avoid overwriting data already on the shelf",
    "Avoid overwriting data already on the shelf",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Get animal IDs and corresponding indices in the arrays of detections",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Only 1 animal, let us return the full graph indices only",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Covariance matrix estimation fails due to numerical singularities",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Mark the unique body parts as assembled anyway so",
    "they are not used later on to fill assemblies.",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "Spawning (rather than forking) multiple processes does not",
    "work nicely with the GUI or interactive sessions.",
    "In that case, we fall back to the serial assembly.",
    "Swap corresponding keypoints",
    "Only consider assemblies of at least two keypoints",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "Sort matching score (OKS) in descending order of assembly affinity",
    "Guarantee precision decreases monotonically",
    "See https://jonathan-hui.medium.com/map-mean-average-precision-for-object-detection-45c121a31173)",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "High uncertainty to the unobservable initial velocities",
    "Give high uncertainty to the unobservable initial velocities",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "filter out matched with low IOU",
    "TODO: get cropping parameters and utilize!",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "If a string was passed in, auto-convert to True for backward compatibility",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Ignore best edges possibly defined during a prior evaluation",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Form 2D array of shape (n_rows, 4) where the last dimension",
    "is (sample_index, peak_y, peak_x, bpt_index) to slice the PAFs.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "Clip peak locations to PAFs dimensions",
    "unit_vecs = vecs / lengths[:, np.newaxis]",
    "affinities = np.squeeze(y @ np.expand_dims(unit_vecs, axis=2)).sum(axis=1)",
    "Form cost matrices",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "Multi stage is currently only implemented for resnets",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "FIXME Fix wrong scope with Keras layers",
    "def prediction_layer(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2DTranspose(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=2,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "## New DLCNet Addition: multi-stage decoder",
    "def prediction_layer_stage(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2D(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=1,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "turn into x times y time bs * bpts",
    "extract corresponding locref x and y as well as probability",
    "Filter predicted heatmaps with a 2D Gaussian kernel as in:",
    "https://openaccess.thecvf.com/content_CVPR_2020/papers/Huang_The_Devil_Is_in_the_Details_Delving_Into_Unbiased_Data_CVPR_2020_paper.pdf",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Clamp to 40% of crop size to ensure that at least",
    "the center keypoint remains visible after the offset is applied.",
    "Points located close to one another are sampled preferentially",
    "in order to augment crowded regions.",
    "Include keypoints in the count to avoid null probabilities",
    "Shift the crop center in both dimensions by random amounts",
    "and normalize to the original image dimensions.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "Add smart, keypoint-aware image cropping",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "Discard keypoints whose coordinates lie outside the cropped image",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "imageio.imwrite(data_items[i].im_path.split('/')[-1],im)",
    "Produce score maps and location refinement fields",
    "Find indices of individuals in joint_id",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "TODO Finish implementing actual abstract class",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Check the training image paths are correctly stored as arrays of strings",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "NET = \"dlcr101_ms5\"",
    "Always test a different model from list above",
    "Check the training image paths are correctly stored as arrays of strings",
    "\"multi_step\": [[0.001, N_ITER]],",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one identical splits for 3 networks and 3 augmentations",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "Setting specific parameters for training",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "Test bounding box from a single keypoint",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Guarantee that images smaller than crop size are handled fine",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Disable stochastic scale jitter",
    "Verify the aspect ratio is preserved",
    "Check data comprise path, shape, and xy coordinates",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "Test flipped keypoints",
    "Original (cached) coordinates must have remained empty",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID.",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-"
  ],
  "v2.2.0.3": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "def install(package):",
    "subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", package])",
    "install(\"tensorflow==1.13.1\")",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Suppress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / all require TF",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "Create the pose_config.yaml files",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "TODO Avoid looping over all pairs of tracklets",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Default to the distance cost function",
    "Add in identity weighing before building the graph",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "Historically DLC used: from scipy.misc import imread, imresize >> deprecated functions",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (indivdual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "Keep only the individuals and bodyparts that were labeled",
    "Either display the animals defined in the config if they are found",
    "in the dataframe, or all the trajectories regardless of their names",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "self.save.Enable(False)",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "topSplitter = wx.SplitterWindow(self)",
    "",
    "self.image_panel = ImagePanel(topSplitter, config,video,shuffle,Dataframe,self.gui_size)",
    "self.widget_panel = WidgetPanel(topSplitter)",
    "",
    "topSplitter.SplitHorizontally(self.image_panel, self.widget_panel,sashPosition=self.gui_size[1]*0.83)#0.9",
    "topSplitter.SetSashGravity(1)",
    "sizer = wx.BoxSizer(wx.VERTICAL)",
    "sizer.Add(topSplitter, 1, wx.EXPAND)",
    "self.SetSizer(sizer)",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0,10), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=10)",
    "Add all the options",
    "line = wx.StaticLine(self)",
    "self.sizer.Add(line, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=10)",
    "",
    "self.multi_choice.Bind(wx.EVT_CHECKBOX,self.activate_copy_videos)",
    "Hide the button as this is not the default option",
    "self.vids.Enable(False)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "self.yes.Enable(False)",
    "self.no.Enable(False)",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.buttonCounter = []",
    "self.bodyparts = []",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "convert the image to RGB as you are showing the image with matplotlib",
    "draw epipolar lines",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.filelist = self.filelist + self.vids",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "convert the image to RGB as you are showing the image with matplotlib",
    "draw epipolar lines",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "checks for unique bodyparts",
    "Reading the existing dataset,if already present",
    "Handle data previously labeled on a different platform",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Cache original bodyparts",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Rearrange bodypart columns in config order",
    "Test whether there are missing frames and superfluous data",
    "Check whether new individuals or body parts were added",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Discard data associated with bodyparts that are no longer in the config",
    "Re-organize the dataframe so the CSV looks consistent with the config",
    "restore the background region",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.build = wx.Button(self, label=\"Build skeleton\")",
    "sizer.Add(self.build, pos=(4, 3), flag=wx.BOTTOM | wx.RIGHT, border=10)",
    "self.build.Bind(wx.EVT_BUTTON, self.build_skeleton)",
    "self.build.Enable(True)",
    "def build_skeleton(self, event):",
    "skeleton.SkeletonBuilder(self.config)",
    "Settting the GUI size and panels design",
    "Checks if zoom/pan button is ON",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "Read the pose config file",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "def video_tracklets(self,event):",
    "shuffle = self.shuffle.GetValue()",
    "trainingsetindex = self.trainingset.GetValue()",
    "deeplabcut.create_video_from_pickled_tracks(self.filelist, picklefile, pcutoff=0.6)",
    "self.select_destfolder.SetPath(\"None\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.shuffles.SetValue(\"1\")",
    "DownSampleVideo(vname,width=-1,height=200,outsuffix='downsampled',outpath=None,rotatecw=False):",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "majorDimension=0,",
    "self.videotype.SetStringSelection(\".avi\")",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "Overwrite the config-defined individual names",
    "with those actually present in the annotated data",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "if self.plot_scoremaps.GetStringSelection() == \"Yes\":",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "shuffle = self.shuffle.GetValue()",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "self.cfg = auxiliaryfunctions.read_config(config)",
    "self.statusbar.SetStatusText(\"\")",
    "dlg = wx.MessageDialog(None,\"Are you sure?\", \"Quit!\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_YES:",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0, 4), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=5)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "## dlcnet_ms5: backbone resnet50 + multi-fusion & multi-stage module",
    "## dlcr101_ms5/dlcr152_ms5: backbone resnet101/152 + multi-fusion & multi-stage module",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Disable the prediction of PAFs if the graph is empty",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Search a pose_config.yaml file to parse missing information",
    "Clean the training-datasets folder prior to recreating the data pickles",
    "Load updated lists:",
    "Find the corresponding video file",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Determine the index length required to guarantee",
    "the train\u2013test ratio is exactly the desired one.",
    "Pad indices so lengths agree",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "sort the models directories",
    "get the shuffle index",
    "read cfg file",
    "create log file",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "from skimage.io import imread",
    "frame=imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: addd cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: If dataname line above is changed then line below is obsolete?",
    "trackname = trackname.replace(videofolder, destfolder)",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Get animal IDs and corresponding indices in the arrays of detections",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Only 1 animal, let us return the full graph indices only",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Covariance matrix estimation fails due to numerical singularities",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Mark the unique body parts as assembled anyway so",
    "they are not used later on to fill assemblies.",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "Spawning (rather than forking) multiple processes does not",
    "work nicely with the GUI or interactive sessions.",
    "In that case, we fall back to the serial assembly.",
    "Swap corresponding keypoints",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "Sort matching score (OKS) in descending order of assembly affinity",
    "Guarantee precision decreases monotonically",
    "See https://jonathan-hui.medium.com/map-mean-average-precision-for-object-detection-45c121a31173)",
    "define constant velocity model",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "Reset tracker IDs",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "TODO Try particle filter (since we already have the keypoints)",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "filter out matched with low IOU",
    "get predicted locations from existing trackers.",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "TODO: get cropping parameters and utilize!",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "If a string was passed in, auto-convert to True for backward compatibility",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Handle data previously annotated on a different platform",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Ignore best edges possibly defined during a prior evaluation",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Form 2D array of shape (n_rows, 4) where the last dimension",
    "is (sample_index, peak_y, peak_x, bpt_index) to slice the PAFs.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "Clip peak locations to PAFs dimensions",
    "unit_vecs = vecs / lengths[:, np.newaxis]",
    "affinities = np.squeeze(y @ np.expand_dims(unit_vecs, axis=2)).sum(axis=1)",
    "Form cost matrices",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "Multi stage is currently only implemented for resnets",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "FIXME Fix wrong scope with Keras layers",
    "def prediction_layer(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2DTranspose(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=2,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "## New DLCNet Addition: multi-stage decoder",
    "def prediction_layer_stage(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2D(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=1,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "turn into x times y time bs * bpts",
    "extract corresponding locref x and y as well as probability",
    "Filter predicted heatmaps with a 2D Gaussian kernel as in:",
    "https://openaccess.thecvf.com/content_CVPR_2020/papers/Huang_The_Devil_Is_in_the_Details_Delving_Into_Unbiased_Data_CVPR_2020_paper.pdf",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Clamp to 40% of crop size to ensure that at least",
    "the center keypoint remains visible after the offset is applied.",
    "Points located close to one another are sampled preferentially",
    "in order to augment crowded regions.",
    "Include keypoints in the count to avoid null probabilities",
    "Shift the crop center in both dimensions by random amounts",
    "and normalize to the original image dimensions.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "Add smart, keypoint-aware image cropping",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "Discard keypoints whose coordinates lie outside the cropped image",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "imageio.imwrite(data_items[i].im_path.split('/')[-1],im)",
    "Produce score maps and location refinement fields",
    "Find indices of individuals in joint_id",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "TODO Finish implementing actual abstract class",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "net_type = \"mobilenet_v2_0.35\"",
    "net_type = \"efficientnet-b0\"  # to -b6",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "NET = \"dlcr101_ms5\"",
    "NET = \"resnet_152\"",
    "NET = \"efficientnet-b0\"",
    "NET = \"mobilenet_v2_0.35\" # should be fixed",
    "\"multi_step\": [[0.001, N_ITER]],",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "for EfficientNet",
    "imgaug",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "Test bounding box from a single keypoint",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Guarantee that images smaller than crop size are handled fine",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Disable stochastic scale jitter",
    "Verify the aspect ratio is preserved",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "Test flipped keypoints",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID.",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-"
  ],
  "v2.2.0": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "def install(package):",
    "subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", package])",
    "install(\"tensorflow==1.13.1\")",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Suppress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / all require TF",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "Create the pose_config.yaml files",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "TODO Avoid looping over all pairs of tracklets",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Default to the distance cost function",
    "Add in identity weighing before building the graph",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "Historically DLC used: from scipy.misc import imread, imresize >> deprecated functions",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (indivdual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "Keep only the individuals and bodyparts that were labeled",
    "Either display the animals defined in the config if they are found",
    "in the dataframe, or all the trajectories regardless of their names",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "self.save.Enable(False)",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "topSplitter = wx.SplitterWindow(self)",
    "",
    "self.image_panel = ImagePanel(topSplitter, config,video,shuffle,Dataframe,self.gui_size)",
    "self.widget_panel = WidgetPanel(topSplitter)",
    "",
    "topSplitter.SplitHorizontally(self.image_panel, self.widget_panel,sashPosition=self.gui_size[1]*0.83)#0.9",
    "topSplitter.SetSashGravity(1)",
    "sizer = wx.BoxSizer(wx.VERTICAL)",
    "sizer.Add(topSplitter, 1, wx.EXPAND)",
    "self.SetSizer(sizer)",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0,10), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=10)",
    "Add all the options",
    "line = wx.StaticLine(self)",
    "self.sizer.Add(line, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=10)",
    "",
    "self.multi_choice.Bind(wx.EVT_CHECKBOX,self.activate_copy_videos)",
    "Hide the button as this is not the default option",
    "self.vids.Enable(False)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "self.yes.Enable(False)",
    "self.no.Enable(False)",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.buttonCounter = []",
    "self.bodyparts = []",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "draw epipolar lines",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.filelist = self.filelist + self.vids",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "im = cv2.imread(img)",
    "convert the image to RGB as you are showing the image with matplotlib",
    "draw epipolar lines",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "checks for unique bodyparts",
    "Reading the existing dataset,if already present",
    "Handle data previously labeled on a different platform",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Cache original bodyparts",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Rearrange bodypart columns in config order",
    "Test whether there are missing frames and superfluous data",
    "Check whether new individuals or body parts were added",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Discard data associated with bodyparts that are no longer in the config",
    "Re-organize the dataframe so the CSV looks consistent with the config",
    "restore the background region",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.build = wx.Button(self, label=\"Build skeleton\")",
    "sizer.Add(self.build, pos=(4, 3), flag=wx.BOTTOM | wx.RIGHT, border=10)",
    "self.build.Bind(wx.EVT_BUTTON, self.build_skeleton)",
    "self.build.Enable(True)",
    "def build_skeleton(self, event):",
    "skeleton.SkeletonBuilder(self.config)",
    "Settting the GUI size and panels design",
    "Checks if zoom/pan button is ON",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "Read the pose config file",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "def video_tracklets(self,event):",
    "shuffle = self.shuffle.GetValue()",
    "trainingsetindex = self.trainingset.GetValue()",
    "deeplabcut.create_video_from_pickled_tracks(self.filelist, picklefile, pcutoff=0.6)",
    "self.select_destfolder.SetPath(\"None\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.shuffles.SetValue(\"1\")",
    "DownSampleVideo(vname,width=-1,height=200,outsuffix='downsampled',outpath=None,rotatecw=False):",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "majorDimension=0,",
    "self.videotype.SetStringSelection(\".avi\")",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "Overwrite the config-defined individual names",
    "with those actually present in the annotated data",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "if self.plot_scoremaps.GetStringSelection() == \"Yes\":",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "shuffle = self.shuffle.GetValue()",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "self.cfg = auxiliaryfunctions.read_config(config)",
    "self.statusbar.SetStatusText(\"\")",
    "dlg = wx.MessageDialog(None,\"Are you sure?\", \"Quit!\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_YES:",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0, 4), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=5)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "## dlcnet_ms5: backbone resnet50 + multi-fusion & multi-stage module",
    "## dlcr101_ms5/dlcr152_ms5: backbone resnet101/152 + multi-fusion & multi-stage module",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Search a pose_config.yaml file to parse missing information",
    "Clean the training-datasets folder prior to recreating the data pickles",
    "Load updated lists:",
    "Find the corresponding video file",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Determine the index length required to guarantee",
    "the train\u2013test ratio is exactly the desired one.",
    "Pad indices so lengths agree",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "sort the models directories",
    "get the shuffle index",
    "read cfg file",
    "create log file",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "from skimage.io import imread",
    "frame=imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: addd cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: If dataname line above is changed then line below is obsolete?",
    "trackname = trackname.replace(videofolder, destfolder)",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "print(\"If the tracking is not satisfactory for some videos, consider expanding the training set. You can use the function 'extract_outlier_frames' to extract any outlier frames!\")",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Get animal IDs and corresponding indices in the arrays of detections",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Only 1 animal, let us return the full graph indices only",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Covariance matrix estimation fails due to numerical singularities",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Mark the unique body parts as assembled anyway so",
    "they are not used later on to fill assemblies.",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "Spawning (rather than forking) multiple processes does not",
    "work nicely with the GUI or interactive sessions.",
    "In that case, we fall back to the serial assembly.",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "define constant velocity model",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "Reset tracker IDs",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "TODO Try particle filter (since we already have the keypoints)",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "filter out matched with low IOU",
    "get predicted locations from existing trackers.",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "TODO: get cropping parameters and utilize!",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Handle data previously annotated on a different platform",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Ignore best edges possibly defined during a prior evaluation",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Form 2D array of shape (n_rows, 4) where the last dimension",
    "is (sample_index, peak_y, peak_x, bpt_index) to slice the PAFs.",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "Clip peak locations to PAFs dimensions",
    "unit_vecs = vecs / lengths[:, np.newaxis]",
    "affinities = np.squeeze(y @ np.expand_dims(unit_vecs, axis=2)).sum(axis=1)",
    "Form cost matrices",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "Multi stage is currently only implemented for resnets",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "FIXME Fix wrong scope with Keras layers",
    "def prediction_layer(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2DTranspose(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=2,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "## New DLCNet Addition: multi-stage decoder",
    "def prediction_layer_stage(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2D(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=1,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "turn into x times y time bs * bpts",
    "extract corresponding locref x and y as well as probability",
    "Filter predicted heatmaps with a 2D Gaussian kernel as in:",
    "https://openaccess.thecvf.com/content_CVPR_2020/papers/Huang_The_Devil_Is_in_the_Details_Delving_Into_Unbiased_Data_CVPR_2020_paper.pdf",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Clamp to 40% of crop size to ensure that at least",
    "the center keypoint remains visible after the offset is applied.",
    "Points located close to one another are sampled preferentially",
    "in order to augment crowded regions.",
    "Include keypoints in the count to avoid null probabilities",
    "Shift the crop center in both dimensions by random amounts",
    "and normalize to the original image dimensions.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "Add smart, keypoint-aware image cropping",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "Discard keypoints whose coordinates lie outside the cropped image",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "imageio.imwrite(data_items[i].im_path.split('/')[-1],im)",
    "Produce score maps and location refinement fields",
    "Find indices of individuals in joint_id",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "TODO Finish implementing actual abstract class",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "net_type = \"mobilenet_v2_0.35\"",
    "net_type = \"efficientnet-b0\"  # to -b6",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "NET = \"dlcrnet_ms5\"",
    "NET = \"resnet_152\"",
    "NET = \"efficientnet-b0\"",
    "NET = \"mobilenet_v2_0.35\" # should be fixed",
    "\"multi_step\": [[0.001, N_ITER]],",
    "Copy over meaningful tracklets to test stitching",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "for EfficientNet",
    "imgaug",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Guarantee that images smaller than crop size are handled fine",
    "Ensure at least a keypoint is visible in each crop",
    "Test passing in a batch of frames",
    "Verify the aspect ratio is preserved",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID."
  ],
  "v2.2rc3": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "def install(package):",
    "subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", package])",
    "install(\"tensorflow==1.13.1\")",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Suppress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / all require TF",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "Create the pose_config.yaml files",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "TODO Avoid looping over all pairs of tracklets",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Default to the distance cost function",
    "Add in identity weighing before building the graph",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "Historically DLC used: from scipy.misc import imread, imresize >> deprecated functions",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (indivdual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "Keep only the individuals and bodyparts that were labeled",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "self.save.Enable(False)",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "topSplitter = wx.SplitterWindow(self)",
    "",
    "self.image_panel = ImagePanel(topSplitter, config,video,shuffle,Dataframe,self.gui_size)",
    "self.widget_panel = WidgetPanel(topSplitter)",
    "",
    "topSplitter.SplitHorizontally(self.image_panel, self.widget_panel,sashPosition=self.gui_size[1]*0.83)#0.9",
    "topSplitter.SetSashGravity(1)",
    "sizer = wx.BoxSizer(wx.VERTICAL)",
    "sizer.Add(topSplitter, 1, wx.EXPAND)",
    "self.SetSizer(sizer)",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0,10), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=10)",
    "Add all the options",
    "line = wx.StaticLine(self)",
    "self.sizer.Add(line, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=10)",
    "",
    "self.multi_choice.Bind(wx.EVT_CHECKBOX,self.activate_copy_videos)",
    "Hide the button as this is not the default option",
    "self.vids.Enable(False)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "self.yes.Enable(False)",
    "self.no.Enable(False)",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.buttonCounter = []",
    "self.bodyparts = []",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "draw epipolar lines",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.filelist = self.filelist + self.vids",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "im = cv2.imread(img)",
    "convert the image to RGB as you are showing the image with matplotlib",
    "draw epipolar lines",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "checks for unique bodyparts",
    "Reading the existing dataset,if already present",
    "Handle data previously labeled on a different platform",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Cache original bodyparts",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Rearrange bodypart columns in config order",
    "Test whether there are missing frames and superfluous data",
    "Check whether new individuals or body parts were added",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Discard data associated with bodyparts that are no longer in the config",
    "Re-organize the dataframe so the CSV looks consistent with the config",
    "restore the background region",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.build = wx.Button(self, label=\"Build skeleton\")",
    "sizer.Add(self.build, pos=(4, 3), flag=wx.BOTTOM | wx.RIGHT, border=10)",
    "self.build.Bind(wx.EVT_BUTTON, self.build_skeleton)",
    "self.build.Enable(True)",
    "def build_skeleton(self, event):",
    "skeleton.SkeletonBuilder(self.config)",
    "Settting the GUI size and panels design",
    "Checks if zoom/pan button is ON",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "Read the pose config file",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "def video_tracklets(self,event):",
    "shuffle = self.shuffle.GetValue()",
    "trainingsetindex = self.trainingset.GetValue()",
    "deeplabcut.create_video_from_pickled_tracks(self.filelist, picklefile, pcutoff=0.6)",
    "self.select_destfolder.SetPath(\"None\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.shuffles.SetValue(\"1\")",
    "DownSampleVideo(vname,width=-1,height=200,outsuffix='downsampled',outpath=None,rotatecw=False):",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "majorDimension=0,",
    "self.videotype.SetStringSelection(\".avi\")",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "Overwrite the config-defined individual names",
    "with those actually present in the annotated data",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "if self.plot_scoremaps.GetStringSelection() == \"Yes\":",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "shuffle = self.shuffle.GetValue()",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "self.cfg = auxiliaryfunctions.read_config(config)",
    "self.statusbar.SetStatusText(\"\")",
    "dlg = wx.MessageDialog(None,\"Are you sure?\", \"Quit!\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_YES:",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0, 4), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=5)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "utility function to split different crops from same image into either train or test!",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Loading the encoder (if necessary downloading from TF)",
    "Map back to the original indices.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Load updated lists:",
    "Find the corresponding video file",
    "Avoid cropping already cropped images",
    "initialize a all zero image container with target crop size",
    "new upper left, border protection",
    "be careful crop side can be smaller than one side of the image",
    "new bottom right, border protection",
    "avoid to exceed the container's border",
    "fill original image to the container image",
    "use safe upper left and bottom right to crop original image and fill it to the container",
    "all keypoints are shifted by +x0 and +y0",
    "possibly out of border again",
    "some keypoints are out of the borders",
    "save the padded img",
    "moving old entry to _original, dropping it from video_set and update crop parameters",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Determine the index length required to guarantee",
    "the train\u2013test ratio is exactly the desired one.",
    "Pad indices so lengths agree",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "Now that the training fraction is guaranteed to be correct,",
    "the values added to pad the indices are removed.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "sort the models directories",
    "get the shuffle index",
    "read cfg file",
    "create log file",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "Re-use data-driven PAF graph for video analysis. Note that this must",
    "happen after setting up the TF session to avoid graph mismatch.",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "from skimage.io import imread",
    "frame=imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: addd cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: If dataname line above is changed then line below is obsolete?",
    "trackname = trackname.replace(videofolder, destfolder)",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "print(\"If the tracking is not satisfactory for some videos, consider expanding the training set. You can use the function 'extract_outlier_frames' to extract any outlier frames!\")",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "initializing constants",
    "PredicteData['frame'+str(counter)]=predict.get_detectionswithcosts(frame, dlc_cfg, sess, inputs, outputs, outall=False,nms_radius=dlc_cfg.nmsradius,det_min_score=dlc_cfg.minconfidence)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "PredicteData[batch_num*batchsize:batch_num*batchsize+batch_ind, :] = pose[:batch_ind,:]",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Sort crop patches to maximize the probability they overlap with others",
    "Form the ground truth back",
    "Match detections across crops",
    "Store the costs associated with the retained candidates",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Only 1 animal, let us return the full graph indices only",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Covariance matrix estimation fails due to numerical singularities",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "Spawning (rather than forking) multiple processes does not",
    "work nicely with the GUI or interactive sessions.",
    "In that case, we fall back to the serial assembly.",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "define constant velocity model",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "Reset tracker IDs",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "TODO Try particle filter (since we already have the keypoints)",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "filter out matched with low IOU",
    "get predicted locations from existing trackers.",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "TODO: get cropping parameters and utilize!",
    "openmp_arg = '-fopenmp'",
    "if _platform == \"win32\":",
    "openmp_arg = '-openmp'",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Handle data previously annotated on a different platform",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "print(dlc_cfg)",
    "Specifying state of model (snapshot / training state)",
    "Evaluate PAF edge lengths to calibrate `distnorm`",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "For OKS/PCK, compute the standard deviation error across all frames",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "returning to intial folder",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "get coordinates for bp1 and bp2",
    "'m2'",
    "distscalarproduct=np.zeros((len(C1),len(C2)))*np.nan",
    "distscalarproduct[c1i,c2i]=dy*v[1]+dx*v[0] #scalar product [v unit vector dx,dy in pixel coordinats from partaffinitymap]",
    "Distances[l]['m2'] = distscalarproduct",
    "TODO: compute all the grids etc. once for the video analysis method",
    "(and then just pass on the variables)",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "These two functions are for evaluation specifically (one also calculates integral between gt points)",
    "get dist_grid",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "if 'eval_scale' in cfg.keys():",
    "import imgaug.augmenters as iaa",
    "im = iaa.Resize(float(cfg['eval_scale']))(images=im)",
    "# Functions below implement are for batch sizes > 1:",
    "get dist_grid",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "batchsize,ny,nx,num_joints = scmap.shape",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "Multi stage is currently only implemented for resnets",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "FIXME Fix wrong scope with Keras layers",
    "def prediction_layer(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2DTranspose(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=2,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "## New DLCNet Addition: multi-stage decoder",
    "def prediction_layer_stage(cfg, input, name, num_outputs):",
    "with tf.compat.v1.variable_scope(name):",
    "layer = tf.keras.layers.Conv2D(",
    "filters=num_outputs,",
    "kernel_size=(3, 3),",
    "strides=1,",
    "padding=\"same\",",
    "kernel_regularizer=tf.keras.regularizers.l2(0.5 * (cfg['weight_decay'])),",
    "name=name,",
    "dtype=input.dtype.base_dtype,",
    ")",
    "return layer(input)",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "turn into x times y time bs * bpts",
    "extract corresponding locref x and y as well as probability",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "assert len(batch_images) == self.batch_size",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "imageio.imwrite(data_items[i].im_path.split('/')[-1],im)",
    "if returndata:",
    "return batch_images,batch_joints,targetmaps",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Find indices of individuals in joint_id",
    "if self.cfg.partaffinityfield_predict:",
    "print(\"hello\",joint_id)",
    "print(np.concatenate(joint_id)) #this is all joint_ids for all individuals!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "TODO Finish implementing actual abstract class",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "net_type = \"mobilenet_v2_0.35\"",
    "net_type = \"efficientnet-b0\"  # to -b6",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "NET = \"resnet_152\"",
    "NET = \"efficientnet-b0\"",
    "NET = \"mobilenet_v2_0.35\" # should be fixed",
    "\"multi_step\": [[0.001, N_ITER]],",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "for EfficientNet",
    "imgaug",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "Verify the aspect ratio is preserved",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID."
  ],
  "2.2rc2": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Suppress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / all require TF",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "Create the pose_config.yaml files",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "TODO Avoid looping over all pairs of tracklets",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Rebuild a full graph from the remaining nodes without",
    "temporal constraint on what tracklets can be stitched together.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Default to the distance cost function",
    "Add in identity weighing before building the graph",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "Historically DLC used: from scipy.misc import imread, imresize >> deprecated functions",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (indivdual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "Keep only the individuals and bodyparts that were labeled",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "self.save.Enable(False)",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "topSplitter = wx.SplitterWindow(self)",
    "",
    "self.image_panel = ImagePanel(topSplitter, config,video,shuffle,Dataframe,self.gui_size)",
    "self.widget_panel = WidgetPanel(topSplitter)",
    "",
    "topSplitter.SplitHorizontally(self.image_panel, self.widget_panel,sashPosition=self.gui_size[1]*0.83)#0.9",
    "topSplitter.SetSashGravity(1)",
    "sizer = wx.BoxSizer(wx.VERTICAL)",
    "sizer.Add(topSplitter, 1, wx.EXPAND)",
    "self.SetSizer(sizer)",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0,10), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=10)",
    "Add all the options",
    "line = wx.StaticLine(self)",
    "self.sizer.Add(line, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=10)",
    "",
    "self.multi_choice.Bind(wx.EVT_CHECKBOX,self.activate_copy_videos)",
    "Hide the button as this is not the default option",
    "self.vids.Enable(False)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "self.yes.Enable(False)",
    "self.no.Enable(False)",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.buttonCounter = []",
    "self.bodyparts = []",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "draw epipolar lines",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.filelist = self.filelist + self.vids",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "im = cv2.imread(img)",
    "convert the image to RGB as you are showing the image with matplotlib",
    "draw epipolar lines",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "checks for unique bodyparts",
    "Reading the existing dataset,if already present",
    "Handle data previously labeled on a different platform",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Cache original bodyparts",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Rearrange bodypart columns in config order",
    "Test whether there are missing frames and superfluous data",
    "Check whether new individuals or body parts were added",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Discard data associated with bodyparts that are no longer in the config",
    "Re-organize the dataframe so the CSV looks consistent with the config",
    "restore the background region",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.build = wx.Button(self, label=\"Build skeleton\")",
    "sizer.Add(self.build, pos=(4, 3), flag=wx.BOTTOM | wx.RIGHT, border=10)",
    "self.build.Bind(wx.EVT_BUTTON, self.build_skeleton)",
    "self.build.Enable(True)",
    "def build_skeleton(self, event):",
    "skeleton.SkeletonBuilder(self.config)",
    "Settting the GUI size and panels design",
    "Checks if zoom/pan button is ON",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "Read the pose config file",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "def video_tracklets(self,event):",
    "shuffle = self.shuffle.GetValue()",
    "trainingsetindex = self.trainingset.GetValue()",
    "deeplabcut.create_video_from_pickled_tracks(self.filelist, picklefile, pcutoff=0.6)",
    "self.select_destfolder.SetPath(\"None\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.shuffles.SetValue(\"1\")",
    "DownSampleVideo(vname,width=-1,height=200,outsuffix='downsampled',outpath=None,rotateccw=False):",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "majorDimension=0,",
    "self.videotype.SetStringSelection(\".avi\")",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "Overwrite the config-defined individual names",
    "with those actually present in the annotated data",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "if self.plot_scoremaps.GetStringSelection() == \"Yes\":",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "shuffle = self.shuffle.GetValue()",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "self.cfg = auxiliaryfunctions.read_config(config)",
    "self.statusbar.SetStatusText(\"\")",
    "dlg = wx.MessageDialog(None,\"Are you sure?\", \"Quit!\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_YES:",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0, 4), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=5)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "utility function to split different crops from same image into either train or test!",
    "Ignore possible connections between 'multi' and 'unique' body parts;",
    "one can never be too careful...",
    "Loading the encoder (if necessary downloading from TF)",
    "Map back to the original indices.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Load updated lists:",
    "Find the corresponding video file",
    "Avoid cropping already cropped images",
    "moving old entry to _original, dropping it from video_set and update crop parameters",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Blazing fast and does not load the image into memory",
    "Check that points lie within the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "sort the models directories",
    "get the shuffle index",
    "read cfg file",
    "create log file",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "Re-use data-driven PAF graph for video analysis. Note that this must",
    "happen after setting up the TF session to avoid graph mismatch.",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "from skimage.io import imread",
    "frame=imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: addd cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: this can be used if only a subset is relevant. I.e. [0,1] for only first and second joint!",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Optimal identity assignment based on soft voting",
    "print(\"If the tracking is not satisfactory for some videos, consider expanding the training set. You can use the function 'extract_outlier_frames' to extract any outlier frames!\")",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Dependencies for anaysis",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Handle data previously annotated on a different platform",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "print(dlc_cfg)",
    "Specifying state of model (snapshot / training state)",
    "Evaluate PAF edge lengths to calibrate `distnorm`",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "For OKS/PCK, compute the standard deviation error across all frames",
    "Skip data-driven skeleton selection unless",
    "the model was trained on the full graph.",
    "returning to intial folder",
    "loading backbone from ResNet, MobileNet etc.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "from deeplabcut.pose_estimation_tensorflow.predict_multianimal import convert_detections2tracklet",
    "initializing constants",
    "PredicteData['frame'+str(counter)]=predict.get_detectionswithcosts(frame, dlc_cfg, sess, inputs, outputs, outall=False,nms_radius=dlc_cfg.nmsradius,det_min_score=dlc_cfg.minconfidence)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "PredicteData[batch_num*batchsize:batch_num*batchsize+batch_ind, :] = pose[:batch_ind,:]",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Sort crop patches to maximize the probability they overlap with others",
    "Form the ground truth back",
    "Match detections across crops",
    "Store the costs associated with the retained candidates",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "define constant velocity model",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "Reset tracker IDs",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "TODO Try particle filter (since we already have the keypoints)",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "filter out matched with low IOU",
    "get predicted locations from existing trackers.",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "TODO: get cropping parameters and utilize!",
    "openmp_arg = '-fopenmp'",
    "if _platform == \"win32\":",
    "openmp_arg = '-openmp'",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "setting pairwise bodypart loss",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "print(end_points.keys()) >> to see what else is available.",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "setting pairwise bodypart loss",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "class TpuBatchNormalization(tf.layers.BatchNormalization):",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "Clear the old folder.",
    "Write checkpoints.",
    "Update the best objective.",
    "We maintain mva for batch norm moving mean and variance as well.",
    "Return the top 5 predictions (idx and prob) for each image.",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "## New DLCNet Addition: multi-stage decoder",
    "standard stride 2 decoder",
    "Multi stage is currently only implemented for resnets",
    "The next part of the code depends upon the tensorflow version",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "return self.prediction_layers(net, end_points)",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "from nets.mobilenet import conv_blocks as ops",
    "from nets.mobilenet import mobilenet as lib",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "The next part of the code depends upon which tensorflow version you have.",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "setting pairwise bodypart loss",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "get coordinates for bp1 and bp2",
    "'m2'",
    "distscalarproduct=np.zeros((len(C1),len(C2)))*np.nan",
    "distscalarproduct[c1i,c2i]=dy*v[1]+dx*v[0] #scalar product [v unit vector dx,dy in pixel coordinats from partaffinitymap]",
    "Distances[l]['m2'] = distscalarproduct",
    "TODO: compute all the grids etc. once for the video analysis method",
    "(and then just pass on the variables)",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "These two functions are for evaluation specifically (one also calculates integral between gt points)",
    "get dist_grid",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "if 'eval_scale' in cfg.keys():",
    "import imgaug.augmenters as iaa",
    "im = iaa.Resize(float(cfg['eval_scale']))(images=im)",
    "# Functions below implement are for batch sizes > 1:",
    "get dist_grid",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "batchsize,ny,nx,num_joints = scmap.shape",
    "Augmentation functions",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "assert len(batch_images) == self.batch_size",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "imageio.imwrite(data_items[i].im_path.split('/')[-1],im)",
    "if returndata:",
    "return batch_images,batch_joints,targetmaps",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "print(person_id,joint_ids,data_item.im_path.split('/')[-1])",
    "if self.cfg.partaffinityfield_predict:",
    "print(\"hello\",joint_id)",
    "print(np.concatenate(joint_id)) #this is all joint_ids for all individuals!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "plt.savefig(\"along\"+str(data_item.im_path.split('/')[-1]))",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "print(person_id,k, j_id, coords[0])",
    "assert(0==1)",
    "A[:,:,2]=partaffinityfield_map[:,:,j]*0",
    "A[:,:,2]=partaffinityfield_map[:,:,j]*0",
    "plt.savefig(\"SomePafs\"+str(data_item.im_path.split('/')[-1]))",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "from scipy.misc import imread, imresize",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "from scipy.misc import imread, imresize",
    "from dataset.pose_dataset import Batch, data_to_input, mirror_joints_map, CropImage, DataItem",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "net_type = \"mobilenet_v2_0.35\"",
    "net_type = \"efficientnet-b0\"  # to -b6",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "NET = \"resnet_152\"",
    "NET = \"efficientnet-b0\"",
    "NET = \"mobilenet_v2_0.35\" # should be fixed",
    "\"multi_step\": [[0.001, N_ITER]],",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "for EfficientNet",
    "imgaug",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "Verify the aspect ratio is preserved",
    "Break the graph to test stitching failure",
    "Add fake IDs",
    "Split all tracklets in half",
    "Assemble based on the smallest graph to speed up testing",
    "Generate fake identity predictions",
    "Assemble based on the smallest graph to speed up testing",
    "Test now with identity only and ensure assemblies",
    "contain only parts of a single group ID."
  ],
  "v2.2rc1": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Suppress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / all require TF",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "Create the pose_config.yaml files",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "TODO Avoid looping over all pairs of tracklets",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Default to the distance cost function",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "Historically DLC used: from scipy.misc import imread, imresize >> deprecated functions",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (indivdual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "Keep only the individuals and bodyparts that were labeled",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "if \"MULTI!\" in allbpts:",
    "Ensure same order as in config.yaml",
    "ABBREVIATE NETWORK NAMES -- esp. for mobilenet!",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "self.save.Enable(False)",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "topSplitter = wx.SplitterWindow(self)",
    "",
    "self.image_panel = ImagePanel(topSplitter, config,video,shuffle,Dataframe,self.gui_size)",
    "self.widget_panel = WidgetPanel(topSplitter)",
    "",
    "topSplitter.SplitHorizontally(self.image_panel, self.widget_panel,sashPosition=self.gui_size[1]*0.83)#0.9",
    "topSplitter.SetSashGravity(1)",
    "sizer = wx.BoxSizer(wx.VERTICAL)",
    "sizer.Add(topSplitter, 1, wx.EXPAND)",
    "self.SetSizer(sizer)",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0,10), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=10)",
    "Add all the options",
    "line = wx.StaticLine(self)",
    "self.sizer.Add(line, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=10)",
    "",
    "self.multi_choice.Bind(wx.EVT_CHECKBOX,self.activate_copy_videos)",
    "Hide the button as this is not the default option",
    "self.vids.Enable(False)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "self.yes.Enable(False)",
    "self.no.Enable(False)",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.buttonCounter = []",
    "self.bodyparts = []",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "draw epipolar lines",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.filelist = self.filelist + self.vids",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "im = cv2.imread(img)",
    "convert the image to RGB as you are showing the image with matplotlib",
    "draw epipolar lines",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "checks for unique bodyparts",
    "Reading the existing dataset,if already present",
    "Handle data previously labeled on a different platform",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Cache original bodyparts",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Rearrange bodypart columns in config order",
    "Test whether there are missing frames and superfluous data",
    "Check whether new labels were added",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Discard data associated with bodyparts that are no longer in the config",
    "Re-organize the dataframe so the CSV looks consistent with the config",
    "restore the background region",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.build = wx.Button(self, label=\"Build skeleton\")",
    "sizer.Add(self.build, pos=(4, 3), flag=wx.BOTTOM | wx.RIGHT, border=10)",
    "self.build.Bind(wx.EVT_BUTTON, self.build_skeleton)",
    "self.build.Enable(True)",
    "def build_skeleton(self, event):",
    "skeleton.SkeletonBuilder(self.config)",
    "Settting the GUI size and panels design",
    "Checks if zoom/pan button is ON",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "Read the pose config file",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "def video_tracklets(self,event):",
    "shuffle = self.shuffle.GetValue()",
    "trainingsetindex = self.trainingset.GetValue()",
    "deeplabcut.create_video_from_pickled_tracks(self.filelist, picklefile, pcutoff=0.6)",
    "self.select_destfolder.SetPath(\"None\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.shuffles.SetValue(\"1\")",
    "DownSampleVideo(vname,width=-1,height=200,outsuffix='downsampled',outpath=None,rotateccw=False):",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "majorDimension=0,",
    "self.videotype.SetStringSelection(\".avi\")",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "if self.plot_scoremaps.GetStringSelection() == \"Yes\":",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "shuffle = self.shuffle.GetValue()",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "self.cfg = auxiliaryfunctions.read_config(config)",
    "self.statusbar.SetStatusText(\"\")",
    "dlg = wx.MessageDialog(None,\"Are you sure?\", \"Quit!\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_YES:",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0, 4), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=5)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "actualbpts=set(Data.columns.get_level_values(0))",
    "utility function to split different crops from same image into either train or test!",
    "loading & linking pretrained models",
    "CURRENTLY ONLY ResNet supported!",
    "multianimal case:",
    "Automatically form a complete PAF graph",
    "Loading the encoder (if necessary downloading from TF)",
    "Map back to the original indices.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "if socialbdpt in actualbpts:",
    "if socialbdpt in actualbpts:",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Load updated lists:",
    "Find the corresponding video file",
    "Avoid cropping already cropped images",
    "moving old entry to _original, dropping it from video_set and update crop parameters",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Check that points lie within the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "sort the models directories",
    "get the shuffle index",
    "read cfg file",
    "create log file",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "sess, inputs, outputs = predict.setup_pose_prediction(dlc_cfg)",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "Re-use data-driven PAF graph for video analysis. Note that this must",
    "happen after setting up the TF session to avoid graph mismatch.",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "from skimage.io import imread",
    "frame=imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: addd cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: this can be used if only a subset is relevant. I.e. [0,1] for only first and second joint!",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "print(\"If the tracking is not satisfactory for some videos, consider expanding the training set. You can use the function 'extract_outlier_frames' to extract any outlier frames!\")",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Dependencies for anaysis",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Handle data previously annotated on a different platform",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "print(dlc_cfg)",
    "Specifying state of model (snapshot / training state)",
    "Evaluate PAF edge lengths to calibrate `distnorm`",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "For OKS/PCK, compute the standard deviation error across all frames",
    "Data-driven skeleton selection",
    "returning to intial folder",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "from deeplabcut.pose_estimation_tensorflow.predict_multianimal import convert_detections2tracklet",
    "initializing constants",
    "PredicteData['frame'+str(counter)]=predict.get_detectionswithcosts(frame, dlc_cfg, sess, inputs, outputs, outall=False,nms_radius=dlc_cfg.nmsradius,det_min_score=dlc_cfg.minconfidence)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "PredicteData[batch_num*batchsize:batch_num*batchsize+batch_ind, :] = pose[:batch_ind,:]",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Sort crop patches to maximize the probability they overlap with others",
    "Form the ground truth back",
    "Match detections across crops",
    "Store the costs associated with the retained candidates",
    "Form ground truth beforehand",
    "Assemble animals on the full set of detections",
    "Count the number of unassembled bodyparts",
    "Handle unlabeled bodyparts...",
    "Find minimal skeleton",
    "Select optimal PAF graph",
    "Selective copy; deepcopy is >5x slower",
    "Only keeps skeletons that are more than 90% complete",
    "TODO Normalize dists by longest length?",
    "TODO Smarter imputation technique (Bayesian? Grassmann averages?)",
    "Correct distance to account for missing observations",
    "Alternatively, reduce contribution of missing values to the Mahalanobis",
    "distance to zero by substituting the corresponding means.",
    "Fill the subsets with unambiguous, complete individuals",
    "Fuse superfluous assemblies",
    "Second pass without edge safety",
    "Store selected edges for subsequent frames",
    "Remove invalid assemblies",
    "Fill assemblies with unconnected body parts",
    "sigma is taken as the median of all COCO keypoint standard deviations",
    "define constant velocity model",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "Reset tracker IDs",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "TODO Try particle filter (since we already have the keypoints)",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "filter out matched with low IOU",
    "get predicted locations from existing trackers.",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "TODO: get cropping parameters and utilize!",
    "openmp_arg = '-fopenmp'",
    "if _platform == \"win32\":",
    "openmp_arg = '-openmp'",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "setting pairwise bodypart loss",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "print(end_points.keys()) >> to see what else is available.",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "setting pairwise bodypart loss",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "class TpuBatchNormalization(tf.layers.BatchNormalization):",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "Clear the old folder.",
    "Write checkpoints.",
    "Update the best objective.",
    "We maintain mva for batch norm moving mean and variance as well.",
    "Return the top 5 predictions (idx and prob) for each image.",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "## New DLCNet Addition: multi-stage decoder",
    "standard stride 2 decoder",
    "Multi stage is currently only implemented for resnets",
    "The next part of the code depends upon the tensorflow version",
    "Defining multi_fusion backbone",
    "Attaching multi-stage decoder",
    "stage_paf_output = stage_paf_output + pre_stage_paf_output",
    "return self.prediction_layers(net, end_points)",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "from nets.mobilenet import conv_blocks as ops",
    "from nets.mobilenet import mobilenet as lib",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "The next part of the code depends upon which tensorflow version you have.",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "setting pairwise bodypart loss",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "get coordinates for bp1 and bp2",
    "'m2'",
    "distscalarproduct=np.zeros((len(C1),len(C2)))*np.nan",
    "distscalarproduct[c1i,c2i]=dy*v[1]+dx*v[0] #scalar product [v unit vector dx,dy in pixel coordinats from partaffinitymap]",
    "Distances[l]['m2'] = distscalarproduct",
    "TODO: compute all the grids etc. once for the video analysis method",
    "(and then just pass on the variables)",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "These two functions are for evaluation specifically (one also calculates integral between gt points)",
    "get dist_grid",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "if 'eval_scale' in cfg.keys():",
    "import imgaug.augmenters as iaa",
    "im = iaa.Resize(float(cfg['eval_scale']))(images=im)",
    "# Functions below implement are for batch sizes > 1:",
    "get dist_grid",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "batchsize,ny,nx,num_joints = scmap.shape",
    "Augmentation functions",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "assert len(batch_images) == self.batch_size",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "imageio.imwrite(data_items[i].im_path.split('/')[-1],im)",
    "if returndata:",
    "return batch_images,batch_joints,targetmaps",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "print(person_id,joint_ids,data_item.im_path.split('/')[-1])",
    "if self.cfg.partaffinityfield_predict:",
    "print(\"hello\",joint_id)",
    "print(np.concatenate(joint_id)) #this is all joint_ids for all individuals!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "plt.savefig(\"along\"+str(data_item.im_path.split('/')[-1]))",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "print(person_id,k, j_id, coords[0])",
    "assert(0==1)",
    "A[:,:,2]=partaffinityfield_map[:,:,j]*0",
    "A[:,:,2]=partaffinityfield_map[:,:,j]*0",
    "plt.savefig(\"SomePafs\"+str(data_item.im_path.split('/')[-1]))",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "from scipy.misc import imread, imresize",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "from scipy.misc import imread, imresize",
    "from dataset.pose_dataset import Batch, data_to_input, mirror_joints_map, CropImage, DataItem",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "net_type = \"mobilenet_v2_0.35\"",
    "net_type = \"efficientnet-b0\"  # to -b6",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "NET = \"efficientnet-b0\"",
    "\"multi_step\": [[0.001, N_ITER]],",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "for EfficientNet",
    "imgaug",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "Verify the aspect ratio is preserved",
    "Break the graph to test stitching failure",
    "Assemble based on the smallest graph to speed up testing"
  ],
  "v2.1.10.4": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Suppress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / all require TF",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "Create the pose_config.yaml files",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "TODO Avoid looping over all pairs of tracklets",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Default to the distance cost function",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "Historically DLC used: from scipy.misc import imread, imresize >> deprecated functions",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "CHECKS if each bpt is connected to at least one other bpt",
    "TODO: check that there is a path leading from each (multi)bpt to each other (multi)bpt!",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "if suffix=='_full': #save metadata!",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (indivdual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "Keep only the individuals and bodyparts that were labeled",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "Ensure same order as in config.yaml",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "NEW ROW:",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "self.save.Enable(False)",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "topSplitter = wx.SplitterWindow(self)",
    "",
    "self.image_panel = ImagePanel(topSplitter, config,video,shuffle,Dataframe,self.gui_size)",
    "self.widget_panel = WidgetPanel(topSplitter)",
    "",
    "topSplitter.SplitHorizontally(self.image_panel, self.widget_panel,sashPosition=self.gui_size[1]*0.83)#0.9",
    "topSplitter.SetSashGravity(1)",
    "sizer = wx.BoxSizer(wx.VERTICAL)",
    "sizer.Add(topSplitter, 1, wx.EXPAND)",
    "self.SetSizer(sizer)",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0,10), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=10)",
    "Add all the options",
    "line = wx.StaticLine(self)",
    "self.sizer.Add(line, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=10)",
    "",
    "self.multi_choice.Bind(wx.EVT_CHECKBOX,self.activate_copy_videos)",
    "Hide the button as this is not the default option",
    "self.vids.Enable(False)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "self.yes.Enable(False)",
    "self.no.Enable(False)",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.buttonCounter = []",
    "self.bodyparts = []",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "draw epipolar lines",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.filelist = self.filelist + self.vids",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "load labeledPoints and fundamental Matrix",
    "Find offset terms for drawing epipolar Lines",
    "Get crop params for camera being labeled",
    "Get crop params for other camera",
    "im = cv2.imread(img)",
    "convert the image to RGB as you are showing the image with matplotlib",
    "draw epipolar lines",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "checks for unique bodyparts",
    "Reading the existing dataset,if already present",
    "Handle data previously labeled on a different platform",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Cache original bodyparts",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Rearrange bodypart columns in config order",
    "Test whether there are missing frames and superfluous data",
    "Check whether new labels were added",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Discard data associated with bodyparts that are no longer in the config",
    "Re-organize the dataframe so the CSV looks consistent with the config",
    "restore the background region",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "Settting the GUI size and panels design",
    "Checks if zoom/pan button is ON",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "Read the pose config file",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "if self.cfg.get(\"multianimalproject\", False):",
    "pass",
    "else:",
    "removing this as several downstream maDLC steps don't support dest_folder at this time:",
    "destfolder_text = wx.StaticBox(self, label=\"Specify destination folder\")",
    "destfolderboxsizer = wx.StaticBoxSizer(destfolder_text, wx.VERTICAL)",
    "self.change_workingdir = wx.CheckBox(",
    "self, label=\"optional destination folder\"",
    ")",
    "self.hbox2.Add(self.change_workingdir)",
    "self.change_workingdir.Bind(wx.EVT_CHECKBOX, self.activate_change_wd)",
    "self.sel_wd = wx.Button(self, label=\"Browse\")",
    "self.sel_wd.Enable(False)",
    "self.sel_wd.Bind(wx.EVT_BUTTON, self.select_destfolder)",
    "self.hbox2.Add(self.sel_wd, 0, wx.ALL, -1)",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "def video_tracklets(self,event):",
    "shuffle = self.shuffle.GetValue()",
    "trainingsetindex = self.trainingset.GetValue()",
    "deeplabcut.create_video_from_pickled_tracks(self.filelist, picklefile, pcutoff=0.6)",
    "self.select_destfolder.SetPath(\"None\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.shuffles.SetValue(\"1\")",
    "DownSampleVideo(vname,width=-1,height=200,outsuffix='downsampled',outpath=None,rotateccw=False):",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "majorDimension=0,",
    "self.videotype.SetStringSelection(\".avi\")",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "if self.plot_scoremaps.GetStringSelection() == \"Yes\":",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "shuffle = self.shuffle.GetValue()",
    "Read from edited inf. file first ...",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "self.cfg = auxiliaryfunctions.read_config(config)",
    "self.statusbar.SetStatusText(\"\")",
    "dlg = wx.MessageDialog(None,\"Are you sure?\", \"Quit!\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_YES:",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0, 4), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=5)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "actualbpts=set(Data.columns.get_level_values(0))",
    "utility function to split different crops from same image into either train or test!",
    "loading & linking pretrained models",
    "CURRENTLY ONLY ResNet supported!",
    "multianimal case:",
    "ATTENTION: order has to be multibodyparts, then uniquebodyparts (for indexing)",
    "Loading the encoder (if necessary downloading from TF)",
    "Map back to the original indices.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "if socialbdpt in actualbpts:",
    "if socialbdpt in actualbpts:",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Load updated lists:",
    "Find the corresponding video file",
    "Avoid cropping already cropped images",
    "moving old entry to _original, dropping it from video_set and update crop parameters",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Check that points lie within the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "sort the models directories",
    "get the shuffle index",
    "read cfg file",
    "create log file",
    "Check for variable correctness",
    "Moviepy:",
    "select crop method",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "sess, inputs, outputs = predict.setup_pose_prediction(dlc_cfg)",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "from skimage.io import imread",
    "frame=imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: addd cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: this can be used if only a subset is relevant. I.e. [0,1] for only first and second joint!",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "Test whether the unique bodyparts have been assembled",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "print(\"If the tracking is not satisfactory for some videos, consider expanding the training set. You can use the function 'extract_outlier_frames' to extract any outlier frames!\")",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Dependencies for anaysis",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "# Also storing one \"large\" table with results:",
    "note: evaluationfolder.parents[0] to get common folder above all shuffle evaluations.",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Handle data previously annotated on a different platform",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "print(dlc_cfg)",
    "Specifying state of model (snapshot / training state)",
    "Evaluate PAF edge lengths to calibrate `distnorm`",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "For OKS/PCK, compute the standard deviation error across all frames",
    "returning to intial folder",
    "wild guesses for a wide range:",
    "Check which snapshots are available and sort them by # iterations",
    "Pick distance threshold for (r)PCK from the statistics computed during evaluation",
    "update number of individuals to retain.",
    "calculating result at best best solution",
    "print(\"Quantification:\", DataOptParams.head())",
    "DataOptParams.to_hdf(",
    "path_inference_config.split(\".yaml\")[0] + \".h5\",",
    "\"df_with_missing\",",
    "format=\"table\",",
    "mode=\"w\",",
    ")",
    "Store best predictions",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "from deeplabcut.pose_estimation_tensorflow.predict_multianimal import convert_detections2tracklet",
    "initializing constants",
    "PredicteData['frame'+str(counter)]=predict.get_detectionswithcosts(frame, dlc_cfg, sess, inputs, outputs, outall=False,nms_radius=dlc_cfg.nmsradius,det_min_score=dlc_cfg.minconfidence)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "PredicteData[batch_num*batchsize:batch_num*batchsize+batch_ind, :] = pose[:batch_ind,:]",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "animal & bpt-wise distance!",
    "corrkps=np.sum((gt[row_indices]-ani[col_indices])**2,axis=2)<dcorr**2",
    "animal & bpt-wise distance!",
    "corrkps=np.sum((gt[row_indices]-ani[col_indices])**2,axis=2)<dcorr**2",
    "load params",
    "Ensure type consistency",
    "stats = compute_crossval_metrics(config_path, inferencecfg, shuffle,trainingsetindex,",
    "dcorr=dcorr,leastbpts=leastbpts,modelprefix=modelprefix)",
    "val = stats['rmse_test'].values[0]*(1+stats['misses_test'].values[0]*1./stats['hits_test'].values[0])",
    "##################################",
    "### auxiliaryfunctions",
    "##################################",
    "#########################################################",
    "### conversion & greedy bodypart matching code",
    "#########################################################",
    "d=distance(np.array(cand_a[i][:2]),np.array(cand_b[j][:2]))",
    "filtering with global distance bounds",
    "sort candidate connections by score",
    "if both bodyparts don't exist, create a new subset",
    "filter detections according to inferencecfg parameters",
    "filter connections according to inferencecfg parameters",
    "assemble putative subsets",
    "define constant velocity model",
    "Regularize by forcing AR <= 5",
    "max_ar = 5",
    "if el.aspect_ratio >= max_ar:",
    "if el.height > el.width:",
    "el.width = el.height / max_ar",
    "else:",
    "el.height = el.width / max_ar",
    "Orient the ellipse such that it encompasses most points",
    "n_inside = el.contains_points(np.c_[self.x, self.y]).sum()",
    "el.theta += 0.5 * np.pi",
    "if el.contains_points(np.c_[self.x, self.y]).sum() < n_inside:",
    "el.theta -= 0.5 * np.pi",
    "r2 = chi2.ppf(2 * norm.cdf(sd) - 1, 2)",
    "height, width = np.sqrt(E * r2)",
    "The general quadratic curve has the form:",
    "ax^2 + 2bxy + cy^2 + 2dx + 2fy + g = 0",
    "Ellipse center coordinates",
    "Semi-axes lengths",
    "Angle to the horizontal",
    "Reset tracker IDs",
    "diff = val - cost_matrix",
    "diff[row, col] += val",
    "if (",
    "val < self.iou_threshold",
    "or np.any(diff[row] <= 0.2)",
    "or np.any(diff[:, col] <= 0.2)",
    "):",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "TODO Try particle filter (since we already have the keypoints)",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "filter out matched with low IOU",
    "get predicted locations from existing trackers.",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "TODO: get cropping parameters and utilize!",
    "openmp_arg = '-fopenmp'",
    "if _platform == \"win32\":",
    "openmp_arg = '-openmp'",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "setting pairwise bodypart loss",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "print(end_points.keys()) >> to see what else is available.",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "setting pairwise bodypart loss",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "class TpuBatchNormalization(tf.layers.BatchNormalization):",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "Clear the old folder.",
    "Write checkpoints.",
    "Update the best objective.",
    "We maintain mva for batch norm moving mean and variance as well.",
    "Return the top 5 predictions (idx and prob) for each image.",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "from nets.mobilenet import conv_blocks as ops",
    "from nets.mobilenet import mobilenet as lib",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "The next part of the code depends upon which tensorflow version you have.",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "setting pairwise bodypart loss",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "get coordinates for bp1 and bp2",
    "'m2'",
    "distscalarproduct=np.zeros((len(C1),len(C2)))*np.nan",
    "distscalarproduct[c1i,c2i]=dy*v[1]+dx*v[0] #scalar product [v unit vector dx,dy in pixel coordinats from partaffinitymap]",
    "Distances[l]['m2'] = distscalarproduct",
    "TODO: compute all the grids etc. once for the video analysis method",
    "(and then just pass on the variables)",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "These two functions are for evaluation specifically (one also calculates integral between gt points)",
    "get dist_grid",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "if 'eval_scale' in cfg.keys():",
    "import imgaug.augmenters as iaa",
    "im = iaa.Resize(float(cfg['eval_scale']))(images=im)",
    "# Functions below implement are for batch sizes > 1:",
    "get dist_grid",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "batchsize,ny,nx,num_joints = scmap.shape",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "The next part of the code depends upon which tensorflow version you have.",
    "return self.prediction_layers(net, end_points)",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Augmentation functions",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "assert len(batch_images) == self.batch_size",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "imageio.imwrite(data_items[i].im_path.split('/')[-1],im)",
    "if returndata:",
    "return batch_images,batch_joints,targetmaps",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "print(person_id,joint_ids,data_item.im_path.split('/')[-1])",
    "if self.cfg.partaffinityfield_predict:",
    "print(\"hello\",joint_id)",
    "print(np.concatenate(joint_id)) #this is all joint_ids for all individuals!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "plt.savefig(\"along\"+str(data_item.im_path.split('/')[-1]))",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "print(person_id,k, j_id, coords[0])",
    "assert(0==1)",
    "A[:,:,2]=partaffinityfield_map[:,:,j]*0",
    "A[:,:,2]=partaffinityfield_map[:,:,j]*0",
    "plt.savefig(\"SomePafs\"+str(data_item.im_path.split('/')[-1]))",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "from scipy.misc import imread, imresize",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "net_type = \"efficientnet-b0\"  # to -b6",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "NET = \"efficientnet-b0\"",
    "\"multi_step\": [[0.001, N_ITER]],",
    "Need to add the 'likelihood' level value to simulate analyzed data",
    "Ugliest hack in the history of pandas",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "for EfficientNet",
    "imgaug",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "Verify the aspect ratio is preserved"
  ],
  "v2.1.10.2": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Suppress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / all require TF",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "Create the pose_config.yaml files",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "topSplitter = wx.SplitterWindow(self)",
    "",
    "self.image_panel = ImagePanel(topSplitter, config,video,shuffle,Dataframe,self.gui_size)",
    "self.widget_panel = WidgetPanel(topSplitter)",
    "",
    "topSplitter.SplitHorizontally(self.image_panel, self.widget_panel,sashPosition=self.gui_size[1]*0.83)#0.9",
    "topSplitter.SetSashGravity(1)",
    "sizer = wx.BoxSizer(wx.VERTICAL)",
    "sizer.Add(topSplitter, 1, wx.EXPAND)",
    "self.SetSizer(sizer)",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.buttonCounter = []",
    "self.bodyparts = []",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "See Li et al., 2012. Cross-view Activity Recognition using Hankelets.",
    "As proposed in the paper, the Hankel matrix can either be formed from",
    "the tracklet's centroid or its normalized velocity.",
    "vel = np.diff(self.centroid, axis=0)",
    "vel /= np.linalg.norm(vel, axis=1, keepdims=True)",
    "return self.hankelize(vel)",
    "TODO Add missing data imputation",
    "nrows, ncols = mat.shape",
    "beta = nrows / ncols",
    "omega = 0.56 * beta ** 3 - 0.95 * beta ** 2 + 1.82 * beta + 1.43",
    "return np.argmin(s > omega * np.median(s))",
    "Note that if tracklets are very short, some may actually be part of the same track",
    "and thus incorrectly reflect separate track endpoints...",
    "Map each Tracklet to an entry and output nodes and vice versa,",
    "which is convenient once the tracklets are stitched.",
    "TODO Avoid looping over all pairs of tracklets",
    "The algorithm works better with integer weights",
    "Let us prune the graph by removing all source and sink edges",
    "but those connecting the `n_tracks` first and last tracklets.",
    "Preflow push seems to work slightly better than shortest",
    "augmentation path..., and is more computationally efficient.",
    "Verify whether there are overlapping tracklets",
    "Pick the segment that minimizes \"smoothness\", computed here",
    "with the coefficient of variation of the differences.",
    "Cycle through the residuals and incorporate back those",
    "that only fit in a single tracklet.",
    "Greedily add the remaining residuals",
    "Refresh temporal bounds",
    "Default to the distance cost function",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "Checks if zoom/pan button is ON",
    "print(\"DLC loaded in light mode; you cannot use the relabeling GUI!\")",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "Historically DLC used: from scipy.misc import imread, imresize >> deprecated functions",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "CHECKS if each bpt is connected to at least one other bpt",
    "TODO: check that there is a path leading from each (multi)bpt to each other (multi)bpt!",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "if suffix=='_full': #save metadata!",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (indivdual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "Keep only the individuals and bodyparts that were labeled",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "Ensure same order as in config.yaml",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "self.cfg = auxiliaryfunctions.read_config(config)",
    "self.statusbar.SetStatusText(\"\")",
    "dlg = wx.MessageDialog(None,\"Are you sure?\", \"Quit!\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_YES:",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "NEW ROW:",
    "self.save.Enable(False)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0,10), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=10)",
    "Add all the options",
    "line = wx.StaticLine(self)",
    "self.sizer.Add(line, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=10)",
    "",
    "self.multi_choice.Bind(wx.EVT_CHECKBOX,self.activate_copy_videos)",
    "Hide the button as this is not the default option",
    "self.vids.Enable(False)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "self.yes.Enable(False)",
    "self.no.Enable(False)",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.filelist = self.filelist + self.vids",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "Read the pose config file",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "if self.cfg.get(\"multianimalproject\", False):",
    "pass",
    "else:",
    "removing this as several downstream maDLC steps don't support dest_folder at this time:",
    "destfolder_text = wx.StaticBox(self, label=\"Specify destination folder\")",
    "destfolderboxsizer = wx.StaticBoxSizer(destfolder_text, wx.VERTICAL)",
    "self.change_workingdir = wx.CheckBox(",
    "self, label=\"optional destination folder\"",
    ")",
    "self.hbox2.Add(self.change_workingdir)",
    "self.change_workingdir.Bind(wx.EVT_CHECKBOX, self.activate_change_wd)",
    "self.sel_wd = wx.Button(self, label=\"Browse\")",
    "self.sel_wd.Enable(False)",
    "self.sel_wd.Bind(wx.EVT_BUTTON, self.select_destfolder)",
    "self.hbox2.Add(self.sel_wd, 0, wx.ALL, -1)",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "def video_tracklets(self,event):",
    "shuffle = self.shuffle.GetValue()",
    "trainingsetindex = self.trainingset.GetValue()",
    "deeplabcut.create_video_from_pickled_tracks(self.filelist, picklefile, pcutoff=0.6)",
    "self.select_destfolder.SetPath(\"None\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.shuffles.SetValue(\"1\")",
    "DownSampleVideo(vname,width=-1,height=200,outsuffix='downsampled',outpath=None,rotateccw=False):",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.videotype.SetStringSelection(\".avi\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "if self.plot_scoremaps.GetStringSelection() == \"Yes\":",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "shuffle = self.shuffle.GetValue()",
    "Read from edited inf. file first ...",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0, 4), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=5)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = cv2.imread(img)",
    "convert the image to RGB as you are showing the image with matplotlib",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "checks for unique bodyparts",
    "Reading the existing dataset,if already present",
    "Handle data previously labeled on a different platform",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Cache original bodyparts",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Rearrange bodypart columns in config order",
    "Test whether there are missing frames and superfluous data",
    "Check whether new labels were added",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Discard data associated with bodyparts that are no longer in the config",
    "Re-organize the dataframe so the CSV looks consistent with the config",
    "Checks if zoom/pan button is ON",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "actualbpts=set(Data.columns.get_level_values(0))",
    "utility function to split different crops from same image into either train or test!",
    "loading & linking pretrained models",
    "CURRENTLY ONLY ResNet supported!",
    "multianimal case:",
    "ATTENTION: order has to be multibodyparts, then uniquebodyparts (for indexing)",
    "Loading the encoder (if necessary downloading from TF)",
    "Map back to the original indices.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "if socialbdpt in actualbpts:",
    "if socialbdpt in actualbpts:",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Load updated lists:",
    "Find the corresponding video file",
    "Avoid cropping already cropped images",
    "moving old entry to _original, dropping it from video_set and update crop parameters",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Check that points lie within the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "sort the models directories",
    "get the shuffle index",
    "read cfg file",
    "create log file",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.individual_names+','+self.bodyParts)",
    "Check for variable correctness",
    "Moviepy:",
    "print(\"DLC loaded in light mode; you cannot use the labeling GUI!\")",
    "def __init__(self, point,bodyParts):",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.bodyParts)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "sess, inputs, outputs = predict.setup_pose_prediction(dlc_cfg)",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "from skimage.io import imread",
    "frame=imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: addd cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: this can be used if only a subset is relevant. I.e. [0,1] for only first and second joint!",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "get corresponding bounding boxes!",
    "Test whether the unique bodyparts have been assembled",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "print(\"If the tracking is not satisfactory for some videos, consider expanding the training set. You can use the function 'extract_outlier_frames' to extract any outlier frames!\")",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Dependencies for anaysis",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Handle data previously annotated on a different platform",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "print(dlc_cfg)",
    "Specifying state of model (snapshot / training state)",
    "Evaluate PAF edge lengths to calibrate `distnorm`",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "For OKS/PCK, compute the standard deviation error across all frames",
    "returning to intial folder",
    "wild guesses for a wide range:",
    "Check which snapshots are available and sort them by # iterations",
    "Pick distance threshold for (r)PCK from the statistics computed during evaluation",
    "update number of individuals to retain.",
    "calculating result at best best solution",
    "print(\"Quantification:\", DataOptParams.head())",
    "DataOptParams.to_hdf(",
    "path_inference_config.split(\".yaml\")[0] + \".h5\",",
    "\"df_with_missing\",",
    "format=\"table\",",
    "mode=\"w\",",
    ")",
    "Store best predictions",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "from deeplabcut.pose_estimation_tensorflow.predict_multianimal import convert_detections2tracklet",
    "initializing constants",
    "PredicteData['frame'+str(counter)]=predict.get_detectionswithcosts(frame, dlc_cfg, sess, inputs, outputs, outall=False,nms_radius=dlc_cfg.nmsradius,det_min_score=dlc_cfg.minconfidence)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "PredicteData[batch_num*batchsize:batch_num*batchsize+batch_ind, :] = pose[:batch_ind,:]",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "animal & bpt-wise distance!",
    "corrkps=np.sum((gt[row_indices]-ani[col_indices])**2,axis=2)<dcorr**2",
    "animal & bpt-wise distance!",
    "corrkps=np.sum((gt[row_indices]-ani[col_indices])**2,axis=2)<dcorr**2",
    "load params",
    "Ensure type consistency",
    "stats = compute_crossval_metrics(config_path, inferencecfg, shuffle,trainingsetindex,",
    "dcorr=dcorr,leastbpts=leastbpts,modelprefix=modelprefix)",
    "val = stats['rmse_test'].values[0]*(1+stats['misses_test'].values[0]*1./stats['hits_test'].values[0])",
    "##################################",
    "### auxiliaryfunctions",
    "##################################",
    "#########################################################",
    "### conversion & greedy bodypart matching code",
    "#########################################################",
    "d=distance(np.array(cand_a[i][:2]),np.array(cand_b[j][:2]))",
    "filtering with global distance bounds",
    "sort candidate connections by score",
    "if both bodyparts don't exist, create a new subset",
    "filter detections according to inferencecfg parameters",
    "filter connections according to inferencecfg parameters",
    "assemble putative subsets",
    "define constant velocity model",
    "TODO Try particle filter (since we already have the keypoints)",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "filter out matched with low IOU",
    "get predicted locations from existing trackers.",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "openmp_arg = '-fopenmp'",
    "if _platform == \"win32\":",
    "openmp_arg = '-openmp'",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "setting pairwise bodypart loss",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "print(end_points.keys()) >> to see what else is available.",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "setting pairwise bodypart loss",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "class TpuBatchNormalization(tf.layers.BatchNormalization):",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "Clear the old folder.",
    "Write checkpoints.",
    "Update the best objective.",
    "We maintain mva for batch norm moving mean and variance as well.",
    "Return the top 5 predictions (idx and prob) for each image.",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "from nets.mobilenet import conv_blocks as ops",
    "from nets.mobilenet import mobilenet as lib",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "The next part of the code depends upon which tensorflow version you have.",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "setting pairwise bodypart loss",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "get coordinates for bp1 and bp2",
    "'m2'",
    "distscalarproduct=np.zeros((len(C1),len(C2)))*np.nan",
    "distscalarproduct[c1i,c2i]=dy*v[1]+dx*v[0] #scalar product [v unit vector dx,dy in pixel coordinats from partaffinitymap]",
    "Distances[l]['m2'] = distscalarproduct",
    "TODO: compute all the grids etc. once for the video analysis method",
    "(and then just pass on the variables)",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "These two functions are for evaluation specifically (one also calculates integral between gt points)",
    "get dist_grid",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "if 'eval_scale' in cfg.keys():",
    "import imgaug.augmenters as iaa",
    "im = iaa.Resize(float(cfg['eval_scale']))(images=im)",
    "# Functions below implement are for batch sizes > 1:",
    "get dist_grid",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "batchsize,ny,nx,num_joints = scmap.shape",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "The next part of the code depends upon which tensorflow version you have.",
    "return self.prediction_layers(net, end_points)",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Augmentation functions",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "assert len(batch_images) == self.batch_size",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "imageio.imwrite(data_items[i].im_path.split('/')[-1],im)",
    "if returndata:",
    "return batch_images,batch_joints,targetmaps",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "print(person_id,joint_ids,data_item.im_path.split('/')[-1])",
    "if self.cfg.partaffinityfield_predict:",
    "print(\"hello\",joint_id)",
    "print(np.concatenate(joint_id)) #this is all joint_ids for all individuals!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "plt.savefig(\"along\"+str(data_item.im_path.split('/')[-1]))",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "print(person_id,k, j_id, coords[0])",
    "assert(0==1)",
    "A[:,:,2]=partaffinityfield_map[:,:,j]*0",
    "A[:,:,2]=partaffinityfield_map[:,:,j]*0",
    "plt.savefig(\"SomePafs\"+str(data_item.im_path.split('/')[-1]))",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "from scipy.misc import imread, imresize",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "net_type = \"mobilenet_v2_0.35\"",
    "net_type = \"efficientnet-b0\"  # to -b6",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "NET = \"efficientnet-b0\"",
    "\"multi_step\": [[0.001, N_ITER]],",
    "Need to add the 'likelihood' level value to simulate analyzed data",
    "Ugliest hack in the history of pandas",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "for EfficientNet",
    "imgaug",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "Verify the aspect ratio is preserved"
  ],
  "v2.1.10": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "quicker variant",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Suppress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / all require TF",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "Create the pose_config.yaml files",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "topSplitter = wx.SplitterWindow(self)",
    "",
    "self.image_panel = ImagePanel(topSplitter, config,video,shuffle,Dataframe,self.gui_size)",
    "self.widget_panel = WidgetPanel(topSplitter)",
    "",
    "topSplitter.SplitHorizontally(self.image_panel, self.widget_panel,sashPosition=self.gui_size[1]*0.83)#0.9",
    "topSplitter.SetSashGravity(1)",
    "sizer = wx.BoxSizer(wx.VERTICAL)",
    "sizer.Add(topSplitter, 1, wx.EXPAND)",
    "self.SetSizer(sizer)",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.buttonCounter = []",
    "self.bodyparts = []",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "Checks if zoom/pan button is ON",
    "print(\"DLC loaded in light mode; you cannot use the relabeling GUI!\")",
    "Find uncropped labeled data",
    "Handle image previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "Historically DLC used: from scipy.misc import imread, imresize >> deprecated functions",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "CHECKS if each bpt is connected to at least one other bpt",
    "TODO: check that there is a path leading from each (multi)bpt to each other (multi)bpt!",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "if suffix=='_full': #save metadata!",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (indivdual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "Keep only the individuals and bodyparts that were labeled",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "Ensure same order as in config.yaml",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "self.cfg = auxiliaryfunctions.read_config(config)",
    "self.statusbar.SetStatusText(\"\")",
    "dlg = wx.MessageDialog(None,\"Are you sure?\", \"Quit!\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_YES:",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "NEW ROW:",
    "self.save.Enable(False)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0,10), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=10)",
    "Add all the options",
    "line = wx.StaticLine(self)",
    "self.sizer.Add(line, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=10)",
    "",
    "self.multi_choice.Bind(wx.EVT_CHECKBOX,self.activate_copy_videos)",
    "Hide the button as this is not the default option",
    "self.vids.Enable(False)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "self.yes.Enable(False)",
    "self.no.Enable(False)",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.filelist = self.filelist + self.vids",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "Read the pose config file",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "if self.cfg.get(\"multianimalproject\", False):",
    "pass",
    "else:",
    "removing this as several downstream maDLC steps don't support dest_folder at this time:",
    "destfolder_text = wx.StaticBox(self, label=\"Specify destination folder\")",
    "destfolderboxsizer = wx.StaticBoxSizer(destfolder_text, wx.VERTICAL)",
    "self.change_workingdir = wx.CheckBox(",
    "self, label=\"optional destination folder\"",
    ")",
    "self.hbox2.Add(self.change_workingdir)",
    "self.change_workingdir.Bind(wx.EVT_CHECKBOX, self.activate_change_wd)",
    "self.sel_wd = wx.Button(self, label=\"Browse\")",
    "self.sel_wd.Enable(False)",
    "self.sel_wd.Bind(wx.EVT_BUTTON, self.select_destfolder)",
    "self.hbox2.Add(self.sel_wd, 0, wx.ALL, -1)",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "def video_tracklets(self,event):",
    "shuffle = self.shuffle.GetValue()",
    "trainingsetindex = self.trainingset.GetValue()",
    "deeplabcut.create_video_from_pickled_tracks(self.filelist, picklefile, pcutoff=0.6)",
    "self.select_destfolder.SetPath(\"None\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.shuffles.SetValue(\"1\")",
    "DownSampleVideo(vname,width=-1,height=200,outsuffix='downsampled',outpath=None,rotateccw=False):",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.videotype.SetStringSelection(\".avi\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "if self.plot_scoremaps.GetStringSelection() == \"Yes\":",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "shuffle = self.shuffle.GetValue()",
    "Read from edited inf. file first ...",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0, 4), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=5)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Reset updated coords",
    "Checks for the last image and disables the Next button",
    "Backup previous save",
    "Drop Nan data frames",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = cv2.imread(img)",
    "convert the image to RGB as you are showing the image with matplotlib",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "checks for unique bodyparts",
    "Reading the existing dataset,if already present",
    "Handle data previously labeled on a different platform",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Cache original bodyparts",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Rearrange bodypart columns in config order",
    "Test whether there are missing frames and superfluous data",
    "Check whether new labels were added",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Reset updated coords",
    "Checks for the last image and disables the Next button",
    "Backup previous save",
    "Windows compatible",
    "Discard data associated with bodyparts that are no longer in the config",
    "Re-organize the dataframe so the CSV looks consistent with the config",
    "Checks if zoom/pan button is ON",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "actualbpts=set(Data.columns.get_level_values(0))",
    "utility function to split different crops from same image into either train or test!",
    "loading & linking pretrained models",
    "CURRENTLY ONLY ResNet supported!",
    "multianimal case:",
    "ATTENTION: order has to be multibodyparts, then uniquebodyparts (for indexing)",
    "Loading the encoder (if necessary downloading from TF)",
    "Map back to the original indices.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "if socialbdpt in actualbpts:",
    "if socialbdpt in actualbpts:",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Load updated lists:",
    "Find the corresponding video file",
    "Avoid cropping already cropped images",
    "moving old entry to _original, dropping it from video_set and update crop parameters",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Check that points lie within the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "sort the models directories",
    "get the shuffle index",
    "read cfg file",
    "create log file",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.individual_names+','+self.bodyParts)",
    "Check for variable correctness",
    "Moviepy:",
    "print(\"DLC loaded in light mode; you cannot use the labeling GUI!\")",
    "def __init__(self, point,bodyParts):",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.bodyParts)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "sess, inputs, outputs = predict.setup_pose_prediction(dlc_cfg)",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "from skimage.io import imread",
    "frame=imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: addd cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: this can be used if only a subset is relevant. I.e. [0,1] for only first and second joint!",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "get corresponding bounding boxes!",
    "Test whether the unique bodyparts have been assembled",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "print(\"If the tracking is not satisfactory for some videos, consider expanding the training set. You can use the function 'extract_outlier_frames' to extract any outlier frames!\")",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Dependencies for anaysis",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Handle data previously annotated on a different platform",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "print(dlc_cfg)",
    "Specifying state of model (snapshot / training state)",
    "Evaluate PAF edge lengths to calibrate `distnorm`",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "Calculate overall prediction error",
    "For OKS/PCK, compute the standard deviation error across all frames",
    "returning to intial folder",
    "wild guesses for a wide range:",
    "Check which snapshots are available and sort them by # iterations",
    "Pick distance threshold for (r)PCK from the statistics computed during evaluation",
    "update number of individuals to retain.",
    "calculating result at best best solution",
    "print(\"Quantification:\", DataOptParams.head())",
    "DataOptParams.to_hdf(",
    "path_inference_config.split(\".yaml\")[0] + \".h5\",",
    "\"df_with_missing\",",
    "format=\"table\",",
    "mode=\"w\",",
    ")",
    "Store best predictions",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "from deeplabcut.pose_estimation_tensorflow.predict_multianimal import convert_detections2tracklet",
    "initializing constants",
    "TODO Fix the code below...",
    "We can't just break the whole thing if there is one corrupted frame",
    "in the middle of the video. Rather iterate over all frames and simply skip corruptions",
    "PredicteData['frame'+str(counter)]=predict.get_detectionswithcosts(frame, dlc_cfg, sess, inputs, outputs, outall=False,nms_radius=dlc_cfg.nmsradius,det_min_score=dlc_cfg.minconfidence)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "PredicteData[batch_num*batchsize:(batch_num+1)*batchsize, :] = pose",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "PredicteData[batch_num*batchsize:batch_num*batchsize+batch_ind, :] = pose[:batch_ind,:]",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "PredicteData[batch_num*batchsize:(batch_num+1)*batchsize, :] = pose",
    "print(PredicteData)",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "animal & bpt-wise distance!",
    "corrkps=np.sum((gt[row_indices]-ani[col_indices])**2,axis=2)<dcorr**2",
    "animal & bpt-wise distance!",
    "corrkps=np.sum((gt[row_indices]-ani[col_indices])**2,axis=2)<dcorr**2",
    "load params",
    "Ensure type consistency",
    "stats = compute_crossval_metrics(config_path, inferencecfg, shuffle,trainingsetindex,",
    "dcorr=dcorr,leastbpts=leastbpts,modelprefix=modelprefix)",
    "val = stats['rmse_test'].values[0]*(1+stats['misses_test'].values[0]*1./stats['hits_test'].values[0])",
    "##################################",
    "### auxiliaryfunctions",
    "##################################",
    "#########################################################",
    "### conversion & greedy bodypart matching code",
    "#########################################################",
    "d=distance(np.array(cand_a[i][:2]),np.array(cand_b[j][:2]))",
    "filtering with global distance bounds",
    "sort candidate connections by score",
    "if both bodyparts don't exist, create a new subset",
    "filter detections according to inferencecfg parameters",
    "filter connections according to inferencecfg parameters",
    "assemble putative subsets",
    "define constant velocity model",
    "TODO Try particle filter (since we already have the keypoints)",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "filter out matched with low IOU",
    "get predicted locations from existing trackers.",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "openmp_arg = '-fopenmp'",
    "if _platform == \"win32\":",
    "openmp_arg = '-openmp'",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "setting pairwise bodypart loss",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "defaults will be a public argument for namedtuple in Python 3.7",
    "https://docs.python.org/3/library/collections.html#collections.namedtuple",
    "Make sure that round down does not go down by more than 10%.",
    "Builds the block accordings to arguments.",
    "Expansion phase:",
    "Depth-wise convolution phase:",
    "Squeeze and Excitation layer.",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Expansion phase:",
    "Output phase:",
    "only apply drop_connect if skip presents.",
    "Builds blocks.",
    "Update block input and output filters based on depth multiplier.",
    "The first block needs to take care of stride and filter size increase.",
    "pylint: disable=protected-access",
    "pylint: enable=protected-access",
    "Stem part.",
    "Head part.",
    "Calls Stem layers",
    "Calls blocks.",
    "Calls final layers and returns logits.",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "(width_coefficient, depth_coefficient, resolution, dropout_rate)",
    "blocks_args = [",
    "'r1_k3_s11_e1_i32_o16_se0.25', 'r2_k3_s22_e6_i16_o24_se0.25',",
    "'r2_k5_s22_e6_i24_o40_se0.25', 'r3_k3_s22_e6_i40_o80_se0.25',",
    "'r3_k5_s11_e6_i80_o112_se0.25', 'r4_k5_s22_e6_i112_o192_se0.25',",
    "'r1_k3_s11_e6_i192_o320_se0.25',",
    "]",
    "The default is TPU-specific batch norm.",
    "The alternative is tf.layers.BatchNormalization.",
    "batch_norm=utils.TpuBatchNormalization,  # TPU-specific requirement.",
    "ValueError will be raised here if override_params has fields not included",
    "in global_params.",
    "print(end_points.keys()) >> to see what else is available.",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "setting pairwise bodypart loss",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Copyright 2019 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "class TpuBatchNormalization(tf.layers.BatchNormalization):",
    "Compute variance using: Var[X]= E[X^2] - E[X]^2.",
    "Compute keep_prob",
    "TODO(tanmingxing): add support for training progress.",
    "Compute drop_connect tensor",
    "Clear the old folder.",
    "Write checkpoints.",
    "Update the best objective.",
    "We maintain mva for batch norm moving mean and variance as well.",
    "Return the top 5 predictions (idx and prob) for each image.",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "from nets.mobilenet import conv_blocks as ops",
    "from nets.mobilenet import mobilenet as lib",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "The next part of the code depends upon which tensorflow version you have.",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "setting pairwise bodypart loss",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "get coordinates for bp1 and bp2",
    "'m2'",
    "distscalarproduct=np.zeros((len(C1),len(C2)))*np.nan",
    "distscalarproduct[c1i,c2i]=dy*v[1]+dx*v[0] #scalar product [v unit vector dx,dy in pixel coordinats from partaffinitymap]",
    "Distances[l]['m2'] = distscalarproduct",
    "TODO: compute all the grids etc. once for the video analysis method",
    "(and then just pass on the variables)",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "These two functions are for evaluation specifically (one also calculates integral between gt points)",
    "get dist_grid",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "if 'eval_scale' in cfg.keys():",
    "import imgaug.augmenters as iaa",
    "im = iaa.Resize(float(cfg['eval_scale']))(images=im)",
    "# Functions below implement are for batch sizes > 1:",
    "get dist_grid",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "batchsize,ny,nx,num_joints = scmap.shape",
    "Change the stride from 2 to 1 to get 16x downscaling instead of 32x.",
    "https://towardsdatascience.com/complete-architectural-details-of-all-efficientnet-models-5fd5b736142",
    "The next part of the code depends upon which tensorflow version you have.",
    "return self.prediction_layers(net, end_points)",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Augmentation functions",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "assert len(batch_images) == self.batch_size",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "imageio.imwrite(data_items[i].im_path.split('/')[-1],im)",
    "if returndata:",
    "return batch_images,batch_joints,targetmaps",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "print(person_id,joint_ids,data_item.im_path.split('/')[-1])",
    "if self.cfg.partaffinityfield_predict:",
    "print(\"hello\",joint_id)",
    "print(np.concatenate(joint_id)) #this is all joint_ids for all individuals!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "plt.savefig(\"along\"+str(data_item.im_path.split('/')[-1]))",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "print(person_id,k, j_id, coords[0])",
    "assert(0==1)",
    "A[:,:,2]=partaffinityfield_map[:,:,j]*0",
    "A[:,:,2]=partaffinityfield_map[:,:,j]*0",
    "plt.savefig(\"SomePafs\"+str(data_item.im_path.split('/')[-1]))",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "from scipy.misc import imread, imresize",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "net_type = \"efficientnet-b0\"  # to -b6",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "TENSORPACK could fail in WINDOWS...",
    "Need to add the 'likelihood' level value to simulate analyzed data",
    "Ugliest hack in the history of pandas",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "for EfficientNet",
    "imgaug",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "Verify the aspect ratio is preserved"
  ],
  "v2.2b8": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Suppress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / all require TF",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "Create the pose_config.yaml files",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam1 camera",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "topSplitter = wx.SplitterWindow(self)",
    "",
    "self.image_panel = ImagePanel(topSplitter, config,video,shuffle,Dataframe,self.gui_size)",
    "self.widget_panel = WidgetPanel(topSplitter)",
    "",
    "topSplitter.SplitHorizontally(self.image_panel, self.widget_panel,sashPosition=self.gui_size[1]*0.83)#0.9",
    "topSplitter.SetSashGravity(1)",
    "sizer = wx.BoxSizer(wx.VERTICAL)",
    "sizer.Add(topSplitter, 1, wx.EXPAND)",
    "self.SetSizer(sizer)",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.buttonCounter = []",
    "self.bodyparts = []",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "Alternatively",
    "Sort tracklets by length to prioritize greater continuity",
    "Drop tracklets that are too short",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Use Manhattan distance to avoid overflow",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "fix move to corner",
    "Checks if zoom/pan button is ON",
    "print(\"DLC loaded in light mode; you cannot use the relabeling GUI!\")",
    "Find uncropped labeled data",
    "Handle data previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "Mask rather than drop unwanted bodyparts to ensure consistent coloring",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "The above already raises a ValueError if formatting is wrong",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "Historically DLC used: from scipy.misc import imread, imresize >> deprecated functions",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "CHECKS if each bpt is connected to at least one other bpt",
    "TODO: check that there is a path leading from each (multi)bpt to each other (multi)bpt!",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "if suffix=='_full': #save metadata!",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (indivdual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "Keep only the individuals and bodyparts that were labeled",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "Ensure same order as in config.yaml",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "self.cfg = auxiliaryfunctions.read_config(config)",
    "self.statusbar.SetStatusText(\"\")",
    "dlg = wx.MessageDialog(None,\"Are you sure?\", \"Quit!\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_YES:",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "NEW ROW:",
    "self.save.Enable(False)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0,10), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=10)",
    "Add all the options",
    "line = wx.StaticLine(self)",
    "self.sizer.Add(line, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=10)",
    "",
    "self.multi_choice.Bind(wx.EVT_CHECKBOX,self.activate_copy_videos)",
    "Hide the button as this is not the default option",
    "self.vids.Enable(False)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "self.yes.Enable(False)",
    "self.no.Enable(False)",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.filelist = self.filelist + self.vids",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "Read the pose config file",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "if self.cfg.get(\"multianimalproject\", False):",
    "pass",
    "else:",
    "removing this as several downstream maDLC steps don't support dest_folder at this time:",
    "destfolder_text = wx.StaticBox(self, label=\"Specify destination folder\")",
    "destfolderboxsizer = wx.StaticBoxSizer(destfolder_text, wx.VERTICAL)",
    "self.change_workingdir = wx.CheckBox(",
    "self, label=\"optional destination folder\"",
    ")",
    "self.hbox2.Add(self.change_workingdir)",
    "self.change_workingdir.Bind(wx.EVT_CHECKBOX, self.activate_change_wd)",
    "self.sel_wd = wx.Button(self, label=\"Browse\")",
    "self.sel_wd.Enable(False)",
    "self.sel_wd.Bind(wx.EVT_BUTTON, self.select_destfolder)",
    "self.hbox2.Add(self.sel_wd, 0, wx.ALL, -1)",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "def video_tracklets(self,event):",
    "shuffle = self.shuffle.GetValue()",
    "trainingsetindex = self.trainingset.GetValue()",
    "deeplabcut.create_video_from_pickled_tracks(self.filelist, picklefile, pcutoff=0.6)",
    "self.select_destfolder.SetPath(\"None\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.shuffles.SetValue(\"1\")",
    "DownSampleVideo(vname,width=-1,height=200,outsuffix='downsampled',outpath=None,rotateccw=False):",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.videotype.SetStringSelection(\".avi\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "if self.plot_scoremaps.GetStringSelection() == \"Yes\":",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "shuffle = self.shuffle.GetValue()",
    "Read from edited inf. file first ...",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0, 4), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=5)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Reset updated coords",
    "Checks for the last image and disables the Next button",
    "Backup previous save",
    "Drop Nan data frames",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = cv2.imread(img)",
    "convert the image to RGB as you are showing the image with matplotlib",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "checks for unique bodyparts",
    "Reading the existing dataset,if already present",
    "Handle data previously labeled on a different platform",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Cache original bodyparts",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Rearrange bodypart columns in config order",
    "Check whether new labels were added",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Reset updated coords",
    "Checks for the last image and disables the Next button",
    "Backup previous save",
    "Drop Nan data frames",
    "Windows compatible",
    "Discard data associated with bodyparts that are no longer in the config",
    "Re-organize the dataframe so the CSV looks consistent with the config",
    "Checks if zoom/pan button is ON",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "actualbpts=set(Data.columns.get_level_values(0))",
    "utility function to split different crops from same image into either train or test!",
    "loading & linking pretrained models",
    "CURRENTLY ONLY ResNet supported!",
    "multianimal case:",
    "ATTENTION: order has to be multibodyparts, then uniquebodyparts (for indexing)",
    "Loading the encoder (if necessary downloading from TF)",
    "Map back to the original indices.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "if socialbdpt in actualbpts:",
    "if socialbdpt in actualbpts:",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "Load updated lists:",
    "Find the corresponding video file",
    "Avoid cropping already cropped images",
    "moving old entry to _original, dropping it from video_set and update crop parameters",
    "print(key, \"dropping?\")",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Check that points lie within the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "these values are dropped as scalecrop",
    "doesn't have rotation implemented",
    "sort the models directories",
    "get the shuffle index",
    "read cfg file",
    "create log file",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.individual_names+','+self.bodyParts)",
    "Check for variable correctness",
    "Moviepy:",
    "print(\"DLC loaded in light mode; you cannot use the labeling GUI!\")",
    "def __init__(self, point,bodyParts):",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.bodyParts)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "sess, inputs, outputs = predict.setup_pose_prediction(dlc_cfg)",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "from skimage.io import imread",
    "frame=imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: addd cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: this can be used if only a subset is relevant. I.e. [0,1] for only first and second joint!",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "get corresponding bounding boxes!",
    "Test whether the unique bodyparts have been assembled",
    "TODO Perhaps easier to check whether links were defined in the PAF graph?",
    "Find an unused tracklet ID for the 'unique' bodyparts",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "print(\"If the tracking is not satisfactory for some videos, consider expanding the training set. You can use the function 'extract_outlier_frames' to extract any outlier frames!\")",
    "imagenet mean for resnet pretraining:",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "for DLC 2.2. (here all set False to not use PAFs/pairwise fields)",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "reloading defaults, as they can bleed over from a previous run otherwise",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "dlc_cfg_train = load_config(str(path_train_config))",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Dependencies for anaysis",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "plt.figure()",
    "source=np.array(Data[ind,j1,'x'][jj],Data[ind,j1,'y'][jj])",
    "target=np.array(Data[ind2,j1,'x'][jj],Data[ind2,j2,'y'][jj])",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "print(inferenceboundscfg)",
    "plt.subplot(len(partaffinityfield_graph),1,pi+1)",
    "plt.hist(ds_within,bins=np.linspace(0,100,21),color='red')",
    "plt.hist(ds_across,bins=np.linspace(0,100,21),color='blue')",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "df.to_hdf(output_path.replace('csv', 'h5'), 'df_with_missing', format='table', mode='w')",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Handle data previously annotated on a different platform",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "print(dlc_cfg)",
    "Specifying state of model (snapshot / training state)",
    "Evaluate PAF edge lengths to calibrate `distnorm`",
    "FIXME Is having an empty array vs nan really that necessary?!",
    "Pick the predictions closest to ground truth,",
    "rather than the ones the model has most confident in",
    "Compute all distance statistics",
    "For OKS/PCK, compute the standard deviation error across all frames",
    "returning to intial folder",
    "wild guesses for a wide range:",
    "Check which snapshots are available and sort them by # iterations",
    "Pick distance threshold for (r)PCK from the statistics computed during evaluation",
    "update number of individuals to retain.",
    "calculating result at best best solution",
    "print(\"Quantification:\", DataOptParams.head())",
    "DataOptParams.to_hdf(",
    "path_inference_config.split(\".yaml\")[0] + \".h5\",",
    "\"df_with_missing\",",
    "format=\"table\",",
    "mode=\"w\",",
    ")",
    "Store best predictions",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "from deeplabcut.pose_estimation_tensorflow.predict_multianimal import convert_detections2tracklet",
    "initializing constants",
    "TODO Fix the code below...",
    "We can't just break the whole thing if there is one corrupted frame",
    "in the middle of the video. Rather iterate over all frames and simply skip corruptions",
    "PredicteData['frame'+str(counter)]=predict.get_detectionswithcosts(frame, dlc_cfg, sess, inputs, outputs, outall=False,nms_radius=dlc_cfg.nmsradius,det_min_score=dlc_cfg.minconfidence)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "PredicteData[batch_num*batchsize:(batch_num+1)*batchsize, :] = pose",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "PredicteData[batch_num*batchsize:batch_num*batchsize+batch_ind, :] = pose[:batch_ind,:]",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "PredicteData[batch_num*batchsize:(batch_num+1)*batchsize, :] = pose",
    "print(PredicteData)",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "animal & bpt-wise distance!",
    "corrkps=np.sum((gt[row_indices]-ani[col_indices])**2,axis=2)<dcorr**2",
    "animal & bpt-wise distance!",
    "corrkps=np.sum((gt[row_indices]-ani[col_indices])**2,axis=2)<dcorr**2",
    "load params",
    "Ensure type consistency",
    "stats = compute_crossval_metrics(config_path, inferencecfg, shuffle,trainingsetindex,",
    "dcorr=dcorr,leastbpts=leastbpts,modelprefix=modelprefix)",
    "val = stats['rmse_test'].values[0]*(1+stats['misses_test'].values[0]*1./stats['hits_test'].values[0])",
    "##################################",
    "### auxiliaryfunctions",
    "##################################",
    "#########################################################",
    "### conversion & greedy bodypart matching code",
    "#########################################################",
    "d=distance(np.array(cand_a[i][:2]),np.array(cand_b[j][:2]))",
    "filtering with global distance bounds",
    "sort candidate connections by score",
    "if both bodyparts don't exist, create a new subset",
    "filter detections according to inferencecfg parameters",
    "filter connections according to inferencecfg parameters",
    "assemble putative subsets",
    "define constant velocity model",
    "TODO Try particle filter (since we already have the keypoints)",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "filter out matched with low IOU",
    "get predicted locations from existing trackers.",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "openmp_arg = '-fopenmp'",
    "if _platform == \"win32\":",
    "openmp_arg = '-openmp'",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "print(end_points.keys()) >> to see what else is available.",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "from nets.mobilenet import conv_blocks as ops",
    "from nets.mobilenet import mobilenet as lib",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "The next part of the code depends upon which tensorflow version you have.",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "setting pairwise bodypart loss",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "get coordinates for bp1 and bp2",
    "'m2'",
    "distscalarproduct=np.zeros((len(C1),len(C2)))*np.nan",
    "distscalarproduct[c1i,c2i]=dy*v[1]+dx*v[0] #scalar product [v unit vector dx,dy in pixel coordinats from partaffinitymap]",
    "Distances[l]['m2'] = distscalarproduct",
    "TODO: compute all the grids etc. once for the video analysis method",
    "(and then just pass on the variables)",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "These two functions are for evaluation specifically (one also calculates integral between gt points)",
    "get dist_grid",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "# Functions below implement are for batch sizes > 1:",
    "get dist_grid",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "batchsize,ny,nx,num_joints = scmap.shape",
    "The next part of the code depends upon which tensorflow version you have.",
    "return self.prediction_layers(net, end_points)",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Augmentation functions",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "First, initializing variables (if they don't exist)",
    "what is the fraction of training samples with scaling augmentation?",
    "loading defaults for rotation range!",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "cfg[\"rotateratio\"] = cfg.get(",
    "\"rotratio\", 0.4",
    ")  # what is the fraction of training samples with rotation augmentation?",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "Auto cropping is new (was not in Nature Neuroscience 2018 paper, but introduced in Nath et al. Nat. Protocols 2019)",
    "and boosts performance by 2X, particularly on challenging datasets, like the cheetah in Nath et al.",
    "Parameters for augmentation with regard to cropping:",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "what is the minimal frames size for cropping plus/minus ie.. [-100,100]^2 for an arb. joint",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "assert len(batch_images) == self.batch_size",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "imageio.imwrite(data_items[i].im_path.split('/')[-1],im)",
    "if returndata:",
    "return batch_images,batch_joints,targetmaps",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "print(person_id,joint_ids,data_item.im_path.split('/')[-1])",
    "if self.cfg.partaffinityfield_predict:",
    "print(\"hello\",joint_id)",
    "print(np.concatenate(joint_id)) #this is all joint_ids for all individuals!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "plt.savefig(\"along\"+str(data_item.im_path.split('/')[-1]))",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "print(person_id,k, j_id, coords[0])",
    "assert(0==1)",
    "A[:,:,2]=partaffinityfield_map[:,:,j]*0",
    "A[:,:,2]=partaffinityfield_map[:,:,j]*0",
    "plt.savefig(\"SomePafs\"+str(data_item.im_path.split('/')[-1]))",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "parameter initialization for augmentation pipeline:",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images of a batch into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "from scipy.misc import imread, imresize",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "deeplabcut.create_labeled_video(path_config_file,[newvideo], destfolder=dfolder,filtered=True)",
    "TENSORPACK could fail in WINDOWS...",
    "os.environ['DLClight'] = 'True'",
    "Need to add the 'likelihood' level value to simulate analyzed data",
    "Ugliest hack in the history of pandas",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "# Create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "# here is an \"old way\" to do this",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "Verify the aspect ratio is preserved"
  ],
  "v2.2b7": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Suppress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / all require TF",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "Create the pose_config.yaml files",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "get vcap property",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam1 camera",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "topSplitter = wx.SplitterWindow(self)",
    "",
    "self.image_panel = ImagePanel(topSplitter, config,video,shuffle,Dataframe,self.gui_size)",
    "self.widget_panel = WidgetPanel(topSplitter)",
    "",
    "topSplitter.SplitHorizontally(self.image_panel, self.widget_panel,sashPosition=self.gui_size[1]*0.83)#0.9",
    "topSplitter.SetSashGravity(1)",
    "sizer = wx.BoxSizer(wx.VERTICAL)",
    "sizer.Add(topSplitter, 1, wx.EXPAND)",
    "self.SetSizer(sizer)",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "self.cropping = False",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.buttonCounter = []",
    "self.bodyparts = []",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "Alternatively",
    "Store tracklets, such that we later manipulate long chains",
    "rather than data of individual frames, yielding greater continuity.",
    "Recursively fill the data containers",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Only overwrite if improving confidence",
    "Fill existing gaps",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Uncertain keypoints are ignored",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "print(\"DLC loaded in light mode; you cannot use the relabeling GUI!\")",
    "Find uncropped labeled data",
    "Handle data previously annotated on a different platform",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as",
    "specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "Historically DLC used: from scipy.misc import imread, imresize >> deprecated functions",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "TODO check if those times exist...",
    "subprocess.call(['ffmpeg','-i',vname,'-ss',str(start),'-to',str(stop),'-c:v','copy','-c:a', newfilename])",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "CHECKS if each bpt is connected to at least one other bpt",
    "TODO: check that there is a path leading from each (multi)bpt to each other (multi)bpt!",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "if suffix=='_full': #save metadata!",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (indivdual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "Keep only the individuals and bodyparts that were labeled",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "Ensure same order as in config.yaml",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "self.cfg = auxiliaryfunctions.read_config(config)",
    "self.statusbar.SetStatusText(\"\")",
    "dlg = wx.MessageDialog(None,\"Are you sure?\", \"Quit!\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_YES:",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "NEW ROW:",
    "self.save.Enable(False)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0,10), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=10)",
    "Add all the options",
    "line = wx.StaticLine(self)",
    "self.sizer.Add(line, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=10)",
    "",
    "self.multi_choice.Bind(wx.EVT_CHECKBOX,self.activate_copy_videos)",
    "Hide the button as this is not the default option",
    "self.vids.Enable(False)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "self.yes.Enable(False)",
    "self.no.Enable(False)",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.filelist = self.filelist + self.vids",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "Read the pose config file",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "if self.cfg.get(\"multianimalproject\", False):",
    "pass",
    "else:",
    "removing this as several downstream maDLC steps don't support dest_folder at this time:",
    "destfolder_text = wx.StaticBox(self, label=\"Specify destination folder\")",
    "destfolderboxsizer = wx.StaticBoxSizer(destfolder_text, wx.VERTICAL)",
    "self.change_workingdir = wx.CheckBox(",
    "self, label=\"optional destination folder\"",
    ")",
    "self.hbox2.Add(self.change_workingdir)",
    "self.change_workingdir.Bind(wx.EVT_CHECKBOX, self.activate_change_wd)",
    "self.sel_wd = wx.Button(self, label=\"Browse\")",
    "self.sel_wd.Enable(False)",
    "self.sel_wd.Bind(wx.EVT_BUTTON, self.select_destfolder)",
    "self.hbox2.Add(self.sel_wd, 0, wx.ALL, -1)",
    "self.sizer.Add(boxsizer, pos=(4, 0), span=(1, 5),flag=wx.EXPAND|wx.TOP|wx.LEFT|wx.RIGHT , border=10)",
    "boxsizer.Add(self.hbox1,0, 5)",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "def video_tracklets(self,event):",
    "shuffle = self.shuffle.GetValue()",
    "trainingsetindex = self.trainingset.GetValue()",
    "deeplabcut.create_video_from_pickled_tracks(self.filelist, picklefile, pcutoff=0.6)",
    "self.select_destfolder.SetPath(\"None\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.shuffles.SetValue(\"1\")",
    "DownSampleVideo(vname,width=-1,height=200,outsuffix='downsampled',outpath=None,rotateccw=False):",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.videotype.SetStringSelection(\".avi\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "if self.plot_scoremaps.GetStringSelection() == \"Yes\":",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "shuffle = self.shuffle.GetValue()",
    "Read from edited inf. file first ...",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0, 4), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=5)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = cv2.imread(img)",
    "convert the image to RGB as you are showing the image with matplotlib",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "checks for unique bodyparts",
    "Reading the existing dataset,if already present",
    "Handle data previously labeled on a different platform",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Cache original bodyparts",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Rearrange bodypart columns in config order",
    "Check whether new labels were added",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Discard data associated with bodyparts that are no longer in the config",
    "Re-organize the dataframe so the CSV looks consistent with the config",
    "Checks if zoom/pan button is ON",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "actualbpts=set(Data.columns.get_level_values(0))",
    "utility function to split different crops from same image into either train or test!",
    "loading & linking pretrained models",
    "CURRENTLY ONLY ResNet supported!",
    "multianimal case:",
    "ATTENTION: order has to be multibodyparts, then uniquebodyparts (for indexing)",
    "Loading the encoder (if necessary downloading from TF)",
    "Map back to the original indices.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "if socialbdpt in actualbpts:",
    "if socialbdpt in actualbpts:",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "TODO:   \"distnormalization\":  could be calculated here based on data and set",
    ">> now we calculate this during evaluation (which is a good spot...)",
    "Load updated lists:",
    "Find the corresponding video file",
    "Avoid cropping already cropped images",
    "moving old entry to _original, dropping it from video_set and update crop parameters",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Check that points lie within the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "sort the models directories",
    "get the shuffle index",
    "read cfg file",
    "create log file",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.individual_names+','+self.bodyParts)",
    "Check for variable correctness",
    "Moviepy:",
    "print(\"DLC loaded in light mode; you cannot use the labeling GUI!\")",
    "def __init__(self, point,bodyParts):",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.bodyParts)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "sess, inputs, outputs = predict.setup_pose_prediction(dlc_cfg)",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "from skimage.io import imread",
    "frame=imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: addd cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: this can be used if only a subset is relevant. I.e. [0,1] for only first and second joint!",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "get corresponding bounding boxes!",
    "Test whether the unique bodyparts have been assembled",
    "TODO Perhaps easier to check whether links were defined in the PAF graph?",
    "Find an unused tracklet ID for the 'unique' bodyparts",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "print(\"If the tracking is not satisfactory for some videos, consider expanding the training set. You can use the function 'extract_outlier_frames' to extract any outlier frames!\")",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "for DLC 2.2.",
    "Parameters for augmentation with regard to cropping",
    "Added and described in \"Using DeepLabCut for 3D markerless pose estimation across species and behaviors\"",
    "Source: https://www.nature.com/articles/s41596-019-0176-0",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "return DATA",
    "print(np.shape(image),np.shape(scmap),np.shape(locref),np.shape(paf))",
    "dest_folder = os.path.join(cfg['project_path'], 'maps')",
    "Dependencies for anaysis",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "plt.figure()",
    "source=np.array(Data[ind,j1,'x'][jj],Data[ind,j1,'y'][jj])",
    "target=np.array(Data[ind2,j1,'x'][jj],Data[ind2,j2,'y'][jj])",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "print(inferenceboundscfg)",
    "plt.subplot(len(partaffinityfield_graph),1,pi+1)",
    "plt.hist(ds_within,bins=np.linspace(0,100,21),color='red')",
    "plt.hist(ds_across,bins=np.linspace(0,100,21),color='blue')",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "df.to_hdf(output_path.replace('csv', 'h5'), 'df_with_missing', format='table', mode='w')",
    "Dependencies for anaysis",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Handle data previously annotated on a different platform",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "print(dlc_cfg)",
    "Specifying state of model (snapshot / training state)",
    "Storing GT data as dictionary, so it can be used for calculating connection costs",
    "returning to intial folder",
    "wild guesses for a wide range:",
    "Check which snapshots are available and sort them by # iterations",
    "update number of individuals to retain.",
    "calculating result at best best solution",
    "print(\"Quantification:\", DataOptParams.head())",
    "Store best predictions",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "from deeplabcut.pose_estimation_tensorflow.predict_multianimal import convert_detections2tracklet",
    "initializing constants",
    "PredicteData['frame'+str(counter)]=predict.get_detectionswithcosts(frame, dlc_cfg, sess, inputs, outputs, outall=False,nms_radius=dlc_cfg.nmsradius,det_min_score=dlc_cfg.minconfidence)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "PredicteData[batch_num*batchsize:(batch_num+1)*batchsize, :] = pose",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "PredicteData[batch_num*batchsize:batch_num*batchsize+batch_ind, :] = pose[:batch_ind,:]",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "PredicteData[batch_num*batchsize:(batch_num+1)*batchsize, :] = pose",
    "print(PredicteData)",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "animal & bpt-wise distance!",
    "corrkps=np.sum((gt[row_indices]-ani[col_indices])**2,axis=2)<dcorr**2",
    "animal & bpt-wise distance!",
    "corrkps=np.sum((gt[row_indices]-ani[col_indices])**2,axis=2)<dcorr**2",
    "load params",
    "Ensure type consistency",
    "stats = compute_crossval_metrics(config_path, inferencecfg, shuffle,trainingsetindex,",
    "dcorr=dcorr,leastbpts=leastbpts,modelprefix=modelprefix)",
    "val = stats['rmse_test'].values[0]*(1+stats['misses_test'].values[0]*1./stats['hits_test'].values[0])",
    "Saving log file",
    "##################################",
    "### auxiliaryfunctions",
    "##################################",
    "#########################################################",
    "### conversion & greedy bodypart matching code",
    "#########################################################",
    "d=distance(np.array(cand_a[i][:2]),np.array(cand_b[j][:2]))",
    "filtering with global distance bounds",
    "sort candidate connections by score",
    "if both bodyparts don't exist, create a new subset",
    "filter detections according to inferencecfg parameters",
    "filter connections according to inferencecfg parameters",
    "assemble putative subsets",
    "define constant velocity model",
    "TODO Try particle filter (since we already have the keypoints)",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "filter out matched with low IOU",
    "get predicted locations from existing trackers.",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "openmp_arg = '-fopenmp'",
    "if _platform == \"win32\":",
    "openmp_arg = '-openmp'",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "print(end_points.keys()) >> to see what else is available.",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "from nets.mobilenet import conv_blocks as ops",
    "from nets.mobilenet import mobilenet as lib",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "The next part of the code depends upon which tensorflow version you have.",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "setting pairwise bodypart loss",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "get coordinates for bp1 and bp2",
    "'m2'",
    "distscalarproduct=np.zeros((len(C1),len(C2)))*np.nan",
    "distscalarproduct[c1i,c2i]=dy*v[1]+dx*v[0] #scalar product [v unit vector dx,dy in pixel coordinats from partaffinitymap]",
    "Distances[l]['m2'] = distscalarproduct",
    "TODO: compute all the grids etc. once for the video analysis method",
    "(and then just pass on the variables)",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "These two functions are for evaluation specifically (one also calculates integral between gt points)",
    "get dist_grid",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "# Functions below implement are for batch sizes > 1:",
    "get dist_grid",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "batchsize,ny,nx,num_joints = scmap.shape",
    "The next part of the code depends upon which tensorflow version you have.",
    "return self.prediction_layers(net, end_points)",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Augmentation functions",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "Initializing variables if they don't exist...",
    "what is the fraction of training samples with scaling augmentation?",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "assert len(batch_images) == self.batch_size",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "imageio.imwrite(data_items[i].im_path.split('/')[-1],im)",
    "if returndata:",
    "return batch_images,batch_joints,targetmaps",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "print(person_id,joint_ids,data_item.im_path.split('/')[-1])",
    "if self.cfg.partaffinityfield_predict:",
    "print(\"hello\",joint_id)",
    "print(np.concatenate(joint_id)) #this is all joint_ids for all individuals!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "plt.savefig(\"along\"+str(data_item.im_path.split('/')[-1]))",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "print(person_id,k, j_id, coords[0])",
    "assert(0==1)",
    "A[:,:,2]=partaffinityfield_map[:,:,j]*0",
    "A[:,:,2]=partaffinityfield_map[:,:,j]*0",
    "plt.savefig(\"SomePafs\"+str(data_item.im_path.split('/')[-1]))",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "from scipy.misc import imread, imresize",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "from scipy.misc import imread, imresize",
    "from dataset.pose_dataset import Batch, data_to_input, mirror_joints_map, CropImage, DataItem",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "deeplabcut.create_labeled_video(path_config_file,[newvideo], destfolder=dfolder,filtered=True)",
    "TENSORPACK could fail in WINDOWS...",
    "os.environ['DLClight'] = 'True'",
    "Need to add the 'likelihood' level value to simulate analyzed data",
    "Ugliest hack in the history of pandas",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "#create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)"
  ],
  "v2.2b6": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Suppress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / all require TF",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "Create the pose_config.yaml files",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "get vcap property",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam1 camera",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "topSplitter = wx.SplitterWindow(self)",
    "",
    "self.image_panel = ImagePanel(topSplitter, config,video,shuffle,Dataframe,self.gui_size)",
    "self.widget_panel = WidgetPanel(topSplitter)",
    "",
    "topSplitter.SplitHorizontally(self.image_panel, self.widget_panel,sashPosition=self.gui_size[1]*0.83)#0.9",
    "topSplitter.SetSashGravity(1)",
    "sizer = wx.BoxSizer(wx.VERTICAL)",
    "sizer.Add(topSplitter, 1, wx.EXPAND)",
    "self.SetSizer(sizer)",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "self.cropping = False",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.buttonCounter = []",
    "self.bodyparts = []",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "Alternatively",
    "Store tracklets, such that we later manipulate long chains",
    "rather than data of individual frames, yielding greater continuity.",
    "Recursively fill the data containers",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Only overwrite if improving confidence",
    "Fill existing gaps and slightly smooth the tracklets",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "print(\"DLC loaded in light mode; you cannot use the relabeling GUI!\")",
    "Find uncropped labeled data",
    "Draw the skeleton if already existent",
    "Find the most 'complete' animal",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "if notanalyzed:",
    "notanalyzed,outdataname,sourcedataname,DLCscorer=auxiliaryfunctions.CheckifPostProcessing(folder,vname,DLCscorer,DLCscorerlegacy,suffix='checking')",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "Historically DLC used: from scipy.misc import imread, imresize >> deprecated functions",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "TODO check if those times exist...",
    "subprocess.call(['ffmpeg','-i',vname,'-ss',str(start),'-to',str(stop),'-c:v','copy','-c:a', newfilename])",
    "Rotate, see: https://stackoverflow.com/questions/3937387/rotating-videos-with-ffmpeg",
    "interesting option to just update metadata.",
    "Read the video until a frame is successfully read",
    "import platform",
    "if platform.system() == \"Darwin\":  # for OSX use WXAgg",
    "fig.canvas.start_event_loop(timeout=-1)",
    "else:",
    "#fig.canvas.stop_event_loop()",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "CHECKS if each bpt is connected to at least one other bpt",
    "TODO: check that there is a path leading from each (multi)bpt to each other (multi)bpt!",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "if suffix=='_full': #save metadata!",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "-> adding (single,bpt) for uniquebodyparts",
    "-> adding (indivdual,bpt) for multianimalbodyparts",
    "load defaults",
    "set project specific parameters:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "Keep only the individuals and bodyparts that were labeled",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "Ensure same order as in config.yaml",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "self.cfg = auxiliaryfunctions.read_config(config)",
    "self.statusbar.SetStatusText(\"\")",
    "dlg = wx.MessageDialog(None,\"Are you sure?\", \"Quit!\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_YES:",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "NEW ROW:",
    "self.save.Enable(False)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0,10), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=10)",
    "Add all the options",
    "line = wx.StaticLine(self)",
    "self.sizer.Add(line, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=10)",
    "",
    "self.multi_choice.Bind(wx.EVT_CHECKBOX,self.activate_copy_videos)",
    "Hide the button as this is not the default option",
    "self.vids.Enable(False)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "self.yes.Enable(False)",
    "self.no.Enable(False)",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.filelist = self.filelist + self.vids",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "Read the pose config file",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "if self.cfg.get(\"multianimalproject\", False):",
    "pass",
    "else:",
    "removing this as several downstream maDLC steps don't support dest_folder at this time:",
    "destfolder_text = wx.StaticBox(self, label=\"Specify destination folder\")",
    "destfolderboxsizer = wx.StaticBoxSizer(destfolder_text, wx.VERTICAL)",
    "self.change_workingdir = wx.CheckBox(",
    "self, label=\"optional destination folder\"",
    ")",
    "self.hbox2.Add(self.change_workingdir)",
    "self.change_workingdir.Bind(wx.EVT_CHECKBOX, self.activate_change_wd)",
    "self.sel_wd = wx.Button(self, label=\"Browse\")",
    "self.sel_wd.Enable(False)",
    "self.sel_wd.Bind(wx.EVT_BUTTON, self.select_destfolder)",
    "self.hbox2.Add(self.sel_wd, 0, wx.ALL, -1)",
    "self.sizer.Add(boxsizer, pos=(4, 0), span=(1, 5),flag=wx.EXPAND|wx.TOP|wx.LEFT|wx.RIGHT , border=10)",
    "boxsizer.Add(self.hbox1,0, 5)",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "def video_tracklets(self,event):",
    "shuffle = self.shuffle.GetValue()",
    "trainingsetindex = self.trainingset.GetValue()",
    "deeplabcut.create_video_from_pickled_tracks(self.filelist, picklefile, pcutoff=0.6)",
    "self.select_destfolder.SetPath(\"None\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.shuffles.SetValue(\"1\")",
    "DownSampleVideo(vname,width=-1,height=200,outsuffix='downsampled',outpath=None,rotateccw=False):",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.videotype.SetStringSelection(\".avi\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "if self.plot_scoremaps.GetStringSelection() == \"Yes\":",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "shuffle = self.shuffle.GetValue()",
    "Read from edited inf. file first ...",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0, 4), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=5)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = cv2.imread(img)",
    "convert the image to RGB as you are showing the image with matplotlib",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "checks for unique bodyparts",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Cache original bodyparts",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Rearrange bodypart columns in config order",
    "Check whether new labels were added",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Discard data associated with bodyparts that are no longer in the config",
    "Re-organize the dataframe so the CSV looks consistent",
    "Checks if zoom/pan button is ON",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "actualbpts=set(Data.columns.get_level_values(0))",
    "utility function to split different crops from same image into either train or test!",
    "loading & linking pretrained models",
    "CURRENTLY ONLY ResNet supported!",
    "multianimal case:",
    "ATTENTION: order has to be multibodyparts, then uniquebodyparts (for indexing)",
    "Loading the encoder (if necessary downloading from TF)",
    "Map back to the original indices.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "if socialbdpt in actualbpts:",
    "if socialbdpt in actualbpts:",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "TODO:   \"distnormalization\":  could be calculated here based on data and set",
    ">> now we calculate this during evaluation (which is a good spot...)",
    "Load updated lists:",
    "Find the corresponding video file",
    "Avoid cropping already cropped images",
    "moving old entry to _original, dropping it from video_set and update crop parameters",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Check that points lie within the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndices,testIndices, Shuffles, augmenter_type,net_type)",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "sort the models directories",
    "get the shuffle index",
    "read cfg file",
    "create log file",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.individual_names+','+self.bodyParts)",
    "Check for variable correctness",
    "Moviepy:",
    "print(\"DLC loaded in light mode; you cannot use the labeling GUI!\")",
    "def __init__(self, point,bodyParts):",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.bodyParts)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "sess, inputs, outputs = predict.setup_pose_prediction(dlc_cfg)",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "from skimage.io import imread",
    "frame=imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: addd cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: this can be used if only a subset is relevant. I.e. [0,1] for only first and second joint!",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "get corresponding bounding boxes!",
    "Test whether the unique bodyparts have been assembled",
    "TODO Perhaps easier to check whether links were defined in the PAF graph?",
    "Find an unused tracklet ID for the 'unique' bodyparts",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "print(\"If the tracking is not satisfactory for some videos, consider expanding the training set. You can use the function 'extract_outlier_frames' to extract any outlier frames!\")",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "for DLC 2.2.",
    "Parameters for augmentation with regard to cropping",
    "Added and described in \"Using DeepLabCut for 3D markerless pose estimation across species and behaviors\"",
    "Source: https://www.nature.com/articles/s41596-019-0176-0",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "return DATA",
    "print(np.shape(image),np.shape(scmap),np.shape(locref),np.shape(paf))",
    "dest_folder = os.path.join(cfg['project_path'], 'maps')",
    "Dependencies for anaysis",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "plt.figure()",
    "source=np.array(Data[ind,j1,'x'][jj],Data[ind,j1,'y'][jj])",
    "target=np.array(Data[ind2,j1,'x'][jj],Data[ind2,j2,'y'][jj])",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "print(inferenceboundscfg)",
    "plt.subplot(len(partaffinityfield_graph),1,pi+1)",
    "plt.hist(ds_within,bins=np.linspace(0,100,21),color='red')",
    "plt.hist(ds_across,bins=np.linspace(0,100,21),color='blue')",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "df.to_hdf(output_path.replace('csv', 'h5'), 'df_with_missing', format='table', mode='w')",
    "Dependencies for anaysis",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "print(dlc_cfg)",
    "Specifying state of model (snapshot / training state)",
    "Storing GT data as dictionary, so it can be used for calculating connection costs",
    "returning to intial folder",
    "wild guesses for a wide range:",
    "Check which snapshots are available and sort them by # iterations",
    "update number of individuals to retain.",
    "calculating result at best best solution",
    "print(\"Quantification:\", DataOptParams.head())",
    "Store best predictions",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "from deeplabcut.pose_estimation_tensorflow.predict_multianimal import convert_detections2tracklet",
    "initializing constants",
    "PredicteData['frame'+str(counter)]=predict.get_detectionswithcosts(frame, dlc_cfg, sess, inputs, outputs, outall=False,nms_radius=dlc_cfg.nmsradius,det_min_score=dlc_cfg.minconfidence)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "PredicteData[batch_num*batchsize:(batch_num+1)*batchsize, :] = pose",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "PredicteData[batch_num*batchsize:batch_num*batchsize+batch_ind, :] = pose[:batch_ind,:]",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "PredicteData[batch_num*batchsize:(batch_num+1)*batchsize, :] = pose",
    "print(PredicteData)",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "animal & bpt-wise distance!",
    "corrkps=np.sum((gt[row_indices]-ani[col_indices])**2,axis=2)<dcorr**2",
    "animal & bpt-wise distance!",
    "corrkps=np.sum((gt[row_indices]-ani[col_indices])**2,axis=2)<dcorr**2",
    "load params",
    "Ensure type consistency",
    "stats = compute_crossval_metrics(config_path, inferencecfg, shuffle,trainingsetindex,",
    "dcorr=dcorr,leastbpts=leastbpts,modelprefix=modelprefix)",
    "val = stats['rmse_test'].values[0]*(1+stats['misses_test'].values[0]*1./stats['hits_test'].values[0])",
    "Saving log file",
    "##################################",
    "### auxiliaryfunctions",
    "##################################",
    "#########################################################",
    "### conversion & greedy bodypart matching code",
    "#########################################################",
    "d=distance(np.array(cand_a[i][:2]),np.array(cand_b[j][:2]))",
    "filtering with global distance bounds",
    "sort candidate connections by score",
    "if both bodyparts don't exist, create a new subset",
    "filter detections according to inferencecfg parameters",
    "filter connections according to inferencecfg parameters",
    "assemble putative subsets",
    "define constant velocity model",
    "TODO Try particle filter (since we already have the keypoints)",
    "Modified from scipy source code:",
    "- to restrict its use to 2D",
    "- to get rid of shuffling (since arrays are only (nbodyparts * 3) element long)",
    "TODO - factor in keypoint confidence (and weight by # of observations??)",
    "mat = self.calc_pairwise_oks(poses, poses_ref)",
    "Remove matched detections with low OKS",
    "matches = []",
    "for row, col in zip(row_indices, col_indices):",
    "if mat[row, col] < self.oks_threshold:",
    "unmatched_poses.append(row)",
    "unmatched_trackers.append(col)",
    "else:",
    "matches.append([row, col])",
    "if not len(matches):",
    "matches = np.empty((0, 2), dtype=int)",
    "else:",
    "matches = np.stack(matches)",
    "filter out matched with low IOU",
    "get predicted locations from existing trackers.",
    "update matched trackers with assigned detections",
    "create and initialise new trackers for unmatched detections",
    "+1 as MOT benchmark requires positive >> this is removed for DLC!",
    "remove dead tracklet",
    "openmp_arg = '-fopenmp'",
    "if _platform == \"win32\":",
    "openmp_arg = '-openmp'",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "print(end_points.keys()) >> to see what else is available.",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "from nets.mobilenet import conv_blocks as ops",
    "from nets.mobilenet import mobilenet as lib",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "The next part of the code depends upon which tensorflow version you have.",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "setting pairwise bodypart loss",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "get coordinates for bp1 and bp2",
    "'m2'",
    "distscalarproduct=np.zeros((len(C1),len(C2)))*np.nan",
    "distscalarproduct[c1i,c2i]=dy*v[1]+dx*v[0] #scalar product [v unit vector dx,dy in pixel coordinats from partaffinitymap]",
    "Distances[l]['m2'] = distscalarproduct",
    "TODO: compute all the grids etc. once for the video analysis method",
    "(and then just pass on the variables)",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "These two functions are for evaluation specifically (one also calculates integral between gt points)",
    "get dist_grid",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "# Functions below implement are for batch sizes > 1:",
    "get dist_grid",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "batchsize,ny,nx,num_joints = scmap.shape",
    "The next part of the code depends upon which tensorflow version you have.",
    "return self.prediction_layers(net, end_points)",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Augmentation functions",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "Initializing variables if they don't exist...",
    "what is the fraction of training samples with scaling augmentation?",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "assert len(batch_images) == self.batch_size",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "imageio.imwrite(data_items[i].im_path.split('/')[-1],im)",
    "if returndata:",
    "return batch_images,batch_joints,targetmaps",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "print(person_id,joint_ids,data_item.im_path.split('/')[-1])",
    "if self.cfg.partaffinityfield_predict:",
    "print(\"hello\",joint_id)",
    "print(np.concatenate(joint_id)) #this is all joint_ids for all individuals!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "plt.savefig(\"along\"+str(data_item.im_path.split('/')[-1]))",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "print(person_id,k, j_id, coords[0])",
    "assert(0==1)",
    "A[:,:,2]=partaffinityfield_map[:,:,j]*0",
    "A[:,:,2]=partaffinityfield_map[:,:,j]*0",
    "plt.savefig(\"SomePafs\"+str(data_item.im_path.split('/')[-1]))",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "from scipy.misc import imread, imresize",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "from scipy.misc import imread, imresize",
    "from dataset.pose_dataset import Batch, data_to_input, mirror_joints_map, CropImage, DataItem",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "Process skeleton",
    "save",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "deeplabcut.create_labeled_video(path_config_file,[newvideo], destfolder=dfolder,filtered=True)",
    "TENSORPACK could fail in WINDOWS...",
    "os.environ['DLClight'] = 'True'",
    "Need to add the 'likelihood' level value to simulate analyzed data",
    "Ugliest hack in the history of pandas",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "#create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)"
  ],
  "v2.1.8.2": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Supress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / require TF",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "Create the pose_config.yaml files",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "get vcap property",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "cfg_file['resnet']=50",
    "Write dictionary to yaml  config file",
    "import yaml",
    "import cv2",
    "import shutil",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam1 camera",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "self.cropping = False",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.buttonCounter = []",
    "self.bodyparts = []",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "extract min and max index based on start stop interval.",
    "figure out body part list:",
    "all indices between start and stop with jump larger than epsilon (leading up to this point!)",
    "deviation_dataname = str(Path(videofolder)/Path(dataname))",
    "Calculate deviatons for video",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "data.to_csv(dataname.split('.h5')[0]+'filtered.csv')",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "Dataframe = pd.read_hdf(os.path.join(videofolder,dataname+'.h5'))",
    "drop duplicate labels:",
    "updates iteration by 1",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "print(\"DLC loaded in light mode; you cannot use the relabeling GUI!\")",
    "###################################################",
    "Dependencies",
    "###################################################",
    "import sys",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as specified in the config file",
    "rr, cc,val = line_aa(int(df_y[pair[0],index]),int(df_x[pair[0],index]),int(df_y[pair[1],index]), int(df_x[pair[1],index]))",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Adds skeleton to the video",
    "###################",
    "less transparent present.",
    "# One can change the parameters of the video creation script below:",
    "See ffmpeg user guide: http://ffmpeg.org/ffmpeg.html#Video-and-Audio-file-format-conversion",
    "",
    "if notanalyzed:",
    "notanalyzed,outdataname,sourcedataname,DLCscorer=auxiliaryfunctions.CheckifPostProcessing(folder,vname,DLCscorer,DLCscorerlegacy,suffix='checking')",
    "Loading cropping data used during analysis",
    "!/usr/bin/env python3",
    "Historically DLC used: from scipy.misc import imread, imresize >> deprecated functions",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "TODO check if those times exist...",
    "subprocess.call(['ffmpeg','-i',vname,'-ss',str(start),'-to',str(stop),'-c:v','copy','-c:a', newfilename])",
    "Read the video until a frame is successfully read",
    "windows throws error if file path is > 260 characters, can fix with prefix. see https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "TODO: update how DLC path is obtained",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "fig.colorbar(im, ax=ax)",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "LoadData",
    "nlines,numcolumns=data.shape",
    "assert(len(orderofbpincsv)==len(cfg['bodyparts']))",
    "TODO: test len of images vs. len of imagenames for another sanity check",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "update path to current location of config.yaml (if different)",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "with open(projconfigfile, 'w') as cf:",
    "ruamelFile_3d.dump(cfg_file_3d, cf)",
    "Read the pickle file",
    "Write the pickle file",
    "checks if input is a directory",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "Ensure same order as in config.yaml",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "self.cfg = auxiliaryfunctions.read_config(config)",
    "self.statusbar.SetStatusText(\"\")",
    "dlg = wx.MessageDialog(None,\"Are you sure?\", \"Quit!\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_YES:",
    "from deeplabcut.gui.refine_tracklets import Refine_tracklets",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0,10), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=10)",
    "Add all the options",
    "line = wx.StaticLine(self)",
    "self.sizer.Add(line, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=10)",
    "",
    "self.multi_choice = wx.CheckBox(self, label=\"Is it a multi-animal project?\")",
    "self.multi_choice.Bind(wx.EVT_CHECKBOX,self.activate_copy_videos)",
    "hbox4.Add(self.multi_choice)",
    "Hide the button as this is not the default option",
    "self.vids.Enable(False)",
    "self.multi_choice.Enable(False)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.multi_choice.Enable(True)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "self.multi_choice.Enable(True)",
    "self.yes.Enable(False)",
    "self.no.Enable(False)",
    "wx.Frame.__init__(self, None, title=\"DeepLabCut\")",
    "wx.Frame.__init__( self, None, id = wx.ID_ANY, title = 'DeepLabCut',size = wx.Size(self.gui_size), pos = wx.DefaultPosition, style = wx.RESIZE_BORDER|wx.DEFAULT_FRAME_STYLE|wx.TAB_TRAVERSAL )",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "Read the pose config file",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.shuffles = wx.SpinCtrl(self, value='1',min=1,max=100)",
    "shuffles_text_boxsizer.Add(self.shuffles,1, wx.EXPAND|wx.TOP|wx.BOTTOM, 10)",
    "if self.draw_skeleton.IsShow():",
    "if self.draw_skeleton.GetStringSelection() == \"Yes\":",
    "self.draw = True",
    "else:",
    "self.draw = True",
    "print(self.config,self.filelist,self.videotype.GetValue(),shuffle,trainingsetindex,gputouse=None,save_as_csv=save_as_csv,destfolder=self.destfolder,cropping=cropping)",
    "self.gpu.SetValue(-1)",
    "import wx.lib.scrolledpanel as SP",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "DownSampleVideo(vname,width=-1,height=200,outsuffix='downsampled',outpath=None,rotateccw=False):",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.videotype.SetStringSelection(\".avi\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.hbox2 = wx.BoxSizer(wx.HORIZONTAL)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "boxsizer.Add(self.hbox2,5, wx.EXPAND|wx.TOP|wx.BOTTOM, 10)",
    "shuffle = self.shuffle.GetValue()",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.sel_config.SetPath(\"Please select the config file\")",
    "else:",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = cv2.imread(img)",
    "convert the image to RGB as you are showing the image with matplotlib",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of old labels",
    "Extracting the list of old unique labels",
    "Checking if new labels are added or not",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checking if user added a new label",
    "if self.new_Multibodyparts==[] and self.new_UniqueBodyparts==[]: # i.e. no new labels",
    "self.figure,self.axes,self.canvas,self.toolbar,self.image_axis = self.image_panel.drawplot(self.img,img_name,self.iter,self.index,self.multibodyparts,self.colormap,keep_view=self.view_locked)",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "self.image_panel.addcolorbar(self.img,self.image_axis,self.iter,self.multibodyparts,self.colormap)",
    "# Only show the bodyparts corresponding to single",
    "if self.individual_names[0] == 'single':",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.uniquebodyparts,self.individual_names,self.file,self.markerSize)",
    "else:",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.multibodyparts,self.individual_names,self.file,self.markerSize)",
    "",
    "self.individualrdb.Bind(wx.EVT_RADIOBOX,self.select_individual)",
    "",
    "# Get the color index, depending on if single is selcted or not.",
    "if self.rdb.GetStringSelection==\"single\":",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "else:",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "self.cidClick = self.canvas.mpl_connect('button_press_event', self.onClick)",
    "else:",
    "# Found new labels in either multiple bodyparts or unique bodyparts",
    "dlg = wx.MessageDialog(None,\"New label found in the config file. Do you want to see all the other labels?\", \"New label found\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_NO:",
    "if self.new_Multibodyparts!=[]:",
    "self.multibodyparts = self.new_Multibodyparts",
    "if self.new_UniqueBodyparts!=[]:",
    "self.uniquebodyparts = self.new_UniqueBodyparts",
    "",
    "self.dataFrame = MainFrame.create_dataframe(self,self.dataFrame,self.relativeimagenames,self.individual_names,self.new_UniqueBodyparts,self.new_Multibodyparts)",
    "self.figure,self.axes,self.canvas,self.toolbar,self.image_axis = self.image_panel.drawplot(self.img,img_name,self.iter,self.index,self.multibodyparts,self.colormap,keep_view=self.view_locked)",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "self.image_panel.addcolorbar(self.img,self.image_axis,self.iter,self.multibodyparts,self.colormap)",
    "",
    "if self.individual_names[0] == 'single':",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.uniquebodyparts,self.individual_names,self.file,self.markerSize)",
    "else:",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.multibodyparts,self.individual_names,self.file,self.markerSize)",
    "self.individualrdb.Bind(wx.EVT_RADIOBOX,self.select_individual)",
    "if self.rdb.GetStringSelection==\"single\":",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "else:",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "self.cidClick = self.canvas.mpl_connect('button_press_event', self.onClick)",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "def plot(self,img):",
    "self.drs= []",
    "self.updatedCoords = []",
    "for ind in self.individual_names:",
    "if self.are_unique_bodyparts_present == False: #no unique bodyparts present",
    "#            for ind in self.individual_names:",
    "image_points = []",
    "for c, bp in enumerate(self.multibodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.multibodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.multibodyparts[c])",
    "else:",
    "if ind == 'single':",
    "for c, bp in enumerate(self.uniquebodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.uniquebodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.uniquebodyparts[c])",
    "else:",
    "for c, bp in enumerate(self.multibodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.multibodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.multibodyparts[c])",
    "",
    "MainFrame.saveEachImage(self)",
    "self.figure.canvas.draw()",
    "return(self.buttonCounter)",
    "print(self.dataFrame)",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "matplotlib.use('Agg')",
    "Load updated lists:",
    "cfg['video_sets'][vn]",
    "labeling_toolbox.show(config,Screens,scale_w,scale_h, winHack, img_scale)",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "plt.savefig(str(Path(tmpfolder)/imagename.split(os.sep)[-1]))",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Check that points lie within the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "print(trainIndexes,testIndexes, Shuffles, augmenter_type,net_type)",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "sort the models directories",
    "get the shuffle index",
    "read cfg file",
    "create log file",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.individual_names+','+self.bodyParts)",
    "Check for variable correctness",
    "Moviepy:",
    "print(\"DLC loaded in light mode; you cannot use the labeling GUI!\")",
    "def __init__(self, point,bodyParts):",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.bodyParts)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "sess, inputs, outputs = predict.setup_pose_prediction(dlc_cfg)",
    "#################################################",
    "Datafolder",
    "#################################################",
    "looping over videos",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "from skimage.io import imread",
    "frame=imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "Parameters for augmentation with regard to cropping",
    "Added and described in \"Using DeepLabCut for 3D markerless pose estimation across species and behaviors\"",
    "Source: https://www.nature.com/articles/s41596-019-0176-0",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "Dependencies for anaysis",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "DLCscorer = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "import skimage.color",
    "from skimage.io import imread",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "image = skimage.color.gray2rgb(image)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "df.to_hdf(output_path.replace('csv', 'h5'), 'df_with_missing', format='table', mode='w')",
    "from scipy.misc import imresize",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Read file path for pose_config file. >> pass it on",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "print(end_points.keys()) >> to see what else is available.",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "from nets.mobilenet import conv_blocks as ops",
    "from nets.mobilenet import mobilenet as lib",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "The next part of the code depends upon which tensorflow version you have.",
    "if cfg.location_refinement:",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "from scipy.misc import imresize",
    "Augmentation functions",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "Initializing variables if they don't exist...",
    "what is the fraction of training samples with scaling augmentation?",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "from scipy.misc import imread, imresize",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "from scipy.misc import imread, imresize",
    "from dataset.pose_dataset import Batch, data_to_input, mirror_joints_map, CropImage, DataItem",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "Process skeleton",
    "save",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "deeplabcut.create_labeled_video(path_config_file,[newvideo], destfolder=dfolder,filtered=True)",
    "TENSORPACK could fail in WINDOWS...",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "#create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 does that much easier...",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "print(\"Analyze Video\")",
    "videofile_path = os.path.join(os.getcwd(),'openfield-Pranav-2018-10-30','videos','m3v1mp4.mp4')",
    "deeplabcut.analyze_videos(path_config_file,[videofile_path], shuffle=shuffle)",
    "print(\"Create Labeled Video\")",
    "deeplabcut.create_labeled_video(path_config_file,[videofile_path],save_frames=False, shuffle=shuffle)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)"
  ],
  "v2.2b5": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Suppress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / all require TF",
    "with open(saveasfile, \"w\") as f:",
    "yaml.dump(dict_test, f)",
    "TBD: 'partaffinityfield_graph' >> use to set skeleton!",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Updating config file:",
    "Create the pose_config.yaml files",
    "downloading base encoder / not required unless on re-trains (but when a training set is created this happens anyway)",
    "model_path, num_shuffles=auxfun_models.Check4weights(pose_cfg['net_type'], parent_path, num_shuffles= 1)",
    "Updating training and test pose_cfg:",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "get vcap property",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "common parameters:",
    "Write dictionary to yaml  config file",
    "import yaml",
    "import cv2",
    "import shutil",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam1 camera",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "topSplitter = wx.SplitterWindow(self)",
    "",
    "self.image_panel = ImagePanel(topSplitter, config,video,shuffle,Dataframe,self.gui_size)",
    "self.widget_panel = WidgetPanel(topSplitter)",
    "",
    "topSplitter.SplitHorizontally(self.image_panel, self.widget_panel,sashPosition=self.gui_size[1]*0.83)#0.9",
    "topSplitter.SetSashGravity(1)",
    "sizer = wx.BoxSizer(wx.VERTICAL)",
    "sizer.Add(topSplitter, 1, wx.EXPAND)",
    "self.SetSizer(sizer)",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "self.cropping = False",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.buttonCounter = []",
    "self.bodyparts = []",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "Alternatively",
    "Store tracklets, such that we later manipulate long chains",
    "rather than data of individual frames, yielding greater continuity.",
    "Recursively fill the data containers",
    "Where slots are available, copy the data over",
    "If about to overwrite data, keep tracklets with highest confidence",
    "Squeeze some data into empty slots",
    "For the remaining data, overwrite where we are least confident",
    "Find keypoints closest to the remaining data",
    "Only overwrite if improving confidence",
    "Fill existing gaps and slightly smooth the tracklets",
    "Retrieve original individual label indices",
    "Map a tracklet # to the animal ID it belongs to or the bodypart # it corresponds to.",
    "ID swaps occur when X and Y simultaneously intersect each other.",
    "Get only those bodypart pairs that belong to different individuals",
    "Take into consideration imprecise OpenCV estimation of total number of frames",
    "Automatically disable the draggable points",
    "Save additional frames to the labeled-data directory",
    "Store the newly-refined data",
    "Merge with the already existing annotated data",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "average distance and average # significant differences avg. over comparisonbodyparts",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "print(\"DLC loaded in light mode; you cannot use the relabeling GUI!\")",
    "Find uncropped labeled data",
    "###################################################",
    "Dependencies",
    "###################################################",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as specified in the config file",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "Prepare figure",
    "if notanalyzed:",
    "notanalyzed,outdataname,sourcedataname,DLCscorer=auxiliaryfunctions.CheckifPostProcessing(folder,vname,DLCscorer,DLCscorerlegacy,suffix='checking')",
    "cropping!",
    "nx=X2-X1",
    "!/usr/bin/env python3",
    "Historically DLC used: from scipy.misc import imread, imresize >> deprecated functions",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "TODO check if those times exist...",
    "subprocess.call(['ffmpeg','-i',vname,'-ss',str(start),'-to',str(stop),'-c:v','copy','-c:a', newfilename])",
    "Read the video until a frame is successfully read",
    "Windows throws error if file path is > 260 characters, can fix with prefix.",
    "See https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "Attention this order has to be consistent (for training set creation, training, inference etc.)",
    "print(lookupdict)",
    "print(link,lookupdict[link[0]])",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "if suffix=='_full': #save metadata!",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "load defaults",
    "set project specific parameters:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "Pose X vs pose Y",
    "Poses vs time",
    "Likelihoods",
    "Histograms",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "Keep only the individuals and bodyparts that were labeled",
    "Determine whether the data are single- or multi-animal without loading into memory",
    "simply by checking whether 'individuals' is in the second line of the CSV.",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "update path to current location of config.yaml (if different)",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "Ensure same order as in config.yaml",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "Iterate over data files and stop as soon as one matching the scorer is found",
    "If there was no match...",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "self.cfg = auxiliaryfunctions.read_config(config)",
    "self.statusbar.SetStatusText(\"\")",
    "dlg = wx.MessageDialog(None,\"Are you sure?\", \"Quit!\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_YES:",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "NEW ROW:",
    "self.save.Enable(False)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0,10), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=10)",
    "Add all the options",
    "line = wx.StaticLine(self)",
    "self.sizer.Add(line, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=10)",
    "",
    "self.multi_choice.Bind(wx.EVT_CHECKBOX,self.activate_copy_videos)",
    "Hide the button as this is not the default option",
    "self.vids.Enable(False)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "self.yes.Enable(False)",
    "self.no.Enable(False)",
    "wx.Frame.__init__(self, None, title=\"DeepLabCut\")",
    "wx.Frame.__init__( self, None, id = wx.ID_ANY, title = 'DeepLabCut',size = wx.Size(self.gui_size), pos = wx.DefaultPosition, style = wx.RESIZE_BORDER|wx.DEFAULT_FRAME_STYLE|wx.TAB_TRAVERSAL )",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.filelist = self.filelist + self.vids",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "Read the pose config file",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "if self.cfg.get(\"multianimalproject\", False):",
    "pass",
    "else:",
    "removing this as several downstream maDLC steps don't support dest_folder at this time:",
    "destfolder_text = wx.StaticBox(self, label=\"Specify destination folder\")",
    "destfolderboxsizer = wx.StaticBoxSizer(destfolder_text, wx.VERTICAL)",
    "self.change_workingdir = wx.CheckBox(",
    "self, label=\"optional destination folder\"",
    ")",
    "self.hbox2.Add(self.change_workingdir)",
    "self.change_workingdir.Bind(wx.EVT_CHECKBOX, self.activate_change_wd)",
    "self.sel_wd = wx.Button(self, label=\"Browse\")",
    "self.sel_wd.Enable(False)",
    "self.sel_wd.Bind(wx.EVT_BUTTON, self.select_destfolder)",
    "self.hbox2.Add(self.sel_wd, 0, wx.ALL, -1)",
    "self.sizer.Add(boxsizer, pos=(4, 0), span=(1, 5),flag=wx.EXPAND|wx.TOP|wx.LEFT|wx.RIGHT , border=10)",
    "boxsizer.Add(self.hbox1,0, 5)",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "def video_tracklets(self,event):",
    "shuffle = self.shuffle.GetValue()",
    "trainingsetindex = self.trainingset.GetValue()",
    "deeplabcut.create_video_from_pickled_tracks(self.filelist, picklefile, pcutoff=0.6)",
    "self.select_destfolder.SetPath(\"None\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.shuffles.SetValue(\"1\")",
    "DownSampleVideo(vname,width=-1,height=200,outsuffix='downsampled',outpath=None,rotateccw=False):",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.videotype.SetStringSelection(\".avi\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "if self.plot_scoremaps.GetStringSelection() == \"Yes\":",
    "Read the infer config file",
    "let the user open the file with default text editor. Also make it mac compatible",
    "shuffle = self.shuffle.GetValue()",
    "Read from edited inf. file first ...",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "icon = wx.StaticBitmap(self, bitmap=wx.Bitmap(logo))",
    "self.sizer.Add(icon, pos=(0, 4), flag=wx.TOP|wx.RIGHT|wx.ALIGN_RIGHT,border=5)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = cv2.imread(img)",
    "convert the image to RGB as you are showing the image with matplotlib",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of old labels",
    "Extracting the list of old unique labels",
    "Checking if new labels are added or not",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "print(self.dataFrame)",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "actualbpts=set(Data.columns.get_level_values(0))",
    "utility function to split different crops from same image into either train or test!",
    "loading & linking pretrained models",
    "CURRENTLY ONLY ResNet supported!",
    "multianimal case:",
    "ATTENTION: order has to be multibodyparts, then uniquebodyparts (for indexing)",
    "Loading the encoder (if necessary downloading from TF)",
    "Map back to the original indices.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "if socialbdpt in actualbpts:",
    "if socialbdpt in actualbpts:",
    "Drop missing body parts",
    "Drop points lying outside the image",
    "###############################################################################",
    "Saving metadata and data file (Pickle file)",
    "###############################################################################",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Setting inference cfg file:",
    "TODO:   \"distnormalization\":  could be calculated here based on data and set",
    ">> now we calculate this during evaluation (which is a good spot...)",
    "Load updated lists:",
    "Find the corresponding video file",
    "folders = [Path(config).parent / 'labeled-data' /Path(i[1]) for i in video_names]",
    "Avoid cropping already cropped images",
    "moving old entry to _original, dropping it from video_set and update crop parameters",
    "adding important values for multianiaml project:",
    "When concatenating DataFrames with misaligned column labels,",
    "all sorts of reordering may happen (mainly depending on 'sort' and 'join')",
    "Ensure the 'bodyparts' level agrees with the order in the config file.",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Check that points lie within the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "updating variable if null/None! #backwardscompatability",
    "Loading the encoder (if necessary downloading from TF)",
    "print(trainIndexes,testIndexes, Shuffles, augmenter_type,net_type)",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "sort the models directories",
    "get the shuffle index",
    "read cfg file",
    "create log file",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.individual_names+','+self.bodyParts)",
    "Check for variable correctness",
    "Moviepy:",
    "print(\"DLC loaded in light mode; you cannot use the labeling GUI!\")",
    "def __init__(self, point,bodyParts):",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.bodyParts)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "sess, inputs, outputs = predict.setup_pose_prediction(dlc_cfg)",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "from skimage.io import imread",
    "frame=imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "TODO: addd cropping as in video analysis!",
    "if cropping is not None:",
    "cfg['cropping']=True",
    "cfg['x1'],cfg['x2'],cfg['y1'],cfg['y2']=cropping",
    "print(\"Overwriting cropping parameters:\", cropping)",
    "print(\"These are used for all videos, but won't be save to the cfg file.\")",
    "Check which snapshots are available and sort them by # iterations",
    "Name for scorer:",
    "#################################################",
    "Looping over videos",
    "#################################################",
    "NOTE: this can be used if only a subset is relevant. I.e. [0,1] for only first and second joint!",
    "TODO: adjust this for multi + unique bodyparts!",
    "this is only for multianimal parts and uniquebodyparts as one (not one uniquebodyparts guy tracked etc. )",
    "get corresponding bounding boxes!",
    "Test whether the unique bodyparts have been assembled",
    "TODO Perhaps easier to check whether links were defined in the PAF graph?",
    "Find an unused tracklet ID for the 'unique' bodyparts",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "print(\"If the tracking is not satisfactory for some videos, consider expanding the training set. You can use the function 'extract_outlier_frames' to extract any outlier frames!\")",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "for DLC 2.2.",
    "Parameters for augmentation with regard to cropping",
    "Added and described in \"Using DeepLabCut for 3D markerless pose estimation across species and behaviors\"",
    "Source: https://www.nature.com/articles/s41596-019-0176-0",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "Name for deeplabcut net (based on its parameters)",
    "DLCscorer,DLCscorerlegacy = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "notanalyzed, resultsfilename, DLCscorer=auxiliaryfunctions.CheckifNotEvaluated(str(evaluationfolder),DLCscorer,DLCscorerlegacy,Snapshots[snapindex])",
    "print(\"Extracting maps for \", DLCscorer, \" with # of trainingiterations:\", trainingsiterations)",
    "if notanalyzed: #this only applies to ask if h5 exists...",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "return DATA",
    "print(np.shape(image),np.shape(scmap),np.shape(locref),np.shape(paf))",
    "dest_folder = os.path.join(cfg['project_path'], 'maps')",
    "Dependencies for anaysis",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Load meta data & annotations",
    "get the graph!",
    "plt.figure()",
    "source=np.array(Data[ind,j1,'x'][jj],Data[ind,j1,'y'][jj])",
    "target=np.array(Data[ind2,j1,'x'][jj],Data[ind2,j2,'y'][jj])",
    "NOTE: the inter-animal distances are currently not used, but are interesting to compare to intra_*",
    "plt.subplot(len(partaffinityfield_graph),1,pi+1)",
    "plt.hist(ds_within,bins=np.linspace(0,100,21),color='red')",
    "plt.hist(ds_across,bins=np.linspace(0,100,21),color='blue')",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "TODO: Make this code not so redundant!",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "df.to_hdf(output_path.replace('csv', 'h5'), 'df_with_missing', format='table', mode='w')",
    "Dependencies for anaysis",
    "#################################################",
    "Load data...",
    "#################################################",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "TODO: IMPLEMENT for different batch sizes?",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "print(dlc_cfg)",
    "Specifying state of model (snapshot / training state)",
    "Storing GT data as dictionary, so it can be used for calculating connection costs",
    "returning to intial folder",
    "wild guesses for a wide range:",
    "Check which snapshots are available and sort them by # iterations",
    "update number of individuals to retain.",
    "calculating result at best best solution",
    "print(\"Quantification:\", DataOptParams.head())",
    "Store best predictions",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "[_, loss_val, summary] = sess.run([train_op, total_loss, merged_summaries],feed_dict={learning_rate: current_lr})",
    "Save snapshot",
    "return to original path.",
    "from scipy.misc import imresize",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "from deeplabcut.pose_estimation_tensorflow.predict_multianimal import convert_detections2tracklet",
    "initializing constants",
    "PredicteData['frame'+str(counter)]=predict.get_detectionswithcosts(frame, dlc_cfg, sess, inputs, outputs, outall=False,nms_radius=dlc_cfg.nmsradius,det_min_score=dlc_cfg.minconfidence)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "PredicteData[batch_num*batchsize:(batch_num+1)*batchsize, :] = pose",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "PredicteData[batch_num*batchsize:batch_num*batchsize+batch_ind, :] = pose[:batch_ind,:]",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "PredicteData[batch_num*batchsize:(batch_num+1)*batchsize, :] = pose",
    "print(PredicteData)",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "print(end_points.keys()) >> to see what else is available.",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "from nets.mobilenet import conv_blocks as ops",
    "from nets.mobilenet import mobilenet as lib",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "The next part of the code depends upon which tensorflow version you have.",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "setting pairwise bodypart loss",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "get coordinates for bp1 and bp2",
    "'m2'",
    "distscalarproduct=np.zeros((len(C1),len(C2)))*np.nan",
    "distscalarproduct[c1i,c2i]=dy*v[1]+dx*v[0] #scalar product [v unit vector dx,dy in pixel coordinats from partaffinitymap]",
    "Distances[l]['m2'] = distscalarproduct",
    "TODO: compute all the grids etc. once for the video analysis method",
    "(and then just pass on the variables)",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "These two functions are for evaluation specifically (one also calculates integral between gt points)",
    "get dist_grid",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "# Functions below implement are for batch sizes > 1:",
    "get dist_grid",
    "apply nms",
    "IMPORTANT, as C++ function expects row-major",
    "batchsize,ny,nx,num_joints = scmap.shape",
    "The next part of the code depends upon which tensorflow version you have.",
    "return self.prediction_layers(net, end_points)",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Augmentation functions",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "Initializing variables if they don't exist...",
    "what is the fraction of training samples with scaling augmentation?",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "item.numanimals=len(item.joints)-1 #as there are also the parts that are not per animal",
    "Scale is sampled only once (per batch) to transform all of the images into same size.",
    "assert len(batch_images) == self.batch_size",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "imageio.imwrite(data_items[i].im_path.split('/')[-1],im)",
    "if returndata:",
    "return batch_images,batch_joints,targetmaps",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "print(person_id,joint_ids,data_item.im_path.split('/')[-1])",
    "if self.cfg.partaffinityfield_predict:",
    "print(\"hello\",joint_id)",
    "print(np.concatenate(joint_id)) #this is all joint_ids for all individuals!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "plt.savefig(\"along\"+str(data_item.im_path.split('/')[-1]))",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "print(person_id,k, j_id, coords[0])",
    "assert(0==1)",
    "A[:,:,2]=partaffinityfield_map[:,:,j]*0",
    "A[:,:,2]=partaffinityfield_map[:,:,j]*0",
    "plt.savefig(\"SomePafs\"+str(data_item.im_path.split('/')[-1]))",
    "WIP!",
    "STD of gaussian is 1/4 of threshold",
    "Grid of coordinates",
    "the animal id plays no role for scoremap + locref!",
    "so let's just loop over all bpts.",
    "Distance between the joint point and each coordinate",
    "NEEDS TO BE DONE!",
    "for k, joint_ids in enumerate(joint_id[person_id]):",
    "CONSIDER SMARTER SEARCHES here... (i.e. calculate the bpts beforehand?)",
    "mask3 = ((x >= 0) & (x <= width-1))",
    "mask4 = ((y >= 0) & (y <= height-1))",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "from scipy.misc import imread, imresize",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "from scipy.misc import imread, imresize",
    "from dataset.pose_dataset import Batch, data_to_input, mirror_joints_map, CropImage, DataItem",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "Get rid of the interpolation beyond the spline knots",
    "Retrieve original individual label indices",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "Process skeleton",
    "save",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "posefile=os.path.join(cfg['project_path'],'dlc-models/iteration-'+str(cfg['iteration'])+'/'+ cfg['Task'] + cfg['date'] + '-trainset' + str(int(cfg['TrainingFraction'][0] * 100)) + 'shuffle' + str(1),'train/pose_cfg.yaml')",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "deeplabcut.create_labeled_video(path_config_file,[newvideo], destfolder=dfolder,filtered=True)",
    "TENSORPACK could fail in WINDOWS...",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "#create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 simplifies network/augmentation comparisons greatly:",
    "legacy mode:",
    "new way:",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "example how to set pose config variables:",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)"
  ],
  "v2.1.7.1": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Supress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / require TF",
    "docs[0]['init_weights'] = '../../pretrained/resnet_v1_101.ckpt'",
    "dict_test['init_weights'] = 'models/mpii/snapshot-1030000'",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Create the pose_config.yaml files",
    "Analyze the videos",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "get vcap property",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Silently sweep the files that were already written.",
    "Set values to config file:",
    "cfg_file['resnet']=50",
    "Write dictionary to yaml  config file",
    "import yaml",
    "import cv2",
    "import shutil",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam1 camera",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "self.cropping = False",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.buttonCounter = []",
    "self.bodyparts = []",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "extract min and max index based on start stop interval.",
    "figure out body part list:",
    "all indices between start and stop with jump larger than epsilon (leading up to this point!)",
    "deviation_dataname = str(Path(videofolder)/Path(dataname))",
    "Calculate deviatons for video",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "data.to_csv(dataname.split('.h5')[0]+'filtered.csv')",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "Dataframe = pd.read_hdf(os.path.join(videofolder,dataname+'.h5'))",
    "drop duplicate labels:",
    "updates iteration by 1",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "print(\"DLC loaded in light mode; you cannot use the relabeling GUI!\")",
    "###################################################",
    "Dependencies",
    "###################################################",
    "import sys",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as specified in the config file",
    "rr, cc,val = line_aa(int(df_y[pair[0],index]),int(df_x[pair[0],index]),int(df_y[pair[1],index]), int(df_x[pair[1],index]))",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Adds skeleton to the video",
    "###################",
    "less transparent present.",
    "# One can change the parameters of the video creation script below:",
    "See ffmpeg user guide: http://ffmpeg.org/ffmpeg.html#Video-and-Audio-file-format-conversion",
    "",
    "if notanalyzed:",
    "notanalyzed,outdataname,sourcedataname,DLCscorer=auxiliaryfunctions.CheckifPostProcessing(folder,vname,DLCscorer,DLCscorerlegacy,suffix='checking')",
    "Loading cropping data used during analysis",
    "!/usr/bin/env python3",
    "Historically DLC used: from scipy.misc import imread, imresize >> deprecated functions",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "TODO check if those times exist...",
    "windows throws error if file path is > 260 characters, can fix with prefix. see https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "fig.colorbar(im, ax=ax)",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "LoadData",
    "nlines,numcolumns=data.shape",
    "assert(len(orderofbpincsv)==len(cfg['bodyparts']))",
    "TODO: test len of images vs. len of imagenames for another sanity check",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "with open(projconfigfile, 'w') as cf:",
    "ruamelFile_3d.dump(cfg_file_3d, cf)",
    "Read the pickle file",
    "Write the pickle file",
    "checks if input is a directory",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "Add all the options",
    "",
    "Hide the button as this is not the default option",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "wx.Frame.__init__(self, None, title=\"DeepLabCut\")",
    "wx.Frame.__init__( self, None, id = wx.ID_ANY, title = 'DeepLabCut',size = wx.Size(self.gui_size), pos = wx.DefaultPosition, style = wx.RESIZE_BORDER|wx.DEFAULT_FRAME_STYLE|wx.TAB_TRAVERSAL )",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "Read the pose config file",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.shuffles = wx.SpinCtrl(self, value='1',min=1,max=100)",
    "shuffles_text_boxsizer.Add(self.shuffles,1, wx.EXPAND|wx.TOP|wx.BOTTOM, 10)",
    "if self.draw_skeleton.IsShow():",
    "if self.draw_skeleton.GetStringSelection() == \"Yes\":",
    "self.draw = True",
    "else:",
    "self.draw = True",
    "print(self.config,self.filelist,self.videotype.GetValue(),shuffle,trainingsetindex,gputouse=None,save_as_csv=save_as_csv,destfolder=self.destfolder,cropping=cropping)",
    "self.gpu.SetValue(-1)",
    "import wx.lib.scrolledpanel as SP",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.hbox2 = wx.BoxSizer(wx.HORIZONTAL)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "boxsizer.Add(self.hbox2,5, wx.EXPAND|wx.TOP|wx.BOTTOM, 10)",
    "shuffle = self.shuffle.GetValue()",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.sel_config.SetPath(\"Please select the config file\")",
    "else:",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = cv2.imread(img)",
    "convert the image to RGB as you are showing the image with matplotlib",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of old labels",
    "Extracting the list of old unique labels",
    "Checking if new labels are added or not",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checking if user added a new label",
    "if self.new_Multibodyparts==[] and self.new_UniqueBodyparts==[]: # i.e. no new labels",
    "self.figure,self.axes,self.canvas,self.toolbar,self.image_axis = self.image_panel.drawplot(self.img,img_name,self.iter,self.index,self.multibodyparts,self.colormap,keep_view=self.view_locked)",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "self.image_panel.addcolorbar(self.img,self.image_axis,self.iter,self.multibodyparts,self.colormap)",
    "# Only show the bodyparts corresponding to single",
    "if self.individual_names[0] == 'single':",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.uniquebodyparts,self.individual_names,self.file,self.markerSize)",
    "else:",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.multibodyparts,self.individual_names,self.file,self.markerSize)",
    "",
    "self.individualrdb.Bind(wx.EVT_RADIOBOX,self.select_individual)",
    "",
    "# Get the color index, depending on if single is selcted or not.",
    "if self.rdb.GetStringSelection==\"single\":",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "else:",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "self.cidClick = self.canvas.mpl_connect('button_press_event', self.onClick)",
    "else:",
    "# Found new labels in either multiple bodyparts or unique bodyparts",
    "dlg = wx.MessageDialog(None,\"New label found in the config file. Do you want to see all the other labels?\", \"New label found\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_NO:",
    "if self.new_Multibodyparts!=[]:",
    "self.multibodyparts = self.new_Multibodyparts",
    "if self.new_UniqueBodyparts!=[]:",
    "self.uniquebodyparts = self.new_UniqueBodyparts",
    "",
    "self.dataFrame = MainFrame.create_dataframe(self,self.dataFrame,self.relativeimagenames,self.individual_names,self.new_UniqueBodyparts,self.new_Multibodyparts)",
    "self.figure,self.axes,self.canvas,self.toolbar,self.image_axis = self.image_panel.drawplot(self.img,img_name,self.iter,self.index,self.multibodyparts,self.colormap,keep_view=self.view_locked)",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "self.image_panel.addcolorbar(self.img,self.image_axis,self.iter,self.multibodyparts,self.colormap)",
    "",
    "if self.individual_names[0] == 'single':",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.uniquebodyparts,self.individual_names,self.file,self.markerSize)",
    "else:",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.multibodyparts,self.individual_names,self.file,self.markerSize)",
    "self.individualrdb.Bind(wx.EVT_RADIOBOX,self.select_individual)",
    "if self.rdb.GetStringSelection==\"single\":",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "else:",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "self.cidClick = self.canvas.mpl_connect('button_press_event', self.onClick)",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "def plot(self,img):",
    "self.drs= []",
    "self.updatedCoords = []",
    "for ind in self.individual_names:",
    "if self.are_unique_bodyparts_present == False: #no unique bodyparts present",
    "#            for ind in self.individual_names:",
    "image_points = []",
    "for c, bp in enumerate(self.multibodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.multibodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.multibodyparts[c])",
    "else:",
    "if ind == 'single':",
    "for c, bp in enumerate(self.uniquebodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.uniquebodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.uniquebodyparts[c])",
    "else:",
    "for c, bp in enumerate(self.multibodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.multibodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.multibodyparts[c])",
    "",
    "MainFrame.saveEachImage(self)",
    "self.figure.canvas.draw()",
    "return(self.buttonCounter)",
    "print(self.dataFrame)",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "matplotlib.use('Agg')",
    "Load updated lists:",
    "cfg['video_sets'][vn]",
    "labeling_toolbox.show(config,Screens,scale_w,scale_h, winHack, img_scale)",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "plt.savefig(str(Path(tmpfolder)/imagename.split(os.sep)[-1]))",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Check that points lie within the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "print(trainIndexes,testIndexes, Shuffles, augmenter_type,net_type)",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "sort the models directories",
    "get the shuffle index",
    "read cfg file",
    "create log file",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.individual_names+','+self.bodyParts)",
    "Check for variable correctness",
    "Moviepy:",
    "print(\"DLC loaded in light mode; you cannot use the labeling GUI!\")",
    "def __init__(self, point,bodyParts):",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.bodyParts)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "sess, inputs, outputs = predict.setup_pose_prediction(dlc_cfg)",
    "#################################################",
    "Datafolder",
    "#################################################",
    "looping over videos",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "from skimage.io import imread",
    "frame=imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "Parameters for augmentation with regard to cropping",
    "Added and described in \"Using DeepLabCut for 3D markerless pose estimation across species and behaviors\"",
    "Source: https://www.nature.com/articles/s41596-019-0176-0",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Deploy config.yaml - info about project origin:",
    "Project path",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "#######################",
    "## find snapshot to use",
    "#######################",
    "Check which snapshots are available and sort them by # iterations",
    "###################################",
    "## Load and setup CNN part detector",
    "###################################",
    "Check if data already was generated:",
    "load network",
    "save graph to pbtxt file",
    "create frozen graph from pbtxt file",
    "## read config file",
    "## load model",
    "## set up export directory",
    "## write pose config file",
    "sort dlc_cfg keys alphabetically, then save to pose_cfg.yaml in export directory",
    "## copy checkpoint to export directory",
    "## create pbtxt and pb files for checkpoint in export directory",
    "## tar export directory",
    "Dependencies for anaysis",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "DLCscorer = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "import skimage.color",
    "from skimage.io import imread",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "image = skimage.color.gray2rgb(image)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "df.to_hdf(output_path.replace('csv', 'h5'), 'df_with_missing', format='table', mode='w')",
    "from scipy.misc import imresize",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Read file path for pose_config file. >> pass it on",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "print(end_points.keys()) >> to see what else is available.",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "from nets.mobilenet import conv_blocks as ops",
    "from nets.mobilenet import mobilenet as lib",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "The next part of the code depends upon which tensorflow version you have.",
    "if cfg.location_refinement:",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "from scipy.misc import imresize",
    "Augmentation functions",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "Initializing variables if they don't exist...",
    "what is the fraction of training samples with scaling augmentation?",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "from scipy.misc import imread, imresize",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "from scipy.misc import imread, imresize",
    "from dataset.pose_dataset import Batch, data_to_input, mirror_joints_map, CropImage, DataItem",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "Process skeleton",
    "save",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "deeplabcut.create_labeled_video(path_config_file,[newvideo], destfolder=dfolder,filtered=True)",
    "TENSORPACK could fail in WINDOWS...",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "#create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 does that much easier...",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "print(\"Analyze Video\")",
    "videofile_path = os.path.join(os.getcwd(),'openfield-Pranav-2018-10-30','videos','m3v1mp4.mp4')",
    "deeplabcut.analyze_videos(path_config_file,[videofile_path], shuffle=shuffle)",
    "print(\"Create Labeled Video\")",
    "deeplabcut.create_labeled_video(path_config_file,[videofile_path],save_frames=False, shuffle=shuffle)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)"
  ],
  "v2.1.6.4": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Supress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / require TF",
    "docs[0]['init_weights'] = '../../pretrained/resnet_v1_101.ckpt'",
    "dict_test['init_weights'] = 'models/mpii/snapshot-1030000'",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Create the pose_config.yaml files",
    "Analyze the videos",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "get vcap property",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "Import all videos in a folder or if just one video withouth [] passed, then make it a list.",
    "if isinstance(videos,str):",
    "#there are two cases:",
    "if os.path.isdir(videos): # it is a path!",
    "path=videos",
    "videos=[os.path.join(path,vp) for vp in os.listdir(path) if videotype in vp]",
    "if len(videos)==0:",
    "print(\"No videos found in\",path,os.listdir(path))",
    "print(\"Perhaps change the videotype, which is currently set to:\", videotype)",
    "else:",
    "print(\"Directory entered, \" , len(videos),\" videos were found.\")",
    "else:",
    "if os.path.isfile(videos):",
    "videos=[videos]",
    "https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "try:",
    "#shutil.copy(src,dst)",
    "except OSError or TypeError: #https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "shutil.copy(os.fspath(src),os.fspath(dst))",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Set values to config file:",
    "cfg_file['resnet']=50",
    "Write dictionary to yaml  config file",
    "import yaml",
    "import cv2",
    "import shutil",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam1 camera",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "self.cropping = False",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.slider.Enable(False)",
    "self.checkBox.Enable(False)",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "extract min and max index based on start stop interval.",
    "figure out body part list:",
    "all indices between start and stop with jump larger than epsilon (leading up to this point!)",
    "deviation_dataname = str(Path(videofolder)/Path(dataname))",
    "Calculate deviatons for video",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "The process is not stationary, but the default SARIMAX model tries to solve for such a distribution...",
    "Relaxing those constraints should do the job.",
    "data.to_csv(dataname.split('.h5')[0]+'filtered.csv')",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "Dataframe = pd.read_hdf(os.path.join(videofolder,dataname+'.h5'))",
    "drop duplicate labels:",
    "updates iteration by 1",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "print(\"DLC loaded in light mode; you cannot use the relabeling GUI!\")",
    "###################################################",
    "Dependencies",
    "###################################################",
    "import sys",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as specified in the config file",
    "rr, cc,val = line_aa(int(df_y[pair[0],index]),int(df_x[pair[0],index]),int(df_y[pair[1],index]), int(df_x[pair[1],index]))",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Adds skeleton to the video",
    "###################",
    "less transparent present.",
    "# One can change the parameters of the video creation script below:",
    "See ffmpeg user guide: http://ffmpeg.org/ffmpeg.html#Video-and-Audio-file-format-conversion",
    "",
    "if notanalyzed:",
    "notanalyzed,outdataname,sourcedataname,DLCscorer=auxiliaryfunctions.CheckifPostProcessing(folder,vname,DLCscorer,DLCscorerlegacy,suffix='checking')",
    "Loading cropping data used during analysis",
    "!/usr/bin/env python3",
    "Historically DLC used: from scipy.misc import imread, imresize >> deprecated functions",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "TODO check if those times exist...",
    "windows throws error if file path is > 260 characters, can fix with prefix. see https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "fig.colorbar(im, ax=ax)",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "LoadData",
    "nlines,numcolumns=data.shape",
    "assert(len(orderofbpincsv)==len(cfg['bodyparts']))",
    "TODO: test len of images vs. len of imagenames for another sanity check",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "with open(projconfigfile, 'w') as cf:",
    "ruamelFile_3d.dump(cfg_file_3d, cf)",
    "Read the pickle file",
    "Write the pickle file",
    "checks if input is a directory",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "Add all the options",
    "",
    "Hide the button as this is not the default option",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "wx.Frame.__init__(self, None, title=\"DeepLabCut\")",
    "wx.Frame.__init__( self, None, id = wx.ID_ANY, title = 'DeepLabCut',size = wx.Size(self.gui_size), pos = wx.DefaultPosition, style = wx.RESIZE_BORDER|wx.DEFAULT_FRAME_STYLE|wx.TAB_TRAVERSAL )",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "Read the pose config file",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.shuffles = wx.SpinCtrl(self, value='1',min=1,max=100)",
    "shuffles_text_boxsizer.Add(self.shuffles,1, wx.EXPAND|wx.TOP|wx.BOTTOM, 10)",
    "if self.draw_skeleton.IsShow():",
    "if self.draw_skeleton.GetStringSelection() == \"Yes\":",
    "self.draw = True",
    "else:",
    "self.draw = True",
    "print(self.config,self.filelist,self.videotype.GetValue(),shuffle,trainingsetindex,gputouse=None,save_as_csv=save_as_csv,destfolder=self.destfolder,cropping=cropping)",
    "self.gpu.SetValue(-1)",
    "import wx.lib.scrolledpanel as SP",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.hbox2 = wx.BoxSizer(wx.HORIZONTAL)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "boxsizer.Add(self.hbox2,5, wx.EXPAND|wx.TOP|wx.BOTTOM, 10)",
    "shuffle = self.shuffle.GetValue()",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.sel_config.SetPath(\"Please select the config file\")",
    "else:",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = cv2.imread(img)",
    "convert the image to RGB as you are showing the image with matplotlib",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of old labels",
    "Extracting the list of old unique labels",
    "Checking if new labels are added or not",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checking if user added a new label",
    "if self.new_Multibodyparts==[] and self.new_UniqueBodyparts==[]: # i.e. no new labels",
    "self.figure,self.axes,self.canvas,self.toolbar,self.image_axis = self.image_panel.drawplot(self.img,img_name,self.iter,self.index,self.multibodyparts,self.colormap,keep_view=self.view_locked)",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "self.image_panel.addcolorbar(self.img,self.image_axis,self.iter,self.multibodyparts,self.colormap)",
    "# Only show the bodyparts corresponding to single",
    "if self.individual_names[0] == 'single':",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.uniquebodyparts,self.individual_names,self.file,self.markerSize)",
    "else:",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.multibodyparts,self.individual_names,self.file,self.markerSize)",
    "",
    "self.individualrdb.Bind(wx.EVT_RADIOBOX,self.select_individual)",
    "",
    "# Get the color index, depending on if single is selcted or not.",
    "if self.rdb.GetStringSelection==\"single\":",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "else:",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "self.cidClick = self.canvas.mpl_connect('button_press_event', self.onClick)",
    "else:",
    "# Found new labels in either multiple bodyparts or unique bodyparts",
    "dlg = wx.MessageDialog(None,\"New label found in the config file. Do you want to see all the other labels?\", \"New label found\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_NO:",
    "if self.new_Multibodyparts!=[]:",
    "self.multibodyparts = self.new_Multibodyparts",
    "if self.new_UniqueBodyparts!=[]:",
    "self.uniquebodyparts = self.new_UniqueBodyparts",
    "",
    "self.dataFrame = MainFrame.create_dataframe(self,self.dataFrame,self.relativeimagenames,self.individual_names,self.new_UniqueBodyparts,self.new_Multibodyparts)",
    "self.figure,self.axes,self.canvas,self.toolbar,self.image_axis = self.image_panel.drawplot(self.img,img_name,self.iter,self.index,self.multibodyparts,self.colormap,keep_view=self.view_locked)",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "self.image_panel.addcolorbar(self.img,self.image_axis,self.iter,self.multibodyparts,self.colormap)",
    "",
    "if self.individual_names[0] == 'single':",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.uniquebodyparts,self.individual_names,self.file,self.markerSize)",
    "else:",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.multibodyparts,self.individual_names,self.file,self.markerSize)",
    "self.individualrdb.Bind(wx.EVT_RADIOBOX,self.select_individual)",
    "if self.rdb.GetStringSelection==\"single\":",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "else:",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "self.cidClick = self.canvas.mpl_connect('button_press_event', self.onClick)",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "def plot(self,img):",
    "self.drs= []",
    "self.updatedCoords = []",
    "for ind in self.individual_names:",
    "if self.are_unique_bodyparts_present == False: #no unique bodyparts present",
    "#            for ind in self.individual_names:",
    "image_points = []",
    "for c, bp in enumerate(self.multibodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.multibodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.multibodyparts[c])",
    "else:",
    "if ind == 'single':",
    "for c, bp in enumerate(self.uniquebodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.uniquebodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.uniquebodyparts[c])",
    "else:",
    "for c, bp in enumerate(self.multibodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.multibodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.multibodyparts[c])",
    "",
    "MainFrame.saveEachImage(self)",
    "self.figure.canvas.draw()",
    "return(self.buttonCounter)",
    "print(self.dataFrame)",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "matplotlib.use('Agg')",
    "Load updated lists:",
    "cfg['video_sets'][vn]",
    "labeling_toolbox.show(config,Screens,scale_w,scale_h, winHack, img_scale)",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "plt.savefig(str(Path(tmpfolder)/imagename.split(os.sep)[-1]))",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Check that points lie within the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "print(trainIndexes,testIndexes, Shuffles, augmenter_type,net_type)",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "sort the models directories",
    "get the shuffle index",
    "read cfg file",
    "create log file",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.individual_names+','+self.bodyParts)",
    "Check for variable correctness",
    "Moviepy:",
    "close video.",
    "print(\"DLC loaded in light mode; you cannot use the labeling GUI!\")",
    "def __init__(self, point,bodyParts):",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.bodyParts)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "sess, inputs, outputs = predict.setup_pose_prediction(dlc_cfg)",
    "#################################################",
    "Datafolder",
    "#################################################",
    "looping over videos",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "from skimage.io import imread",
    "frame=imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "Parameters for augmentation with regard to cropping",
    "Added and described in \"Using DeepLabCut for 3D markerless pose estimation across species and behaviors\"",
    "Source: https://www.nature.com/articles/s41596-019-0176-0",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Dependencies for anaysis",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "DLCscorer = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "import skimage.color",
    "from skimage.io import imread",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "image = skimage.color.gray2rgb(image)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "df.to_hdf(output_path.replace('csv', 'h5'), 'df_with_missing', format='table', mode='w')",
    "from scipy.misc import imresize",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Read file path for pose_config file. >> pass it on",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "print(end_points.keys()) >> to see what else is available.",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "from nets.mobilenet import conv_blocks as ops",
    "from nets.mobilenet import mobilenet as lib",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "The next part of the code depends upon which tensorflow version you have.",
    "if cfg.location_refinement:",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "from scipy.misc import imresize",
    "Augmentation functions",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "Initializing variables if they don't exist...",
    "what is the fraction of training samples with scaling augmentation?",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "from scipy.misc import imread, imresize",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "from scipy.misc import imread, imresize",
    "from dataset.pose_dataset import Batch, data_to_input, mirror_joints_map, CropImage, DataItem",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "Process skeleton",
    "save",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "deeplabcut.create_labeled_video(path_config_file,[newvideo], destfolder=dfolder,filtered=True)",
    "TENSORPACK could fail in WINDOWS...",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "#create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 does that much easier...",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "deeplabcut.load_demo_data(path_config_file)",
    "shuffle=11 #>> imageio functions!",
    "print(\"Analyze Video\")",
    "videofile_path = os.path.join(os.getcwd(),'openfield-Pranav-2018-10-30','videos','m3v1mp4.mp4')",
    "deeplabcut.analyze_videos(path_config_file,[videofile_path], shuffle=shuffle)",
    "print(\"Create Labeled Video\")",
    "deeplabcut.create_labeled_video(path_config_file,[videofile_path],save_frames=False, shuffle=shuffle)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)"
  ],
  "v2.1.6": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Supress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / require TF",
    "docs[0]['init_weights'] = '../../pretrained/resnet_v1_101.ckpt'",
    "dict_test['init_weights'] = 'models/mpii/snapshot-1030000'",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Create the pose_config.yaml files",
    "Analyze the videos",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "get vcap property",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "Import all videos in a folder or if just one video withouth [] passed, then make it a list.",
    "if isinstance(videos,str):",
    "#there are two cases:",
    "if os.path.isdir(videos): # it is a path!",
    "path=videos",
    "videos=[os.path.join(path,vp) for vp in os.listdir(path) if videotype in vp]",
    "if len(videos)==0:",
    "print(\"No videos found in\",path,os.listdir(path))",
    "print(\"Perhaps change the videotype, which is currently set to:\", videotype)",
    "else:",
    "print(\"Directory entered, \" , len(videos),\" videos were found.\")",
    "else:",
    "if os.path.isfile(videos):",
    "videos=[videos]",
    "https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "try:",
    "#shutil.copy(src,dst)",
    "except OSError or TypeError: #https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "shutil.copy(os.fspath(src),os.fspath(dst))",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Set values to config file:",
    "cfg_file['resnet']=50",
    "Write dictionary to yaml  config file",
    "import yaml",
    "import cv2",
    "import shutil",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam1 camera",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "self.cropping = False",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.slider.Enable(False)",
    "self.checkBox.Enable(False)",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "extract min and max index based on start stop interval.",
    "figure out body part list:",
    "all indices between start and stop with jump larger than epsilon (leading up to this point!)",
    "deviation_dataname = str(Path(videofolder)/Path(dataname))",
    "Calculate deviatons for video",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "data.to_csv(dataname.split('.h5')[0]+'filtered.csv')",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "Dataframe = pd.read_hdf(os.path.join(videofolder,dataname+'.h5'))",
    "drop duplicate labels:",
    "updates iteration by 1",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "print(\"DLC loaded in light mode; you cannot use the relabeling GUI!\")",
    "###################################################",
    "Dependencies",
    "###################################################",
    "import sys",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as specified in the config file",
    "rr, cc,val = line_aa(int(df_y[pair[0],index]),int(df_x[pair[0],index]),int(df_y[pair[1],index]), int(df_x[pair[1],index]))",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Adds skeleton to the video",
    "###################",
    "less transparent present.",
    "# One can change the parameters of the video creation script below:",
    "See ffmpeg user guide: http://ffmpeg.org/ffmpeg.html#Video-and-Audio-file-format-conversion",
    "",
    "if notanalyzed:",
    "notanalyzed,outdataname,sourcedataname,DLCscorer=auxiliaryfunctions.CheckifPostProcessing(folder,vname,DLCscorer,DLCscorerlegacy,suffix='checking')",
    "Loading cropping data used during analysis",
    "!/usr/bin/env python3",
    "Historically DLC used: from scipy.misc import imread, imresize >> deprecated functions",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "TODO check if those times exist...",
    "windows throws error if file path is > 260 characters, can fix with prefix. see https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "fig.colorbar(im, ax=ax)",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "LoadData",
    "nlines,numcolumns=data.shape",
    "assert(len(orderofbpincsv)==len(cfg['bodyparts']))",
    "TODO: test len of images vs. len of imagenames for another sanity check",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "with open(projconfigfile, 'w') as cf:",
    "ruamelFile_3d.dump(cfg_file_3d, cf)",
    "Read the pickle file",
    "Write the pickle file",
    "checks if input is a directory",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "Add all the options",
    "",
    "Hide the button as this is not the default option",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "wx.Frame.__init__(self, None, title=\"DeepLabCut\")",
    "wx.Frame.__init__( self, None, id = wx.ID_ANY, title = 'DeepLabCut',size = wx.Size(self.gui_size), pos = wx.DefaultPosition, style = wx.RESIZE_BORDER|wx.DEFAULT_FRAME_STYLE|wx.TAB_TRAVERSAL )",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.crop_choice = wx.RadioBox(self, label='Want to crop the frames?', choices=['No', 'Yes'],majorDimension=1, style=wx.RA_SPECIFY_COLS)",
    "hbox1.Add(self.crop_choice,5, wx.EXPAND|wx.TOP|wx.BOTTOM, 5)",
    "self.crop_choice.Enable(False)",
    "self.crop_choice.Enable(True)",
    "if self.crop_choice.GetStringSelection() == 'Yes':",
    "crop = True",
    "else:",
    "crop = False",
    "self.crop_choice.Enable(True)",
    "self.crop_choice.SetStringSelection(\"No\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "Read the pose config file",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.shuffles = wx.SpinCtrl(self, value='1',min=1,max=100)",
    "shuffles_text_boxsizer.Add(self.shuffles,1, wx.EXPAND|wx.TOP|wx.BOTTOM, 10)",
    "if self.draw_skeleton.IsShow():",
    "if self.draw_skeleton.GetStringSelection() == \"Yes\":",
    "self.draw = True",
    "else:",
    "self.draw = True",
    "print(self.config,self.filelist,self.videotype.GetValue(),shuffle,trainingsetindex,gputouse=None,save_as_csv=save_as_csv,destfolder=self.destfolder,cropping=cropping)",
    "self.gpu.SetValue(-1)",
    "import wx.lib.scrolledpanel as SP",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.hbox2 = wx.BoxSizer(wx.HORIZONTAL)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "boxsizer.Add(self.hbox2,5, wx.EXPAND|wx.TOP|wx.BOTTOM, 10)",
    "shuffle = self.shuffle.GetValue()",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.sel_config.SetPath(\"Please select the config file\")",
    "else:",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = cv2.imread(img)",
    "convert the image to RGB as you are showing the image with matplotlib",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "if self.uniquebodyparts == \"\":",
    "self.uniquebodyparts = self.multibodyparts",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of old labels",
    "Extracting the list of old unique labels",
    "Checking if new labels are added or not",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checking if user added a new label",
    "if self.new_Multibodyparts==[] and self.new_UniqueBodyparts==[]: # i.e. no new labels",
    "self.figure,self.axes,self.canvas,self.toolbar,self.image_axis = self.image_panel.drawplot(self.img,img_name,self.iter,self.index,self.multibodyparts,self.colormap,keep_view=self.view_locked)",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "self.image_panel.addcolorbar(self.img,self.image_axis,self.iter,self.multibodyparts,self.colormap)",
    "# Only show the bodyparts corresponding to single",
    "if self.individual_names[0] == 'single':",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.uniquebodyparts,self.individual_names,self.file,self.markerSize)",
    "else:",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.multibodyparts,self.individual_names,self.file,self.markerSize)",
    "",
    "self.individualrdb.Bind(wx.EVT_RADIOBOX,self.select_individual)",
    "",
    "# Get the color index, depending on if single is selcted or not.",
    "if self.rdb.GetStringSelection==\"single\":",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "else:",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "self.cidClick = self.canvas.mpl_connect('button_press_event', self.onClick)",
    "else:",
    "# Found new labels in either multiple bodyparts or unique bodyparts",
    "dlg = wx.MessageDialog(None,\"New label found in the config file. Do you want to see all the other labels?\", \"New label found\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_NO:",
    "if self.new_Multibodyparts!=[]:",
    "self.multibodyparts = self.new_Multibodyparts",
    "if self.new_UniqueBodyparts!=[]:",
    "self.uniquebodyparts = self.new_UniqueBodyparts",
    "",
    "self.dataFrame = MainFrame.create_dataframe(self,self.dataFrame,self.relativeimagenames,self.individual_names,self.new_UniqueBodyparts,self.new_Multibodyparts)",
    "self.figure,self.axes,self.canvas,self.toolbar,self.image_axis = self.image_panel.drawplot(self.img,img_name,self.iter,self.index,self.multibodyparts,self.colormap,keep_view=self.view_locked)",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "self.image_panel.addcolorbar(self.img,self.image_axis,self.iter,self.multibodyparts,self.colormap)",
    "",
    "if self.individual_names[0] == 'single':",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.uniquebodyparts,self.individual_names,self.file,self.markerSize)",
    "else:",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.multibodyparts,self.individual_names,self.file,self.markerSize)",
    "self.individualrdb.Bind(wx.EVT_RADIOBOX,self.select_individual)",
    "if self.rdb.GetStringSelection==\"single\":",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "else:",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "self.cidClick = self.canvas.mpl_connect('button_press_event', self.onClick)",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "def plot(self,img):",
    "self.drs= []",
    "self.updatedCoords = []",
    "for ind in self.individual_names:",
    "if self.are_unique_bodyparts_present == False: #no unique bodyparts present",
    "#            for ind in self.individual_names:",
    "image_points = []",
    "for c, bp in enumerate(self.multibodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.multibodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.multibodyparts[c])",
    "else:",
    "if ind == 'single':",
    "for c, bp in enumerate(self.uniquebodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.uniquebodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.uniquebodyparts[c])",
    "else:",
    "for c, bp in enumerate(self.multibodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.multibodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.multibodyparts[c])",
    "",
    "MainFrame.saveEachImage(self)",
    "self.figure.canvas.draw()",
    "return(self.buttonCounter)",
    "print(self.dataFrame)",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "matplotlib.use('Agg')",
    "Load updated lists:",
    "cfg['video_sets'][vn]",
    "labeling_toolbox.show(config,Screens,scale_w,scale_h, winHack, img_scale)",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "plt.savefig(str(Path(tmpfolder)/imagename.split(os.sep)[-1]))",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Check that points lie within the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "print(trainIndexes,testIndexes, Shuffles, augmenter_type,net_type)",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "sort the models directories",
    "get the shuffle index",
    "read cfg file",
    "create log file",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.individual_names+','+self.bodyParts)",
    "Check for variable correctness",
    "plt.close(\"all\")",
    "Moviepy:",
    "Call the GUI to select the cropping parameters",
    "Update the config.yaml file with current cropping parameters",
    "store full frame from random location (good for augmentation)",
    "clip=clip.crop(y1 = int(coords[2]),y2 = int(coords[3]),x1 = int(coords[0]), x2 = int(coords[1]))",
    "close video.",
    "print(\"DLC loaded in light mode; you cannot use the labeling GUI!\")",
    "def __init__(self, point,bodyParts):",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.bodyParts)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "sess, inputs, outputs = predict.setup_pose_prediction(dlc_cfg)",
    "#################################################",
    "Datafolder",
    "#################################################",
    "looping over videos",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "from skimage.io import imread",
    "frame=imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "Parameters for augmentation with regard to cropping",
    "Added and described in \"Using DeepLabCut for 3D markerless pose estimation across species and behaviors\"",
    "Source: https://www.nature.com/articles/s41596-019-0176-0",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Dependencies for anaysis",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "DLCscorer = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "import skimage.color",
    "from skimage.io import imread",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "image = skimage.color.gray2rgb(image)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "df.to_hdf(output_path.replace('csv', 'h5'), 'df_with_missing', format='table', mode='w')",
    "from scipy.misc import imresize",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Read file path for pose_config file. >> pass it on",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "print(end_points.keys()) >> to see what else is available.",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "from nets.mobilenet import conv_blocks as ops",
    "from nets.mobilenet import mobilenet as lib",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "The next part of the code depends upon which tensorflow version you have.",
    "if cfg.location_refinement:",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "from scipy.misc import imresize",
    "Augmentation functions",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "Initializing variables if they don't exist...",
    "what is the fraction of training samples with scaling augmentation?",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "from scipy.misc import imread, imresize",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "from scipy.misc import imread, imresize",
    "from dataset.pose_dataset import Batch, data_to_input, mirror_joints_map, CropImage, DataItem",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "Process skeleton",
    "save",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "deeplabcut.create_labeled_video(path_config_file,[newvideo], destfolder=dfolder,filtered=True)",
    "TENSORPACK could fail in WINDOWS...",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "#create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 does that much easier...",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "deeplabcut.load_demo_data(path_config_file)",
    "shuffle=11 #>> imageio functions!",
    "print(\"Analyze Video\")",
    "videofile_path = os.path.join(os.getcwd(),'openfield-Pranav-2018-10-30','videos','m3v1mp4.mp4')",
    "deeplabcut.analyze_videos(path_config_file,[videofile_path], shuffle=shuffle)",
    "print(\"Create Labeled Video\")",
    "deeplabcut.create_labeled_video(path_config_file,[videofile_path],save_frames=False, shuffle=shuffle)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)"
  ],
  "v2.1.5.2": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Supress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / require TF",
    "docs[0]['init_weights'] = '../../pretrained/resnet_v1_101.ckpt'",
    "dict_test['init_weights'] = 'models/mpii/snapshot-1030000'",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Create the pose_config.yaml files",
    "Analyze the videos",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "get vcap property",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "Import all videos in a folder or if just one video withouth [] passed, then make it a list.",
    "if isinstance(videos,str):",
    "#there are two cases:",
    "if os.path.isdir(videos): # it is a path!",
    "path=videos",
    "videos=[os.path.join(path,vp) for vp in os.listdir(path) if videotype in vp]",
    "if len(videos)==0:",
    "print(\"No videos found in\",path,os.listdir(path))",
    "print(\"Perhaps change the videotype, which is currently set to:\", videotype)",
    "else:",
    "print(\"Directory entered, \" , len(videos),\" videos were found.\")",
    "else:",
    "if os.path.isfile(videos):",
    "videos=[videos]",
    "https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "try:",
    "#shutil.copy(src,dst)",
    "except OSError or TypeError: #https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "shutil.copy(os.fspath(src),os.fspath(dst))",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Set values to config file:",
    "cfg_file['resnet']=50",
    "Write dictionary to yaml  config file",
    "import yaml",
    "import cv2",
    "import shutil",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam1 camera",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "self.cropping = False",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.slider.Enable(False)",
    "self.checkBox.Enable(False)",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "extract min and max index based on start stop interval.",
    "figure out body part list:",
    "all indices between start and stop with jump larger than epsilon (leading up to this point!)",
    "deviation_dataname = str(Path(videofolder)/Path(dataname))",
    "Calculate deviatons for video",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "data.to_csv(dataname.split('.h5')[0]+'filtered.csv')",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "Dataframe = pd.read_hdf(os.path.join(videofolder,dataname+'.h5'))",
    "drop duplicate labels:",
    "updates iteration by 1",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "print(\"DLC loaded in light mode; you cannot use the relabeling GUI!\")",
    "###################################################",
    "Dependencies",
    "###################################################",
    "import sys",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as specified in the config file",
    "rr, cc,val = line_aa(int(df_y[pair[0],index]),int(df_x[pair[0],index]),int(df_y[pair[1],index]), int(df_x[pair[1],index]))",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Adds skeleton to the video",
    "###################",
    "less transparent present.",
    "# One can change the parameters of the video creation script below:",
    "See ffmpeg user guide: http://ffmpeg.org/ffmpeg.html#Video-and-Audio-file-format-conversion",
    "",
    "if notanalyzed:",
    "notanalyzed,outdataname,sourcedataname,DLCscorer=auxiliaryfunctions.CheckifPostProcessing(folder,vname,DLCscorer,DLCscorerlegacy,suffix='checking')",
    "Loading cropping data used during analysis",
    "!/usr/bin/env python3",
    "Historically DLC used: from scipy.misc import imread, imresize >> deprecated functions",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "TODO check if those times exist...",
    "windows throws error if file path is > 260 characters, can fix with prefix. see https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "fig.colorbar(im, ax=ax)",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "LoadData",
    "nlines,numcolumns=data.shape",
    "assert(len(orderofbpincsv)==len(cfg['bodyparts']))",
    "TODO: test len of images vs. len of imagenames for another sanity check",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "with open(projconfigfile, 'w') as cf:",
    "ruamelFile_3d.dump(cfg_file_3d, cf)",
    "Read the pickle file",
    "Write the pickle file",
    "checks if input is a directory",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "Add all the options",
    "",
    "Hide the button as this is not the default option",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "wx.Frame.__init__(self, None, title=\"DeepLabCut\")",
    "wx.Frame.__init__( self, None, id = wx.ID_ANY, title = 'DeepLabCut',size = wx.Size(self.gui_size), pos = wx.DefaultPosition, style = wx.RESIZE_BORDER|wx.DEFAULT_FRAME_STYLE|wx.TAB_TRAVERSAL )",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.crop_choice = wx.RadioBox(self, label='Want to crop the frames?', choices=['No', 'Yes'],majorDimension=1, style=wx.RA_SPECIFY_COLS)",
    "hbox1.Add(self.crop_choice,5, wx.EXPAND|wx.TOP|wx.BOTTOM, 5)",
    "self.crop_choice.Enable(False)",
    "self.crop_choice.Enable(True)",
    "if self.crop_choice.GetStringSelection() == 'Yes':",
    "crop = True",
    "else:",
    "crop = False",
    "self.crop_choice.Enable(True)",
    "self.crop_choice.SetStringSelection(\"No\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "Read the pose config file",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.shuffles = wx.SpinCtrl(self, value='1',min=1,max=100)",
    "shuffles_text_boxsizer.Add(self.shuffles,1, wx.EXPAND|wx.TOP|wx.BOTTOM, 10)",
    "if self.draw_skeleton.IsShow():",
    "if self.draw_skeleton.GetStringSelection() == \"Yes\":",
    "self.draw = True",
    "else:",
    "self.draw = True",
    "print(self.config,self.filelist,self.videotype.GetValue(),shuffle,trainingsetindex,gputouse=None,save_as_csv=save_as_csv,destfolder=self.destfolder,cropping=cropping)",
    "self.gpu.SetValue(-1)",
    "import wx.lib.scrolledpanel as SP",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.hbox2 = wx.BoxSizer(wx.HORIZONTAL)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "boxsizer.Add(self.hbox2,5, wx.EXPAND|wx.TOP|wx.BOTTOM, 10)",
    "shuffle = self.shuffle.GetValue()",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.sel_config.SetPath(\"Please select the config file\")",
    "else:",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = cv2.imread(img)",
    "convert the image to RGB as you are showing the image with matplotlib",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "if self.uniquebodyparts == \"\":",
    "self.uniquebodyparts = self.multibodyparts",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of old labels",
    "Extracting the list of old unique labels",
    "Checking if new labels are added or not",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checking if user added a new label",
    "if self.new_Multibodyparts==[] and self.new_UniqueBodyparts==[]: # i.e. no new labels",
    "self.figure,self.axes,self.canvas,self.toolbar,self.image_axis = self.image_panel.drawplot(self.img,img_name,self.iter,self.index,self.multibodyparts,self.colormap,keep_view=self.view_locked)",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "self.image_panel.addcolorbar(self.img,self.image_axis,self.iter,self.multibodyparts,self.colormap)",
    "# Only show the bodyparts corresponding to single",
    "if self.individual_names[0] == 'single':",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.uniquebodyparts,self.individual_names,self.file,self.markerSize)",
    "else:",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.multibodyparts,self.individual_names,self.file,self.markerSize)",
    "",
    "self.individualrdb.Bind(wx.EVT_RADIOBOX,self.select_individual)",
    "",
    "# Get the color index, depending on if single is selcted or not.",
    "if self.rdb.GetStringSelection==\"single\":",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "else:",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "self.cidClick = self.canvas.mpl_connect('button_press_event', self.onClick)",
    "else:",
    "# Found new labels in either multiple bodyparts or unique bodyparts",
    "dlg = wx.MessageDialog(None,\"New label found in the config file. Do you want to see all the other labels?\", \"New label found\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_NO:",
    "if self.new_Multibodyparts!=[]:",
    "self.multibodyparts = self.new_Multibodyparts",
    "if self.new_UniqueBodyparts!=[]:",
    "self.uniquebodyparts = self.new_UniqueBodyparts",
    "",
    "self.dataFrame = MainFrame.create_dataframe(self,self.dataFrame,self.relativeimagenames,self.individual_names,self.new_UniqueBodyparts,self.new_Multibodyparts)",
    "self.figure,self.axes,self.canvas,self.toolbar,self.image_axis = self.image_panel.drawplot(self.img,img_name,self.iter,self.index,self.multibodyparts,self.colormap,keep_view=self.view_locked)",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "self.image_panel.addcolorbar(self.img,self.image_axis,self.iter,self.multibodyparts,self.colormap)",
    "",
    "if self.individual_names[0] == 'single':",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.uniquebodyparts,self.individual_names,self.file,self.markerSize)",
    "else:",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.multibodyparts,self.individual_names,self.file,self.markerSize)",
    "self.individualrdb.Bind(wx.EVT_RADIOBOX,self.select_individual)",
    "if self.rdb.GetStringSelection==\"single\":",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "else:",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "self.cidClick = self.canvas.mpl_connect('button_press_event', self.onClick)",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "def plot(self,img):",
    "self.drs= []",
    "self.updatedCoords = []",
    "for ind in self.individual_names:",
    "if self.are_unique_bodyparts_present == False: #no unique bodyparts present",
    "#            for ind in self.individual_names:",
    "image_points = []",
    "for c, bp in enumerate(self.multibodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.multibodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.multibodyparts[c])",
    "else:",
    "if ind == 'single':",
    "for c, bp in enumerate(self.uniquebodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.uniquebodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.uniquebodyparts[c])",
    "else:",
    "for c, bp in enumerate(self.multibodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.multibodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.multibodyparts[c])",
    "",
    "MainFrame.saveEachImage(self)",
    "self.figure.canvas.draw()",
    "return(self.buttonCounter)",
    "print(self.dataFrame)",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "matplotlib.use('Agg')",
    "Load updated lists:",
    "cfg['video_sets'][vn]",
    "labeling_toolbox.show(config,Screens,scale_w,scale_h, winHack, img_scale)",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "plt.savefig(str(Path(tmpfolder)/imagename.split(os.sep)[-1]))",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Check that points lie within the image",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "sort the models directories",
    "get the shuffle index",
    "read cfg file",
    "create log file",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.individual_names+','+self.bodyParts)",
    "Check for variable correctness",
    "plt.close(\"all\")",
    "Moviepy:",
    "Call the GUI to select the cropping parameters",
    "Update the config.yaml file with current cropping parameters",
    "store full frame from random location (good for augmentation)",
    "clip=clip.crop(y1 = int(coords[2]),y2 = int(coords[3]),x1 = int(coords[0]), x2 = int(coords[1]))",
    "close video.",
    "print(\"DLC loaded in light mode; you cannot use the labeling GUI!\")",
    "def __init__(self, point,bodyParts):",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.bodyParts)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "sess, inputs, outputs = predict.setup_pose_prediction(dlc_cfg)",
    "#################################################",
    "Datafolder",
    "#################################################",
    "looping over videos",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "from skimage.io import imread",
    "frame=imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "Parameters for augmentation with regard to cropping",
    "Added and described in \"Using DeepLabCut for 3D markerless pose estimation across species and behaviors\"",
    "Source: https://www.nature.com/articles/s41596-019-0176-0",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Dependencies for anaysis",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "DLCscorer = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "import skimage.color",
    "from skimage.io import imread",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "image = skimage.color.gray2rgb(image)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "from scipy.misc import imresize",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Read file path for pose_config file. >> pass it on",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "print(end_points.keys()) >> to see what else is available.",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "from nets.mobilenet import conv_blocks as ops",
    "from nets.mobilenet import mobilenet as lib",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "The next part of the code depends upon which tensorflow version you have.",
    "if cfg.location_refinement:",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "from scipy.misc import imresize",
    "Augmentation functions",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "Initializing variables if they don't exist...",
    "what is the fraction of training samples with scaling augmentation?",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "from scipy.misc import imread, imresize",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "from scipy.misc import imread, imresize",
    "from dataset.pose_dataset import Batch, data_to_input, mirror_joints_map, CropImage, DataItem",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "Process skeleton",
    "save",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "deeplabcut.create_labeled_video(path_config_file,[newvideo], destfolder=dfolder,filtered=True)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "#create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 does that much easier...",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "deeplabcut.load_demo_data(path_config_file)",
    "shuffle=11 #>> imageio functions!",
    "print(\"Analyze Video\")",
    "videofile_path = os.path.join(os.getcwd(),'openfield-Pranav-2018-10-30','videos','m3v1mp4.mp4')",
    "deeplabcut.analyze_videos(path_config_file,[videofile_path], shuffle=shuffle)",
    "print(\"Create Labeled Video\")",
    "deeplabcut.create_labeled_video(path_config_file,[videofile_path],save_frames=False, shuffle=shuffle)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)"
  ],
  "v2.1.5": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed directly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Supress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / require TF",
    "docs[0]['init_weights'] = '../../pretrained/resnet_v1_101.ckpt'",
    "dict_test['init_weights'] = 'models/mpii/snapshot-1030000'",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Create the pose_config.yaml files",
    "Analyze the videos",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "get vcap property",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "Import all videos in a folder or if just one video withouth [] passed, then make it a list.",
    "if isinstance(videos,str):",
    "#there are two cases:",
    "if os.path.isdir(videos): # it is a path!",
    "path=videos",
    "videos=[os.path.join(path,vp) for vp in os.listdir(path) if videotype in vp]",
    "if len(videos)==0:",
    "print(\"No videos found in\",path,os.listdir(path))",
    "print(\"Perhaps change the videotype, which is currently set to:\", videotype)",
    "else:",
    "print(\"Directory entered, \" , len(videos),\" videos were found.\")",
    "else:",
    "if os.path.isfile(videos):",
    "videos=[videos]",
    "https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "try:",
    "#shutil.copy(src,dst)",
    "except OSError or TypeError: #https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "shutil.copy(os.fspath(src),os.fspath(dst))",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Set values to config file:",
    "cfg_file['resnet']=50",
    "Write dictionary to yaml  config file",
    "import yaml",
    "import cv2",
    "import shutil",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "print(\"Found filtered predictions, will be use these for triangulation.\")",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam1 camera",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "self.cropping = False",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.slider.Enable(False)",
    "self.checkBox.Enable(False)",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "extract min and max index based on start stop interval.",
    "figure out body part list:",
    "all indices between start and stop with jump larger than epsilon (leading up to this point!)",
    "deviation_dataname = str(Path(videofolder)/Path(dataname))",
    "Calculate deviatons for video",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "data.to_csv(dataname.split('.h5')[0]+'filtered.csv')",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "Dataframe = pd.read_hdf(os.path.join(videofolder,dataname+'.h5'))",
    "drop duplicate labels:",
    "updates iteration by 1",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "print(\"DLC loaded in light mode; you cannot use the relabeling GUI!\")",
    "###################################################",
    "Dependencies",
    "###################################################",
    "import sys",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as specified in the config file",
    "rr, cc,val = line_aa(int(df_y[pair[0],index]),int(df_x[pair[0],index]),int(df_y[pair[1],index]), int(df_x[pair[1],index]))",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Adds skeleton to the video",
    "###################",
    "less transparent present.",
    "# One can change the parameters of the video creation script below:",
    "See ffmpeg user guide: http://ffmpeg.org/ffmpeg.html#Video-and-Audio-file-format-conversion",
    "",
    "if notanalyzed:",
    "notanalyzed,outdataname,sourcedataname,DLCscorer=auxiliaryfunctions.CheckifPostProcessing(folder,vname,DLCscorer,DLCscorerlegacy,suffix='checking')",
    "Loading cropping data used during analysis",
    "!/usr/bin/env python3",
    "Historically DLC used: from scipy.misc import imread, imresize >> deprecated functions",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "TODO check if those times exist...",
    "windows throws error if file path is > 260 characters, can fix with prefix. see https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "fig.colorbar(im, ax=ax)",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "LoadData",
    "nlines,numcolumns=data.shape",
    "assert(len(orderofbpincsv)==len(cfg['bodyparts']))",
    "TODO: test len of images vs. len of imagenames for another sanity check",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "with open(projconfigfile, 'w') as cf:",
    "ruamelFile_3d.dump(cfg_file_3d, cf)",
    "Read the pickle file",
    "Write the pickle file",
    "checks if input is a directory",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "Add all the options",
    "",
    "Hide the button as this is not the default option",
    "self.SetSizer(self.sizer)",
    "self.sizer.Add(self.sizer, pos=(3, 0), span=(1, 8),flag=wx.EXPAND|wx.BOTTOM, border=15)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "wx.Frame.__init__(self, None, title=\"DeepLabCut\")",
    "wx.Frame.__init__( self, None, id = wx.ID_ANY, title = 'DeepLabCut',size = wx.Size(self.gui_size), pos = wx.DefaultPosition, style = wx.RESIZE_BORDER|wx.DEFAULT_FRAME_STYLE|wx.TAB_TRAVERSAL )",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.crop_choice = wx.RadioBox(self, label='Want to crop the frames?', choices=['No', 'Yes'],majorDimension=1, style=wx.RA_SPECIFY_COLS)",
    "hbox1.Add(self.crop_choice,5, wx.EXPAND|wx.TOP|wx.BOTTOM, 5)",
    "self.crop_choice.Enable(False)",
    "self.crop_choice.Enable(True)",
    "if self.crop_choice.GetStringSelection() == 'Yes':",
    "crop = True",
    "else:",
    "crop = False",
    "self.crop_choice.Enable(True)",
    "self.crop_choice.SetStringSelection(\"No\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "Read the pose config file",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.shuffles = wx.SpinCtrl(self, value='1',min=1,max=100)",
    "shuffles_text_boxsizer.Add(self.shuffles,1, wx.EXPAND|wx.TOP|wx.BOTTOM, 10)",
    "if self.draw_skeleton.IsShow():",
    "if self.draw_skeleton.GetStringSelection() == \"Yes\":",
    "self.draw = True",
    "else:",
    "self.draw = True",
    "print(self.config,self.filelist,self.videotype.GetValue(),shuffle,trainingsetindex,gputouse=None,save_as_csv=save_as_csv,destfolder=self.destfolder,cropping=cropping)",
    "self.gpu.SetValue(-1)",
    "import wx.lib.scrolledpanel as SP",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.hbox2 = wx.BoxSizer(wx.HORIZONTAL)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "boxsizer.Add(self.hbox2,5, wx.EXPAND|wx.TOP|wx.BOTTOM, 10)",
    "shuffle = self.shuffle.GetValue()",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.sel_config.SetPath(\"Please select the config file\")",
    "else:",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = cv2.imread(img)",
    "convert the image to RGB as you are showing the image with matplotlib",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "if self.uniquebodyparts == \"\":",
    "self.uniquebodyparts = self.multibodyparts",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of old labels",
    "Extracting the list of old unique labels",
    "Checking if new labels are added or not",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checking if user added a new label",
    "if self.new_Multibodyparts==[] and self.new_UniqueBodyparts==[]: # i.e. no new labels",
    "self.figure,self.axes,self.canvas,self.toolbar,self.image_axis = self.image_panel.drawplot(self.img,img_name,self.iter,self.index,self.multibodyparts,self.colormap,keep_view=self.view_locked)",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "self.image_panel.addcolorbar(self.img,self.image_axis,self.iter,self.multibodyparts,self.colormap)",
    "# Only show the bodyparts corresponding to single",
    "if self.individual_names[0] == 'single':",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.uniquebodyparts,self.individual_names,self.file,self.markerSize)",
    "else:",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.multibodyparts,self.individual_names,self.file,self.markerSize)",
    "",
    "self.individualrdb.Bind(wx.EVT_RADIOBOX,self.select_individual)",
    "",
    "# Get the color index, depending on if single is selcted or not.",
    "if self.rdb.GetStringSelection==\"single\":",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "else:",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "self.cidClick = self.canvas.mpl_connect('button_press_event', self.onClick)",
    "else:",
    "# Found new labels in either multiple bodyparts or unique bodyparts",
    "dlg = wx.MessageDialog(None,\"New label found in the config file. Do you want to see all the other labels?\", \"New label found\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_NO:",
    "if self.new_Multibodyparts!=[]:",
    "self.multibodyparts = self.new_Multibodyparts",
    "if self.new_UniqueBodyparts!=[]:",
    "self.uniquebodyparts = self.new_UniqueBodyparts",
    "",
    "self.dataFrame = MainFrame.create_dataframe(self,self.dataFrame,self.relativeimagenames,self.individual_names,self.new_UniqueBodyparts,self.new_Multibodyparts)",
    "self.figure,self.axes,self.canvas,self.toolbar,self.image_axis = self.image_panel.drawplot(self.img,img_name,self.iter,self.index,self.multibodyparts,self.colormap,keep_view=self.view_locked)",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "self.image_panel.addcolorbar(self.img,self.image_axis,self.iter,self.multibodyparts,self.colormap)",
    "",
    "if self.individual_names[0] == 'single':",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.uniquebodyparts,self.individual_names,self.file,self.markerSize)",
    "else:",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.multibodyparts,self.individual_names,self.file,self.markerSize)",
    "self.individualrdb.Bind(wx.EVT_RADIOBOX,self.select_individual)",
    "if self.rdb.GetStringSelection==\"single\":",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "else:",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "self.cidClick = self.canvas.mpl_connect('button_press_event', self.onClick)",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "def plot(self,img):",
    "self.drs= []",
    "self.updatedCoords = []",
    "for ind in self.individual_names:",
    "if self.are_unique_bodyparts_present == False: #no unique bodyparts present",
    "#            for ind in self.individual_names:",
    "image_points = []",
    "for c, bp in enumerate(self.multibodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.multibodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.multibodyparts[c])",
    "else:",
    "if ind == 'single':",
    "for c, bp in enumerate(self.uniquebodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.uniquebodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.uniquebodyparts[c])",
    "else:",
    "for c, bp in enumerate(self.multibodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.multibodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.multibodyparts[c])",
    "",
    "MainFrame.saveEachImage(self)",
    "self.figure.canvas.draw()",
    "return(self.buttonCounter)",
    "print(self.dataFrame)",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "matplotlib.use('Agg')",
    "Load updated lists:",
    "cfg['video_sets'][vn]",
    "labeling_toolbox.show(config,Screens,scale_w,scale_h, winHack, img_scale)",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "plt.savefig(str(Path(tmpfolder)/imagename.split(os.sep)[-1]))",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "trainIndexes, testIndexes = SplitTrials(range(len(Data.index)), trainFraction)",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "check whether the labels are positive and inside the img",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "sort the models directories",
    "get the shuffle index",
    "read cfg file",
    "create log file",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.individual_names+','+self.bodyParts)",
    "Check for variable correctness",
    "plt.close(\"all\")",
    "Moviepy:",
    "Call the GUI to select the cropping parameters",
    "Update the config.yaml file with current cropping parameters",
    "store full frame from random location (good for augmentation)",
    "clip=clip.crop(y1 = int(coords[2]),y2 = int(coords[3]),x1 = int(coords[0]), x2 = int(coords[1]))",
    "close video.",
    "print(\"DLC loaded in light mode; you cannot use the labeling GUI!\")",
    "def __init__(self, point,bodyParts):",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.bodyParts)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "sess, inputs, outputs = predict.setup_pose_prediction(dlc_cfg)",
    "#################################################",
    "Datafolder",
    "#################################################",
    "looping over videos",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "from skimage.io import imread",
    "frame=imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "Parameters for augmentation with regard to cropping",
    "Added and described in \"Using DeepLabCut for 3D markerless pose estimation across species and behaviors\"",
    "Source: https://www.nature.com/articles/s41596-019-0176-0",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Dependencies for anaysis",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "DLCscorer = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "import skimage.color",
    "from skimage.io import imread",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "image = skimage.color.gray2rgb(image)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "from scipy.misc import imresize",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Read file path for pose_config file. >> pass it on",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "print(end_points.keys()) >> to see what else is available.",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "from nets.mobilenet import conv_blocks as ops",
    "from nets.mobilenet import mobilenet as lib",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "The next part of the code depends upon which tensorflow version you have.",
    "if cfg.location_refinement:",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "from scipy.misc import imresize",
    "Augmentation functions",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "Initializing variables if they don't exist...",
    "what is the fraction of training samples with scaling augmentation?",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "from scipy.misc import imread, imresize",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "from scipy.misc import imread, imresize",
    "from dataset.pose_dataset import Batch, data_to_input, mirror_joints_map, CropImage, DataItem",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "Process skeleton",
    "save",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "deeplabcut.create_labeled_video(path_config_file,[newvideo], destfolder=dfolder,filtered=True)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "#create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 does that much easier...",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "deeplabcut.load_demo_data(path_config_file)",
    "shuffle=11 #>> imageio functions!",
    "print(\"Analyze Video\")",
    "videofile_path = os.path.join(os.getcwd(),'openfield-Pranav-2018-10-30','videos','m3v1mp4.mp4')",
    "deeplabcut.analyze_videos(path_config_file,[videofile_path], shuffle=shuffle)",
    "print(\"Create Labeled Video\")",
    "deeplabcut.create_labeled_video(path_config_file,[videofile_path],save_frames=False, shuffle=shuffle)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)"
  ],
  "v2.1.4": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "if module is executed direcyly (i.e. `python -m deeplabcut.__init__`) launch straight into the GUI",
    "Supress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / require TF",
    "docs[0]['init_weights'] = '../../pretrained/resnet_v1_101.ckpt'",
    "dict_test['init_weights'] = 'models/mpii/snapshot-1030000'",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Create the pose_config.yaml files",
    "Analyze the videos",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "get vcap property",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "Import all videos in a folder or if just one video withouth [] passed, then make it a list.",
    "if isinstance(videos,str):",
    "#there are two cases:",
    "if os.path.isdir(videos): # it is a path!",
    "path=videos",
    "videos=[os.path.join(path,vp) for vp in os.listdir(path) if videotype in vp]",
    "if len(videos)==0:",
    "print(\"No videos found in\",path,os.listdir(path))",
    "print(\"Perhaps change the videotype, which is currently set to:\", videotype)",
    "else:",
    "print(\"Directory entered, \" , len(videos),\" videos were found.\")",
    "else:",
    "if os.path.isfile(videos):",
    "videos=[videos]",
    "https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "try:",
    "#shutil.copy(src,dst)",
    "except OSError or TypeError: #https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "shutil.copy(os.fspath(src),os.fspath(dst))",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Set values to config file:",
    "cfg_file['resnet']=50",
    "Write dictionary to yaml  config file",
    "import yaml",
    "import cv2",
    "import shutil",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam1 camera",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "self.cropping = False",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.slider.Enable(False)",
    "self.checkBox.Enable(False)",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "extract min and max index based on start stop interval.",
    "figure out body part list:",
    "all indices between start and stop with jump larger than epsilon (leading up to this point!)",
    "deviation_dataname = str(Path(videofolder)/Path(dataname))",
    "Calculate deviatons for video",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "data.to_csv(dataname.split('.h5')[0]+'filtered.csv')",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "Dataframe = pd.read_hdf(os.path.join(videofolder,dataname+'.h5'))",
    "drop duplicate labels:",
    "updates iteration by 1",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "self.choiceBox,self.visualization_rdb = self.choice_panel.addRadioButtons()",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "take into account of all the bodyparts for the colorscheme. Sort the bodyparts to have same order as in the config file",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "self.figure.delaxes(self.figure.axes[1]) # Removes the axes corresponding to the colorbar",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "print(self.Dataframe.head())",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "print(\"DLC loaded in light mode; you cannot use the relabeling GUI!\")",
    "###################################################",
    "Dependencies",
    "###################################################",
    "import sys",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as specified in the config file",
    "rr, cc,val = line_aa(int(df_y[pair[0],index]),int(df_x[pair[0],index]),int(df_y[pair[1],index]), int(df_x[pair[1],index]))",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Adds skeleton to the video",
    "###################",
    "less transparent present.",
    "# One can change the parameters of the video creation script below:",
    "See ffmpeg user guide: http://ffmpeg.org/ffmpeg.html#Video-and-Audio-file-format-conversion",
    "",
    "if notanalyzed:",
    "notanalyzed,outdataname,sourcedataname,DLCscorer=auxiliaryfunctions.CheckifPostProcessing(folder,vname,DLCscorer,DLCscorerlegacy,suffix='checking')",
    "Loading cropping data used during analysis",
    "!/usr/bin/env python3",
    "Historically DLC used: from scipy.misc import imread, imresize >> deprecated functions",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "TODO check if those times exist...",
    "windows throws error if file path is > 260 characters, can fix with prefix. see https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "fig.colorbar(im, ax=ax)",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "LoadData",
    "nlines,numcolumns=data.shape",
    "assert(len(orderofbpincsv)==len(cfg['bodyparts']))",
    "TODO: test len of images vs. len of imagenames for another sanity check",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "with open(projconfigfile, 'w') as cf:",
    "ruamelFile_3d.dump(cfg_file_3d, cf)",
    "Read the pickle file",
    "Write the pickle file",
    "checks if input is a directory",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "Add all the options",
    "",
    "Hide the button as this is not the default option",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "wx.Frame.__init__(self, None, title=\"DeepLabCut\")",
    "wx.Frame.__init__( self, None, id = wx.ID_ANY, title = 'DeepLabCut',size = wx.Size(self.gui_size), pos = wx.DefaultPosition, style = wx.RESIZE_BORDER|wx.DEFAULT_FRAME_STYLE|wx.TAB_TRAVERSAL )",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.crop_choice = wx.RadioBox(self, label='Want to crop the frames?', choices=['No', 'Yes'],majorDimension=1, style=wx.RA_SPECIFY_COLS)",
    "hbox1.Add(self.crop_choice,5, wx.EXPAND|wx.TOP|wx.BOTTOM, 5)",
    "self.crop_choice.Enable(False)",
    "self.crop_choice.Enable(True)",
    "if self.crop_choice.GetStringSelection() == 'Yes':",
    "crop = True",
    "else:",
    "crop = False",
    "self.crop_choice.Enable(True)",
    "self.crop_choice.SetStringSelection(\"No\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "Read the pose config file",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.shuffles = wx.SpinCtrl(self, value='1',min=1,max=100)",
    "shuffles_text_boxsizer.Add(self.shuffles,1, wx.EXPAND|wx.TOP|wx.BOTTOM, 10)",
    "if self.draw_skeleton.IsShow():",
    "if self.draw_skeleton.GetStringSelection() == \"Yes\":",
    "self.draw = True",
    "else:",
    "self.draw = True",
    "print(self.config,self.filelist,self.videotype.GetValue(),shuffle,trainingsetindex,gputouse=None,save_as_csv=save_as_csv,destfolder=self.destfolder,cropping=cropping)",
    "self.gpu.SetValue(-1)",
    "import wx.lib.scrolledpanel as SP",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.hbox2 = wx.BoxSizer(wx.HORIZONTAL)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "boxsizer.Add(self.hbox2,5, wx.EXPAND|wx.TOP|wx.BOTTOM, 10)",
    "shuffle = self.shuffle.GetValue()",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.sel_config.SetPath(\"Please select the config file\")",
    "else:",
    "deeplabcut.label_frames(self.config)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = cv2.imread(img)",
    "convert the image to RGB as you are showing the image with matplotlib",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "if self.uniquebodyparts == \"\":",
    "self.uniquebodyparts = self.multibodyparts",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of old labels",
    "Extracting the list of old unique labels",
    "Checking if new labels are added or not",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checking if user added a new label",
    "if self.new_Multibodyparts==[] and self.new_UniqueBodyparts==[]: # i.e. no new labels",
    "self.figure,self.axes,self.canvas,self.toolbar,self.image_axis = self.image_panel.drawplot(self.img,img_name,self.iter,self.index,self.multibodyparts,self.colormap,keep_view=self.view_locked)",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "self.image_panel.addcolorbar(self.img,self.image_axis,self.iter,self.multibodyparts,self.colormap)",
    "# Only show the bodyparts corresponding to single",
    "if self.individual_names[0] == 'single':",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.uniquebodyparts,self.individual_names,self.file,self.markerSize)",
    "else:",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.multibodyparts,self.individual_names,self.file,self.markerSize)",
    "",
    "self.individualrdb.Bind(wx.EVT_RADIOBOX,self.select_individual)",
    "",
    "# Get the color index, depending on if single is selcted or not.",
    "if self.rdb.GetStringSelection==\"single\":",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "else:",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "self.cidClick = self.canvas.mpl_connect('button_press_event', self.onClick)",
    "else:",
    "# Found new labels in either multiple bodyparts or unique bodyparts",
    "dlg = wx.MessageDialog(None,\"New label found in the config file. Do you want to see all the other labels?\", \"New label found\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_NO:",
    "if self.new_Multibodyparts!=[]:",
    "self.multibodyparts = self.new_Multibodyparts",
    "if self.new_UniqueBodyparts!=[]:",
    "self.uniquebodyparts = self.new_UniqueBodyparts",
    "",
    "self.dataFrame = MainFrame.create_dataframe(self,self.dataFrame,self.relativeimagenames,self.individual_names,self.new_UniqueBodyparts,self.new_Multibodyparts)",
    "self.figure,self.axes,self.canvas,self.toolbar,self.image_axis = self.image_panel.drawplot(self.img,img_name,self.iter,self.index,self.multibodyparts,self.colormap,keep_view=self.view_locked)",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "self.image_panel.addcolorbar(self.img,self.image_axis,self.iter,self.multibodyparts,self.colormap)",
    "",
    "if self.individual_names[0] == 'single':",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.uniquebodyparts,self.individual_names,self.file,self.markerSize)",
    "else:",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.multibodyparts,self.individual_names,self.file,self.markerSize)",
    "self.individualrdb.Bind(wx.EVT_RADIOBOX,self.select_individual)",
    "if self.rdb.GetStringSelection==\"single\":",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "else:",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "self.cidClick = self.canvas.mpl_connect('button_press_event', self.onClick)",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "def plot(self,img):",
    "self.drs= []",
    "self.updatedCoords = []",
    "for ind in self.individual_names:",
    "if self.are_unique_bodyparts_present == False: #no unique bodyparts present",
    "#            for ind in self.individual_names:",
    "image_points = []",
    "for c, bp in enumerate(self.multibodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.multibodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.multibodyparts[c])",
    "else:",
    "if ind == 'single':",
    "for c, bp in enumerate(self.uniquebodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.uniquebodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.uniquebodyparts[c])",
    "else:",
    "for c, bp in enumerate(self.multibodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.multibodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.multibodyparts[c])",
    "",
    "MainFrame.saveEachImage(self)",
    "self.figure.canvas.draw()",
    "return(self.buttonCounter)",
    "print(self.dataFrame)",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "matplotlib.use('Agg')",
    "Load updated lists:",
    "cfg['video_sets'][vn]",
    "labeling_toolbox.show(config,Screens,scale_w,scale_h, winHack, img_scale)",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "plt.savefig(str(Path(tmpfolder)/imagename.split(os.sep)[-1]))",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "trainIndexes, testIndexes = SplitTrials(range(len(Data.index)), trainFraction)",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "check whether the labels are positive and inside the img",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "sort the models directories",
    "get the shuffle index",
    "read cfg file",
    "create log file",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.individual_names+','+self.bodyParts)",
    "Check for variable correctness",
    "plt.close(\"all\")",
    "Moviepy:",
    "Call the GUI to select the cropping parameters",
    "Update the config.yaml file with current cropping parameters",
    "store full frame from random location (good for augmentation)",
    "clip=clip.crop(y1 = int(coords[2]),y2 = int(coords[3]),x1 = int(coords[0]), x2 = int(coords[1]))",
    "close video.",
    "print(\"DLC loaded in light mode; you cannot use the labeling GUI!\")",
    "def __init__(self, point,bodyParts):",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.bodyParts)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "sess, inputs, outputs = predict.setup_pose_prediction(dlc_cfg)",
    "#################################################",
    "Datafolder",
    "#################################################",
    "looping over videos",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "from skimage.io import imread",
    "frame=imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "Parameters for augmentation with regard to cropping",
    "Added and described in \"Using DeepLabCut for 3D markerless pose estimation across species and behaviors\"",
    "Source: https://www.nature.com/articles/s41596-019-0176-0",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Dependencies for anaysis",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "DLCscorer = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "import skimage.color",
    "from skimage.io import imread",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "image = skimage.color.gray2rgb(image)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "from scipy.misc import imresize",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Read file path for pose_config file. >> pass it on",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "print(end_points.keys()) >> to see what else is available.",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "from nets.mobilenet import conv_blocks as ops",
    "from nets.mobilenet import mobilenet as lib",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "The next part of the code depends upon which tensorflow version you have.",
    "if cfg.location_refinement:",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "from scipy.misc import imresize",
    "Augmentation functions",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "Initializing variables if they don't exist...",
    "what is the fraction of training samples with scaling augmentation?",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "make sure joint ids are 0-indexed",
    "Scale is sampled only once to transform all of the images into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "import imageio",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "from scipy.misc import imread, imresize",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "from scipy.misc import imread, imresize",
    "from dataset.pose_dataset import Batch, data_to_input, mirror_joints_map, CropImage, DataItem",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "Process skeleton",
    "save",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "deeplabcut.create_labeled_video(path_config_file,[newvideo], destfolder=dfolder,filtered=True)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "#create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 does that much easier...",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "deeplabcut.load_demo_data(path_config_file)",
    "shuffle=11 #>> imageio functions!",
    "print(\"Analyze Video\")",
    "videofile_path = os.path.join(os.getcwd(),'openfield-Pranav-2018-10-30','videos','m3v1mp4.mp4')",
    "deeplabcut.analyze_videos(path_config_file,[videofile_path], shuffle=shuffle)",
    "print(\"Create Labeled Video\")",
    "deeplabcut.create_labeled_video(path_config_file,[videofile_path],save_frames=False, shuffle=shuffle)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=None",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)"
  ],
  "v2.1.1": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "Supress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / require TF",
    "docs[0]['init_weights'] = '../../pretrained/resnet_v1_101.ckpt'",
    "dict_test['init_weights'] = 'models/mpii/snapshot-1030000'",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Create the pose_config.yaml files",
    "Analyze the videos",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "get vcap property",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "Import all videos in a folder or if just one video withouth [] passed, then make it a list.",
    "if isinstance(videos,str):",
    "#there are two cases:",
    "if os.path.isdir(videos): # it is a path!",
    "path=videos",
    "videos=[os.path.join(path,vp) for vp in os.listdir(path) if videotype in vp]",
    "if len(videos)==0:",
    "print(\"No videos found in\",path,os.listdir(path))",
    "print(\"Perhaps change the videotype, which is currently set to:\", videotype)",
    "else:",
    "print(\"Directory entered, \" , len(videos),\" videos were found.\")",
    "else:",
    "if os.path.isfile(videos):",
    "videos=[videos]",
    "https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "try:",
    "#shutil.copy(src,dst)",
    "except OSError or TypeError: #https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "shutil.copy(os.fspath(src),os.fspath(dst))",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Set values to config file:",
    "cfg_file['resnet']=50",
    "Write dictionary to yaml  config file",
    "import yaml",
    "import cv2",
    "import shutil",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam1 camera",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "self.cropping = False",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.slider.Enable(False)",
    "self.checkBox.Enable(False)",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "extract min and max index based on start stop interval.",
    "figure out body part list:",
    "all indices between start and stop with jump larger than epsilon (leading up to this point!)",
    "deviation_dataname = str(Path(videofolder)/Path(dataname))",
    "Calculate deviatons for video",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "data.to_csv(dataname.split('.h5')[0]+'filtered.csv')",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "Dataframe = pd.read_hdf(os.path.join(videofolder,dataname+'.h5'))",
    "drop duplicate labels:",
    "updates iteration by 1",
    "###################################################",
    "Dependencies",
    "###################################################",
    "import sys",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as specified in the config file",
    "rr, cc,val = line_aa(int(df_y[pair[0],index]),int(df_x[pair[0],index]),int(df_y[pair[1],index]), int(df_x[pair[1],index]))",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Adds skeleton to the video",
    "###################",
    "less transparent present.",
    "# One can change the parameters of the video creation script below:",
    "See ffmpeg user guide: http://ffmpeg.org/ffmpeg.html#Video-and-Audio-file-format-conversion",
    "",
    "if notanalyzed:",
    "notanalyzed,outdataname,sourcedataname,DLCscorer=auxiliaryfunctions.CheckifPostProcessing(folder,vname,DLCscorer,DLCscorerlegacy,suffix='checking')",
    "Loading cropping data used during analysis",
    "!/usr/bin/env python3",
    "import imageio",
    "from skimage import io",
    "from skimage.util import img_as_ubyte",
    "from PIL import Image",
    "Historically DLC used: from scipy.misc import imread, imresize >> deprecated functions",
    "print(np.max(a),np.min(a),np.median(a))",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "height, width, depth = img.shape",
    "imgScale = W/width",
    "newX,newY = oriimg.shape[1]*imgScale, oriimg.shape[0]*imgScale",
    "a=cv2.resize(img,(int(height*size),int(width*size)))",
    "print(np.shape(a))",
    "print(np.max(a),np.min(a),np.median(a))",
    "TODO check if those times exist...",
    "windows throws error if file path is > 260 characters, can fix with prefix. see https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "fig.colorbar(im, ax=ax)",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "LoadData",
    "nlines,numcolumns=data.shape",
    "assert(len(orderofbpincsv)==len(cfg['bodyparts']))",
    "TODO: test len of images vs. len of imagenames for another sanity check",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "with open(projconfigfile, 'w') as cf:",
    "ruamelFile_3d.dump(cfg_file_3d, cf)",
    "Read the pickle file",
    "Write the pickle file",
    "Creates an empty dataFrame of same shape as df_side_view.",
    "flag = number of coordinates. e.g. 4 for 3d,3 for 2d as we need to store the likelihood too.",
    "df = pd.read_hdf(dataframe)",
    "checks if input is a directory",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "Add all the options",
    "",
    "Hide the button as this is not the default option",
    "def help_function(self,event):",
    "wx.MessageBox(\"1. Choose an option to create a new project or load an existing project.\\n\\n2. To create a new project, enter the name of project, experimenter, and choose videos to add to the project.\\n\\n3. As an optional step, choose a directory where you need to create the project and specify if you need to copy the videos\\n\\n4. To load an existing project, use the active Browse button to select the config.yaml file of the project\",'Help',wx.OK | wx.ICON_INFORMATION)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "wx.Frame.__init__(self, None, title=\"DeepLabCut\")",
    "wx.Frame.__init__( self, None, id = wx.ID_ANY, title = 'DeepLabCut',size = wx.Size(self.gui_size), pos = wx.DefaultPosition, style = wx.RESIZE_BORDER|wx.DEFAULT_FRAME_STYLE|wx.TAB_TRAVERSAL )",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.crop_choice = wx.RadioBox(self, label='Want to crop the frames?', choices=['No', 'Yes'],majorDimension=1, style=wx.RA_SPECIFY_COLS)",
    "hbox1.Add(self.crop_choice,5, wx.EXPAND|wx.TOP|wx.BOTTOM, 5)",
    "self.crop_choice.Enable(False)",
    "self.crop_choice.Enable(True)",
    "if self.crop_choice.GetStringSelection() == 'Yes':",
    "crop = True",
    "else:",
    "crop = False",
    "self.crop_choice.Enable(True)",
    "self.crop_choice.SetStringSelection(\"No\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "Read the pose config file",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.shuffles = wx.SpinCtrl(self, value='1',min=1,max=100)",
    "shuffles_text_boxsizer.Add(self.shuffles,1, wx.EXPAND|wx.TOP|wx.BOTTOM, 10)",
    "if self.draw_skeleton.IsShow():",
    "if self.draw_skeleton.GetStringSelection() == \"Yes\":",
    "self.draw = True",
    "else:",
    "self.draw = True",
    "print(self.config,self.filelist,self.videotype.GetValue(),shuffle,trainingsetindex,gputouse=None,save_as_csv=save_as_csv,destfolder=self.destfolder,cropping=cropping)",
    "self.gpu.SetValue(-1)",
    "import wx.lib.scrolledpanel as SP",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.hbox2 = wx.BoxSizer(wx.HORIZONTAL)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "boxsizer.Add(self.hbox2,5, wx.EXPAND|wx.TOP|wx.BOTTOM, 10)",
    "shuffle = self.shuffle.GetValue()",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.sel_config.SetPath(\"Please select the config file\")",
    "else:",
    "deeplabcut.label_frames(self.config)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = cv2.imread(img)",
    "convert the image to RGB as you are showing the image with matplotlib",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "if self.uniquebodyparts == \"\":",
    "self.uniquebodyparts = self.multibodyparts",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of old labels",
    "Extracting the list of old unique labels",
    "Checking if new labels are added or not",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checking if user added a new label",
    "if self.new_Multibodyparts==[] and self.new_UniqueBodyparts==[]: # i.e. no new labels",
    "self.figure,self.axes,self.canvas,self.toolbar,self.image_axis = self.image_panel.drawplot(self.img,img_name,self.iter,self.index,self.multibodyparts,self.colormap,keep_view=self.view_locked)",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "self.image_panel.addcolorbar(self.img,self.image_axis,self.iter,self.multibodyparts,self.colormap)",
    "# Only show the bodyparts corresponding to single",
    "if self.individual_names[0] == 'single':",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.uniquebodyparts,self.individual_names,self.file,self.markerSize)",
    "else:",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.multibodyparts,self.individual_names,self.file,self.markerSize)",
    "",
    "self.individualrdb.Bind(wx.EVT_RADIOBOX,self.select_individual)",
    "",
    "# Get the color index, depending on if single is selcted or not.",
    "if self.rdb.GetStringSelection==\"single\":",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "else:",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "self.cidClick = self.canvas.mpl_connect('button_press_event', self.onClick)",
    "else:",
    "# Found new labels in either multiple bodyparts or unique bodyparts",
    "dlg = wx.MessageDialog(None,\"New label found in the config file. Do you want to see all the other labels?\", \"New label found\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_NO:",
    "if self.new_Multibodyparts!=[]:",
    "self.multibodyparts = self.new_Multibodyparts",
    "if self.new_UniqueBodyparts!=[]:",
    "self.uniquebodyparts = self.new_UniqueBodyparts",
    "",
    "self.dataFrame = MainFrame.create_dataframe(self,self.dataFrame,self.relativeimagenames,self.individual_names,self.new_UniqueBodyparts,self.new_Multibodyparts)",
    "self.figure,self.axes,self.canvas,self.toolbar,self.image_axis = self.image_panel.drawplot(self.img,img_name,self.iter,self.index,self.multibodyparts,self.colormap,keep_view=self.view_locked)",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "self.image_panel.addcolorbar(self.img,self.image_axis,self.iter,self.multibodyparts,self.colormap)",
    "",
    "if self.individual_names[0] == 'single':",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.uniquebodyparts,self.individual_names,self.file,self.markerSize)",
    "else:",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.multibodyparts,self.individual_names,self.file,self.markerSize)",
    "self.individualrdb.Bind(wx.EVT_RADIOBOX,self.select_individual)",
    "if self.rdb.GetStringSelection==\"single\":",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "else:",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "self.cidClick = self.canvas.mpl_connect('button_press_event', self.onClick)",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "def plot(self,img):",
    "self.drs= []",
    "self.updatedCoords = []",
    "for ind in self.individual_names:",
    "if self.are_unique_bodyparts_present == False: #no unique bodyparts present",
    "#            for ind in self.individual_names:",
    "image_points = []",
    "for c, bp in enumerate(self.multibodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.multibodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.multibodyparts[c])",
    "else:",
    "if ind == 'single':",
    "for c, bp in enumerate(self.uniquebodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.uniquebodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.uniquebodyparts[c])",
    "else:",
    "for c, bp in enumerate(self.multibodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.multibodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.multibodyparts[c])",
    "",
    "MainFrame.saveEachImage(self)",
    "self.figure.canvas.draw()",
    "return(self.buttonCounter)",
    "print(self.dataFrame)",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "matplotlib.use('Agg')",
    "Load updated lists:",
    "cfg['video_sets'][vn]",
    "labeling_toolbox.show(config,Screens,scale_w,scale_h, winHack, img_scale)",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "plt.savefig(str(Path(tmpfolder)/imagename.split(os.sep)[-1]))",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "trainIndexes, testIndexes = SplitTrials(range(len(Data.index)), trainFraction)",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "sort the models directories",
    "get the shuffle index",
    "read cfg file",
    "create log file",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.individual_names+','+self.bodyParts)",
    "Check for variable correctness",
    "plt.close(\"all\")",
    "Moviepy:",
    "Call the GUI to select the cropping parameters",
    "Update the config.yaml file with current cropping parameters",
    "store full frame from random location (good for augmentation)",
    "clip=clip.crop(y1 = int(coords[2]),y2 = int(coords[3]),x1 = int(coords[0]), x2 = int(coords[1]))",
    "close video.",
    "def __init__(self, point,bodyParts):",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.bodyParts)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "sess, inputs, outputs = predict.setup_pose_prediction(dlc_cfg)",
    "#################################################",
    "Datafolder",
    "#################################################",
    "looping over videos",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "from skimage.io import imread",
    "frame=imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "Parameters for augmentation with regard to cropping",
    "Added and described in \"Using DeepLabCut for 3D markerless pose estimation across species and behaviors\"",
    "Source: https://www.nature.com/articles/s41596-019-0176-0",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Dependencies for anaysis",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Data=pd.read_hdf(os.path.join(cfg[\"project_path\"],str(trainingsetfolder),'CollectedData_' + cfg[\"scorer\"] + '.h5'),'df_with_missing')",
    "Get list of body parts to evaluate network for",
    "#################################################",
    "Load data...",
    "#################################################",
    "Load meta data",
    "########################## RESCALING (to global scale)",
    "Check which snapshots are available and sort them by # iterations",
    "name for deeplabcut net (based on its parameters)",
    "DLCscorer = auxiliaryfunctions.GetScorerName(cfg,shuffle,trainFraction,trainingsiterations)",
    "resultsfilename=os.path.join(str(evaluationfolder),DLCscorer + '-' + str(Snapshots[snapindex])+  '.h5') # + '-' + str(snapshot)+  ' #'-' + Snapshots[snapindex]+  '.h5')",
    "import skimage.color",
    "from skimage.io import imread",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "image = skimage.color.gray2rgb(image)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "from scipy.misc import imresize",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Read file path for pose_config file. >> pass it on",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "print(end_points.keys()) >> to see what else is available.",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "from nets.mobilenet import conv_blocks as ops",
    "from nets.mobilenet import mobilenet as lib",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "The next part of the code depends upon which tensorflow version you have.",
    "if cfg.location_refinement:",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "from scipy.misc import imresize",
    "Augmentation functions",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "Initializing variables if they don't exist...",
    "what is the fraction of training samples with scaling augmentation?",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "make sure joint ids are 0-indexed",
    "Load Matlab file dataset annotation",
    "mlab = sio.loadmat(file_name)",
    "mlab = sio.loadmat(os.path.join(self.cfg.project_path,file_name))",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "mlab = mlab['dataset']",
    "Scale is sampled only once to transform all of the images into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "from scipy.misc import imread, imresize",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "from scipy.misc import imread, imresize",
    "from dataset.pose_dataset import Batch, data_to_input, mirror_joints_map, CropImage, DataItem",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "Process skeleton",
    "save",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "deeplabcut.create_labeled_video(path_config_file,[newvideo], destfolder=dfolder,filtered=True)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "#create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 does that much easier...",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "deeplabcut.load_demo_data(path_config_file)",
    "shuffle=11 #>> imageio functions!",
    "print(\"Analyze Video\")",
    "videofile_path = os.path.join(os.getcwd(),'openfield-Pranav-2018-10-30','videos','m3v1mp4.mp4')",
    "deeplabcut.analyze_videos(path_config_file,[videofile_path], shuffle=shuffle)",
    "print(\"Create Labeled Video\")",
    "deeplabcut.create_labeled_video(path_config_file,[videofile_path],save_frames=False, shuffle=shuffle)"
  ],
  "v2.1": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://www.python.org/dev/peps/pep-0440/#compatible-release",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "Supress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / require TF",
    "docs[0]['init_weights'] = '../../pretrained/resnet_v1_101.ckpt'",
    "dict_test['init_weights'] = 'models/mpii/snapshot-1030000'",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "Create the pose_config.yaml files",
    "Analyze the videos",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "get vcap property",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "Import all videos in a folder or if just one video withouth [] passed, then make it a list.",
    "if isinstance(videos,str):",
    "#there are two cases:",
    "if os.path.isdir(videos): # it is a path!",
    "path=videos",
    "videos=[os.path.join(path,vp) for vp in os.listdir(path) if videotype in vp]",
    "if len(videos)==0:",
    "print(\"No videos found in\",path,os.listdir(path))",
    "print(\"Perhaps change the videotype, which is currently set to:\", videotype)",
    "else:",
    "print(\"Directory entered, \" , len(videos),\" videos were found.\")",
    "else:",
    "if os.path.isfile(videos):",
    "videos=[videos]",
    "https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "try:",
    "#shutil.copy(src,dst)",
    "except OSError or TypeError: #https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "shutil.copy(os.fspath(src),os.fspath(dst))",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Set values to config file:",
    "cfg_file['resnet']=50",
    "Write dictionary to yaml  config file",
    "import yaml",
    "import cv2",
    "import shutil",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "name for output video",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "In case user adds save_as_csv is True after triangulating",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam1 camera",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "self.cropping = False",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "cv2.imwrite(img_name, frame)",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.slider.Enable(False)",
    "self.checkBox.Enable(False)",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "extract min and max index based on start stop interval.",
    "figure out body part list:",
    "all indices between start and stop with jump larger than epsilon (leading up to this point!)",
    "deviation_dataname = str(Path(videofolder)/Path(dataname))",
    "Calculate deviatons for video",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "data.to_csv(dataname.split('.h5')[0]+'filtered.csv')",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "Dataframe = pd.read_hdf(os.path.join(videofolder,dataname+'.h5'))",
    "drop duplicate labels:",
    "updates iteration by 1",
    "###################################################",
    "Dependencies",
    "###################################################",
    "import sys",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as specified in the config file",
    "rr, cc,val = line_aa(int(df_y[pair[0],index]),int(df_x[pair[0],index]),int(df_y[pair[1],index]), int(df_x[pair[1],index]))",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Adds skeleton to the video",
    "###################",
    "less transparent present.",
    "# One can change the parameters of the video creation script below:",
    "See ffmpeg user guide: http://ffmpeg.org/ffmpeg.html#Video-and-Audio-file-format-conversion",
    "",
    "if notanalyzed:",
    "notanalyzed,outdataname,sourcedataname,DLCscorer=auxiliaryfunctions.CheckifPostProcessing(folder,vname,DLCscorer,DLCscorerlegacy,suffix='checking')",
    "Loading cropping data used during analysis",
    "!/usr/bin/env python3",
    "import imageio",
    "from skimage import io",
    "from skimage.util import img_as_ubyte",
    "from PIL import Image",
    "Historically DLC used: from scipy.misc import imread, imresize >> deprecated functions",
    "print(np.max(a),np.min(a),np.median(a))",
    "https://docs.opencv.org/3.4.0/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121",
    "height, width, depth = img.shape",
    "imgScale = W/width",
    "newX,newY = oriimg.shape[1]*imgScale, oriimg.shape[0]*imgScale",
    "a=cv2.resize(img,(int(height*size),int(width*size)))",
    "print(np.shape(a))",
    "print(np.max(a),np.min(a),np.median(a))",
    "TODO check if those times exist...",
    "windows throws error if file path is > 260 characters, can fix with prefix. see https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "fig.colorbar(im, ax=ax)",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "LoadData",
    "nlines,numcolumns=data.shape",
    "assert(len(orderofbpincsv)==len(cfg['bodyparts']))",
    "TODO: test len of images vs. len of imagenames for another sanity check",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "with open(projconfigfile, 'w') as cf:",
    "ruamelFile_3d.dump(cfg_file_3d, cf)",
    "Read the pickle file",
    "Write the pickle file",
    "Creates an empty dataFrame of same shape as df_side_view.",
    "flag = number of coordinates. e.g. 4 for 3d,3 for 2d as we need to store the likelihood too.",
    "df = pd.read_hdf(dataframe)",
    "checks if input is a directory",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "legacy scorername until DLC 2.1. (cfg['resnet'] is deprecated / which is why we get the resnet_xyz name from dlc_cfg!",
    "scorer_legacy = 'DeepCut' + \"_resnet\" + str(cfg['resnet']) + \"_\" + Task + str(date) + 'shuffle' + str(shuffle) + '_' + str(trainingsiterations)",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "Add all the options",
    "",
    "Hide the button as this is not the default option",
    "def help_function(self,event):",
    "wx.MessageBox(\"1. Choose an option to create a new project or load an existing project.\\n\\n2. To create a new project, enter the name of project, experimenter, and choose videos to add to the project.\\n\\n3. As an optional step, choose a directory where you need to create the project and specify if you need to copy the videos\\n\\n4. To load an existing project, use the active Browse button to select the config.yaml file of the project\",'Help',wx.OK | wx.ICON_INFORMATION)",
    "self.ok.Enable(False)",
    "else:",
    "self.ok.Enable(True)",
    "For mac compatibility",
    "Remove the pages in case the user goes back to the create new project and creates/load a new project",
    "Add all the other pages",
    "wx.Frame.__init__(self, None, title=\"DeepLabCut\")",
    "wx.Frame.__init__( self, None, id = wx.ID_ANY, title = 'DeepLabCut',size = wx.Size(self.gui_size), pos = wx.DefaultPosition, style = wx.RESIZE_BORDER|wx.DEFAULT_FRAME_STYLE|wx.TAB_TRAVERSAL )",
    "Here we create a panel and a notebook on the panel",
    "create the page windows as children of the notebook and add the pages to the notebook with the label to show on the tab",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.crop_choice = wx.RadioBox(self, label='Want to crop the frames?', choices=['No', 'Yes'],majorDimension=1, style=wx.RA_SPECIFY_COLS)",
    "hbox1.Add(self.crop_choice,5, wx.EXPAND|wx.TOP|wx.BOTTOM, 5)",
    "self.crop_choice.Enable(False)",
    "self.crop_choice.Enable(True)",
    "if self.crop_choice.GetStringSelection() == 'Yes':",
    "crop = True",
    "else:",
    "crop = False",
    "self.crop_choice.Enable(True)",
    "self.crop_choice.SetStringSelection(\"No\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "use the default pose_cfg file for default values",
    "self.display_iters.Enable(False)",
    "self.save_iters.Enable(False)",
    "self.max_iters.Enable(False)",
    "self.snapshots.Enable(False)",
    "Read the pose config file",
    "print(os.path.join(cfg['project_path'],auxiliaryfunctions.GetModelFolder(trainFraction, self.shuffles.GetValue(),cfg),'train','pose_cfg.yaml'))",
    "let the user open the file with default text editor. Also make it mac compatible",
    "update the variables with the edited values in the pose config file",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.shuffles = wx.SpinCtrl(self, value='1',min=1,max=100)",
    "shuffles_text_boxsizer.Add(self.shuffles,1, wx.EXPAND|wx.TOP|wx.BOTTOM, 10)",
    "if self.draw_skeleton.IsShow():",
    "if self.draw_skeleton.GetStringSelection() == \"Yes\":",
    "self.draw = True",
    "else:",
    "self.draw = True",
    "print(self.config,self.filelist,self.videotype.GetValue(),shuffle,trainingsetindex,gputouse=None,save_as_csv=save_as_csv,destfolder=self.destfolder,cropping=cropping)",
    "self.gpu.SetValue(-1)",
    "import wx.lib.scrolledpanel as SP",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.hbox2 = wx.BoxSizer(wx.HORIZONTAL)",
    "self.SetSizer(self.sizer)",
    "self.sizer.Fit(self)",
    "boxsizer.Add(self.hbox2,5, wx.EXPAND|wx.TOP|wx.BOTTOM, 10)",
    "shuffle = self.shuffle.GetValue()",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "self.sel_config.SetPath(\"Please select the config file\")",
    "else:",
    "deeplabcut.label_frames(self.config)",
    "variable initilization",
    "design the panel",
    "Add logo of DLC",
    "self.sel_config = wx.FilePickerCtrl(self, path=\"\",style=wx.FLP_USE_TEXTCTRL,message=\"Choose the config.yaml file\", wildcard=\"config.yaml\")",
    "#         design the panel",
    "Add image of DLC",
    "if editing this text make sure you add the '\\n' to get the new line. The sizer is unable to format lines correctly.",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = cv2.imread(img)",
    "convert the image to RGB as you are showing the image with matplotlib",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "if self.uniquebodyparts == \"\":",
    "self.uniquebodyparts = self.multibodyparts",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of old labels",
    "Extracting the list of old unique labels",
    "Checking if new labels are added or not",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "check if single is slected when radio buttons are changed",
    "Checking if user added a new label",
    "if self.new_Multibodyparts==[] and self.new_UniqueBodyparts==[]: # i.e. no new labels",
    "self.figure,self.axes,self.canvas,self.toolbar,self.image_axis = self.image_panel.drawplot(self.img,img_name,self.iter,self.index,self.multibodyparts,self.colormap,keep_view=self.view_locked)",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "self.image_panel.addcolorbar(self.img,self.image_axis,self.iter,self.multibodyparts,self.colormap)",
    "# Only show the bodyparts corresponding to single",
    "if self.individual_names[0] == 'single':",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.uniquebodyparts,self.individual_names,self.file,self.markerSize)",
    "else:",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.multibodyparts,self.individual_names,self.file,self.markerSize)",
    "",
    "self.individualrdb.Bind(wx.EVT_RADIOBOX,self.select_individual)",
    "",
    "# Get the color index, depending on if single is selcted or not.",
    "if self.rdb.GetStringSelection==\"single\":",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "else:",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "self.cidClick = self.canvas.mpl_connect('button_press_event', self.onClick)",
    "else:",
    "# Found new labels in either multiple bodyparts or unique bodyparts",
    "dlg = wx.MessageDialog(None,\"New label found in the config file. Do you want to see all the other labels?\", \"New label found\",wx.YES_NO | wx.ICON_WARNING)",
    "result = dlg.ShowModal()",
    "if result == wx.ID_NO:",
    "if self.new_Multibodyparts!=[]:",
    "self.multibodyparts = self.new_Multibodyparts",
    "if self.new_UniqueBodyparts!=[]:",
    "self.uniquebodyparts = self.new_UniqueBodyparts",
    "",
    "self.dataFrame = MainFrame.create_dataframe(self,self.dataFrame,self.relativeimagenames,self.individual_names,self.new_UniqueBodyparts,self.new_Multibodyparts)",
    "self.figure,self.axes,self.canvas,self.toolbar,self.image_axis = self.image_panel.drawplot(self.img,img_name,self.iter,self.index,self.multibodyparts,self.colormap,keep_view=self.view_locked)",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "self.image_panel.addcolorbar(self.img,self.image_axis,self.iter,self.multibodyparts,self.colormap)",
    "",
    "if self.individual_names[0] == 'single':",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.uniquebodyparts,self.individual_names,self.file,self.markerSize)",
    "else:",
    "self.choiceBox,self.individualrdb,self.rdb,self.change_marker_size,self.checkBox = self.choice_panel.addRadioButtons(self.multibodyparts,self.individual_names,self.file,self.markerSize)",
    "self.individualrdb.Bind(wx.EVT_RADIOBOX,self.select_individual)",
    "if self.rdb.GetStringSelection==\"single\":",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "else:",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "self.cidClick = self.canvas.mpl_connect('button_press_event', self.onClick)",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "def plot(self,img):",
    "self.drs= []",
    "self.updatedCoords = []",
    "for ind in self.individual_names:",
    "if self.are_unique_bodyparts_present == False: #no unique bodyparts present",
    "#            for ind in self.individual_names:",
    "image_points = []",
    "for c, bp in enumerate(self.multibodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.multibodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.multibodyparts[c])",
    "else:",
    "if ind == 'single':",
    "for c, bp in enumerate(self.uniquebodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.uniquebodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.uniquebodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.uniquebodyparts[c])",
    "else:",
    "for c, bp in enumerate(self.multibodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.points = [self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter]]",
    "self.norm,self.colorIndex = self.image_panel.getColorIndices(self.img,self.multibodyparts)",
    "color = self.colormap(self.norm(self.colorIndex[c]))",
    "circle = patches.Circle((self.points[0], self.points[1]), radius=self.markerSize, fc = color, alpha=self.alpha)",
    "#                    print(circle)",
    "print(self.axes)",
    "self.axes.add_patch(circle)",
    "self.dr = auxfun_drag_label_multiple_individuals.DraggablePoint(circle,ind,self.multibodyparts[c])",
    "self.dr.connect()",
    "self.dr.coords = image_points",
    "self.drs.append(self.dr)",
    "self.updatedCoords.append(self.dr.coords)",
    "if np.isnan(self.points)[0] == False:",
    "self.buttonCounter[ind].append(self.multibodyparts[c])",
    "",
    "MainFrame.saveEachImage(self)",
    "self.figure.canvas.draw()",
    "return(self.buttonCounter)",
    "print(self.dataFrame)",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "matplotlib.use('Agg')",
    "Load updated lists:",
    "cfg['video_sets'][vn]",
    "labeling_toolbox.show(config,Screens,scale_w,scale_h, winHack, img_scale)",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "plt.savefig(str(Path(tmpfolder)/imagename.split(os.sep)[-1]))",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "trainIndexes, testIndexes = SplitTrials(range(len(Data.index)), trainFraction)",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "sort the models directories",
    "get the shuffle index",
    "read cfg file",
    "create log file",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.individual_names+','+self.bodyParts)",
    "Check for variable correctness",
    "plt.close(\"all\")",
    "Moviepy:",
    "Call the GUI to select the cropping parameters",
    "Update the config.yaml file with current cropping parameters",
    "store full frame from random location (good for augmentation)",
    "clip=clip.crop(y1 = int(coords[2]),y2 = int(coords[3]),x1 = int(coords[0]), x2 = int(coords[1]))",
    "close video.",
    "def __init__(self, point,bodyParts):",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.bodyParts)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "Update number of output and batchsize",
    "update batchsize (based on parameters in config.yaml)",
    "(state,detectiontreshold,margin)=dynamic",
    "Name for scorer:",
    "sess, inputs, outputs = predict.setup_pose_prediction(dlc_cfg)",
    "#################################################",
    "Datafolder",
    "#################################################",
    "looping over videos",
    "pose = predict.getpose(frame, dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames,dlc_cfg, sess, inputs, outputs)",
    "pose = predict.getposeNP(frames, dlc_cfg, sess, inputs, outputs) #process the whole batch (some frames might be from previous batch!)",
    "TODO: perform detection on resized image (For speed)",
    "print(counter,x1,x2,y1,y2,detected)",
    "print(\"looking again, lost!\")",
    "GetPoseF_GTF(cfg,dlc_cfg, sess, inputs, outputs,cap,nframes,int(dlc_cfg[\"batch_size\"]))",
    "\"gpu_info\": device_lib.list_local_devices()",
    "from skimage.io import imread",
    "frame=imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "Parameters for augmentation with regard to cropping",
    "Added and described in \"Using DeepLabCut for 3D markerless pose estimation across species and behaviors\"",
    "Source: https://www.nature.com/articles/s41596-019-0176-0",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Dependencies for anaysis",
    "import skimage.color",
    "from skimage.io import imread",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "########################## RESCALING (to global scale)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "image = skimage.color.gray2rgb(image)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "from scipy.misc import imresize",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "loading backbone from ResNet, MobileNet etc.",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Read file path for pose_config file. >> pass it on",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Note: want to round down, we adjust each split to match the total.",
    "We use scope_depthwise, scope_pointwise for compatibility with V1 ckpts.",
    "which provide numbered scopes.",
    "b1 -> b2 * r -> b2",
    "i -> (o * r) (bottleneck) -> o",
    "Note in contrast with expansion, we always have",
    "projection to produce the desired output size.",
    "stride check enforces that we don't add residuals when spatial",
    "dimensions are None",
    "Depth matches",
    "Don't do any splitting if we end up with less than 8 filters",
    "on either side.",
    "print(end_points.keys()) >> to see what else is available.",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "Make sure that round down does not go down by more than 10%.",
    "Set conv defs defaults and overrides.",
    "a) Set the tensorflow scope",
    "b) set padding to default: note we might consider removing this",
    "since it is also set by mobilenet_scope",
    "c) set all defaults",
    "d) set all extra overrides.",
    "pylint: disable=g-backslash-continuation",
    "The current_stride variable keeps track of the output stride of the",
    "activations, i.e., the running product of convolution strides up to the",
    "current network layer. This allows us to invoke atrous convolution",
    "whenever applying the next convolution would result in the activations",
    "having output stride larger than the target output_stride.",
    "The atrous convolution rate parameter.",
    "Insert default parameters before the base scope which includes",
    "any custom overrides set in mobilenet.",
    "If we have reached the target output_stride, then we need to employ",
    "atrous convolution with stride=1 and multiply the atrous rate by the",
    "current unit's stride for use in subsequent layers.",
    "Update params.",
    "Only insert rate to params if rate > 1 and kernel size is not [1, 1].",
    "We will apply atrous rate in the following cases:",
    "1) When kernel_size is not in params, the operation then uses",
    "default kernel size 3x3.",
    "2) When kernel_size is in params, and if the kernel_size is not",
    "equal to (1, 1) (there is no need to apply atrous convolution to",
    "any 1x1 convolution).",
    "Set padding",
    "Add all tensors that end with 'output' to",
    "endpoints",
    "1 x 1 x num_classes",
    "Note: legacy scope name.",
    "Recover output shape, for unknown shape.",
    "the network created will be trainble with dropout/batch norm",
    "initialized appropriately.",
    "Note: do not introduce parameters that would change the inference",
    "model here (for example whether to use bias), modify conv_def instead.",
    "Set weight_decay for weights in Conv and FC layers.",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "## Code for TF inference on GPU",
    "Restore variables from disk.",
    "Copyright 2018 The TensorFlow Authors. All Rights Reserved.",
    "",
    "Licensed under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License.",
    "You may obtain a copy of the License at",
    "",
    "http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software",
    "distributed under the License is distributed on an \"AS IS\" BASIS,",
    "WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
    "See the License for the specific language governing permissions and",
    "limitations under the License.",
    "==============================================================================",
    "from nets.mobilenet import conv_blocks as ops",
    "from nets.mobilenet import mobilenet as lib",
    "pyformat: disable",
    "Architecture: https://arxiv.org/abs/1801.04381",
    "Note: these parameters of batch norm affect the architecture",
    "that's why they are here and not in training_scope.",
    "pyformat: enable",
    "NB: do not set depth_args unless they are provided to avoid overriding",
    "whatever default depth_multiplier might have thanks to arg_scope.",
    "Wrappers for mobilenet v2 with depth-multipliers. Be noticed that",
    "'finegrain_classification_mode' is set to True, which means the embedding",
    "layer will not be shrinked when given a depth-multiplier < 1.0.",
    "The next part of the code depends upon which tensorflow version you have.",
    "if cfg.location_refinement:",
    "assuming batchsize 1 here!",
    "probs = tf.squeeze(probs, axis=0)",
    "locref = locref*cfg.locref_stdev",
    "turn into x times y time bs * bpts",
    "print(locref.get_shape().as_list())",
    "print(probs.get_shape().as_list())",
    "extract corresponding locref x and y as well as probability",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "from scipy.misc import imresize",
    "Augmentation functions",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "Initializing variables if they don't exist...",
    "what is the fraction of training samples with scaling augmentation?",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "make sure joint ids are 0-indexed",
    "Load Matlab file dataset annotation",
    "mlab = sio.loadmat(file_name)",
    "mlab = sio.loadmat(os.path.join(self.cfg.project_path,file_name))",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "mlab = mlab['dataset']",
    "Scale is sampled only once to transform all of the images into same size.",
    "Approximating the scale",
    "If you would like to check the augmented images, script for saving",
    "the images with joints on:",
    "for i in range(self.batch_size):",
    "joints = batch_joints[i]",
    "kps = KeypointsOnImage([Keypoint(x=joint[0], y=joint[1]) for joint in joints], shape=batch_images[i].shape)",
    "im = kps.draw_on_image(batch_images[i])",
    "imageio.imwrite('some_location/augmented/'+str(i)+'.png', im)",
    "dist_thresh = float(self.cfg.pos_dist_thresh * scale)",
    "Grid of coordinates",
    "Distance between the joint point and each coordinate",
    "from scipy.misc import imread, imresize",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "from scipy.misc import imread, imresize",
    "from dataset.pose_dataset import Batch, data_to_input, mirror_joints_map, CropImage, DataItem",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "utility functions",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "Process skeleton",
    "save",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "newvideo=deeplabcut.ShortenVideo(video,start='00:00:00',stop='00:00:20',outsuffix='short')",
    "print(\"CREATE VIDEO\")",
    "Checked: dynamic=(True,1.1,0)) >> only keeps large limits (full frame >> never detects)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "For testing a color video:",
    "videoname='baby4hin2min'",
    "video=[os.path.join('/home/alex/Desktop/Data',videoname+'.mp4')]",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.evaluate_network(path_config_file,plotting=True,trainingsetindex=33)",
    "Make super short video (so the analysis is quick!)",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "subprocess.call(['ffmpeg','-i',video[0],'-ss','00:00:00','-to','00:00:00.4','-c','copy',newvideo])",
    "deeplabcut.create_labeled_video(path_config_file,[newvideo], destfolder=dfolder,filtered=True)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "#create one split and make Shuffle 2 and 3 have the same split.",
    "##Note that the new function in DLC 2.1 does that much easier...",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "deeplabcut.train_network(configfile,shuffle=1) #>> fails one body part too much!",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "deeplabcut.load_demo_data(path_config_file)",
    "shuffle=11 #>> imageio functions!",
    "print(\"Analyze Video\")",
    "videofile_path = os.path.join(os.getcwd(),'openfield-Pranav-2018-10-30','videos','m3v1mp4.mp4')",
    "deeplabcut.analyze_videos(path_config_file,[videofile_path], shuffle=shuffle)",
    "print(\"Create Labeled Video\")",
    "deeplabcut.create_labeled_video(path_config_file,[videofile_path],save_frames=False, shuffle=shuffle)"
  ],
  "v2.0.9": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://stackoverflow.com/questions/39590187/in-requirements-txt-what-does-tilde-equals-mean",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "Supress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / require TF",
    "docs[0]['init_weights'] = '../../pretrained/resnet_v1_101.ckpt'",
    "dict_test['init_weights'] = 'models/mpii/snapshot-1030000'",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "create the pose_config.yaml files",
    "Analyze the videos",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "get vcap property",
    "Create project and sub-directories",
    "Add all videos in the folder. Multiple folders can be passed in a list, similar to the video files. Folders and video files can also be passed!",
    "Check if it is a folder",
    "Import all videos in a folder or if just one video withouth [] passed, then make it a list.",
    "if isinstance(videos,str):",
    "#there are two cases:",
    "if os.path.isdir(videos): # it is a path!",
    "path=videos",
    "videos=[os.path.join(path,vp) for vp in os.listdir(path) if videotype in vp]",
    "if len(videos)==0:",
    "print(\"No videos found in\",path,os.listdir(path))",
    "print(\"Perhaps change the videotype, which is currently set to:\", videotype)",
    "else:",
    "print(\"Directory entered, \" , len(videos),\" videos were found.\")",
    "else:",
    "if os.path.isfile(videos):",
    "videos=[videos]",
    "https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "try:",
    "#shutil.copy(src,dst)",
    "except OSError or TypeError: #https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "shutil.copy(os.fspath(src),os.fspath(dst))",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Set values to config file:",
    "Write dictionary to yaml  config file",
    "import yaml",
    "import cv2",
    "import shutil",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam1 camera",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "self.cropping = False",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variable initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "Overwrite machine label file",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.slider.Enable(False)",
    "self.checkBox.Enable(False)",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "Checks if zoom/pan button is ON",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "extract min and max index based on start stop interval.",
    "figure out body part list:",
    "all indices between start and stop with jump larger than epsilon (leading up to this point!)",
    "deviation_dataname = str(Path(videofolder)/Path(dataname))",
    "Calculate deviatons for video",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "data.to_csv(dataname.split('.h5')[0]+'filtered.csv')",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "Dataframe = pd.read_hdf(os.path.join(videofolder,dataname+'.h5'))",
    "drop duplicate labels:",
    "updates iteration by 1",
    "###################################################",
    "Dependencies",
    "###################################################",
    "import sys",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as specified in the config file",
    "rr, cc,val = line_aa(int(df_y[pair[0],index]),int(df_x[pair[0],index]),int(df_y[pair[1],index]), int(df_x[pair[1],index]))",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Adds skeleton to the video",
    "###################",
    "less transparent present.",
    "# One can change the parameters of the video creation script below:",
    "See ffmpeg user guide: http://ffmpeg.org/ffmpeg.html#Video-and-Audio-file-format-conversion",
    "",
    "videofolder = str(Path(video).parents[0])",
    "print(metadata)",
    "Loading cropping data used during analysis",
    "!/usr/bin/env python3",
    "TODO check if those times exist...",
    "windows throws error if file path is > 260 characters, can fix with prefix. see https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "fig.colorbar(im, ax=ax)",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "nlines,numcolumns=data.shape",
    "assert(len(orderofbpincsv)==len(cfg['bodyparts']))",
    "TODO: test len of images vs. len of imagenames for another sanity check",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "with open(projconfigfile, 'w') as cf:",
    "ruamelFile_3d.dump(cfg_file_3d, cf)",
    "Read the pickle file",
    "Write the pickle file",
    "Creates an empty dataFrame of same shape as df_side_view.",
    "flag = number of coordinates. e.g. 4 for 3d,3 for 2d as we need to store the likelihood too.",
    "df = pd.read_hdf(dataframe)",
    "checks if input is a directory",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "dlc_cfg = read_config(os.path.join(modelfolder,'pose_cfg.yaml'))",
    "dlc_cfg['init_weights'] = os.path.join(modelfolder , 'train', Snapshots[snapshotindex])",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = cv2.imread(img)",
    "convert the image to RGB as you are showing the image with matplotlib",
    "divider = make_axes_locatable(self.axes)",
    "colorIndex = np.linspace(np.min(im),np.max(im),len(bodyparts))",
    "cax = divider.append_axes(\"right\", size=\"5%\", pad=0.05)",
    "cbar = self.figure.colorbar(ax, cax=cax,spacing='proportional', ticks=colorIndex)",
    "cbar.set_ticklabels(bodyparts[::-1])",
    "self.figure.canvas.draw()",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "MainFrame.saveDataSet(self, event)",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Create an empty data frame",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of old labels",
    "Extracting the list of old unique labels",
    "Checking if new labels are added or not",
    "Checking if user added a new label",
    "Found new labels in either multiple bodyparts or unique bodyparts",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "matplotlib.use('Agg')",
    "Load updated lists:",
    "cfg['video_sets'][vn]",
    "labeling_toolbox.show(config,Screens,scale_w,scale_h, winHack, img_scale)",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "plt.savefig(str(Path(tmpfolder)/imagename.split(os.sep)[-1]))",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "trainIndexes, testIndexes = SplitTrials(range(len(Data.index)), trainFraction)",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.individual_names+','+self.bodyParts)",
    "Check for variable correctness",
    "plt.close(\"all\")",
    "Moviepy:",
    "Call the GUI to select the cropping parameters",
    "Update the config.yaml file with current cropping parameters",
    "store full frame from random location (good for augmentation)",
    "clip=clip.crop(y1 = int(coords[2]),y2 = int(coords[3]),x1 = int(coords[0]), x2 = int(coords[1]))",
    "close video.",
    "def __init__(self, point,bodyParts):",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.bodyParts)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "update number of outputs",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "looping over videos",
    "reset cap to frame 0!",
    "Attempt to load data...",
    "frame=io.imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "Attempt to load data...",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "Parameters for augmentation with regard to cropping",
    "Added and described in \"Using DeepLabCut for 3D markerless pose estimation across species and behaviors\"",
    "Source: https://www.nature.com/articles/s41596-019-0176-0",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Dependencies for anaysis",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "The next part of the code depends upon which tensorflow version you have.",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Augmentation functions",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "print(item.joints)",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "Initializing variables if they don't exist...",
    "what is the fraction of training samples with scaling augmentation?",
    "Randomly rotates an image with respect to the image center within the",
    "range [-rotate_max_deg_abs; rotate_max_deg_abs] to augment training data",
    "Randomly adds brightness within the range [-brightness_dif, brightness_dif]",
    "to augment training data",
    "Randomly applies x = (x - mean) * contrast_factor + mean`` to each",
    "color channel within the range [contrast_factor_lo, contrast_factor_up]",
    "to augment training data",
    "Randomly adjusts saturation within range 1 + [-saturation_max_dif, saturation_max_dif]",
    "to augment training data",
    "Randomly applies gaussian noise N(0, noise_sigma^2) to an image",
    "to augment training data",
    "Randomly applies gaussian blur to an image with a random window size",
    "within the range [0, 2 * blur_max_window_size + 1] to augment training data",
    "Whether image is RGB  or RBG. If None, contrast augmentation uses the mean per-channel.",
    "Clips image to [0, 255] even when data type is not uint8",
    "Number of processes to use per core during training",
    "Number of datapoints to prefetch at a time during training",
    "don't loop over entire heatmap, but just relevant locations",
    "print(la.norm(diff))",
    "logging.debug('image %s', im_file)",
    "print('image: {}'.format(im_file))",
    "logging.debug('mirror %r', mirror)",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "from dataset.pose_dataset import Batch, data_to_input, mirror_joints_map, CropImage, DataItem",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "print(\"Filtering with ARIMA model %s\",video)",
    "UTILS FUNCTIONS",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "See if file was already proccessed",
    "Process skeleton",
    "save",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "for windows:",
    "deeplabcut.create_labeled_video(path_config_file,[newvideo], destfolder=dfolder,filtered=True)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Loading example data set",
    "create one split and make Shuffle 5 and 6 have the same split.",
    "otherwise default...",
    "DLC_config=deeplabcut.auxiliaryfunctions.read_plainconfig(posefile)",
    "DLC_config['save_iters']=10",
    "DLC_config['display_iters']=2",
    "DLC_config['multi_step']=[[0.005,15001]]",
    "deeplabcut.auxiliaryfunctions.write_plainconfig(posefile,DLC_config)",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set"
  ],
  "v2.0.8": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://stackoverflow.com/questions/39590187/in-requirements-txt-what-does-tilde-equals-mean",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "Supress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / require TF",
    "docs[0]['init_weights'] = '../../pretrained/resnet_v1_101.ckpt'",
    "dict_test['init_weights'] = 'models/mpii/snapshot-1030000'",
    "Create the model directory",
    "Download the weights and put then in appropriate directory",
    "create the pose_config.yaml files",
    "Analyze the videos",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "get vcap property",
    "Create project and sub-directories",
    "Import all videos in a folder or if just one video withouth [] passed, then make it a list.",
    "there are two cases:",
    "https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "try:",
    "#shutil.copy(src,dst)",
    "except OSError or TypeError: #https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "shutil.copy(os.fspath(src),os.fspath(dst))",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Set values to config file:",
    "Write dictionary to yaml  config file",
    "import yaml",
    "import cv2",
    "import shutil",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "flag to check if the video_path variable is a string or a list of list",
    "Check for the camera matrix",
    "Check for scorer names in the pickle file of 3d output",
    "Analyze video if score name is different",
    "if len(dataname)>0:",
    "undistort points for this pair",
    "raise Exception(\"The number of frames do not match in the two videos. Please make sure that your videos have same number of frames and then retry!\")",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "have to make the dest folder none so that it can be updated for a new pair of videos",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam1 camera",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "self.cropping = False",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "SP.ScrolledPanel.__init__(self, parent, -1,style=wx.SUNKEN_BORDER, **kwargs)",
    "self.parent = parent",
    "self.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "widgetsizer.AddStretchSpacer(15)",
    "self.adjustLabelCheck = wx.CheckBox(self.widget_panel,id=wx.ID_ANY,  label = 'Adjust original labels?')",
    "widgetsizer.Add(self.adjustLabelCheck , 1, wx.ALL, 15)",
    "self.adjustLabelCheck.Bind(wx.EVT_CHECKBOX,self.adjustLabel)",
    "##############################################################################################################################",
    "Variable initialization",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.clear()",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.slider.Enable(False)",
    "self.checkBox.Enable(False)",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "print(self.points)",
    "Checks if zoom/pan button is ON",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "extract min and max index based on start stop interval.",
    "figure out body part list:",
    "all indices between start and stop with jump larger than epsilon (leading up to this point!)",
    "deviation_dataname = str(Path(videofolder)/Path(dataname))",
    "Calculate deviatons for video",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "data.to_csv(dataname.split('.h5')[0]+'filtered.csv')",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "Dataframe = pd.read_hdf(os.path.join(videofolder,dataname+'.h5'))",
    "drop duplicate labels:",
    "updates iteration by 1",
    "###################################################",
    "Dependencies",
    "###################################################",
    "import sys",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as specified in the config file",
    "rr, cc,val = line_aa(int(df_y[pair[0],index]),int(df_x[pair[0],index]),int(df_y[pair[1],index]), int(df_x[pair[1],index]))",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Adds skeleton to the video",
    "###################",
    "less transparent present.",
    "# One can change the parameters of the video creation script below:",
    "See ffmpeg user guide: http://ffmpeg.org/ffmpeg.html#Video-and-Audio-file-format-conversion",
    "",
    "videofolder = str(Path(video).parents[0])",
    "print(metadata)",
    "Loading cropping data used during analysis",
    "windows throws error if file path is > 260 characters, can fix with prefix. see https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "fig.colorbar(im, ax=ax)",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "nlines,numcolumns=data.shape",
    "assert(len(orderofbpincsv)==len(cfg['bodyparts']))",
    "TODO: test len of images vs. len of imagenames for another sanity check",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "with open(projconfigfile, 'w') as cf:",
    "ruamelFile_3d.dump(cfg_file_3d, cf)",
    "Read the pickle file",
    "Write the pickle file",
    "Creates an empty dataFrame of same shape as df_side_view.",
    "flag = number of coordinates. e.g. 4 for 3d,3 for 2d as we need to store the likelihood too.",
    "df = pd.read_hdf(dataframe)",
    "checks if input is a directory",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "dlc_cfg = read_config(os.path.join(modelfolder,'pose_cfg.yaml'))",
    "dlc_cfg['init_weights'] = os.path.join(modelfolder , 'train', Snapshots[snapshotindex])",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "MainFrame.saveEachImage(self)",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "MainFrame.saveEachImage(self)",
    "def getLabels(self,ind,img_index):",
    "\"\"\"",
    "Returns a list of x and y labels of the corresponding image index",
    "\"\"\"",
    "self.previous_image_points = []",
    "for bpindex, bp in enumerate(self.bodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.previous_image_points.append(image_points)",
    "return(self.previous_image_points)",
    "self.dr.coords = MainFrame.getLabels(self,ind,self.iter)[bpindex]",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "matplotlib.use('Agg')",
    "Load updated lists:",
    "cfg['video_sets'][vn]",
    "labeling_toolbox.show(config,Screens,scale_w,scale_h, winHack, img_scale)",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "plt.savefig(str(Path(tmpfolder)/imagename.split(os.sep)[-1]))",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "trainIndexes, testIndexes = SplitTrials(range(len(Data.index)), trainFraction)",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.individual_names+','+self.bodyParts)",
    "Check for variable correctness",
    "plt.close(\"all\")",
    "Moviepy:",
    "Call the GUI to select the cropping parameters",
    "Update the config.yaml file with current cropping parameters",
    "store full frame from random location (good for augmentation)",
    "clip=clip.crop(y1 = int(coords[2]),y2 = int(coords[3]),x1 = int(coords[0]), x2 = int(coords[1]))",
    "close video.",
    "def __init__(self, point,bodyParts):",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.bodyParts)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "update number of outputs",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "looping over videos",
    "Attempt to load data...",
    "frame=io.imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "update number of outputs and adjust pandas indices",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "Attempt to load data...",
    "types of datasets, see factory: deeplabcut/pose_estimation_tensorflow/dataset/factory.py",
    "you can also set this to deterministic, see https://github.com/AlexEMG/DeepLabCut/pull/324",
    "Parameters for augmentation with regard to cropping",
    "Added and described in \"Using DeepLabCut for 3D markerless pose estimation across species and behaviors\"",
    "Source: https://www.nature.com/articles/s41596-019-0176-0",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Dependencies for anaysis",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "The next part of the code depends upon which tensorflow version you have.",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Augmentation functions",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "from dataset.pose_dataset import Batch, data_to_input, mirror_joints_map, CropImage, DataItem",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "print(\"Filtering with ARIMA model %s\",video)",
    "UTILS FUNCTIONS",
    "Check dataformats",
    "Calculate distance",
    "if not 0 <= ang <+ 360: raise ValueError('Ang was not computed correctly')",
    "Check data format",
    "Calculate",
    "Process single bone",
    "get bone length and orientation",
    "keep the smallest of the two likelihoods",
    "Create dataframe and return",
    "df.index.name=name",
    "MAIN FUNC",
    "Load config file, scorer and videos",
    "See if file was already proccessed",
    "Process skeleton",
    "save",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "for windows:",
    "deeplabcut.create_labeled_video(path_config_file,[newvideo], destfolder=dfolder,filtered=True)",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set"
  ],
  "v2.0.7": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://stackoverflow.com/questions/39590187/in-requirements-txt-what-does-tilde-equals-mean",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "Supress tensorflow warning messages",
    "DLClight version does not support GUIs. Importing accordingly",
    "Train, evaluate & predict functions / require TF",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "get vcap property",
    "Create project and sub-directories",
    "Import all videos in a folder or if just one video withouth [] passed, then make it a list.",
    "there are two cases:",
    "https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "try:",
    "#shutil.copy(src,dst)",
    "except OSError or TypeError: #https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "shutil.copy(os.fspath(src),os.fspath(dst))",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Set values to config file:",
    "Write dictionary to yaml  config file",
    "import yaml",
    "import cv2",
    "import shutil",
    "Create project and sub-directories",
    "Create config file",
    "cfg_file_3d['config_files']= [str('Enter the path of the config file ')+str(i)+ ' to include' for i in range(1,3)]",
    "cfg_file_3d['config_files']= ['Enter the path of the config file 1']",
    "Read the config file and related variables",
    "Flatten the list of bodyparts to connect",
    "triangulated file is a list which is always sorted as [triangulated.h5,camera-1.videotype,camera-2.videotype]",
    "Read the video files and corresponfing h5 files",
    "Look for the filtered predictions file",
    "Start plotting for every frame",
    "Once all the frames are saved, then make a movie using ffmpeg.",
    "Create the fig and define the axes",
    "Clear plot and initialize the variables",
    "Initialize arrays for appending the 3d data for actual plotting the points",
    "Initialize arrays for appending the 3d data for drawing the lines",
    "Initialize arrays for appending the 2d data from cam1 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam2 for actual plotting the points",
    "Initialize arrays for appending the 2d data from cam1 for drawing the lines",
    "Initialize arrays for appending the 2d data from cam2 for drawing the lines",
    "Get the scorer names from the dataframe",
    "Set the x,y, and z limits for the 3d view",
    "Set the frame number to read#max(0,index-trailpoints):index",
    "Plot the labels for each body part",
    "Connecting the bodyparts specified in the config file.3d file is created based on the likelihoods of cam1 and cam2. Using 3d file and check if the body part is nan then dont plot skeleton",
    "Saving the frames",
    "Termination criteria",
    "Prepare object points, like (0,0,0), (1,0,0), (2,0,0) ....,(6,5,0)",
    "Read the config file",
    "update the variable snapshot* in config file according to the name of the cameras",
    "Initialize the dictionary",
    "Sort the images.",
    "Find the chess board corners",
    "If found, add object points, image points (after refining them)",
    "Draw the corners and store the images",
    "Perform calibration for each cameras and store the matrices as a pickle file",
    "Calibrating each camera",
    "Save the camera calibration result for later use (we won't use rvecs / tvecs)",
    "Compute mean re-projection errors for individual cameras",
    "Compute stereo calibration for each pair of cameras",
    "Stereo Rectification",
    "Read the config file",
    "colormap = plt.get_cmap(cfg_3d['colormap'])",
    "Sort the images",
    "Remapping dataFrame_camera1_undistort",
    "Remapping",
    "Display images in RGB",
    "Plot the undistorted corner points",
    "Triangulate",
    "Check if the config file exists",
    "undistort points for this pair",
    "Extract the indices of frames where the likelihood of a bodypart for both cameras are less than pvalue",
    "Extract frames where likelihood for both the views is less than the pcutoff",
    "low_likelihood_frames = np.all(likelihoods < pcutoff, axis=1)",
    "For cam1 camera: Assign nans to x and y values of a bodypart where the likelihood for is less than pvalue",
    "For cam2 camera: Assign nans to x and y values of a bodypart where the likelihood is less than pvalue",
    "ToDo: speed up func. below by saving in numpy.array",
    "Create an empty dataframe to store x,y,z of 3d data",
    "currently no interm. saving of this due to high speed.",
    "check if the undistorted files are already present",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Create an empty dataFrame to store the undistorted 2d coordinates and likelihood",
    "Undistorting the points from cam1 camera",
    "Undistorting the points from cam2 camera",
    "Save the undistorted files",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "self.cropping = False",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "SP.ScrolledPanel.__init__(self, parent, -1,style=wx.SUNKEN_BORDER, **kwargs)",
    "self.parent = parent",
    "self.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "widgetsizer.AddStretchSpacer(15)",
    "self.adjustLabelCheck = wx.CheckBox(self.widget_panel,id=wx.ID_ANY,  label = 'Adjust original labels?')",
    "widgetsizer.Add(self.adjustLabelCheck , 1, wx.ALL, 15)",
    "self.adjustLabelCheck.Bind(wx.EVT_CHECKBOX,self.adjustLabel)",
    "##############################################################################################################################",
    "Variable initialization",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.slider.Enable(False)",
    "self.checkBox.Enable(False)",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "print(self.points)",
    "Checks if zoom/pan button is ON",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "extract min and max index based on start stop interval.",
    "figure out body part list:",
    "all indices between start and stop with jump larger than epsilon (leading up to this point!)",
    "deviation_dataname = str(Path(videofolder)/Path(dataname))",
    "Calculate deviatons for video",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "data.to_csv(dataname.split('.h5')[0]+'filtered.csv')",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "Dataframe = pd.read_hdf(os.path.join(videofolder,dataname+'.h5'))",
    "drop duplicate labels:",
    "updates iteration by 1",
    "###################################################",
    "Dependencies",
    "###################################################",
    "import sys",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Draw the skeleton for specific bodyparts to be connected as specified in the config file",
    "rr, cc,val = line_aa(int(df_y[pair[0],index]),int(df_x[pair[0],index]),int(df_y[pair[1],index]), int(df_x[pair[1],index]))",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "recode the bodyparts2connect into indices for df_x and df_y for speed",
    "Adds skeleton to the video",
    "###################",
    "less transparent present.",
    "# One can change the parameters of the video creation script below:",
    "See ffmpeg user guide: http://ffmpeg.org/ffmpeg.html#Video-and-Audio-file-format-conversion",
    "",
    "videofolder = str(Path(video).parents[0])",
    "print(metadata)",
    "Loading cropping data used during analysis",
    "windows throws error if file path is > 260 characters, can fix with prefix. see https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "Creates an empty dataFrame of same shape as df_side_view",
    "flag = 2d or 3d",
    "Plotting",
    "Find videos only specific to the cam names",
    "Exclude the labeled video files",
    "print(\"here is what I found\",vid)",
    "print([os.path.join(path,pref+cam+suf+ending),putativecam2name])",
    "found a pair!!!",
    "Checks if filepath is a directory",
    "Get the filename of the triangulated file excluing the scorer name and remove any '-' or _ from it",
    "Get the suffix and prefix of the video filenames so that they can be used for matching the triangulated file names.",
    "Match the suffix and prefix with the triangulated file name and return the list with triangulated file and corresponding video files.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "fig.colorbar(im, ax=ax)",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "nlines,numcolumns=data.shape",
    "assert(len(orderofbpincsv)==len(cfg['bodyparts']))",
    "TODO: test len of images vs. len of imagenames for another sanity check",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Plotting configuration",
    "Number of cameras, camera names, path of the config files, shuffle index and trainingsetindex used to analyze videos:",
    "Adding default value for variable skeleton and skeleton_color for backward compatibility.",
    "with open(projconfigfile, 'w') as cf:",
    "ruamelFile_3d.dump(cfg_file_3d, cf)",
    "Read the pickle file",
    "Write the pickle file",
    "Creates an empty dataFrame of same shape as df_side_view.",
    "flag = number of coordinates. e.g. 4 for 3d,3 for 2d as we need to store the likelihood too.",
    "df = pd.read_hdf(dataframe)",
    "checks if input is a directory",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "dlc_cfg = read_config(os.path.join(modelfolder,'pose_cfg.yaml'))",
    "dlc_cfg['init_weights'] = os.path.join(modelfolder , 'train', Snapshots[snapshotindex])",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "MainFrame.saveEachImage(self)",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "MainFrame.saveEachImage(self)",
    "def getLabels(self,ind,img_index):",
    "\"\"\"",
    "Returns a list of x and y labels of the corresponding image index",
    "\"\"\"",
    "self.previous_image_points = []",
    "for bpindex, bp in enumerate(self.bodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.previous_image_points.append(image_points)",
    "return(self.previous_image_points)",
    "self.dr.coords = MainFrame.getLabels(self,ind,self.iter)[bpindex]",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "Workaround for MAC - xlim and ylim changed events seem to be triggered too often so need to make sure that the",
    "xlim and ylim have actually changed before turning zoom off",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Save pre-zoom xlim and ylim values",
    "See if axis limits have actually changed",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "matplotlib.use('Agg')",
    "Load updated lists:",
    "cfg['video_sets'][vn]",
    "labeling_toolbox.show(config,Screens,scale_w,scale_h, winHack, img_scale)",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "loading & linking pretrained models",
    "trainIndexes, testIndexes = SplitTrials(range(len(Data.index)), trainFraction)",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.individual_names+','+self.bodyParts)",
    "Check for variable correctness",
    "plt.close(\"all\")",
    "Moviepy:",
    "Call the GUI to select the cropping parameters",
    "Update the config.yaml file with current cropping parameters",
    "store full frame from random location (good for augmentation)",
    "clip=clip.crop(y1 = int(coords[2]),y2 = int(coords[3]),x1 = int(coords[0]), x2 = int(coords[1]))",
    "close video.",
    "def __init__(self, point,bodyParts):",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.bodyParts)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "looping over videos",
    "Attempt to load data...",
    "frame=io.imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "Attempt to load data...",
    "Parameters for augmentation with regard to cropping",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "these will be updated by trainingsetmanipulation.py in the future",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Dependencies for anaysis",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "reload logger.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "The next part of the code depends upon which tensorflow version you have.",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "Xstart=int(np.max([0,int(Xlabel)-widthback]))",
    "Xstop=int(np.min([np.shape(im)[1]-1,int(Xlabel)+widthforward]))",
    "Ystart=int(np.max([0,int(Ylabel)-hdown]))",
    "Ystop=int(np.min([np.shape(im)[0]-1,int(Ylabel)+hup]))",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "print(\"Filtering with ARIMA model %s\",video)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "for windows:",
    "deeplabcut.create_labeled_video(path_config_file,[newvideo], destfolder=dfolder,filtered=True)",
    "copying demo video from reaching data set and create two \"views\":",
    "copying demo video from reaching data set and create two \"views\":",
    "checking if 2d test project is available",
    "Creating the name of the project",
    "Dowloading the calibration images",
    "Deleting unneccesary images; the ones whose corners are not detected and .mat files",
    "change the file names for calibration images to match the name of cameras in config.yaml file.i.e. camera-1 and camera-2",
    "Sorting images",
    "Removing some of the images where the corner was not detected",
    "output_path = [os.path.join(basepath,folder)]",
    "deeplabcut.create_labeled_video_3d(path_config_file,output_path,start=5,end=10)"
  ],
  "v2.0.6.2": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://stackoverflow.com/questions/39590187/in-requirements-txt-what-does-tilde-equals-mean",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "Supress tensorflow warning messages",
    "Direct import for convenience",
    "Direct import for convenience",
    "from deeplabcut import create_project",
    "Direct import for convenience",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "get vcap property",
    "Create project and sub-directories",
    "Import all videos in a folder or if just one video withouth [] passed, then make it a list.",
    "there are two cases:",
    "https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "try:",
    "#shutil.copy(src,dst)",
    "except OSError or TypeError: #https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "shutil.copy(os.fspath(src),os.fspath(dst))",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Set values to config file:",
    "Write dictionary to yaml  config file",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "self.cropping = False",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "SP.ScrolledPanel.__init__(self, parent, -1,style=wx.SUNKEN_BORDER, **kwargs)",
    "self.parent = parent",
    "self.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "widgetsizer.AddStretchSpacer(15)",
    "self.adjustLabelCheck = wx.CheckBox(self.widget_panel,id=wx.ID_ANY,  label = 'Adjust original labels?')",
    "widgetsizer.Add(self.adjustLabelCheck , 1, wx.ALL, 15)",
    "self.adjustLabelCheck.Bind(wx.EVT_CHECKBOX,self.adjustLabel)",
    "##############################################################################################################################",
    "Variable initialization",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.slider.Enable(False)",
    "self.checkBox.Enable(False)",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "print(self.points)",
    "Checks if zoom/pan button is ON",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "extract min and max index based on start stop interval.",
    "figure out body part list:",
    "all indices between start and stop with jump larger than epsilon (leading up to this point!)",
    "deviation_dataname = str(Path(videofolder)/Path(dataname))",
    "Calculate deviatons for video",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "data.to_csv(dataname.split('.h5')[0]+'filtered.csv')",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "Dataframe = pd.read_hdf(os.path.join(videofolder,dataname+'.h5'))",
    "drop duplicate labels:",
    "updates iteration by 1",
    "###################################################",
    "Dependencies",
    "###################################################",
    "import sys",
    "rr, cc = circle_perimeter(yc,xc,radius)",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "vname=str(Path(tmpfolder).stem).split('-')[1]",
    "# One can change the parameters of the video creation script below:",
    "See ffmpeg user guide: http://ffmpeg.org/ffmpeg.html#Video-and-Audio-file-format-conversion",
    "",
    "videofolder = str(Path(video).parents[0])",
    "Loading cropping data used during analysis",
    "CreateVideoSlow(clip,Dataframe,tmpfolder,cfg[\"dotsize\"],cfg[\"colormap\"],cfg[\"alphavalue\"],cfg[\"pcutoff\"],cfg[\"cropping\"],cfg[\"x1\"],cfg[\"x2\"],cfg[\"y1\"],cfg[\"y2\"],delete,DLCscorer,bodyparts)",
    "windows throws error if file path is > 260 characters, can fix with prefix. see https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "###################################################",
    "Dependencies",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "fig.colorbar(im, ax=ax)",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "nlines,numcolumns=data.shape",
    "assert(len(orderofbpincsv)==len(cfg['bodyparts']))",
    "TODO: test len of images vs. len of imagenames for another sanity check",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "checks if input is a directory",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "dlc_cfg = read_config(os.path.join(modelfolder,'pose_cfg.yaml'))",
    "dlc_cfg['init_weights'] = os.path.join(modelfolder , 'train', Snapshots[snapshotindex])",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "MainFrame.saveEachImage(self)",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "MainFrame.saveEachImage(self)",
    "def getLabels(self,ind,img_index):",
    "\"\"\"",
    "Returns a list of x and y labels of the corresponding image index",
    "\"\"\"",
    "self.previous_image_points = []",
    "for bpindex, bp in enumerate(self.bodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.previous_image_points.append(image_points)",
    "return(self.previous_image_points)",
    "self.dr.coords = MainFrame.getLabels(self,ind,self.iter)[bpindex]",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "def onZoom(self, ax):",
    "print(self.zoom.GetValue())",
    "if self.zoom.GetValue():",
    "self.updateZoomPan()",
    "self.statusbar.SetStatusText(\"Zoom Off\")",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "if os.environ.get('DLClight', default=False) == 'True':",
    "mpl.use('AGG') #anti-grain geometry engine #https://matplotlib.org/faq/usage_faq.html",
    "pass",
    "else:",
    "mpl.use('TkAgg')",
    "import matplotlib.pyplot as plt",
    "matplotlib.use('Agg')",
    "Load updated lists:",
    "cfg['video_sets'][vn]",
    "labeling_toolbox.show(config,Screens,scale_w,scale_h, winHack, img_scale)",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "set model type. we will allow more in the future.",
    "trainIndexes, testIndexes = SplitTrials(range(len(Data.index)), trainFraction)",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.individual_names+','+self.bodyParts)",
    "Check for variable correctness",
    "plt.close(\"all\")",
    "indexlength = int(np.ceil(np.log10(clip.duration * clip.fps)))",
    "Moviepy:",
    "Display the image",
    "ax.imshow(image)",
    "Call the GUI to select the cropping parameters",
    "Update the config.yaml file with current cropping parameters",
    "store full frame from random location (good for augmentation)",
    "clip=clip.crop(y1 = int(coords[2]),y2 = int(coords[3]),x1 = int(coords[0]), x2 = int(coords[1]))",
    "close video.",
    "def __init__(self, point,bodyParts):",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.bodyParts)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "looping over videos",
    "Attempt to load data...",
    "frame=io.imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "Attempt to load data...",
    "Parameters for augmentation with regard to cropping",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "these will be updated by trainingsetmanipulation.py in the future",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Dependencies for anaysis",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "The next part of the code depends upon which tensorflow version you have.",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "Xstart=int(np.max([0,int(Xlabel)-widthback]))",
    "Xstop=int(np.min([np.shape(im)[1]-1,int(Xlabel)+widthforward]))",
    "Ystart=int(np.max([0,int(Ylabel)-hdown]))",
    "Ystop=int(np.min([np.shape(im)[0]-1,int(Ylabel)+hup]))",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "for windows:"
  ],
  "v2.0.6": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://stackoverflow.com/questions/39590187/in-requirements-txt-what-does-tilde-equals-mean",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "Supress tensorflow warning messages",
    "Direct import for convenience",
    "Direct import for convenience",
    "from deeplabcut import create_project",
    "Direct import for convenience",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video.",
    "video_path = os.path.realpath(video)",
    "get vcap property",
    "Create project and sub-directories",
    "Import all videos in a folder or if just one video withouth [] passed, then make it a list.",
    "there are two cases:",
    "https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "try:",
    "#shutil.copy(src,dst)",
    "except OSError or TypeError: #https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "shutil.copy(os.fspath(src),os.fspath(dst))",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "For windows os.path.realpath does not work and does not link to the real video. [old: rel_video_path = os.path.realpath(video)]",
    "Set values to config file:",
    "Write dictionary to yaml  config file",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "self.startFrame = wx.SpinCtrl(self.widget_panel, value='0', size=(100, -1), min=0, max=120)",
    "",
    "Variables initialization",
    "self.cropping = False",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "Check for it output path and a machine label file exist",
    "If machine label file does not exist then create one",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "SP.ScrolledPanel.__init__(self, parent, -1,style=wx.SUNKEN_BORDER, **kwargs)",
    "self.parent = parent",
    "self.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "widgetsizer.AddStretchSpacer(15)",
    "self.adjustLabelCheck = wx.CheckBox(self.widget_panel,id=wx.ID_ANY,  label = 'Adjust original labels?')",
    "widgetsizer.Add(self.adjustLabelCheck , 1, wx.ALL, 15)",
    "self.adjustLabelCheck.Bind(wx.EVT_CHECKBOX,self.adjustLabel)",
    "##############################################################################################################################",
    "Variable initialization",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.slider.Enable(False)",
    "self.checkBox.Enable(False)",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "print(self.points)",
    "Checks if zoom/pan button is ON",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "extract min and max index based on start stop interval.",
    "figure out body part list:",
    "all indices between start and stop with jump larger than epsilon (leading up to this point!)",
    "deviation_dataname = str(Path(videofolder)/Path(dataname))",
    "Calculate deviatons for video",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "data.to_csv(dataname.split('.h5')[0]+'filtered.csv')",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "Dataframe = pd.read_hdf(os.path.join(videofolder,dataname+'.h5'))",
    "drop duplicate labels:",
    "updates iteration by 1",
    "###################################################",
    "Dependencies",
    "###################################################",
    "import sys",
    "rr, cc = circle_perimeter(yc,xc,radius)",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "vname=str(Path(tmpfolder).stem).split('-')[1]",
    "# One can change the parameters of the video creation script below:",
    "See ffmpeg user guide: http://ffmpeg.org/ffmpeg.html#Video-and-Audio-file-format-conversion",
    "",
    "videofolder = str(Path(video).parents[0])",
    "Loading cropping data used during analysis",
    "CreateVideoSlow(clip,Dataframe,tmpfolder,cfg[\"dotsize\"],cfg[\"colormap\"],cfg[\"alphavalue\"],cfg[\"pcutoff\"],cfg[\"cropping\"],cfg[\"x1\"],cfg[\"x2\"],cfg[\"y1\"],cfg[\"y2\"],delete,DLCscorer,bodyparts)",
    "windows throws error if file path is > 260 characters, can fix with prefix. see https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "###################################################",
    "Dependencies",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "fig.colorbar(im, ax=ax)",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "nlines,numcolumns=data.shape",
    "assert(len(orderofbpincsv)==len(cfg['bodyparts']))",
    "TODO: test len of images vs. len of imagenames for another sanity check",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "checks if input is a directory",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "dlc_cfg = read_config(os.path.join(modelfolder,'pose_cfg.yaml'))",
    "dlc_cfg['init_weights'] = os.path.join(modelfolder , 'train', Snapshots[snapshotindex])",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "Variables initialization",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "MainFrame.saveEachImage(self)",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "MainFrame.saveEachImage(self)",
    "def getLabels(self,ind,img_index):",
    "\"\"\"",
    "Returns a list of x and y labels of the corresponding image index",
    "\"\"\"",
    "self.previous_image_points = []",
    "for bpindex, bp in enumerate(self.bodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.previous_image_points.append(image_points)",
    "return(self.previous_image_points)",
    "self.dr.coords = MainFrame.getLabels(self,ind,self.iter)[bpindex]",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "convert the image to RGB as you are showing the image with matplotlib",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "def onZoom(self, ax):",
    "print(self.zoom.GetValue())",
    "if self.zoom.GetValue():",
    "self.updateZoomPan()",
    "self.statusbar.SetStatusText(\"Zoom Off\")",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "self.axes.callbacks.connect('xlim_changed', self.onZoom)",
    "self.axes.callbacks.connect('ylim_changed', self.onZoom)",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "if os.environ.get('DLClight', default=False) == 'True':",
    "mpl.use('AGG') #anti-grain geometry engine #https://matplotlib.org/faq/usage_faq.html",
    "pass",
    "else:",
    "mpl.use('TkAgg')",
    "import matplotlib.pyplot as plt",
    "matplotlib.use('Agg')",
    "Load updated lists:",
    "cfg['video_sets'][vn]",
    "labeling_toolbox.show(config,Screens,scale_w,scale_h, winHack, img_scale)",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "print(index,name.split(os.sep)[1])",
    "print(name,test_video_name)",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "set model type. we will allow more in the future.",
    "trainIndexes, testIndexes = SplitTrials(range(len(Data.index)), trainFraction)",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.individual_names+','+self.bodyParts)",
    "Check for variable correctness",
    "plt.close(\"all\")",
    "indexlength = int(np.ceil(np.log10(clip.duration * clip.fps)))",
    "Moviepy:",
    "Display the image",
    "ax.imshow(image)",
    "Call the GUI to select the cropping parameters",
    "Update the config.yaml file with current cropping parameters",
    "store full frame from random location (good for augmentation)",
    "clip=clip.crop(y1 = int(coords[2]),y2 = int(coords[3]),x1 = int(coords[0]), x2 = int(coords[1]))",
    "close video.",
    "def __init__(self, point,bodyParts):",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.bodyParts)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "looping over videos",
    "Attempt to load data...",
    "frame=io.imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "Attempt to load data...",
    "Parameters for augmentation with regard to cropping",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "these will be updated by trainingsetmanipulation.py in the future",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Dependencies for anaysis",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "The next part of the code depends upon which tensorflow version you have.",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "Xstart=int(np.max([0,int(Xlabel)-widthback]))",
    "Xstop=int(np.min([np.shape(im)[1]-1,int(Xlabel)+widthforward]))",
    "Ystart=int(np.max([0,int(Ylabel)-hdown]))",
    "Ystop=int(np.min([np.shape(im)[0]-1,int(Ylabel)+hup]))",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "to test destination folder:",
    "dfolder=basepath",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "for windows:"
  ],
  "v2.0.5": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://stackoverflow.com/questions/39590187/in-requirements-txt-what-does-tilde-equals-mean",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "Supress tensorflow warning messages",
    "Direct import for convenience",
    "Direct import for convenience",
    "from deeplabcut import create_project",
    "Direct import for convenience",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "get vcap property",
    "Create project and sub-directories",
    "Import all videos in a folder or if just one video withouth [] passed, then make it a list.",
    "there are two cases:",
    "https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "try:",
    "#shutil.copy(src,dst)",
    "except OSError or TypeError: #https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "shutil.copy(os.fspath(src),os.fspath(dst))",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "Set values to config file:",
    "Write dictionary to yaml  config file",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "im = io.imread(img)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "widgetsizer.Add(self.help , 1, wx.ALL, 15)",
    "",
    "Variables initialization",
    "self.cropping = False",
    "Read confing file",
    "Read the video file",
    "Set the values of slider and range of frames",
    "Set the status bar",
    "Adding the video file to the config file.",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "SP.ScrolledPanel.__init__(self, parent, -1,style=wx.SUNKEN_BORDER, **kwargs)",
    "self.parent = parent",
    "self.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "widgetsizer.AddStretchSpacer(15)",
    "self.adjustLabelCheck = wx.CheckBox(self.widget_panel,id=wx.ID_ANY,  label = 'Adjust original labels?')",
    "widgetsizer.Add(self.adjustLabelCheck , 1, wx.ALL, 15)",
    "self.adjustLabelCheck.Bind(wx.EVT_CHECKBOX,self.adjustLabel)",
    "##############################################################################################################################",
    "Variable initialization",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "dlg = wx.FileDialog(self, \"Choose the machinelabels file for current iteration.\",cwd, \"\",wildcard=fname,style=wx.FD_OPEN | wx.FD_FILE_MUST_EXIST)",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.slider.Enable(False)",
    "self.checkBox.Enable(False)",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "print(self.points)",
    "Checks if zoom/pan button is ON",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "extract min and max index based on start stop interval.",
    "figure out body part list:",
    "all indices between start and stop with jump larger than epsilon (leading up to this point!)",
    "deviation_dataname = str(Path(videofolder)/Path(dataname))",
    "Calculate deviatons for video",
    "Some heuristics for extracting frames based on distance:",
    "Run always except when the outlieralgorithm == manual.",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "meanx,CIx=meanx.values,CIx.values",
    "meany,CIy=meany.values,CIy.values",
    "data.to_csv(dataname.split('.h5')[0]+'filtered.csv')",
    "elif extractionalgorithm=='manual':",
    "wd = Path(config).resolve().parents[0]",
    "os.chdir(str(wd))",
    "from deeplabcut.refine_training_dataset import outlier_frame_extraction_toolbox",
    "outlier_frame_extraction_toolbox.show(config,video,shuffle)",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "###################################################",
    "Dependencies",
    "###################################################",
    "import sys",
    "rr, cc = circle_perimeter(yc,xc,radius)",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "# One can change the parameters of the video creation script below:",
    "See ffmpeg user guide: http://ffmpeg.org/ffmpeg.html#Video-and-Audio-file-format-conversion",
    "",
    "print(metadata)",
    "Loading cropping data used during analysis",
    "CreateVideoSlow(clip,Dataframe,tmpfolder,cfg[\"dotsize\"],cfg[\"colormap\"],cfg[\"alphavalue\"],cfg[\"pcutoff\"],cfg[\"cropping\"],cfg[\"x1\"],cfg[\"x2\"],cfg[\"y1\"],cfg[\"y2\"],delete,DLCscorer,bodyparts)",
    "windows throws error if file path is > 260 characters, can fix with prefix. see https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "###################################################",
    "Dependencies",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "fig.colorbar(im, ax=ax)",
    "vname = video.split('.')[0]",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "nlines,numcolumns=data.shape",
    "assert(len(orderofbpincsv)==len(cfg['bodyparts']))",
    "TODO: test len of images vs. len of imagenames for another sanity check",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "checks if input is a directory",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "dlc_cfg = read_config(os.path.join(modelfolder,'pose_cfg.yaml'))",
    "dlc_cfg['init_weights'] = os.path.join(modelfolder , 'train', Snapshots[snapshotindex])",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counters",
    "MainFrame.saveEachImage(self)",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "MainFrame.saveEachImage(self)",
    "def getLabels(self,ind,img_index):",
    "\"\"\"",
    "Returns a list of x and y labels of the corresponding image index",
    "\"\"\"",
    "self.previous_image_points = []",
    "for bpindex, bp in enumerate(self.bodyparts):",
    "image_points = [[self.dataFrame[self.scorer][ind][bp]['x'].values[self.iter],self.dataFrame[self.scorer][ind][bp]['y'].values[self.iter],ind,bp]]",
    "self.previous_image_points.append(image_points)",
    "return(self.previous_image_points)",
    "self.dr.coords = MainFrame.getLabels(self,ind,self.iter)[bpindex]",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "Reading the existing dataset,if already present",
    "Finds the first empty row in the dataframe and sets the iteration to that index",
    "Reading the image name",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "matplotlib.use('Agg')",
    "Load updated lists:",
    "cfg['video_sets'][vn]",
    "labeling_toolbox.show(config,Screens,scale_w,scale_h, winHack, img_scale)",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "set model type. we will allow more in the future.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "Hiding these widgets and show them once the video is loaded",
    "Variables initialization",
    "Select ROI of interest by drawing a rectangle",
    "Update the config.yaml file",
    "Checks if the video is corrupt.",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.individual_names+','+self.bodyParts)",
    "Check for variable correctness",
    "plt.close(\"all\")",
    "indexlength = int(np.ceil(np.log10(clip.duration * clip.fps)))",
    "Moviepy:",
    "Display the image",
    "store full frame from random location (good for augmentation)",
    "clip=clip.crop(y1 = int(coords[2]),y2 = int(coords[3]),x1 = int(coords[0]), x2 = int(coords[1]))",
    "close video.",
    "def __init__(self, point,bodyParts):",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "text = str(self.bodyParts)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "looping over videos",
    "Attempt to load data...",
    "frame=io.imread(os.path.join(directory,framename),mode='RGB')",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "Attempt to load data...",
    "Parameters for augmentation with regard to cropping",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "these will be updated by trainingsetmanipulation.py in the future",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Dependencies for anaysis",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "The next part of the code depends upon which tensorflow version you have.",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "Xstart=int(np.max([0,int(Xlabel)-widthback]))",
    "Xstop=int(np.min([np.shape(im)[1]-1,int(Xlabel)+widthforward]))",
    "Ystart=int(np.max([0,int(Ylabel)-hdown]))",
    "Ystop=int(np.min([np.shape(im)[0]-1,int(Ylabel)+hup]))",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "for windows:"
  ],
  "v2.0.4.1": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://stackoverflow.com/questions/39590187/in-requirements-txt-what-does-tilde-equals-mean",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "Supress tensorflow warning messages",
    "Direct import for convenience",
    "from deeplabcut import create_project",
    "Direct import for convenience",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "get vcap property",
    "Create project and sub-directories",
    "Import all videos in a folder or if just one video withouth [] passed, then make it a list.",
    "there are two cases:",
    "https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "try:",
    "#shutil.copy(src,dst)",
    "except OSError or TypeError: #https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "shutil.copy(os.fspath(src),os.fspath(dst))",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "Set values to config file:",
    "Write dictionary to yaml  config file",
    "from skimage import io",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "SP.ScrolledPanel.__init__(self, parent, -1,style=wx.SUNKEN_BORDER, **kwargs)",
    "self.parent = parent",
    "self.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "widgetsizer.AddStretchSpacer(15)",
    "self.adjustLabelCheck = wx.CheckBox(self.widget_panel,id=wx.ID_ANY,  label = 'Adjust original labels?')",
    "widgetsizer.Add(self.adjustLabelCheck , 1, wx.ALL, 15)",
    "self.adjustLabelCheck.Bind(wx.EVT_CHECKBOX,self.adjustLabel)",
    "##############################################################################################################################",
    "Variable initialization",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "bodyParts = self.Dataframe.columns.get_level_values(1)",
    "_, idx = np.unique(bodyParts, return_index=True)",
    "self.num_joints = len(self.bodyparts)",
    "self.bodyparts =  bodyParts[np.sort(idx)]",
    "Reading images",
    "Adding Slider and Checkbox",
    "Show image",
    "Setting axis title:dont want to show the threshold as it is not selected yet.",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "Plotting",
    "Checks if zoom/pan button is ON",
    "Checks if zoom/pan button is ON",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "self.slider.Enable(False)",
    "self.checkBox.Enable(False)",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "small hack in case there are any 0 intensity images!",
    "print(self.points)",
    "Checks if zoom/pan button is ON",
    "self.adjust_original_labels = adjust_original_labels",
    "restore the background region",
    "if self.adjust_original_labels == True:",
    "text = str(self.bodyParts)",
    "else:",
    "extract min and max index based on start stop interval.",
    "figure out body part list:",
    "all indices between start and stop with jump larger than epsilon (leading up to this point!)",
    "deviation_dataname = str(Path(videofolder)/Path(dataname))",
    "Calculate deviatons for video",
    "Some heuristics for extracting frames based on distance:",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "meanx,CIx=meanx.values,CIx.values",
    "meany,CIy=meany.values,CIy.values",
    "data.to_csv(dataname.split('.h5')[0]+'filtered.csv')",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "###################################################",
    "Dependencies",
    "###################################################",
    "import sys",
    "rr, cc = circle_perimeter(yc,xc,radius)",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "# One can change the parameters of the video creation script below:",
    "See ffmpeg user guide: http://ffmpeg.org/ffmpeg.html#Video-and-Audio-file-format-conversion",
    "",
    "print(metadata)",
    "Loading cropping data used during analysis",
    "CreateVideoSlow(clip,Dataframe,tmpfolder,cfg[\"dotsize\"],cfg[\"colormap\"],cfg[\"alphavalue\"],cfg[\"pcutoff\"],cfg[\"cropping\"],cfg[\"x1\"],cfg[\"x2\"],cfg[\"y1\"],cfg[\"y2\"],delete,DLCscorer,bodyparts)",
    "windows throws error if file path is > 260 characters, can fix with prefix. see https://docs.microsoft.com/en-us/windows/desktop/fileio/naming-a-file#maximum-path-length-limitation",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "###################################################",
    "Dependencies",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "fig.colorbar(im, ax=ax)",
    "vname = video.split('.')[0]",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "nlines,numcolumns=data.shape",
    "TODO: test len of images vs. len of imagenames for another sanity check",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "checks if input is a directory",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "dlc_cfg = read_config(os.path.join(modelfolder,'pose_cfg.yaml'))",
    "dlc_cfg['init_weights'] = os.path.join(modelfolder , 'train', Snapshots[snapshotindex])",
    "import matplotlib as mpl",
    "mpl.use('WxAgg')",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "def __init__(self, parent, **kwargs):",
    "SP.ScrolledPanel.__init__(self, parent, -1,style=wx.SUNKEN_BORDER, **kwargs)",
    "self.parent = parent",
    "self.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "self.Layout()",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "if self.pan.GetValue() == True:",
    "self.toolbar.pan()",
    "if self.zoom.GetValue() == True:",
    "self.toolbar.zoom()",
    "if self.flag == len(self.bodyparts):",
    "wx.MessageBox('All body parts are annotated! Click \\'Save\\' to save the changes. \\n Click OK to continue.', 'Done!', wx.OK | wx.ICON_INFORMATION)",
    "self.canvas.mpl_disconnect(self.onClick)",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "np.sort(glob.glob(os.path.join(self.dir,'*.png')))",
    "self.labeled_imgs = np.sort(glob.glob(os.path.join(self.dir,'*_labeled.png')))",
    "self.index = np.sort(list(set(self.index) - set(self.labeled_imgs)))",
    "Reading the image name",
    "Reading the existing dataset,if already present",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "self.dr.coords = self.updatedCoords",
    "self.updatedCoords = []",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "print(self.updatedCoords)",
    "self.dataFrame.loc[self.index[self.iter]][self.scorer, bp[0][-2],'x' ] = bp[-1][0]",
    "self.dataFrame.loc[self.index[self.iter]][self.scorer, bp[0][-2],'y' ] = bp[-1][1]",
    "self.dataFrame.loc[self.relativeimagenames[self.iter]][self.scorer, bp[0][-2],'x' ] = bp[-1][0]",
    "self.dataFrame.loc[self.relativeimagenames[self.iter]][self.scorer, bp[0][-2],'y' ] = bp[-1][1]",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "matplotlib.use('Agg')",
    "Load updated lists:",
    "cfg['video_sets'][vn]",
    "labeling_toolbox.show(config,Screens,scale_w,scale_h, winHack, img_scale)",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "set model type. we will allow more in the future.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "matplotlib.use('Agg')",
    "Load updated lists:",
    "cfg['video_sets'][vn]",
    "labeling_toolbox.show(config,Screens,scale_w,scale_h, winHack, img_scale)",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "set model type. we will allow more in the future.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make training file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "matplotlib.use('TkAgg') #already set..",
    "from skimage.util import img_as_ubyte",
    "import math",
    "print(\"Scaled GUI width\", self.gui_width, \"and height\", self.gui_height)",
    "Select ROI of interest by adjusting values in myconfig.py",
    "time = start",
    "set image size:",
    "self.ax1f1.set_title(str(str(self.currFrame)+\"/\"+str(self.numberFrames) +\" \"+ self.filename))",
    "self.canvas.Destroy()",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "Check for variable correctness",
    "plt.close(\"all\")",
    "indexlength = int(np.ceil(np.log10(clip.duration * clip.fps)))",
    "Moviepy:",
    "Display the image",
    "Create a Rectangle patch",
    "Add the patch to the Axes",
    "saveimg = str(Path(config).parents[0] / Path('labeled-data','IsCroppingOK_'+fname.stem +\".png\"))",
    "io.imsave(saveimg, image)",
    "store full frame from random location (good for augmentation)",
    "clip=clip.crop(y1 = int(coords[2]),y2 = int(coords[3]),x1 = int(coords[0]), x2 = int(coords[1]))",
    "close video.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "looping over videos",
    "Attempt to load data...",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "Attempt to load data...",
    "Parameters for augmentation with regard to cropping",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "these will be updated by trainingsetmanipulation.py in the future",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Dependencies for anaysis",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "The next part of the code depends upon which tensorflow version you have.",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "Xstart=int(np.max([0,int(Xlabel)-widthback]))",
    "Xstop=int(np.min([np.shape(im)[1]-1,int(Xlabel)+widthforward]))",
    "Ystart=int(np.max([0,int(Ylabel)-hdown]))",
    "Ystop=int(np.min([np.shape(im)[0]-1,int(Ylabel)+hup]))",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "for windows:"
  ],
  "v2.0.4": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://stackoverflow.com/questions/39590187/in-requirements-txt-what-does-tilde-equals-mean",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "Supress tensorflow warning messages",
    "Direct import for convenience",
    "from deeplabcut import create_project",
    "Direct import for convenience",
    "Read the config file",
    "adds the video list to the config.yaml file",
    "get vcap property",
    "Create project and sub-directories",
    "Import all videos in a folder or if just one video withouth [] passed, then make it a list.",
    "there are two cases:",
    "https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "try:",
    "#shutil.copy(src,dst)",
    "except OSError or TypeError: #https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "shutil.copy(os.fspath(src),os.fspath(dst))",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "Set values to config file:",
    "Write dictionary to yaml  config file",
    "from skimage import io",
    "import matplotlib as mpl",
    "mpl.use('TkAgg')",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "minic small screen:",
    "displaysize = (400, 400)",
    "Note, if the variable Screens = 2, it assumes two screens in landscape next to eachother! If you use a different configuration, consider changing displaysize to your known display size. see troubleshooting for more information https://github.com/AlexEMG/DeepLabCut/wiki/Troubleshooting-Tips.",
    "On Windows, there can be a issue with the sizing on start, so you can scale it down then resize on your screen. Namely, set winHack=.5 and this solves this issue. Thanks to Federico Claudi for troubleshooting this with us!",
    "print(\"Scaled GUI width\", self.gui_width, \"and height\", self.gui_height)",
    "Add SplitterWindow panels top for figure and bottom for buttons",
    "self.top_split = wx.Panel(self.split_win, style=wx.SUNKEN_BORDER)",
    "Add Buttons to the bottom_split window and bind them to plot functions",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "Reading images",
    "Plotting",
    "imagename1 = os.path.join(self.dir,self.index[self.iter])",
    "Checks for the last image and disables the Next button",
    "read the image",
    "imagename1 = os.path.join(self.dir,self.index[self.iter])",
    "Plotting",
    "imagename1 = os.path.join(self.dir,self.index[self.iter])",
    "im=io.imread(imagename1)",
    "Plotting",
    "self.cb.SetValue(False)",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "imagename1 = os.path.join(self.dir,\"file%04d.png\" % self.index[self.iter])",
    "imagename1 = os.path.join(self.dir,self.index[self.iter])",
    "im=io.imread(imagename1)",
    "Plotting",
    "plt.tight_layout(rect=[0, 0.1, 1, 0.95])",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "self.canvas = FigureCanvas(self, -1, self.fig1)",
    "small hack in case there are any 0 intensity images!",
    "cbar.set_ticks(range(12,np.max(im),8))",
    "Calling auxfun_drag class for moving points around",
    "###########################################################################",
    "Class for MatPlotLib Panel",
    "###########################################################################",
    "restore the background region",
    "extract min and max index based on start stop interval.",
    "figure out body part list:",
    "all indices between start and stop with jump larger than epsilon (leading up to this point!)",
    "deviation_dataname = str(Path(videofolder)/Path(dataname))",
    "Calculate deviatons for video",
    "Some heuristics for extracting frames based on distance:",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "meanx,CIx=meanx.values,CIx.values",
    "meany,CIy=meany.values,CIy.values",
    "data.to_csv(dataname.split('.h5')[0]+'filtered.csv')",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "###################################################",
    "Dependencies",
    "###################################################",
    "import sys",
    "rr, cc = circle_perimeter(yc,xc,radius)",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "print(metadata)",
    "Loading cropping data used during analysis",
    "CreateVideoSlow(clip,Dataframe,tmpfolder,cfg[\"dotsize\"],cfg[\"colormap\"],cfg[\"alphavalue\"],cfg[\"pcutoff\"],cfg[\"cropping\"],cfg[\"x1\"],cfg[\"x2\"],cfg[\"y1\"],cfg[\"y2\"],delete,DLCscorer,bodyparts)",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "###################################################",
    "Dependencies",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "fig.colorbar(im, ax=ax)",
    "vname = video.split('.')[0]",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "checks if input is a directory",
    "nlines,numcolumns=data.shape",
    "TODO: test len of images vs. len of imagenames for another sanity check",
    "Is there a scorer for this?",
    "Project definitions (do not edit)",
    "Project path (change when moving around)",
    "Annotation data set configuration (and individual video cropping parameters)",
    "Plotting configuration",
    "Training,Evaluation and Analysis configuration",
    "Cropping Parameters (for analysis and outlier frame detection)",
    "if cropping is true for analysis, then set the values here:",
    "Refinement configuration (parameters from annotation dataset configuration also relevant in this stage)",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "dlc_cfg = read_config(os.path.join(modelfolder,'pose_cfg.yaml'))",
    "dlc_cfg['init_weights'] = os.path.join(modelfolder , 'train', Snapshots[snapshotindex])",
    "import matplotlib as mpl",
    "mpl.use('WxAgg')",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "def __init__(self, parent, **kwargs):",
    "SP.ScrolledPanel.__init__(self, parent, -1,style=wx.SUNKEN_BORDER, **kwargs)",
    "self.parent = parent",
    "self.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "self.Layout()",
    "Settting the GUI size and panels design",
    "##################################################################################################################################################",
    "Spliting the frame into top and bottom panels. Bottom panels contains the widgets. The top panel is for showing images and plotting!",
    "self.choice_panel.SetupScrolling(scroll_x=True, scroll_y=True, scrollToTop=False)",
    "self.choice_panel.SetupScrolling(scroll_x=True, scrollToTop=False)",
    "##################################################################################################################################################",
    "Add Buttons to the WidgetPanel and bind them to their respective functions.",
    "",
    "##############################################################################################################################",
    "Variables initialization",
    "##############################################################################################################################",
    "BUTTONS FUNCTIONS FOR HOTKEYS",
    "if self.pan.GetValue() == True:",
    "self.toolbar.pan()",
    "if self.zoom.GetValue() == True:",
    "self.toolbar.zoom()",
    "if self.flag == len(self.bodyparts):",
    "wx.MessageBox('All body parts are annotated! Click \\'Save\\' to save the changes. \\n Click OK to continue.', 'Done!', wx.OK | wx.ICON_INFORMATION)",
    "self.canvas.mpl_disconnect(self.onClick)",
    "Enabling the zoom, pan and home buttons",
    "Reading config file and its variables",
    "np.sort(glob.glob(os.path.join(self.dir,'*.png')))",
    "self.labeled_imgs = np.sort(glob.glob(os.path.join(self.dir,'*_labeled.png')))",
    "self.index = np.sort(list(set(self.index) - set(self.labeled_imgs)))",
    "Reading the image name",
    "Reading the existing dataset,if already present",
    "Checking for new frames and adding them to the existing dataframe",
    "Create an empty dataframe with all the new images and then merge this to the existing dataframe.",
    "Sort it by the index values",
    "checks for unique bodyparts",
    "Extracting the list of new labels",
    "Checking if user added a new label",
    "Checks for the last image and disables the Next button",
    "Checks if zoom/pan button is ON",
    "Refreshing the button counter",
    "self.dr.coords = self.updatedCoords",
    "self.updatedCoords = []",
    "Checks for the first image and disables the Previous button",
    "Checks if zoom/pan button is ON",
    "print(self.updatedCoords)",
    "self.dataFrame.loc[self.index[self.iter]][self.scorer, bp[0][-2],'x' ] = bp[-1][0]",
    "self.dataFrame.loc[self.index[self.iter]][self.scorer, bp[0][-2],'y' ] = bp[-1][1]",
    "self.dataFrame.loc[self.relativeimagenames[self.iter]][self.scorer, bp[0][-2],'x' ] = bp[-1][0]",
    "self.dataFrame.loc[self.relativeimagenames[self.iter]][self.scorer, bp[0][-2],'y' ] = bp[-1][1]",
    "Windows compatible",
    "Checks if zoom/pan button is ON",
    "matplotlib.use('Agg')",
    "Load updated lists:",
    "cfg['video_sets'][vn]",
    "labeling_toolbox.show(config,Screens,scale_w,scale_h, winHack, img_scale)",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "Let's check if the code is *not* run on windows (Source: #https://stackoverflow.com/questions/1325581/how-do-i-check-if-im-running-on-windows-in-python)",
    "but the paths are in windows format...",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "set model type. we will allow more in the future.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make matlab train file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "matplotlib.use('TkAgg') #already set..",
    "from skimage.util import img_as_ubyte",
    "import math",
    "print(\"Scaled GUI width\", self.gui_width, \"and height\", self.gui_height)",
    "Select ROI of interest by adjusting values in myconfig.py",
    "time = start",
    "set image size:",
    "self.ax1f1.set_title(str(str(self.currFrame)+\"/\"+str(self.numberFrames) +\" \"+ self.filename))",
    "self.canvas.Destroy()",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "restore the background region",
    "Check for variable correctness",
    "plt.close(\"all\")",
    "indexlength = int(np.ceil(np.log10(clip.duration * clip.fps)))",
    "Moviepy:",
    "Display the image",
    "Create a Rectangle patch",
    "Add the patch to the Axes",
    "saveimg = str(Path(config).parents[0] / Path('labeled-data','IsCroppingOK_'+fname.stem +\".png\"))",
    "io.imsave(saveimg, image)",
    "store full frame from random location (good for augmentation)",
    "clip=clip.crop(y1 = int(coords[2]),y2 = int(coords[3]),x1 = int(coords[0]), x2 = int(coords[1]))",
    "close video.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "checks if input is a directory",
    "looping over videos",
    "Attempt to load data...",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "Attempt to load data...",
    "Parameters for augmentation with regard to cropping",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "these will be updated by trainingsetmanipulation.py in the future",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Dependencies for anaysis",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "The next part of the code depends upon which tensorflow version you have.",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "Xstart=int(np.max([0,int(Xlabel)-widthback]))",
    "Xstop=int(np.min([np.shape(im)[1]-1,int(Xlabel)+widthforward]))",
    "Ystart=int(np.max([0,int(Ylabel)-hdown]))",
    "Ystop=int(np.min([np.shape(im)[0]-1,int(Ylabel)+hup]))",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "for windows:"
  ],
  "v2.0.3": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://stackoverflow.com/questions/39590187/in-requirements-txt-what-does-tilde-equals-mean",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "Supress tensorflow warning messages",
    "Direct import for convenience",
    "from deeplabcut import create_project",
    "Direct import for convenience",
    "Read the config file",
    "get vcap property",
    "Create project and sub-directories",
    "Import all videos in a folder or if just one video withouth [] passed, then make it a list.",
    "there are two cases:",
    "https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "try:",
    "#shutil.copy(src,dst)",
    "except OSError or TypeError: #https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "shutil.copy(os.fspath(src),os.fspath(dst))",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "Configuration file templates",
    "Write dictionary to yaml  config file",
    "from skimage import io",
    "import matplotlib as mpl",
    "mpl.use('TkAgg')",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "minic small screen:",
    "displaysize = (400, 400)",
    "Note, if the variable Screens = 2, it assumes two screens in landscape next to eachother! If you use a different configuration, consider changing displaysize to your known display size. see troubleshooting for more information https://github.com/AlexEMG/DeepLabCut/wiki/Troubleshooting-Tips.",
    "On Windows, there can be a issue with the sizing on start, so you can scale it down then resize on your screen. Namely, set winHack=.5 and this solves this issue. Thanks to Federico Claudi for troubleshooting this with us!",
    "print(\"Scaled GUI width\", self.gui_width, \"and height\", self.gui_height)",
    "Add SplitterWindow panels top for figure and bottom for buttons",
    "self.top_split = wx.Panel(self.split_win, style=wx.SUNKEN_BORDER)",
    "Add Buttons to the bottom_split window and bind them to plot functions",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "Reading images",
    "Plotting",
    "imagename1 = os.path.join(self.dir,self.index[self.iter])",
    "Checks for the last image and disables the Next button",
    "read the image",
    "imagename1 = os.path.join(self.dir,self.index[self.iter])",
    "Plotting",
    "imagename1 = os.path.join(self.dir,self.index[self.iter])",
    "im=io.imread(imagename1)",
    "Plotting",
    "self.cb.SetValue(False)",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "imagename1 = os.path.join(self.dir,\"file%04d.png\" % self.index[self.iter])",
    "imagename1 = os.path.join(self.dir,self.index[self.iter])",
    "im=io.imread(imagename1)",
    "Plotting",
    "plt.tight_layout(rect=[0, 0.1, 1, 0.95])",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "self.canvas = FigureCanvas(self, -1, self.fig1)",
    "small hack in case there are any 0 intensity images!",
    "cbar.set_ticks(range(12,np.max(im),8))",
    "Calling auxfun_drag class for moving points around",
    "###########################################################################",
    "Class for MatPlotLib Panel",
    "###########################################################################",
    "restore the background region",
    "extract min and max index based on start stop interval.",
    "figure out body part list:",
    "all indices between start and stop with jump larger than epsilon (leading up to this point!)",
    "deviation_dataname = str(Path(videofolder)/Path(dataname))",
    "Calculate deviatons for video",
    "Some heuristics for extracting frames based on distance:",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "meanx,CIx=meanx.values,CIx.values",
    "meany,CIy=meany.values,CIy.values",
    "data.to_csv(dataname.split('.h5')[0]+'filtered.csv')",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "close videos",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "###################################################",
    "Dependencies",
    "###################################################",
    "import sys",
    "rr, cc = circle_perimeter(yc,xc,radius)",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "print(metadata)",
    "Loading cropping data used during analysis",
    "CreateVideoSlow(clip,Dataframe,tmpfolder,cfg[\"dotsize\"],cfg[\"colormap\"],cfg[\"alphavalue\"],cfg[\"pcutoff\"],cfg[\"cropping\"],cfg[\"x1\"],cfg[\"x2\"],cfg[\"y1\"],cfg[\"y2\"],delete,DLCscorer,bodyparts)",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "fig.colorbar(im, ax=ax)",
    "vname = video.split('.')[0]",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "checks if input is a directory",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "dlc_cfg = read_config(os.path.join(modelfolder,'pose_cfg.yaml'))",
    "dlc_cfg['init_weights'] = os.path.join(modelfolder , 'train', Snapshots[snapshotindex])",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "minic small screen:",
    "displaysize = (400, 400)",
    "Note, if the variable Screens = 2, it assumes two screens in landscape next to eachother! If you use a different configuration, consider changing displaysize to your known display size. see troubleshooting for more information https://github.com/AlexEMG/DeepLabCut/wiki/Troubleshooting-Tips.",
    "On Windows, there can be a issue with the sizing on start, so you can scale it down then resize on your screen. Namely, set winHack=.5 and this solves this issue. Thanks to Federico Claudi for troubleshooting this with us!",
    "print(\"Scaled GUI width\", self.gui_width, \"and height\", self.gui_height)",
    "add buttons for  zoom",
    "radio buttons position: (1250, 65)",
    "for btn in buttons_list:",
    "btn.SetBackgroundColour((160, 160, 160))",
    "Define variables",
    "BUTTONS FUNCTIONS",
    "fallback: warn user",
    "self.relativeimagenames=self.index ##[n.split(self.project_path+'/')[1] for n in self.index]",
    "self.relativeimagenames=[n.split(self.project_path+'/')[1] for n in self.index]",
    "checks for unique bodyparts",
    "frame = pd.DataFrame(a, columns = index, index = self.index)",
    "Checks for the last image and disables the Next button + diesbt load the next if RIGHT arrow key pressed",
    "Refreshing the button counter",
    "read the image",
    "Plotting",
    "Recreate toolbar for zooming",
    "Windows compatible",
    "color = self.colormap(normalize(col))",
    "self.toolbar.set_active([0,1])",
    "This way of adding to sizer allows resizing",
    "Best to allow the toolbar to resize!",
    "sizer.Add(self.toolbar, 0, wx.GROW)",
    "You will need to override GetToolBar if you are using an",
    "unmanaged toolbar in your frame",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "uses openCV",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "image=img_as_ubyte(cv2.resize(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB),None,fx=ratio,fy=ratio))",
    "cap.release() >> still used in frame_extraction!",
    "matplotlib.use('Agg')",
    "Load updated lists:",
    "cfg['video_sets'][vn]",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "set model type. we will allow more in the future.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make matlab train file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "matplotlib.use('TkAgg') #already set..",
    "from skimage.util import img_as_ubyte",
    "import math",
    "print(\"Scaled GUI width\", self.gui_width, \"and height\", self.gui_height)",
    "Select ROI of interest by adjusting values in myconfig.py",
    "time = start",
    "set image size:",
    "self.ax1f1.set_title(str(str(self.currFrame)+\"/\"+str(self.numberFrames) +\" \"+ self.filename))",
    "self.canvas.Destroy()",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "self.Button1.Enable(True)",
    "self.Button2.Enable(False)",
    "self.Button4.Enable(False)",
    "else:",
    "self.Close(True)",
    "self.press = None",
    "DraggablePoint.lock = None",
    "self.point.set_animated(False)",
    "self.background = None",
    "self.final_point = (np.nan,np.nan)",
    "self.coords.append(self.final_point)",
    "self.point.figure.canvas.draw()",
    "self.point.center = (np.nan,np.nan)",
    "restore the background region",
    "Check for variable correctness",
    "plt.close(\"all\")",
    "indexlength = int(np.ceil(np.log10(clip.duration * clip.fps)))",
    "Moviepy:",
    "Display the image",
    "Create a Rectangle patch",
    "Add the patch to the Axes",
    "saveimg = str(Path(config).parents[0] / Path('labeled-data','IsCroppingOK_'+fname.stem +\".png\"))",
    "io.imsave(saveimg, image)",
    "store full frame from random location (good for augmentation)",
    "clip=clip.crop(y1 = int(coords[2]),y2 = int(coords[3]),x1 = int(coords[0]), x2 = int(coords[1]))",
    "close video.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "checks if input is a directory",
    "looping over videos",
    "Attempt to load data...",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "#################################################",
    "Loading the images",
    "#################################################",
    "checks if input is a directory",
    "Attempt to load data...",
    "Parameters for augmentation with regard to cropping",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "these will be updated by trainingsetmanipulation.py in the future",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Dependencies for anaysis",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "The next part of the code depends upon which tensorflow version you have.",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "Xstart=int(np.max([0,int(Xlabel)-widthback]))",
    "Xstop=int(np.min([np.shape(im)[1]-1,int(Xlabel)+widthforward]))",
    "Ystart=int(np.max([0,int(Ylabel)-hdown]))",
    "Ystop=int(np.min([np.shape(im)[0]-1,int(Ylabel)+hup]))",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "this is much easier now: deeplabcut.train_network(path_config_file,gputouse=0,max_snapshots_to_keep=None,saveiters=1)",
    "Make super short video (so the analysis is quick!)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "for windows:"
  ],
  "v2.0.1": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://stackoverflow.com/questions/39590187/in-requirements-txt-what-does-tilde-equals-mean",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "Supress tensorflow warning messages",
    "Direct import for convenience",
    "from deeplabcut import create_project",
    "Direct import for convenience",
    "Read the config file",
    "get vcap property",
    "Create project and sub-directories",
    "Import all videos in a folder or if just one video withouth [] passed, then make it a list.",
    "there are two cases:",
    "https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "try:",
    "#shutil.copy(src,dst)",
    "except OSError or TypeError: #https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "shutil.copy(os.fspath(src),os.fspath(dst))",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "Configuration file templates",
    "Write dictionary to yaml  config file",
    "from skimage import io",
    "import matplotlib as mpl",
    "mpl.use('TkAgg')",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "minic small screen:",
    "displaysize = (400, 400)",
    "Note, if the variable Screens = 2, it assumes two screens in landscape next to eachother! If you use a different configuration, consider changing displaysize to your known display size. see troubleshooting for more information https://github.com/AlexEMG/DeepLabCut/wiki/Troubleshooting-Tips.",
    "On Windows, there can be a issue with the sizing on start, so you can scale it down then resize on your screen. Namely, set winHack=.5 and this solves this issue. Thanks to Federico Claudi for troubleshooting this with us!",
    "print(\"Scaled GUI width\", self.gui_width, \"and height\", self.gui_height)",
    "Add SplitterWindow panels top for figure and bottom for buttons",
    "self.top_split = wx.Panel(self.split_win, style=wx.SUNKEN_BORDER)",
    "Add Buttons to the bottom_split window and bind them to plot functions",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "Reading images",
    "Plotting",
    "imagename1 = os.path.join(self.dir,self.index[self.iter])",
    "Checks for the last image and disables the Next button",
    "read the image",
    "imagename1 = os.path.join(self.dir,self.index[self.iter])",
    "Plotting",
    "imagename1 = os.path.join(self.dir,self.index[self.iter])",
    "im=io.imread(imagename1)",
    "Plotting",
    "self.cb.SetValue(False)",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "imagename1 = os.path.join(self.dir,\"file%04d.png\" % self.index[self.iter])",
    "imagename1 = os.path.join(self.dir,self.index[self.iter])",
    "im=io.imread(imagename1)",
    "Plotting",
    "plt.tight_layout(rect=[0, 0.1, 1, 0.95])",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "self.canvas = FigureCanvas(self, -1, self.fig1)",
    "small hack in case there are any 0 intensity images!",
    "cbar.set_ticks(range(12,np.max(im),8))",
    "Calling auxfun_drag class for moving points around",
    "###########################################################################",
    "Class for MatPlotLib Panel",
    "###########################################################################",
    "restore the background region",
    "extract min and max index based on start stop interval.",
    "figure out body part list:",
    "all indices between start and stop with jump larger than epsilon (leading up to this point!)",
    "deviation_dataname = str(Path(videofolder)/Path(dataname))",
    "Calculate deviatons for video",
    "Some heuristics for extracting frames based on distance:",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "meanx,CIx=meanx.values,CIx.values",
    "meany,CIy=meany.values,CIy.values",
    "data.to_csv(dataname.split('.h5')[0]+'filtered.csv')",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "###################################################",
    "Dependencies",
    "###################################################",
    "import sys",
    "rr, cc = circle_perimeter(yc,xc,radius)",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "print(metadata)",
    "Loading cropping data used during analysis",
    "CreateVideoSlow(clip,Dataframe,tmpfolder,cfg[\"dotsize\"],cfg[\"colormap\"],cfg[\"alphavalue\"],cfg[\"pcutoff\"],cfg[\"cropping\"],cfg[\"x1\"],cfg[\"x2\"],cfg[\"y1\"],cfg[\"y2\"],delete,DLCscorer,bodyparts)",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "fig.colorbar(im, ax=ax)",
    "vname = video.split('.')[0]",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "checks if input is a directory",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "dlc_cfg = read_config(os.path.join(modelfolder,'pose_cfg.yaml'))",
    "dlc_cfg['init_weights'] = os.path.join(modelfolder , 'train', Snapshots[snapshotindex])",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "minic small screen:",
    "displaysize = (400, 400)",
    "Note, if the variable Screens = 2, it assumes two screens in landscape next to eachother! If you use a different configuration, consider changing displaysize to your known display size. see troubleshooting for more information https://github.com/AlexEMG/DeepLabCut/wiki/Troubleshooting-Tips.",
    "On Windows, there can be a issue with the sizing on start, so you can scale it down then resize on your screen. Namely, set winHack=.5 and this solves this issue. Thanks to Federico Claudi for troubleshooting this with us!",
    "print(\"Scaled GUI width\", self.gui_width, \"and height\", self.gui_height)",
    "add buttons for  zoom",
    "radio buttons position: (1250, 65)",
    "for btn in buttons_list:",
    "btn.SetBackgroundColour((160, 160, 160))",
    "Define variables",
    "BUTTONS FUNCTIONS",
    "fallback: warn user",
    "self.relativeimagenames=self.index ##[n.split(self.project_path+'/')[1] for n in self.index]",
    "self.relativeimagenames=[n.split(self.project_path+'/')[1] for n in self.index]",
    "checks for unique bodyparts",
    "frame = pd.DataFrame(a, columns = index, index = self.index)",
    "Checks for the last image and disables the Next button + diesbt load the next if RIGHT arrow key pressed",
    "Refreshing the button counter",
    "read the image",
    "Plotting",
    "Recreate toolbar for zooming",
    "Windows compatible",
    "color = self.colormap(normalize(col))",
    "self.toolbar.set_active([0,1])",
    "This way of adding to sizer allows resizing",
    "Best to allow the toolbar to resize!",
    "sizer.Add(self.toolbar, 0, wx.GROW)",
    "You will need to override GetToolBar if you are using an",
    "unmanaged toolbar in your frame",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "matplotlib.use('Agg')",
    "Load updated lists:",
    "cfg['video_sets'][vn]",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "set model type. we will allow more in the future.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make matlab train file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "matplotlib.use('TkAgg') #already set..",
    "from skimage.util import img_as_ubyte",
    "import math",
    "print(\"Scaled GUI width\", self.gui_width, \"and height\", self.gui_height)",
    "Select ROI of interest by adjusting values in myconfig.py",
    "time = start",
    "set image size:",
    "self.ax1f1.set_title(str(str(self.currFrame)+\"/\"+str(self.numberFrames) +\" \"+ self.filename))",
    "self.canvas.Destroy()",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "self.Button1.Enable(True)",
    "self.Button2.Enable(False)",
    "self.Button4.Enable(False)",
    "else:",
    "self.Close(True)",
    "self.press = None",
    "DraggablePoint.lock = None",
    "self.point.set_animated(False)",
    "self.background = None",
    "self.final_point = (np.nan,np.nan)",
    "self.coords.append(self.final_point)",
    "self.point.figure.canvas.draw()",
    "self.point.center = (np.nan,np.nan)",
    "restore the background region",
    "Check for variable correctness",
    "update to openCV",
    "Display the image",
    "Create a Rectangle patch",
    "Add the patch to the Axes",
    "saveimg = str(Path(config).parents[0] / Path('labeled-data','IsCroppingOK_'+fname.stem +\".png\"))",
    "io.imsave(saveimg, image)",
    "store full frame (good for augmentation)",
    "crop and move on with extraction of frames:",
    "crop and move on with extraction of frames:",
    "close video.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "checks if input is a directory",
    "looping over videos",
    "from moviepy.editor import VideoFileClip",
    "videotype = Path(video).suffix",
    "Attempt to load data...",
    "Parameters for augmentation with regard to cropping",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "these will be updated by trainingsetmanipulation.py in the future",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Dependencies for anaysis",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "The next part of the code depends upon which tensorflow version you have.",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "Xstart=int(np.max([0,int(Xlabel)-widthback]))",
    "Xstop=int(np.min([np.shape(im)[1]-1,int(Xlabel)+widthforward]))",
    "Ystart=int(np.max([0,int(Ylabel)-hdown]))",
    "Ystop=int(np.min([np.shape(im)[0]-1,int(Ylabel)+hup]))",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "this is much easier now: deeplabcut.train_network(path_config_file,gputouse=0,max_snapshots_to_keep=None,saveiters=1)",
    "Make super short video (so the analysis is quick!)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "for windows:"
  ],
  "v2.0.0.dev6": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://stackoverflow.com/questions/39590187/in-requirements-txt-what-does-tilde-equals-mean",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "Supress tensorflow warning messages",
    "Direct import for convenience",
    "from deeplabcut import create_project",
    "Direct import for convenience",
    "Read the config file",
    "get vcap property",
    "Create project and sub-directories",
    "Import all videos in a folder or if just one video withouth [] passed, then make it a list.",
    "there are two cases:",
    "https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "try:",
    "#shutil.copy(src,dst)",
    "except OSError or TypeError: #https://github.com/AlexEMG/DeepLabCut/issues/105 (for windows)",
    "shutil.copy(os.fspath(src),os.fspath(dst))",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "Configuration file templates",
    "Write dictionary to yaml  config file",
    "from skimage import io",
    "import matplotlib as mpl",
    "mpl.use('TkAgg')",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Add SplitterWindow panels top for figure and bottom for buttons",
    "self.top_split = wx.Panel(self.split_win, style=wx.SUNKEN_BORDER)",
    "Add Buttons to the bottom_split window and bind them to plot functions",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "Reading images",
    "Plotting",
    "Checks for the last image and disables the Next button",
    "read the image",
    "imagename1 = os.path.join(self.dir,self.index[self.iter])",
    "Plotting",
    "imagename1 = os.path.join(self.dir,self.index[self.iter])",
    "im=io.imread(imagename1)",
    "Plotting",
    "self.cb.SetValue(False)",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "imagename1 = os.path.join(self.dir,\"file%04d.png\" % self.index[self.iter])",
    "imagename1 = os.path.join(self.dir,self.index[self.iter])",
    "im=io.imread(imagename1)",
    "Plotting",
    "plt.tight_layout(rect=[0, 0.1, 1, 0.95])",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "self.canvas = FigureCanvas(self, -1, self.fig1)",
    "small hack in case there are any 0 intensity images!",
    "cbar.set_ticks(range(12,np.max(im),8))",
    "Calling auxfun_drag class for moving points around",
    "###########################################################################",
    "Class for MatPlotLib Panel",
    "###########################################################################",
    "restore the background region",
    "extract min and max index based on start stop interval.",
    "figure out body part list:",
    "all indices between start and stop with jump larger than epsilon (leading up to this point!)",
    "deviation_dataname = str(Path(videofolder)/Path(dataname))",
    "Calculate deviatons for video",
    "Some heuristics for extracting frames based on distance:",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "meanx,CIx=meanx.values,CIx.values",
    "meany,CIy=meany.values,CIy.values",
    "data.to_csv(dataname.split('.h5')[0]+'filtered.csv')",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "###################################################",
    "Dependencies",
    "###################################################",
    "import sys",
    "rr, cc = circle_perimeter(yc,xc,radius)",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "print(metadata)",
    "Loading cropping data used during analysis",
    "CreateVideoSlow(clip,Dataframe,tmpfolder,cfg[\"dotsize\"],cfg[\"colormap\"],cfg[\"alphavalue\"],cfg[\"pcutoff\"],cfg[\"cropping\"],cfg[\"x1\"],cfg[\"x2\"],cfg[\"y1\"],cfg[\"y2\"],delete,DLCscorer,bodyparts)",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "fig.colorbar(im, ax=ax)",
    "vname = video.split('.')[0]",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "checks if input is a directory",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "dlc_cfg = read_config(os.path.join(modelfolder,'pose_cfg.yaml'))",
    "dlc_cfg['init_weights'] = os.path.join(modelfolder , 'train', Snapshots[snapshotindex])",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "minic small screen:",
    "displaysize = (400, 400)",
    "Note, if the variable Screens = 2, it assumes two screens in landscape next to eachother! If you use a different configuration, consider changing displaysize to your known display size. see troubleshooting for more information https://github.com/AlexEMG/DeepLabCut/wiki/Troubleshooting-Tips.",
    "On Windows, there can be a issue with the sizing on start, so you can scale it down then resize on your screen. Namely, set winHack=.5 and this solves this issue. Thanks to Federico Claudi for troubleshooting this with us!",
    "print(\"Scaled GUI width\", self.gui_width, \"and height\", self.gui_height)",
    "add buttons for  zoom",
    "radio buttons position: (1250, 65)",
    "for btn in buttons_list:",
    "btn.SetBackgroundColour((160, 160, 160))",
    "btn.SetForegroundColour((0, 0, 0))",
    "Define variables",
    "BUTTONS FUNCTIONS",
    "fallback: warn user",
    "checks for unique bodyparts",
    "frame = pd.DataFrame(a, columns = index, index = self.index)",
    "Checks for the last image and disables the Next button + diesbt load the next if RIGHT arrow key pressed",
    "Refreshing the button counter",
    "read the image",
    "Plotting",
    "Recreate toolbar for zooming",
    "Windows compatible",
    "color = self.colormap(normalize(col))",
    "self.toolbar.set_active([0,1])",
    "This way of adding to sizer allows resizing",
    "Best to allow the toolbar to resize!",
    "sizer.Add(self.toolbar, 0, wx.GROW)",
    "You will need to override GetToolBar if you are using an",
    "unmanaged toolbar in your frame",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "matplotlib.use('Agg')",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "set model type. we will allow more in the future.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make matlab train file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "matplotlib.use('TkAgg') #already set..",
    "from skimage.util import img_as_ubyte",
    "import math",
    "print(\"Scaled GUI width\", self.gui_width, \"and height\", self.gui_height)",
    "Select ROI of interest by adjusting values in myconfig.py",
    "time = start",
    "set image size:",
    "self.ax1f1.set_title(str(str(self.currFrame)+\"/\"+str(self.numberFrames) +\" \"+ self.filename))",
    "self.canvas.Destroy()",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "self.Button1.Enable(True)",
    "self.Button2.Enable(False)",
    "self.Button4.Enable(False)",
    "else:",
    "self.Close(True)",
    "self.press = None",
    "DraggablePoint.lock = None",
    "self.point.set_animated(False)",
    "self.background = None",
    "self.final_point = (np.nan,np.nan)",
    "self.coords.append(self.final_point)",
    "self.point.figure.canvas.draw()",
    "self.point.center = (np.nan,np.nan)",
    "restore the background region",
    "Check for variable correctness",
    "update to openCV",
    "Display the image",
    "Create a Rectangle patch",
    "Add the patch to the Axes",
    "saveimg = str(Path(config).parents[0] / Path('labeled-data','IsCroppingOK_'+fname.stem +\".png\"))",
    "io.imsave(saveimg, image)",
    "store full frame (good for augmentation)",
    "crop and move on with extraction of frames:",
    "crop and move on with extraction of frames:",
    "close video.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "checks if input is a directory",
    "looping over videos",
    "from moviepy.editor import VideoFileClip",
    "videotype = Path(video).suffix",
    "Attempt to load data...",
    "Parameters for augmentation with regard to cropping",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "these will be updated by trainingsetmanipulation.py in the future",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Dependencies for anaysis",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "Restore variables from disk.",
    "display_iters = max(1,int(displayiters))",
    "Save snapshot",
    "return to original path.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "The next part of the code depends upon which tensorflow version you have.",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "Xstart=int(np.max([0,int(Xlabel)-widthback]))",
    "Xstop=int(np.min([np.shape(im)[1]-1,int(Xlabel)+widthforward]))",
    "Ystart=int(np.max([0,int(Ylabel)-hdown]))",
    "Ystop=int(np.min([np.shape(im)[0]-1,int(Ylabel)+hup]))",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "this is much easier now: deeplabcut.train_network(path_config_file,gputouse=0,max_snapshots_to_keep=None,saveiters=1)",
    "Make super short video (so the analysis is quick!)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "for windows:"
  ],
  "v2.0.0.dev4": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "https://stackoverflow.com/questions/39590187/in-requirements-txt-what-does-tilde-equals-mean",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "Supress tensorflow warning messages",
    "Direct import for convenience",
    "from deeplabcut import create_project",
    "Direct import for convenience",
    "Read the config file",
    "get vcap property",
    "Create project and sub-directories",
    "Import all videos in a folder or if just one video withouth [] passed, then make it a list.",
    "there are two cases:",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "Configuration file templates",
    "Write dictionary to yaml  config file",
    "from skimage import io",
    "import matplotlib as mpl",
    "mpl.use('TkAgg')",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Add SplitterWindow panels top for figure and bottom for buttons",
    "self.top_split = wx.Panel(self.split_win, style=wx.SUNKEN_BORDER)",
    "Add Buttons to the bottom_split window and bind them to plot functions",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "Reading images",
    "Plotting",
    "Checks for the last image and disables the Next button",
    "read the image",
    "imagename1 = os.path.join(self.dir,self.index[self.iter])",
    "Plotting",
    "imagename1 = os.path.join(self.dir,self.index[self.iter])",
    "im=io.imread(imagename1)",
    "Plotting",
    "self.cb.SetValue(False)",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "imagename1 = os.path.join(self.dir,\"file%04d.png\" % self.index[self.iter])",
    "imagename1 = os.path.join(self.dir,self.index[self.iter])",
    "im=io.imread(imagename1)",
    "Plotting",
    "plt.tight_layout(rect=[0, 0.1, 1, 0.95])",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "self.canvas = FigureCanvas(self, -1, self.fig1)",
    "small hack in case there are any 0 intensity images!",
    "cbar.set_ticks(range(12,np.max(im),8))",
    "Calling auxfun_drag class for moving points around",
    "###########################################################################",
    "Class for MatPlotLib Panel",
    "###########################################################################",
    "restore the background region",
    "extract min and max index based on start stop interval.",
    "figure out body part list:",
    "all indices between start and stop with jump larger than epsilon (leading up to this point!)",
    "deviation_dataname = str(Path(videofolder)/Path(dataname))",
    "Calculate deviatons for video",
    "Some heuristics for extracting frames based on distance:",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "meanx,CIx=meanx.values,CIx.values",
    "meany,CIy=meany.values,CIy.values",
    "data.to_csv(dataname.split('.h5')[0]+'filtered.csv')",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "###################################################",
    "Dependencies",
    "###################################################",
    "import sys",
    "rr, cc = circle_perimeter(yc,xc,radius)",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "print(metadata)",
    "Loading cropping data used during analysis",
    "CreateVideoSlow(clip,Dataframe,tmpfolder,cfg[\"dotsize\"],cfg[\"colormap\"],cfg[\"alphavalue\"],cfg[\"pcutoff\"],cfg[\"cropping\"],cfg[\"x1\"],cfg[\"x2\"],cfg[\"y1\"],cfg[\"y2\"],delete,DLCscorer,bodyparts)",
    "return cv2.cvtColor(np.flip(self.vid.read()[1],2), cv2.COLOR_BGR2RGB)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "fig.colorbar(im, ax=ax)",
    "vname = video.split('.')[0]",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "checks if input is a directory",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "dlc_cfg = read_config(os.path.join(modelfolder,'pose_cfg.yaml'))",
    "dlc_cfg['init_weights'] = os.path.join(modelfolder , 'train', Snapshots[snapshotindex])",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Add SplitterWindow panels top for figure and bottom for buttons",
    "self.top_split = wx.Panel(self.split_win, style=wx.SUNKEN_BORDER)",
    "self.top_split.SetBackgroundColour((100, 100, 100))",
    "self.bottom_split.SetBackgroundColour((80, 80, 80))",
    "Add Buttons to the bottom_split window and bind them to plot functions",
    "add buttons for  zoom",
    "radio buttons position: (1250, 65)",
    "for btn in buttons_list:",
    "btn.SetBackgroundColour((160, 160, 160))",
    "btn.SetForegroundColour((0, 0, 0))",
    "Define variables",
    "BUTTONS FUNCTIONS",
    "fallback: warn user",
    "checks for unique bodyparts",
    "frame = pd.DataFrame(a, columns = index, index = self.index)",
    "Checks for the last image and disables the Next button + diesbt load the next if RIGHT arrow key pressed",
    "Refreshing the button counter",
    "read the image",
    "Plotting",
    "Recreate toolbar for zooming",
    "self.dataFrame.loc[self.index[self.iter]][self.scorer, bp[0][-2],'x' ] = bp[-1][0]",
    "self.dataFrame.loc[self.index[self.iter]][self.scorer, bp[0][-2],'y' ] = bp[-1][1]",
    "Windows compatible",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "matplotlib.use('Agg')",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "set model type. we will allow more in the future.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make matlab train file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "matplotlib.use('TkAgg') #already set..",
    "from skimage.util import img_as_ubyte",
    "import math",
    "",
    "Select ROI of interest by adjusting values in myconfig.py",
    "time = start",
    "self.ax1f1.set_title(str(str(self.currFrame)+\"/\"+str(self.numberFrames) +\" \"+ self.filename))",
    "self.canvas.Destroy()",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "self.Button1.Enable(True)",
    "self.Button2.Enable(False)",
    "self.Button4.Enable(False)",
    "else:",
    "self.Close(True)",
    "self.press = None",
    "DraggablePoint.lock = None",
    "self.point.set_animated(False)",
    "self.background = None",
    "self.final_point = (np.nan,np.nan)",
    "self.coords.append(self.final_point)",
    "self.point.figure.canvas.draw()",
    "self.point.center = (np.nan,np.nan)",
    "restore the background region",
    "Check for variable correctness",
    "update to openCV",
    "Display the image",
    "Create a Rectangle patch",
    "Add the patch to the Axes",
    "saveimg = str(Path(config).parents[0] / Path('labeled-data','IsCroppingOK_'+fname.stem +\".png\"))",
    "io.imsave(saveimg, image)",
    "store full frame (good for augmentation)",
    "crop and move on with extraction of frames:",
    "crop and move on with extraction of frames:",
    "close video.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "checks if input is a directory",
    "looping over videos",
    "from moviepy.editor import VideoFileClip",
    "videotype = Path(video).suffix",
    "Attempt to load data...",
    "Parameters for augmentation with regard to cropping",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "these will be updated by trainingsetmanipulation.py in the future",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Dependencies for anaysis",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "change batch size, if it was edited during analysis!",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "Restore variables from disk.",
    "Save snapshot",
    "return to original path.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "The next part of the code depends upon which tensorflow version you have.",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "Xstart=int(np.max([0,int(Xlabel)-widthback]))",
    "Xstop=int(np.min([np.shape(im)[1]-1,int(Xlabel)+widthforward]))",
    "Ystart=int(np.max([0,int(Ylabel)-hdown]))",
    "Ystop=int(np.min([np.shape(im)[0]-1,int(Ylabel)+hup]))",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "this is much easier now: deeplabcut.train_network(path_config_file,gputouse=0,max_snapshots_to_keep=None,saveiters=1)",
    "Make super short video (so the analysis is quick!)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "for windows:"
  ],
  "v2.0.0.dev1": [
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "@click.version_option()",
    "##########################################################################################################################",
    "type=click.Path(exists=True, file_okay=False, resolve_path=True), default=Path.cwd(),",
    "help='Directory to create project in. Default is cwd().')",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "for video in videos:",
    "predict.predict_video(config, video,**kwargs)",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "##########################################################################################################################",
    "Supress tensorflow warning messages",
    "Direct import for convenience",
    "from deeplabcut import create_project",
    "Direct import for convenience",
    "Read the config file",
    "get vcap property",
    "Create project and sub-directories",
    "creates the symlinks of the video and puts it in the videos directory.",
    "adds the video list to the config.yaml file",
    "Configuration file templates",
    "Write dictionary to yaml  config file",
    "from skimage import io",
    "import matplotlib as mpl",
    "mpl.use('TkAgg')",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Add SplitterWindow panels top for figure and bottom for buttons",
    "self.top_split = wx.Panel(self.split_win, style=wx.SUNKEN_BORDER)",
    "Add Buttons to the bottom_split window and bind them to plot functions",
    "###########################################################################",
    "functions for button responses",
    "###########################################################################",
    "Reading images",
    "Plotting",
    "Checks for the last image and disables the Next button",
    "read the image",
    "imagename1 = os.path.join(self.dir,self.index[self.iter])",
    "Plotting",
    "imagename1 = os.path.join(self.dir,self.index[self.iter])",
    "im=io.imread(imagename1)",
    "Plotting",
    "self.cb.SetValue(False)",
    "Checks for the first image and disables the Previous button",
    "Reading Image",
    "imagename1 = os.path.join(self.dir,\"file%04d.png\" % self.index[self.iter])",
    "imagename1 = os.path.join(self.dir,self.index[self.iter])",
    "im=io.imread(imagename1)",
    "Plotting",
    "plt.tight_layout(rect=[0, 0.1, 1, 0.95])",
    "combine datasets Original Col. + corrected machinefiles:",
    "Now drop redundant ones keeping the first one [this will make sure that the refined machine file gets preference]",
    "###########################################################################",
    "Other functions",
    "###########################################################################",
    "self.canvas = FigureCanvas(self, -1, self.fig1)",
    "small hack in case there are any 0 intensity images!",
    "cbar.set_ticks(range(12,np.max(im),8))",
    "Calling auxfun_drag class for moving points around",
    "###########################################################################",
    "Class for MatPlotLib Panel",
    "###########################################################################",
    "restore the background region",
    "extract min and max index based on start stop interval.",
    "figure out body part list:",
    "all indices between start and stop with jump larger than epsilon (leading up to this point!)",
    "deviation_dataname = str(Path(videofolder)/Path(dataname))",
    "Calculate deviatons for video",
    "Some heuristics for extracting frames based on distance:",
    "Now extract from those Indices!",
    "Seasonal Autoregressive Integrated Moving-Average with eXogenous regressors (SARIMAX)",
    "see http://www.statsmodels.org/stable/statespace.html#seasonal-autoregressive-integrated-moving-average-with-exogenous-regressors-sarimax",
    "SARIMAX implemetnation has better prediction models than simple ARIMAX (however we do not use the seasonal etc. parameters!)",
    "Autoregressive Moving Average ARMA(p,q) Model",
    "mod = sm.tsa.ARIMA(Y, order=(ARdegree,0,MAdegree)) #order=(ARdegree,0,MAdegree)",
    "meanx,CIx=meanx.values,CIx.values",
    "meany,CIy=meany.values,CIy.values",
    "data.to_csv(dataname.split('.h5')[0]+'filtered.csv')",
    "Extract frames + frames with plotted labels and store them in folder (with name derived from video name) nder labeled-data",
    "Extract annotations based on DeepLabCut and store in the folder (with name derived from video name) under labeled-data",
    "drop duplicate labels:",
    "updates iteration by 1",
    "###################################################",
    "Dependencies",
    "###################################################",
    "import sys",
    "rr, cc = circle_perimeter(yc,xc,radius)",
    "scorer=np.unique(Dataframe.columns.get_level_values(0))[0]",
    "bodyparts2plot = list(np.unique(Dataframe.columns.get_level_values(1)))",
    "print(metadata)",
    "Loading cropping data used during analysis",
    "CreateVideoSlow(clip,Dataframe,tmpfolder,cfg[\"dotsize\"],cfg[\"colormap\"],cfg[\"alphavalue\"],cfg[\"pcutoff\"],cfg[\"cropping\"],cfg[\"x1\"],cfg[\"x2\"],cfg[\"y1\"],cfg[\"y2\"],delete,DLCscorer,bodyparts)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "fig.colorbar(im, ax=ax)",
    "vname = video.split('.')[0]",
    "#################################################",
    "Looping analysis over video",
    "#################################################",
    "checks if input is a directory",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "Pickle the 'labeled-data' dictionary using the highest protocol available.",
    "# Various functions to get filenames, foldernames etc. based on configuration parameters.",
    "Filename for metadata and data relative to project path for corresponding parameters",
    "dlc_cfg = read_config(os.path.join(modelfolder,'pose_cfg.yaml'))",
    "dlc_cfg['init_weights'] = os.path.join(modelfolder , 'train', Snapshots[snapshotindex])",
    "###########################################################################",
    "Class for GUI MainFrame",
    "###########################################################################",
    "Add SplitterWindow panels top for figure and bottom for buttons",
    "self.top_split = wx.Panel(self.split_win, style=wx.SUNKEN_BORDER)",
    "Add Buttons to the bottom_split window and bind them to plot functions",
    "",
    "checks for unique bodyparts",
    "frame = pd.DataFrame(a, columns = index, index = self.index)",
    "Refreshing the button counter",
    "Checks for the last image and disables the Next button",
    "read the image",
    "Plotting",
    "self.dataFrame.loc[self.index[self.iter]][self.scorer, bp[0][-2],'x' ] = bp[-1][0]",
    "self.dataFrame.loc[self.index[self.iter]][self.scorer, bp[0][-2],'y' ] = bp[-1][1]",
    "Windows compatible",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "matplotlib.use('Agg')",
    "plotting parameters:",
    "folders = [Path(config).parent / 'labeled-data' /Path(i) for i in video_names]",
    "Loading metadata from config file:",
    "Create path for training sets & store data there",
    "set model type. we will allow more in the future.",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make matlab train file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "###############################################################################",
    "Saving metadata (Pickle file)",
    "###############################################################################",
    "###############################################################################",
    "Saving data file (convert to training file for deeper cut (*.mat))",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "str(cfg['proj_path']+'/'+Path(modelfoldername) / 'test'  /  'pose_cfg.yaml')",
    "matplotlib.use('TkAgg') #already set..",
    "from skimage.util import img_as_ubyte",
    "import math",
    "",
    "Select ROI of interest by adjusting values in myconfig.py",
    "time = start",
    "self.ax1f1.set_title(str(str(self.currFrame)+\"/\"+str(self.numberFrames) +\" \"+ self.filename))",
    "self.canvas.Destroy()",
    "self.likelihood = likelihood",
    "self.coords = [0,0]",
    "self.Button1.Enable(True)",
    "self.Button2.Enable(False)",
    "self.Button4.Enable(False)",
    "else:",
    "self.Close(True)",
    "self.press = None",
    "DraggablePoint.lock = None",
    "self.point.set_animated(False)",
    "self.background = None",
    "self.final_point = (np.nan,np.nan)",
    "self.coords.append(self.final_point)",
    "self.point.figure.canvas.draw()",
    "self.point.center = (np.nan,np.nan)",
    "restore the background region",
    "Check for variable correctness",
    "update to openCV",
    "Display the image",
    "Create a Rectangle patch",
    "Add the patch to the Axes",
    "saveimg = str(Path(config).parents[0] / Path('labeled-data','IsCroppingOK_'+fname.stem +\".png\"))",
    "io.imsave(saveimg, image)",
    "store full frame (good for augmentation)",
    "crop and move on with extraction of frames:",
    "close video.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "import imageio",
    "imageio.plugins.ffmpeg.download()",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check if data already was generated:",
    "update batchsize (based on parameters in config.yaml)",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "checks if input is a directory",
    "looping over videos",
    "from moviepy.editor import VideoFileClip",
    "videotype = Path(video).suffix",
    "Attempt to load data...",
    "Parameters for augmentation with regard to cropping",
    "limit width  [-leftwidth*u-100,100+u*rightwidth] x [-bottomwith*u-100,100+u*topwidth] where u is always a (different) random number in unit interval",
    "these will be updated by trainingsetmanipulation.py in the future",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Update the snapshot path to the corresponding path!",
    "the default is: \"./snapshot\"",
    "Dependencies for anaysis",
    "tf.logging.set_verbosity(tf.logging.WARN)",
    "Read file path for pose_config file. >> pass it on",
    "Loading human annotatated data",
    "Get list of body parts to evaluate network for",
    "Make folder for evaluation",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Load meta data",
    "Create folder structure to store results.",
    "path_train_config = modelfolder / 'train' / 'pose_cfg.yaml'",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "name for deeplabcut net (based on its parameters)",
    "Specifying state of model (snapshot / training state)",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results",
    "print(final_result)",
    "returning to intial folder",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "Restore variables from disk.",
    "Save snapshot",
    "return to original path.",
    "Read file path for pose_config file. >> pass it on",
    "Set environment variables",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "The next part of the code depends upon which tensorflow version you have.",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "Xstart=int(np.max([0,int(Xlabel)-widthback]))",
    "Xstop=int(np.min([np.shape(im)[1]-1,int(Xlabel)+widthforward]))",
    "Ystart=int(np.max([0,int(Ylabel)-hdown]))",
    "Ystop=int(np.min([np.shape(im)[0]-1,int(Ylabel)+hup]))",
    "Load Matlab file dataset annotation",
    "print('Dataset has {} images'.format(num_images))",
    "print(sample)",
    "make sure joint ids are 0-indexed",
    "if cfg.crop:",
    "crop = sample[3][0] - 1",
    "item.crop = extend_crop(crop, cfg.crop_pad, item.im_size)",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "print(im_file, os.getcwd())",
    "print(self.cfg.project_path)",
    "1. get center of joints",
    "draw random crop dimensions & subtract joint points",
    "print(joints,j,'ahah')",
    "if self.has_gt:",
    "joints[0,:, 1] -= x0",
    "joints[0,:, 2] -= y0",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "Importing the toolbox (takes several seconds)",
    "Loading example data set",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "this is much easier now: deeplabcut.train_network(path_config_file,gputouse=0,max_snapshots_to_keep=None,saveiters=1)",
    "Make super short video (so the analysis is quick!)",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "As this next step is manual, we update the labels by putting them on the diagonal (fixed for all frames)",
    "Make super short video (so the analysis is quick!)",
    "for windows:"
  ],
  "1.11": [
    "coding: utf-8",
    "########################################################################################",
    "This configuration file sets various parameters for running a trained model on videos!",
    "",
    "First, make sure that the network performed well on the train/test data set.",
    "",
    "The pose output is saved as hdf file with a name containing the video name as well as the network name",
    "You can also save the output as csv (see below) or in many other formats see https://github.com/AlexEMG/DeepLabCut/issues/17",
    "",
    "########################################################################################",
    "Filename and path to behavioral video for analysis",
    "Note: under the hood there is moviepy, which can handle many types of videos:",
    "See: https://zulko.github.io/moviepy/_modules/moviepy/video/io/VideoFileClip.html",
    "If you have stacks of tiffs (instead of videos) you can use \"AnalyzeABunchofPictures.py\"",
    "ROI dimensions / bounding box (only used if cropping == True)",
    "x1,y1 indicates the top left corner and",
    "x2,y2 is the lower right corner of the cropped region.",
    "########################################################################################",
    "Analysis Network parameters",
    "########################################################################################",
    "These variables should be changed so that the right networks is loaded for analysis",
    "(Typicaly just copy them over from myconfig.py)",
    "inferencemethod = >> set inside individual script!",
    "batch based processing",
    "the ideal value strongly depends on frame sizes, see for considerations: https://www.biorxiv.org/content/early/2018/10/30/457242.article-info",
    "Note the data is always saved in hdf - format which is an efficient format",
    "that easily allows to load the full pandas multiarray at a later stage",
    "########################################################################################",
    "# For plotting (MakingLabeledVideo.py / MakingLabeledVideo_fast.py)",
    "########################################################################################",
    "based on the labels for this network state.",
    "delete individual (labeled) frames after making video? (note there could be many...)",
    "coding: utf-8",
    "####################################################################################",
    "This configuration file sets various parameters for training and evaluating DeepLabCut",
    "####################################################################################",
    "myconfig.py:",
    "#######################################",
    "Step 1: Selecting Frames from videos",
    "#######################################",
    "Filename and path to behavioral video:",
    "Put name of video: / or 'all' to extract frames from all videos in folder.",
    "filename = 'all'",
    "ROI dimensions / bounding box (only used if cropping == True)",
    "x1,y1 indicates the top left corner and",
    "x2,y2 is the lower right corner of the cropped region.",
    "Portion of the video to sample from in step 1 (In relative terms of video length, i.e. [0,1] is the full video)",
    "Number of frames to pick",
    "Method to pick frames: uniform or kmeans",
    "the algorithm 'uniform' temporally uniformly sampes frames in interval (start,stop). Visual information within video is irrelevant for this method. This code is very fast and sufficient (to extract distinct frames) when behavioral videos naturally covers many states.",
    "Alternatively consider using: 'kmeans'",
    "This code downsamples the video. The video is extracted as a numpy array, which is then",
    "clustered by kmeans whereby each frames are treated as a vector. Frames from different clusters are then selected for labeling. This",
    "procedure makes sure that the frames \"look different\", i.e. different postures etc.",
    "On large videos this code is slow. Consider not extracting the frames from the whole video but rather set start and stop to a period around interesting behavior that you want DeepLabCut to resolve/analyze (i.e. a reach).",
    "#######################################",
    "Step 2: Converting frames to pandas array",
    "#######################################",
    "annotator in *.csv file (for multibodypartsfile). For single files order is irrelevant",
    "Set this true if the data was sequentially labeled and if there is one file per folder (you can set the name of this file below, i.e. multibodypartsfilename)",
    "Otherwise there should be individual files per bodypart, i.e. in our demo case hand.csv, Finger1.csv etc.",
    "If true then those files will be generated from Results.txt",
    "When importing the images and the labels in the csv/xls files should be in the same order!",
    "During labeling in Fiji one can thus (for occluded body parts) click in the origin of the image",
    "(i.e. top left corner (close to 0,0)), these \"false\" labels will then be removed. To do so set the following variable:",
    "set this to 0 if no labels should be removed!",
    "If you started from already extracted frames in a different format then change the format here (for step2 to 4).",
    "#######################################",
    "Step 3: Check labels / makes plots",
    "#######################################",
    "#######################################",
    "Step 4: Generate Training Files",
    "#######################################",
    "Userparameters for training set. Other parameters can be set in pose_cfg.yaml",
    "Which resnet to use, 101 for deeper!",
    "then change net_type and init_weights in Generating_a_Training_Set/pose_cfg.yaml",
    "Afterwards train your network!",
    "#######################################################################################################################",
    "For Evaluation your network",
    "#######################################################################################################################",
    "identifier of evaluation network:",
    "To evaluate the last snapshot (i.e. the network that was trained longest) : -1",
    "To evaluate all models (training stages) set this to: \"all\"  (as string!)",
    "This cutoff will also be used in plots.",
    "Note that this will be plotted for all snapshots as indicated by snapshotindex",
    "Select ROI of interest by adjusting values in myconfig.py",
    "###################################################",
    "Creating folder with name of experiment and extract random frames",
    "###################################################",
    "Extract the first frame (not cropped!) - useful for data augmentation",
    "Select ROI of interest by adjusting values in myconfig.py",
    "####################################################################",
    "First load the image and crop (if necessary)/ set checkcropping = True (in myconfig to do so)",
    "####################################################################",
    "###################################################",
    "Creating folder with name of experiment and extract random frames",
    "###################################################",
    "###################################################",
    "Loading dependencies",
    "###################################################",
    "##################################################",
    "Code if each bodypart has its own label file!",
    "##################################################",
    "############################################",
    "Make sure you update the train.yaml file!",
    "############################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "Data frame to hold data of all data sets for different scorers, bodyparts and images",
    "Make list of different video data sets:",
    "videos=np.sort([fn for fn in os.listdir(os.curdir) if (\"avi\" in fn)])",
    "sort image file names according to how they were stacked (when labeled in Fiji)",
    "This is important when using data combined / which runs consecutively!",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "##################################################",
    "Code if all bodyparts (per folder are shared in one file)",
    "This code below converts it into multiple csv files per body part & folder",
    "Based on an idea by @sneakers-the-rat",
    "##################################################",
    "load csv, iterate over nth value in a grouping by frame, save to bodyparts files",
    "##################################################",
    "Code if each bodypart has its own label file!",
    "##################################################",
    "Data frame to hold data of all data sets for different scorers,",
    "bodyparts and images",
    "Make list of different video data sets / each one has its own folder",
    "print(\"found\",len(folders),len(numdistinctfolders))",
    "print(\"Loading folder \", folder)",
    "sort image file names according to how they were stacked",
    "files=np.sort([fn for fn in os.listdir(os.curdir)",
    "if (\"img\" in fn and \".png\" in fn and \"_labelled\" not in fn)])",
    "Note: If your csv file is not correctly loaded, then a common error is:",
    "\"AttributeError: 'DataFrame' object has no attribute 'X'\" or the corresponding error with Slice",
    "Try to make sure you specify the seperator of the csv file correctly. See https://github.com/AlexEMG/DeepLabCut/issues/10 for details.",
    "get rid of values that are invisible >> thus user scored in left corner!",
    "frame=pd.DataFrame(np.vstack([dframe.X,dframe.Y]).T, columns=index,index=imageaddress)",
    "print(frame.head())",
    "print(\"Done with folder \", folder)",
    "Save data by this scorer",
    "###################################################",
    "Loading dependencies",
    "###################################################",
    "###################################################",
    "Definitions (Folders, data source and labels)",
    "###################################################",
    "Loading scorer's data:",
    "Make that folder and put in the collecteddata (see below)",
    "This relative path is required due way DeeperCut is structured",
    "copy images and folder structure in the folder containing",
    "training data comparison",
    "Filename for pickle file:",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make matlab train file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Convert to idosyncratic training file for deeper cut (*.mat)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "https://stackoverflow.com/questions/800197/how-to-get-all-of-the-immediate-subdirectories-in-python",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "sys.path.append(subfolder + \"/pose-tensorflow/\")",
    "###################################################",
    "Auxiliary functions",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "###################################################",
    "Loading dependencies",
    "###################################################",
    "loading meta data / i.e. training & test files",
    "###################################################",
    "Models vs. benchmark for varying training state",
    "###################################################",
    "only specific parts can also be compared (not all!) (in that case change which bodyparts by providing a list below)",
    "extract training iterations:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Deep-cut dependencies",
    "Dependencies for anaysis",
    "loading meta data / i.e. training & test files & labels",
    "######################################################################",
    "Load and setup CNN part detector as well as its configuration",
    "######################################################################",
    "Specifying state of model (snapshot / training state)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Deep-cut dependencies",
    "###################################################",
    "Loading data and evaluating network on data",
    "###################################################",
    "###############################################################################",
    "Check which snapshots exist for given network (with training data split).",
    "###############################################################################",
    "Check which snap shots are available and sort them by # iterations",
    "if not analyzed, then call auxiliary script to analyze the network:",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "Restore variables from disk.",
    "Save snapshot",
    "Adapted from original predict.py by Eldar Insafutdinov's implementation of [DeeperCut](https://github.com/eldar/pose-tensorflow)",
    "To do faster inference on videos. See https://www.biorxiv.org/content/early/2018/10/30/457242",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "The next part of the code depends upon which tensorflow version you have.",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Load Matlab file dataset annotation",
    "make sure joint ids are 0-indexed",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Dependencies for video:",
    "###################################################",
    "Loading descriptors of model",
    "###################################################",
    "loading meta data / i.e. training & test files",
    "basefolder = os.path.join('..','pose-tensorflow','models')",
    "datafolder = os.path.join(basefolder , \"UnaugmentedDataSet_\" + Task + date)",
    "Data = pd.read_hdf(os.path.join(datafolder , 'data-' + Task , 'CollectedData_' + humanscorer + '.h5'),'df_with_missing')",
    "Name for scorer based on passed on parameters from myconfig_analysis. Make sure they refer to the network of interest.",
    "###################################################",
    "Auxiliary function",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "one might want to adjust",
    "clip.reader.skip_frames(1)",
    "image = img_as_ubyte(clip.get_frame(index * 1. / clip.fps))",
    "image = img_as_ubyte(clip.reader.read_frame())",
    "#################################################",
    "Datafolder",
    "#################################################",
    "videofolder='../videos/' #where your folder with videos is.",
    "return to start path.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Deep-cut dependencies",
    "Dependencies for video:",
    "import matplotlib.pyplot as plt",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Check if data already was generated:",
    "Name for scorer:",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "Auxiliary functions:",
    "Intitalize net & change batch size",
    "Change to video folder.",
    "videofolder='../videos/' #where your folder with videos is.",
    "Attempt to load data.",
    "clip = clip.crop(y1=y1, y2=y2, x1=x1, x2=x2)  # one might want to adjust",
    "Delete clip + reader object https://github.com/Zulko/moviepy/issues/57",
    "https://github.com/Zulko/moviepy/issues/518 (can slow down on Windows ...)",
    "reader.close()",
    "del clip.reader",
    "return to start path.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Deep-cut dependencies",
    "Dependencies for video:",
    "import matplotlib.pyplot as plt",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check which snap shots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Check if data already was generated:",
    "Name for scorer:",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "Folder where your tiffstacks are:",
    "Attempt to load data...",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Deep-cut dependencies",
    "Dependencies for video:",
    "import matplotlib.pyplot as plt",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Check if data already was generated:",
    "Name for scorer:",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "videofolder='../videos/' #where your folder with videos is.",
    "Attempt to load data...",
    "nframes = np.sum(1 for j in clip.iter_frames()) #this is slow (but accurate)",
    "this will overestimage number of frames (see https://github.com/AlexEMG/DeepLabCut/issues/9) This is especially a problem",
    "for high frame rates and long durations due to rounding errors (as Rich Warren found). Later we crop the result (line 187)",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Dependencies for video:",
    "###################################################",
    "Loading descriptors of model",
    "###################################################",
    "loading meta data / i.e. training & test files",
    "basefolder = os.path.join('..','pose-tensorflow','models')",
    "datafolder = os.path.join(basefolder , \"UnaugmentedDataSet_\" + Task + date)",
    "Data = pd.read_hdf(os.path.join(datafolder , 'data-' + Task , 'CollectedData_' + humanscorer + '.h5'),'df_with_missing')",
    "Name for scorer based on passed on parameters from myconfig_analysis. Make sure they refer to the network of interest.",
    "###################################################",
    "Auxiliary function",
    "###################################################",
    "rr, cc = circle_perimeter(yc,xc,radius)",
    "#################################################",
    "Datafolder",
    "#################################################",
    "return to start path."
  ],
  "v1.1": [
    "coding: utf-8",
    "########################################################################################",
    "This configuration file sets various parameters for running a trained model on videos!",
    "",
    "First, make sure that the network performed well on the train/test data set.",
    "",
    "The pose output is saved as hdf file with a name containing the video name as well as the network name",
    "You can also save the output as csv (see below) or in many other formats see https://github.com/AlexEMG/DeepLabCut/issues/17",
    "",
    "########################################################################################",
    "Filename and path to behavioral video for analysis",
    "Note: under the hood there is moviepy, which can handle many types of videos:",
    "See: https://zulko.github.io/moviepy/_modules/moviepy/video/io/VideoFileClip.html",
    "If you have stacks of tiffs (instead of videos) you can use \"AnalyzeABunchofPictures.py\"",
    "ROI dimensions / bounding box (only used if cropping == True)",
    "x1,y1 indicates the top left corner and",
    "x2,y2 is the lower right corner of the cropped region.",
    "########################################################################################",
    "Analysis Network parameters",
    "########################################################################################",
    "These variables should be changed so that the right networks is loaded for analysis",
    "(Typicaly just copy them over from myconfig.py)",
    "inferencemethod = >> set inside individual script!",
    "batch based processing",
    "Note the data is always saved in hdf - format which is an efficient format",
    "that easily allows to load the full pandas multiarray at a later stage",
    "########################################################################################",
    "# For plotting (MakingLabeledVideo.py / MakingLabeledVideo_fast.py)",
    "########################################################################################",
    "based on the labels for this network state.",
    "delete individual (labeled) frames after making video? (note there could be many...)",
    "coding: utf-8",
    "####################################################################################",
    "This configuration file sets various parameters for training and evaluating DeepLabCut",
    "####################################################################################",
    "myconfig.py:",
    "#######################################",
    "Step 1: Selecting Frames from videos",
    "#######################################",
    "Filename and path to behavioral video:",
    "Put name of video: / or 'all' to extract frames from all videos in folder.",
    "filename = 'all'",
    "ROI dimensions / bounding box (only used if cropping == True)",
    "x1,y1 indicates the top left corner and",
    "x2,y2 is the lower right corner of the cropped region.",
    "Portion of the video to sample from in step 1 (In relative terms of video length, i.e. [0,1] is the full video)",
    "Number of frames to pick",
    "Method to pick frames: uniform or kmeans",
    "the algorithm 'uniform' temporally uniformly sampes frames in interval (start,stop). Visual information within video is irrelevant for this method. This code is very fast and sufficient (to extract distinct frames) when behavioral videos naturally covers many states.",
    "Alternatively consider using: 'kmeans'",
    "This code downsamples the video. The video is extracted as a numpy array, which is then",
    "clustered by kmeans whereby each frames are treated as a vector. Frames from different clusters are then selected for labeling. This",
    "procedure makes sure that the frames \"look different\", i.e. different postures etc.",
    "On large videos this code is slow. Consider not extracting the frames from the whole video but rather set start and stop to a period around interesting behavior that you want DeepLabCut to resolve/analyze (i.e. a reach).",
    "#######################################",
    "Step 2: Converting frames to pandas array",
    "#######################################",
    "annotator in *.csv file (for multibodypartsfile). For single files order is irrelevant",
    "Set this true if the data was sequentially labeled and if there is one file per folder (you can set the name of this file below, i.e. multibodypartsfilename)",
    "Otherwise there should be individual files per bodypart, i.e. in our demo case hand.csv, Finger1.csv etc.",
    "If true then those files will be generated from Results.txt",
    "When importing the images and the labels in the csv/xls files should be in the same order!",
    "During labeling in Fiji one can thus (for occluded body parts) click in the origin of the image",
    "(i.e. top left corner (close to 0,0)), these \"false\" labels will then be removed. To do so set the following variable:",
    "set this to 0 if no labels should be removed!",
    "If you started from already extracted frames in a different format then change the format here (for step2 to 4).",
    "#######################################",
    "Step 3: Check labels / makes plots",
    "#######################################",
    "#######################################",
    "Step 4: Generate Training Files",
    "#######################################",
    "Userparameters for training set. Other parameters can be set in pose_cfg.yaml",
    "Which resnet to use, 101 for deeper!",
    "then change net_type and init_weights in Generating_a_Training_Set/pose_cfg.yaml",
    "Afterwards train your network!",
    "#######################################################################################################################",
    "For Evaluation your network",
    "#######################################################################################################################",
    "identifier of evaluation network:",
    "To evaluate the last snapshot (i.e. the network that was trained longest) : -1",
    "To evaluate all models (training stages) set this to: \"all\"  (as string!)",
    "This cutoff will also be used in plots.",
    "Note that this will be plotted for all snapshots as indicated by snapshotindex",
    "Select ROI of interest by adjusting values in myconfig.py",
    "###################################################",
    "Creating folder with name of experiment and extract random frames",
    "###################################################",
    "Extract the first frame (not cropped!) - useful for data augmentation",
    "Select ROI of interest by adjusting values in myconfig.py",
    "####################################################################",
    "First load the image and crop (if necessary)/ set checkcropping = True (in myconfig to do so)",
    "####################################################################",
    "###################################################",
    "Creating folder with name of experiment and extract random frames",
    "###################################################",
    "###################################################",
    "Loading dependencies",
    "###################################################",
    "##################################################",
    "Code if each bodypart has its own label file!",
    "##################################################",
    "############################################",
    "Make sure you update the train.yaml file!",
    "############################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "Data frame to hold data of all data sets for different scorers, bodyparts and images",
    "Make list of different video data sets:",
    "videos=np.sort([fn for fn in os.listdir(os.curdir) if (\"avi\" in fn)])",
    "sort image file names according to how they were stacked (when labeled in Fiji)",
    "This is important when using data combined / which runs consecutively!",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "##################################################",
    "Code if all bodyparts (per folder are shared in one file)",
    "This code below converts it into multiple csv files per body part & folder",
    "Based on an idea by @sneakers-the-rat",
    "##################################################",
    "load csv, iterate over nth value in a grouping by frame, save to bodyparts files",
    "##################################################",
    "Code if each bodypart has its own label file!",
    "##################################################",
    "Data frame to hold data of all data sets for different scorers,",
    "bodyparts and images",
    "Make list of different video data sets / each one has its own folder",
    "print(\"found\",len(folders),len(numdistinctfolders))",
    "print(\"Loading folder \", folder)",
    "sort image file names according to how they were stacked",
    "files=np.sort([fn for fn in os.listdir(os.curdir)",
    "if (\"img\" in fn and \".png\" in fn and \"_labelled\" not in fn)])",
    "Note: If your csv file is not correctly loaded, then a common error is:",
    "\"AttributeError: 'DataFrame' object has no attribute 'X'\" or the corresponding error with Slice",
    "Try to make sure you specify the seperator of the csv file correctly. See https://github.com/AlexEMG/DeepLabCut/issues/10 for details.",
    "get rid of values that are invisible >> thus user scored in left corner!",
    "frame=pd.DataFrame(np.vstack([dframe.X,dframe.Y]).T, columns=index,index=imageaddress)",
    "print(frame.head())",
    "print(\"Done with folder \", folder)",
    "Save data by this scorer",
    "###################################################",
    "Loading dependencies",
    "###################################################",
    "###################################################",
    "Definitions (Folders, data source and labels)",
    "###################################################",
    "Loading scorer's data:",
    "Make that folder and put in the collecteddata (see below)",
    "This relative path is required due way DeeperCut is structured",
    "copy images and folder structure in the folder containing",
    "training data comparison",
    "Filename for pickle file:",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make matlab train file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Convert to idosyncratic training file for deeper cut (*.mat)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "https://stackoverflow.com/questions/800197/how-to-get-all-of-the-immediate-subdirectories-in-python",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "sys.path.append(subfolder + \"/pose-tensorflow/\")",
    "###################################################",
    "Auxiliary functions",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "###################################################",
    "Loading dependencies",
    "###################################################",
    "loading meta data / i.e. training & test files",
    "###################################################",
    "Models vs. benchmark for varying training state",
    "###################################################",
    "only specific parts can also be compared (not all!) (in that case change which bodyparts by providing a list below)",
    "extract training iterations:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Deep-cut dependencies",
    "Dependencies for anaysis",
    "loading meta data / i.e. training & test files & labels",
    "######################################################################",
    "Load and setup CNN part detector as well as its configuration",
    "######################################################################",
    "Specifying state of model (snapshot / training state)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Deep-cut dependencies",
    "###################################################",
    "Loading data and evaluating network on data",
    "###################################################",
    "###############################################################################",
    "Check which snapshots exist for given network (with training data split).",
    "###############################################################################",
    "Check which snap shots are available and sort them by # iterations",
    "if not analyzed, then call auxiliary script to analyze the network:",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "Restore variables from disk.",
    "Save snapshot",
    "Adapted from original predict.py by Eldar Insafutdinov's implementation of [DeeperCut](https://github.com/eldar/pose-tensorflow)",
    "To do faster inference on videos. See https://www.biorxiv.org/content/early/2018/10/30/457242",
    "Restore variables from disk.",
    "# Functions below implement are for batch sizes > 1:",
    "Combine scoremat and offsets to the final pose.",
    "The next part of the code depends upon which tensorflow version you have.",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Load Matlab file dataset annotation",
    "make sure joint ids are 0-indexed",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Dependencies for video:",
    "###################################################",
    "Loading descriptors of model",
    "###################################################",
    "loading meta data / i.e. training & test files",
    "basefolder = os.path.join('..','pose-tensorflow','models')",
    "datafolder = os.path.join(basefolder , \"UnaugmentedDataSet_\" + Task + date)",
    "Data = pd.read_hdf(os.path.join(datafolder , 'data-' + Task , 'CollectedData_' + humanscorer + '.h5'),'df_with_missing')",
    "Name for scorer based on passed on parameters from myconfig_analysis. Make sure they refer to the network of interest.",
    "###################################################",
    "Auxiliary function",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "one might want to adjust",
    "image = img_as_ubyte(clip.get_frame(index * 1. / clip.fps))",
    "#################################################",
    "Datafolder",
    "#################################################",
    "videofolder='../videos/' #where your folder with videos is.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Deep-cut dependencies",
    "Dependencies for video:",
    "import matplotlib.pyplot as plt",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Check if data already was generated:",
    "Name for scorer:",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "Auxiliary functions:",
    "videofolder='../videos/' #where your folder with videos is.",
    "Attempt to load data.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Deep-cut dependencies",
    "Dependencies for video:",
    "import matplotlib.pyplot as plt",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check which snap shots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Check if data already was generated:",
    "Name for scorer:",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "Folder where your tiffstacks are:",
    "Attempt to load data...",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Deep-cut dependencies",
    "Dependencies for video:",
    "import matplotlib.pyplot as plt",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Check if data already was generated:",
    "Name for scorer:",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "videofolder='../videos/' #where your folder with videos is.",
    "Attempt to load data...",
    "nframes = np.sum(1 for j in clip.iter_frames()) #this is slow (but accurate)",
    "this will overestimage number of frames (see https://github.com/AlexEMG/DeepLabCut/issues/9) This is especially a problem",
    "for high frame rates and long durations due to rounding errors (as Rich Warren found). Later we crop the result (line 187)",
    "image = img_as_ubyte(clip.get_frame(index * 1. / fps))",
    "Thanks to Rick Warren for the  following snipplet:",
    "if close to end of video, start checking whether two adjacent frames are identical",
    "this should only happen when moviepy has reached the final frame",
    "if two adjacent frames are identical, terminate the loop",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Dependencies for video:",
    "###################################################",
    "Loading descriptors of model",
    "###################################################",
    "loading meta data / i.e. training & test files",
    "basefolder = os.path.join('..','pose-tensorflow','models')",
    "datafolder = os.path.join(basefolder , \"UnaugmentedDataSet_\" + Task + date)",
    "Data = pd.read_hdf(os.path.join(datafolder , 'data-' + Task , 'CollectedData_' + humanscorer + '.h5'),'df_with_missing')",
    "Name for scorer based on passed on parameters from myconfig_analysis. Make sure they refer to the network of interest.",
    "###################################################",
    "Auxiliary function",
    "###################################################",
    "rr, cc = circle_perimeter(yc,xc,radius)",
    "#################################################",
    "Datafolder",
    "#################################################"
  ],
  "v1.02": [
    "coding: utf-8",
    "########################################################################################",
    "This configuration file sets various parameters for running a trained model on videos!",
    "",
    "First, make sure that the network performed well on the train/test data set.",
    "",
    "The pose output is saved as hdf file with a name containing the video name as well as the network name",
    "You can also save the output as csv (see below) or in many other formats see https://github.com/AlexEMG/DeepLabCut/issues/17",
    "",
    "########################################################################################",
    "Filename and path to behavioral video for analysis",
    "Note: under the hood there is moviepy, which can handle many types of videos:",
    "See: https://zulko.github.io/moviepy/_modules/moviepy/video/io/VideoFileClip.html",
    "If you have stacks of tiffs (instead of videos) you can use \"AnalyzeABunchofPictures.py\"",
    "ROI dimensions / bounding box (only used if cropping == True)",
    "x1,y1 indicates the top left corner and",
    "x2,y2 is the lower right corner of the cropped region.",
    "########################################################################################",
    "Analysis Network parameters",
    "########################################################################################",
    "These variables should be changed so that the right networks is loaded for analysis",
    "(Typicaly just copy them over from myconfig.py)",
    "Note the data is always saved in hdf - format which is an efficient format",
    "that easily allows to load the full pandas multiarray at a later stage",
    "########################################################################################",
    "# For plotting (MakingLabeledVideo.py / MakingLabeledVideo_fast.py)",
    "########################################################################################",
    "based on the labels for this network state.",
    "delete individual (labeled) frames after making video? (note there could be many...)",
    "coding: utf-8",
    "####################################################################################",
    "This configuration file sets various parameters for training and evaluating DeepLabCut",
    "####################################################################################",
    "myconfig.py:",
    "#######################################",
    "Step 1: Selecting Frames from videos",
    "#######################################",
    "Filename and path to behavioral video:",
    "Put name of video: / or 'all' to extract frames from all videos in folder.",
    "filename = 'all'",
    "ROI dimensions / bounding box (only used if cropping == True)",
    "x1,y1 indicates the top left corner and",
    "x2,y2 is the lower right corner of the cropped region.",
    "Portion of the video to sample from in step 1 (In relative terms of video length, i.e. [0,1] is the full video)",
    "Number of frames to pick",
    "Method to pick frames: uniform or kmeans",
    "the algorithm 'uniform' temporally uniformly sampes frames in interval (start,stop). Visual information within video is irrelevant for this method. This code is very fast and sufficient (to extract distinct frames) when behavioral videos naturally covers many states.",
    "Alternatively consider using: 'kmeans'",
    "This code downsamples the video. The video is extracted as a numpy array, which is then",
    "clustered by kmeans whereby each frames are treated as a vector. Frames from different clusters are then selected for labeling. This",
    "procedure makes sure that the frames \"look different\", i.e. different postures etc.",
    "On large videos this code is slow. Consider not extracting the frames from the whole video but rather set start and stop to a period around interesting behavior that you want DeepLabCut to resolve/analyze (i.e. a reach).",
    "#######################################",
    "Step 2: Converting frames to pandas array",
    "#######################################",
    "annotator in *.csv file (for multibodypartsfile). For single files order is irrelevant",
    "Set this true if the data was sequentially labeled and if there is one file per folder (you can set the name of this file below, i.e. multibodypartsfilename)",
    "Otherwise there should be individual files per bodypart, i.e. in our demo case hand.csv, Finger1.csv etc.",
    "If true then those files will be generated from Results.txt",
    "When importing the images and the labels in the csv/xls files should be in the same order!",
    "During labeling in Fiji one can thus (for occluded body parts) click in the origin of the image",
    "(i.e. top left corner (close to 0,0)), these \"false\" labels will then be removed. To do so set the following variable:",
    "set this to 0 if no labels should be removed!",
    "If you started from already extracted frames in a different format then change the format here (for step2 to 4).",
    "#######################################",
    "Step 3: Check labels / makes plots",
    "#######################################",
    "#######################################",
    "Step 4: Generate Training Files",
    "#######################################",
    "Userparameters for training set. Other parameters can be set in pose_cfg.yaml",
    "Which resnet to use, 101 for deeper!",
    "then change net_type and init_weights in Generating_a_Training_Set/pose_cfg.yaml",
    "Afterwards train your network!",
    "#######################################################################################################################",
    "For Evaluation your network",
    "#######################################################################################################################",
    "identifier of evaluation network:",
    "To evaluate the last snapshot (i.e. the network that was trained longest) : -1",
    "To evaluate all models (training stages) set this to: \"all\"  (as string!)",
    "This cutoff will also be used in plots.",
    "Note that this will be plotted for all snapshots as indicated by snapshotindex",
    "Select ROI of interest by adjusting values in myconfig.py",
    "###################################################",
    "Creating folder with name of experiment and extract random frames",
    "###################################################",
    "Extract the first frame (not cropped!) - useful for data augmentation",
    "Select ROI of interest by adjusting values in myconfig.py",
    "####################################################################",
    "First load the image and crop (if necessary)/ set checkcropping = True (in myconfig to do so)",
    "####################################################################",
    "###################################################",
    "Creating folder with name of experiment and extract random frames",
    "###################################################",
    "###################################################",
    "Loading dependencies",
    "###################################################",
    "##################################################",
    "Code if each bodypart has its own label file!",
    "##################################################",
    "############################################",
    "Make sure you update the train.yaml file!",
    "############################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "Data frame to hold data of all data sets for different scorers, bodyparts and images",
    "Make list of different video data sets:",
    "videos=np.sort([fn for fn in os.listdir(os.curdir) if (\"avi\" in fn)])",
    "sort image file names according to how they were stacked (when labeled in Fiji)",
    "This is important when using data combined / which runs consecutively!",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "##################################################",
    "Code if all bodyparts (per folder are shared in one file)",
    "This code below converts it into multiple csv files per body part & folder",
    "Based on an idea by @sneakers-the-rat",
    "##################################################",
    "load csv, iterate over nth value in a grouping by frame, save to bodyparts files",
    "##################################################",
    "Code if each bodypart has its own label file!",
    "##################################################",
    "Data frame to hold data of all data sets for different scorers,",
    "bodyparts and images",
    "Make list of different video data sets / each one has its own folder",
    "print(\"found\",len(folders),len(numdistinctfolders))",
    "print(\"Loading folder \", folder)",
    "sort image file names according to how they were stacked",
    "files=np.sort([fn for fn in os.listdir(os.curdir)",
    "if (\"img\" in fn and \".png\" in fn and \"_labelled\" not in fn)])",
    "Note: If your csv file is not correctly loaded, then a common error is:",
    "\"AttributeError: 'DataFrame' object has no attribute 'X'\" or the corresponding error with Slice",
    "Try to make sure you specify the seperator of the csv file correctly. See https://github.com/AlexEMG/DeepLabCut/issues/10 for details.",
    "get rid of values that are invisible >> thus user scored in left corner!",
    "frame=pd.DataFrame(np.vstack([dframe.X,dframe.Y]).T, columns=index,index=imageaddress)",
    "print(frame.head())",
    "print(\"Done with folder \", folder)",
    "Save data by this scorer",
    "###################################################",
    "Loading dependencies",
    "###################################################",
    "###################################################",
    "Definitions (Folders, data source and labels)",
    "###################################################",
    "Loading scorer's data:",
    "Make that folder and put in the collecteddata (see below)",
    "This relative path is required due way DeeperCut is structured",
    "copy images and folder structure in the folder containing",
    "training data comparison",
    "Filename for pickle file:",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make matlab train file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Convert to idosyncratic training file for deeper cut (*.mat)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "https://stackoverflow.com/questions/800197/how-to-get-all-of-the-immediate-subdirectories-in-python",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "sys.path.append(subfolder + \"/pose-tensorflow/\")",
    "###################################################",
    "Auxiliary functions",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "###################################################",
    "Loading dependencies",
    "###################################################",
    "loading meta data / i.e. training & test files",
    "###################################################",
    "Models vs. benchmark for varying training state",
    "###################################################",
    "only specific parts can also be compared (not all!) (in that case change which bodyparts by providing a list below)",
    "extract training iterations:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Deep-cut dependencies",
    "Dependencies for anaysis",
    "loading meta data / i.e. training & test files & labels",
    "######################################################################",
    "Load and setup CNN part detector as well as its configuration",
    "######################################################################",
    "Specifying state of model (snapshot / training state)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Deep-cut dependencies",
    "###################################################",
    "Loading data and evaluating network on data",
    "###################################################",
    "###############################################################################",
    "Check which snapshots exist for given network (with training data split).",
    "###############################################################################",
    "Check which snap shots are available and sort them by # iterations",
    "if not analyzed, then call auxiliary script to analyze the network:",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Restore variables from disk.",
    "The next part of the code depends upon which tensorflow version you have.",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "Restore variables from disk.",
    "Save snapshot",
    "Restore variables from disk.",
    "The next part of the code depends upon which tensorflow version you have.",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Load Matlab file dataset annotation",
    "make sure joint ids are 0-indexed",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Dependencies for video:",
    "###################################################",
    "Loading descriptors of model",
    "###################################################",
    "loading meta data / i.e. training & test files",
    "basefolder = os.path.join('..','pose-tensorflow','models')",
    "datafolder = os.path.join(basefolder , \"UnaugmentedDataSet_\" + Task + date)",
    "Data = pd.read_hdf(os.path.join(datafolder , 'data-' + Task , 'CollectedData_' + humanscorer + '.h5'),'df_with_missing')",
    "Name for scorer based on passed on parameters from myconfig_analysis. Make sure they refer to the network of interest.",
    "###################################################",
    "Auxiliary function",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "one might want to adjust",
    "image = img_as_ubyte(clip.get_frame(index * 1. / clip.fps))",
    "#################################################",
    "Datafolder",
    "#################################################",
    "videofolder='../videos/' #where your folder with videos is.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Deep-cut dependencies",
    "Dependencies for video:",
    "import matplotlib.pyplot as plt",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Check if data already was generated:",
    "Name for scorer:",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "videofolder='../videos/' #where your folder with videos is.",
    "Attempt to load data...",
    "nframes = np.sum(1 for j in clip.iter_frames()) #this is slow (but accurate)",
    "this will overestimage number of frames (see https://github.com/AlexEMG/DeepLabCut/issues/9) This is especially a problem",
    "for high frame rates and long durations due to rounding errors (as Rich Warren found). Later we crop the result (line 187)",
    "image = img_as_ubyte(clip.get_frame(index * 1. / fps))",
    "Thanks to Rick Warren for the  following snipplet:",
    "if close to end of video, start checking whether two adjacent frames are identical",
    "this should only happen when moviepy has reached the final frame",
    "if two adjacent frames are identical, terminate the loop",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Deep-cut dependencies",
    "Dependencies for video:",
    "import matplotlib.pyplot as plt",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check which snap shots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Check if data already was generated:",
    "Name for scorer:",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "Folder where your tiffstacks are:",
    "Attempt to load data...",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Dependencies for video:",
    "###################################################",
    "Loading descriptors of model",
    "###################################################",
    "loading meta data / i.e. training & test files",
    "basefolder = os.path.join('..','pose-tensorflow','models')",
    "datafolder = os.path.join(basefolder , \"UnaugmentedDataSet_\" + Task + date)",
    "Data = pd.read_hdf(os.path.join(datafolder , 'data-' + Task , 'CollectedData_' + humanscorer + '.h5'),'df_with_missing')",
    "Name for scorer based on passed on parameters from myconfig_analysis. Make sure they refer to the network of interest.",
    "###################################################",
    "Auxiliary function",
    "###################################################",
    "rr, cc = circle_perimeter(yc,xc,radius)",
    "#################################################",
    "Datafolder",
    "#################################################"
  ],
  "v1.01": [
    "coding: utf-8",
    "########################################################################################",
    "This configuration file sets various parameters for running a trained model on videos!",
    "",
    "First, make sure that the network performed well on the train/test data set.",
    "",
    "The pose output is saved as hdf file with a name containing the video name as well as the network name",
    "You can also save the output as csv (see below) or in many other formats see https://github.com/AlexEMG/DeepLabCut/issues/17",
    "",
    "########################################################################################",
    "Filename and path to behavioral video for analysis",
    "Note: under the hood there is moviepy, which can handle many types of videos:",
    "See: https://zulko.github.io/moviepy/_modules/moviepy/video/io/VideoFileClip.html",
    "If you have stacks of tiffs (instead of videos) you can use \"AnalyzeABunchofPictures.py\"",
    "ROI dimensions / bounding box (only used if cropping == True)",
    "x1,y1 indicates the top left corner and",
    "x2,y2 is the lower right corner of the cropped region.",
    "########################################################################################",
    "Analysis Network parameters",
    "########################################################################################",
    "These variables should be changed so that the right networks is loaded for analysis",
    "(Typicaly just copy them over from myconfig.py)",
    "Note the data is always saved in hdf - format which is an efficient format",
    "that easily allows to load the full pandas multiarray at a later stage",
    "########################################################################################",
    "# For plotting (MakingLabeledVideo.py / MakingLabeledVideo_fast.py)",
    "########################################################################################",
    "based on the labels for this network state.",
    "delete individual (labeled) frames after making video? (note there could be many...)",
    "coding: utf-8",
    "####################################################################################",
    "This configuration file sets various parameters for training and evaluating DeepLabCut",
    "####################################################################################",
    "myconfig.py:",
    "#######################################",
    "Step 1: Selecting Frames from videos",
    "#######################################",
    "Filename and path to behavioral video:",
    "Put name of video: / or 'all' to extract frames from all videos in folder.",
    "filename = 'all'",
    "ROI dimensions / bounding box (only used if cropping == True)",
    "x1,y1 indicates the top left corner and",
    "x2,y2 is the lower right corner of the cropped region.",
    "Portion of the video to sample from in step 1 (In relative terms of video length, i.e. [0,1] is the full video)",
    "Number of frames to pick",
    "Method to pick frames: uniform or kmeans",
    "the algorithm 'uniform' temporally uniformly sampes frames in interval (start,stop). Visual information within video is irrelevant for this method. This code is very fast and sufficient (to extract distinct frames) when behavioral videos naturally covers many states.",
    "Alternatively consider using: 'kmeans'",
    "This code downsamples the video. The video is extracted as a numpy array, which is then",
    "clustered by kmeans whereby each frames are treated as a vector. Frames from different clusters are then selected for labeling. This",
    "procedure makes sure that the frames \"look different\", i.e. different postures etc.",
    "On large videos this code is slow. Consider not extracting the frames from the whole video but rather set start and stop to a period around interesting behavior that you want DeepLabCut to resolve/analyze (i.e. a reach).",
    "#######################################",
    "Step 2: Converting frames to pandas array",
    "#######################################",
    "annotator in *.csv file (for multibodypartsfile). For single files order is irrelevant",
    "Set this true if the data was sequentially labeled and if there is one file per folder (you can set the name of this file below, i.e. multibodypartsfilename)",
    "Otherwise there should be individual files per bodypart, i.e. in our demo case hand.csv, Finger1.csv etc.",
    "If true then those files will be generated from Results.txt",
    "When importing the images and the labels in the csv/xls files should be in the same order!",
    "During labeling in Fiji one can thus (for occluded body parts) click in the origin of the image",
    "(i.e. top left corner (close to 0,0)), these \"false\" labels will then be removed. To do so set the following variable:",
    "set this to 0 if no labels should be removed!",
    "If you started from already extracted frames in a different format then change the format here (for step2 to 4).",
    "#######################################",
    "Step 3: Check labels / makes plots",
    "#######################################",
    "#######################################",
    "Step 4: Generate Training Files",
    "#######################################",
    "Userparameters for training set. Other parameters can be set in pose_cfg.yaml",
    "Which resnet to use, 101 for deeper!",
    "then change net_type and init_weights in Generating_a_Training_Set/pose_cfg.yaml",
    "Afterwards train your network!",
    "#######################################################################################################################",
    "For Evaluation your network",
    "#######################################################################################################################",
    "identifier of evaluation network:",
    "To evaluate the last snapshot (i.e. the network that was trained longest) : -1",
    "To evaluate all models (training stages) set this to: \"all\"  (as string!)",
    "This cutoff will also be used in plots.",
    "Note that this will be plotted for all snapshots as indicated by snapshotindex",
    "Select ROI of interest by adjusting values in myconfig.py",
    "###################################################",
    "Creating folder with name of experiment and extract random frames",
    "###################################################",
    "Extract the first frame (not cropped!) - useful for data augmentation",
    "Select ROI of interest by adjusting values in myconfig.py",
    "####################################################################",
    "First load the image and crop (if necessary)/ set checkcropping = True (in myconfig to do so)",
    "####################################################################",
    "###################################################",
    "Creating folder with name of experiment and extract random frames",
    "###################################################",
    "###################################################",
    "Loading dependencies",
    "###################################################",
    "##################################################",
    "Code if each bodypart has its own label file!",
    "##################################################",
    "############################################",
    "Make sure you update the train.yaml file!",
    "############################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "Data frame to hold data of all data sets for different scorers, bodyparts and images",
    "Make list of different video data sets:",
    "videos=np.sort([fn for fn in os.listdir(os.curdir) if (\"avi\" in fn)])",
    "sort image file names according to how they were stacked (when labeled in Fiji)",
    "This is important when using data combined / which runs consecutively!",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "##################################################",
    "Code if all bodyparts (per folder are shared in one file)",
    "This code below converts it into multiple csv files per body part & folder",
    "Based on an idea by @sneakers-the-rat",
    "##################################################",
    "load csv, iterate over nth value in a grouping by frame, save to bodyparts files",
    "##################################################",
    "Code if each bodypart has its own label file!",
    "##################################################",
    "Data frame to hold data of all data sets for different scorers,",
    "bodyparts and images",
    "Make list of different video data sets / each one has its own folder",
    "print(\"found\",len(folders),len(numdistinctfolders))",
    "print(\"Loading folder \", folder)",
    "sort image file names according to how they were stacked",
    "files=np.sort([fn for fn in os.listdir(os.curdir)",
    "if (\"img\" in fn and \".png\" in fn and \"_labelled\" not in fn)])",
    "Note: If your csv file is not correctly loaded, then a common error is:",
    "\"AttributeError: 'DataFrame' object has no attribute 'X'\" or the corresponding error with Slice",
    "Try to make sure you specify the seperator of the csv file correctly. See https://github.com/AlexEMG/DeepLabCut/issues/10 for details.",
    "get rid of values that are invisible >> thus user scored in left corner!",
    "frame=pd.DataFrame(np.vstack([dframe.X,dframe.Y]).T, columns=index,index=imageaddress)",
    "print(frame.head())",
    "print(\"Done with folder \", folder)",
    "Save data by this scorer",
    "###################################################",
    "Loading dependencies",
    "###################################################",
    "###################################################",
    "Definitions (Folders, data source and labels)",
    "###################################################",
    "Loading scorer's data:",
    "Make that folder and put in the collecteddata (see below)",
    "This relative path is required due way DeeperCut is structured",
    "copy images and folder structure in the folder containing",
    "training data comparison",
    "Filename for pickle file:",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make matlab train file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Convert to idosyncratic training file for deeper cut (*.mat)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "https://stackoverflow.com/questions/800197/how-to-get-all-of-the-immediate-subdirectories-in-python",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "sys.path.append(subfolder + \"/pose-tensorflow/\")",
    "###################################################",
    "Auxiliary functions",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "###################################################",
    "Loading dependencies",
    "###################################################",
    "loading meta data / i.e. training & test files",
    "###################################################",
    "Models vs. benchmark for varying training state",
    "###################################################",
    "only specific parts can also be compared (not all!) (in that case change which bodyparts by providing a list below)",
    "extract training iterations:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Deep-cut dependencies",
    "Dependencies for anaysis",
    "loading meta data / i.e. training & test files & labels",
    "######################################################################",
    "Load and setup CNN part detector as well as its configuration",
    "######################################################################",
    "Specifying state of model (snapshot / training state)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Deep-cut dependencies",
    "###################################################",
    "Loading data and evaluating network on data",
    "###################################################",
    "###############################################################################",
    "Check which snapshots exist for given network (with training data split).",
    "###############################################################################",
    "Check which snap shots are available and sort them by # iterations",
    "if not analyzed, then call auxiliary script to analyze the network:",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Restore variables from disk.",
    "The next part of the code depends upon which tensorflow version you have.",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "Restore variables from disk.",
    "Save snapshot",
    "Restore variables from disk.",
    "The next part of the code depends upon which tensorflow version you have.",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Load Matlab file dataset annotation",
    "make sure joint ids are 0-indexed",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Dependencies for video:",
    "###################################################",
    "Loading descriptors of model",
    "###################################################",
    "loading meta data / i.e. training & test files",
    "basefolder = os.path.join('..','pose-tensorflow','models')",
    "datafolder = os.path.join(basefolder , \"UnaugmentedDataSet_\" + Task + date)",
    "Data = pd.read_hdf(os.path.join(datafolder , 'data-' + Task , 'CollectedData_' + humanscorer + '.h5'),'df_with_missing')",
    "Name for scorer based on passed on parameters from myconfig_analysis. Make sure they refer to the network of interest.",
    "###################################################",
    "Auxiliary function",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "one might want to adjust",
    "image = img_as_ubyte(clip.get_frame(index * 1. / clip.fps))",
    "#################################################",
    "Datafolder",
    "#################################################",
    "videofolder='../videos/' #where your folder with videos is.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Deep-cut dependencies",
    "Dependencies for video:",
    "import matplotlib.pyplot as plt",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Check if data already was generated:",
    "Name for scorer:",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "videofolder='../videos/' #where your folder with videos is.",
    "Attempt to load data...",
    "nframes = np.sum(1 for j in clip.iter_frames()) #this is slow (but accurate)",
    "this will overestimage number of frames (see https://github.com/AlexEMG/DeepLabCut/issues/9) This is especially a problem",
    "for high frame rates and long durations due to rounding errors (as Rich Warren found). Later we crop the result (line 187)",
    "image = img_as_ubyte(clip.get_frame(index * 1. / fps))",
    "Thanks to Rick Warren for the  following snipplet:",
    "if close to end of video, start checking whether two adjacent frames are identical",
    "this should only happen when moviepy has reached the final frame",
    "if two adjacent frames are identical, terminate the loop",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Deep-cut dependencies",
    "Dependencies for video:",
    "import matplotlib.pyplot as plt",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check which snap shots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Check if data already was generated:",
    "Name for scorer:",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "Folder where your tiffstacks are:",
    "Attempt to load data...",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Dependencies for video:",
    "###################################################",
    "Loading descriptors of model",
    "###################################################",
    "loading meta data / i.e. training & test files",
    "basefolder = os.path.join('..','pose-tensorflow','models')",
    "datafolder = os.path.join(basefolder , \"UnaugmentedDataSet_\" + Task + date)",
    "Data = pd.read_hdf(os.path.join(datafolder , 'data-' + Task , 'CollectedData_' + humanscorer + '.h5'),'df_with_missing')",
    "Name for scorer based on passed on parameters from myconfig_analysis. Make sure they refer to the network of interest.",
    "###################################################",
    "Auxiliary function",
    "###################################################",
    "rr, cc = circle_perimeter(yc,xc,radius)",
    "#################################################",
    "Datafolder",
    "#################################################"
  ],
  "v1.0": [
    "coding: utf-8",
    "########################################################################################",
    "This configuration file sets various parameters for running a trained model on videos!",
    "",
    "First, make sure that the network performed well on the train/test data set.",
    "",
    "The pose output is saved as hdf file with a name containing the video name as well as the network name",
    "You can also save the output as csv (see below) or in many other formats see https://github.com/AlexEMG/DeepLabCut/issues/17",
    "",
    "########################################################################################",
    "Filename and path to behavioral video for analysis",
    "Note: under the hood there is moviepy, which can handle many types of videos:",
    "See: https://zulko.github.io/moviepy/_modules/moviepy/video/io/VideoFileClip.html",
    "If you have stacks of tiffs (instead of videos) you can use \"AnalyzeABunchofPictures.py\"",
    "ROI dimensions / bounding box (only used if cropping == True)",
    "x1,y1 indicates the top left corner and",
    "x2,y2 is the lower right corner of the cropped region.",
    "########################################################################################",
    "Analysis Network parameters",
    "########################################################################################",
    "These variables should be changed so that the right networks is loaded for analysis",
    "(Typicaly just copy them over from myconfig.py)",
    "Note the data is always saved in hdf - format which is an efficient format",
    "that easily allows to load the full pandas multiarray at a later stage",
    "########################################################################################",
    "# For plotting (MakingLabeledVideo.py / MakingLabeledVideo_fast.py)",
    "########################################################################################",
    "based on the labels for this network state.",
    "delete individual (labeled) frames after making video? (note there could be many...)",
    "coding: utf-8",
    "####################################################################################",
    "This configuration file sets various parameters for training and evaluating DeepLabCut",
    "####################################################################################",
    "myconfig.py:",
    "#######################################",
    "Step 1: Selecting Frames from videos",
    "#######################################",
    "Filename and path to behavioral video:",
    "Put name of video: / or 'all' to extract frames from all videos in folder.",
    "filename = 'all'",
    "ROI dimensions / bounding box (only used if cropping == True)",
    "x1,y1 indicates the top left corner and",
    "x2,y2 is the lower right corner of the cropped region.",
    "Portion of the video to sample from in step 1 (In relative terms of video length, i.e. [0,1] is the full video)",
    "Number of frames to pick",
    "Method to pick frames:",
    "the algorithm 'uniform' temporally uniformly sampes frames in interval (start,stop). Visual information within video is irrelevant for this method. This code is very fast and sufficient (to extract distinct frames) when behavioral videos naturally covers many states.",
    "Alternatively consider using: 'kmeans'",
    "This code downsamples the video. The video is extracted as a numpy array, which is then",
    "clustered by kmeans whereby each frames are treated as a vector. Frames from different clusters are then selected for labeling. This",
    "procedure makes sure that the frames \"look different\", i.e. different postures etc.",
    "On large videos this code is slow. Consider not extracting the frames from the whole video but rather set start and stop to a period around interesting behavior that you want DeepLabCut to resolve/analyze (i.e. a reach).",
    "#######################################",
    "Step 2: Converting frames to pandas array",
    "#######################################",
    "annotator in *.csv file (for multibodypartsfile). For single files order is irrelevant",
    "Set this true if the data was sequentially labeled and if there is one file per folder (you can set the name of this file below, i.e. multibodypartsfilename)",
    "Otherwise there should be individual files per bodypart, i.e. in our demo case hand.csv, Finger1.csv etc.",
    "If true then those files will be generated from Results.txt",
    "When importing the images and the labels in the csv/xls files should be in the same order!",
    "During labeling in Fiji one can thus (for occluded body parts) click in the origin of the image",
    "(i.e. top left corner (close to 0,0)), these \"false\" labels will then be removed. To do so set the following variable:",
    "set this to 0 if no labels should be removed!",
    "If you started from already extracted frames in a different format then change the format here (for step2 to 4).",
    "#######################################",
    "Step 3: Check labels / makes plots",
    "#######################################",
    "#######################################",
    "Step 4: Generate Training Files",
    "#######################################",
    "Userparameters for training set. Other parameters can be set in pose_cfg.yaml",
    "Which resnet to use, 101 for deeper!",
    "then change net_type and init_weights in Generating_a_Training_Set/pose_cfg.yaml",
    "Afterwards train your network!",
    "#######################################################################################################################",
    "For Evaluation your network",
    "#######################################################################################################################",
    "identifier of evaluation network:",
    "To evaluate the last snapshot (i.e. the network that was trained longest) : -1",
    "To evaluate all models (training stages) set this to: \"all\"  (as string!)",
    "This cutoff will also be used in plots.",
    "Note that this will be plotted for all snapshots as indicated by snapshotindex",
    "Select ROI of interest by adjusting values in myconfig.py",
    "###################################################",
    "Creating folder with name of experiment and extract random frames",
    "###################################################",
    "Extract the first frame (not cropped!) - useful for data augmentation",
    "Select ROI of interest by adjusting values in myconfig.py",
    "####################################################################",
    "First load the image and crop (if necessary)/ set checkcropping = True (in myconfig to do so)",
    "####################################################################",
    "###################################################",
    "Creating folder with name of experiment and extract random frames",
    "###################################################",
    "###################################################",
    "Loading dependencies",
    "###################################################",
    "##################################################",
    "Code if each bodypart has its own label file!",
    "##################################################",
    "############################################",
    "Make sure you update the train.yaml file!",
    "############################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "Data frame to hold data of all data sets for different scorers, bodyparts and images",
    "Make list of different video data sets:",
    "videos=np.sort([fn for fn in os.listdir(os.curdir) if (\"avi\" in fn)])",
    "sort image file names according to how they were stacked (when labeled in Fiji)",
    "This is important when using data combined / which runs consecutively!",
    "!/usr/bin/env python3",
    "-*- coding: utf-8 -*-",
    "##################################################",
    "Code if all bodyparts (per folder are shared in one file)",
    "This code below converts it into multiple csv files per body part & folder",
    "Based on an idea by @sneakers-the-rat",
    "##################################################",
    "load csv, iterate over nth value in a grouping by frame, save to bodyparts files",
    "##################################################",
    "Code if each bodypart has its own label file!",
    "##################################################",
    "Data frame to hold data of all data sets for different scorers,",
    "bodyparts and images",
    "Make list of different video data sets / each one has its own folder",
    "print(\"found\",len(folders),len(numdistinctfolders))",
    "print(\"Loading folder \", folder)",
    "sort image file names according to how they were stacked",
    "files=np.sort([fn for fn in os.listdir(os.curdir)",
    "if (\"img\" in fn and \".png\" in fn and \"_labelled\" not in fn)])",
    "Note: If your csv file is not correctly loaded, then a common error is:",
    "\"AttributeError: 'DataFrame' object has no attribute 'X'\" or the corresponding error with Slice",
    "Try to make sure you specify the seperator of the csv file correctly. See https://github.com/AlexEMG/DeepLabCut/issues/10 for details.",
    "get rid of values that are invisible >> thus user scored in left corner!",
    "frame=pd.DataFrame(np.vstack([dframe.X,dframe.Y]).T, columns=index,index=imageaddress)",
    "print(frame.head())",
    "print(\"Done with folder \", folder)",
    "Save data by this scorer",
    "###################################################",
    "Loading dependencies",
    "###################################################",
    "###################################################",
    "Definitions (Folders, data source and labels)",
    "###################################################",
    "Loading scorer's data:",
    "Make that folder and put in the collecteddata (see below)",
    "This relative path is required due way DeeperCut is structured",
    "copy images and folder structure in the folder containing",
    "training data comparison",
    "Filename for pickle file:",
    "###################################################",
    "Generating data structure with labeled information & frame metadata (for deep cut)",
    "###################################################",
    "Make matlab train file!",
    "load image to get dimensions:",
    "print \"Grayscale!\"",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "###############################################################################",
    "Convert to idosyncratic training file for deeper cut (*.mat)",
    "###############################################################################",
    "###############################################################################",
    "Creating file structure for training &",
    "Test files as well as pose_yaml files (containing training and testing information)",
    "################################################################################",
    "Pickle the 'data' dictionary using the highest protocol available.",
    "https://stackoverflow.com/questions/800197/how-to-get-all-of-the-immediate-subdirectories-in-python",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "sys.path.append(subfolder + \"/pose-tensorflow/\")",
    "###################################################",
    "Auxiliary functions",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "###################################################",
    "Loading dependencies",
    "###################################################",
    "loading meta data / i.e. training & test files",
    "###################################################",
    "Models vs. benchmark for varying training state",
    "###################################################",
    "only specific parts can also be compared (not all!) (in that case change which bodyparts by providing a list below)",
    "extract training iterations:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Deep-cut dependencies",
    "Dependencies for anaysis",
    "loading meta data / i.e. training & test files & labels",
    "######################################################################",
    "Load and setup CNN part detector as well as its configuration",
    "######################################################################",
    "Specifying state of model (snapshot / training state)",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Compute prediction with the CNN",
    "Extract maximum scoring location from the heatmap, assume 1 person",
    "Saving results:",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Deep-cut dependencies",
    "###################################################",
    "Loading data and evaluating network on data",
    "###################################################",
    "###############################################################################",
    "Check which snapshots exist for given network (with training data split).",
    "###############################################################################",
    "Check which snap shots are available and sort them by # iterations",
    "if not analyzed, then call auxiliary script to analyze the network:",
    "a must specify keys that are in b",
    "if k not in b:",
    "raise KeyError('{} is not a valid config key'.format(k))",
    "recursively merge dicts",
    "Restore variables from disk.",
    "The next part of the code depends upon which tensorflow version you have.",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "scmask = batch[Batch.part_score_weights]",
    "if scmask.size > 1:",
    "scmask = np.squeeze(scmask).astype('uint8')",
    "else:",
    "scmask = np.zeros(img.shape)",
    "figure(0)",
    "plt.imshow(np.sum(scmap, axis=2))",
    "plt.figure(100)",
    "plt.imshow(img)",
    "plt.figure(2)",
    "plt.imshow(scmask)",
    "Restore variables from disk.",
    "Save snapshot",
    "Restore variables from disk.",
    "The next part of the code depends upon which tensorflow version you have.",
    "loss['total_loss'] = slim.losses.get_total_loss(add_regularization_losses=params.regularize)",
    "Load Matlab file dataset annotation",
    "make sure joint ids are 0-indexed",
    "horizontally flip the x-coordinate, keep y unchanged",
    "joint ids are 0 indexed",
    "swap the joint_id for a symmetric one",
    "don't loop over entire heatmap, but just relevant locations",
    "pt = arr([i*stride+half_stride, j*stride+half_stride])",
    "diff = joint_pt - pt",
    "The code above is too slow in python",
    "print(la.norm(diff))",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Dependencies for video:",
    "###################################################",
    "Loading descriptors of model",
    "###################################################",
    "loading meta data / i.e. training & test files",
    "basefolder = os.path.join('..','pose-tensorflow','models')",
    "datafolder = os.path.join(basefolder , \"UnaugmentedDataSet_\" + Task + date)",
    "Data = pd.read_hdf(os.path.join(datafolder , 'data-' + Task , 'CollectedData_' + humanscorer + '.h5'),'df_with_missing')",
    "Name for scorer based on passed on parameters from myconfig_analysis. Make sure they refer to the network of interest.",
    "###################################################",
    "Auxiliary function",
    "###################################################",
    "https://stackoverflow.com/questions/14720331/how-to-generate-random-colors-in-matplotlib",
    "one might want to adjust",
    "image = img_as_ubyte(clip.get_frame(index * 1. / clip.fps))",
    "#################################################",
    "Datafolder",
    "#################################################",
    "videofolder='../videos/' #where your folder with videos is.",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Deep-cut dependencies",
    "Dependencies for video:",
    "import matplotlib.pyplot as plt",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check which snapshots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Check if data already was generated:",
    "Name for scorer:",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "videofolder='../videos/' #where your folder with videos is.",
    "Attempt to load data...",
    "nframes = np.sum(1 for j in clip.iter_frames()) #this is slow (but accurate)",
    "this will overestimage number of frames (see https://github.com/AlexEMG/DeepLabCut/issues/9) This is especially a problem",
    "for high frame rates and long durations due to rounding errors (as Rich Warren found). Later we crop the result (line 187)",
    "image = img_as_ubyte(clip.get_frame(index * 1. / fps))",
    "Thanks to Rick Warren for the  following snipplet:",
    "if close to end of video, start checking whether two adjacent frames are identical",
    "this should only happen when moviepy has reached the final frame",
    "if two adjacent frames are identical, terminate the loop",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Deep-cut dependencies",
    "Dependencies for video:",
    "import matplotlib.pyplot as plt",
    "###################################################",
    "Loading data, and defining model folder",
    "###################################################",
    "#################################################",
    "Load and setup CNN part detector",
    "#################################################",
    "Check which snap shots are available and sort them by # iterations",
    "#################################################",
    "Compute predictions over images",
    "#################################################",
    "Check if data already was generated:",
    "Name for scorer:",
    "Name for scorer:",
    "#################################################",
    "Datafolder",
    "#################################################",
    "Folder where your tiffstacks are:",
    "Attempt to load data...",
    "###################################################",
    "Dependencies",
    "###################################################",
    "add parent directory: (where nnet & config are!)",
    "Dependencies for video:",
    "###################################################",
    "Loading descriptors of model",
    "###################################################",
    "loading meta data / i.e. training & test files",
    "basefolder = os.path.join('..','pose-tensorflow','models')",
    "datafolder = os.path.join(basefolder , \"UnaugmentedDataSet_\" + Task + date)",
    "Data = pd.read_hdf(os.path.join(datafolder , 'data-' + Task , 'CollectedData_' + humanscorer + '.h5'),'df_with_missing')",
    "Name for scorer based on passed on parameters from myconfig_analysis. Make sure they refer to the network of interest.",
    "###################################################",
    "Auxiliary function",
    "###################################################",
    "rr, cc = circle_perimeter(yc,xc,radius)",
    "#################################################",
    "Datafolder",
    "#################################################"
  ]
}